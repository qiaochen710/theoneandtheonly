/*
BUILT_AT: 2021年2月2日 11:39
*/
!function(t){function e(e){for(var i,r,s=e[0],c=e[1],l=e[2],d=0,f=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);for(u&&u(e);f.length;)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},o={3:0},a=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(t){var e=[],n=o[t];if(0!==n)if(n)e.push(n[2]);else{var i=new Promise((function(e,i){n=o[t]=[e,i]}));e.push(n[2]=i);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=function(t){return r.p+"static/js/"+({}[t]||t)+".faad86e9.js"}(t);var c=new Error;a=function(e){s.onerror=s.onload=null,clearTimeout(l);var n=o[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",c.name="ChunkLoadError",c.type=i,c.request=a,n[1](c)}o[t]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(e)},r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="//s2.hdslb.com/bfs/static/blive/blfe-dynamic-web/",r.oe=function(t){throw console.error(t),t};var s=("undefined"!=typeof self?self:this).webpackJsonp=("undefined"!=typeof self?self:this).webpackJsonp||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;a.push([587,0,1]),n()}([function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return r})),n.d(e,"e",(function(){return s}));var i={ALL:268435455,REPOST:1,PIC:2,WORD:4,VIDEO:8,CLIP:16,DRAMA:32,ARTICLE:64,MUSIC:256,BANGUMI:512,NONE:1024,H5_SHARE:2048,COMIC_SHARE:2049,PGC_BANGUMI:4097,FILM:4098,TV:4099,GUOCHUANG:4100,DOCUMENTARY:4101,LIVE_ROOM:4200,LIVE:4201,MEDIA_LIST:4300,CHEESE_SERIES:4302,CHEESE_UPDATE:4303,LIVE_PUSH:4308,COLLECTION:4310,SUBSCRIPTION:4311,HOT:1e3,QUICK:1001},o={LOAD_NOTICE:"LOAD_NOTICE",SCROLL:"SCROLL",REMOVE_SCROLL:"REMOVE_SCROLL",UNFOCUS:"UNFOCUS",STORAGE_UPDATE:"STORAGE_UPDATE",ADD:"ADD",LOCATE_CARD_EL:"LOCATE_CARD_EL",SET_TOP:"SET_TOP",IFRAME_WRAPPER_CLICK:"IFRAME_WRAPPER_CLICK",MORE_PANEL_CLOSE:"MORE_PANEL_CLOSE",FORWARDING_SCROLL:"FORWARDING_SCROLL",FORWARD_DYNAMIC:"FORWARD_DYNAMIC",INSERT_FORWARDING:"INSERT_FORWARDING",COMM_FOCUS:"COMM_FOCUS",COMM_SCROLL:"COMM_SCROLL",INSERT_COMM:"INSERT_COMM",DELETE_ITEM_COMM:"DELETE_ITEM_COMM",DELETE_CHILDITEM_COMM:"DELETE_CHILD_COMM",ADD_FORWARD_COUNT:"ADD_FORWARD_COUNT",ATTENTION_LIST_UPDATE:"ATTENTION_LIST_UPDATE"},a={MAIN:"MAIN",GUEST:"GUEST",DETAIL:"DETAIL",SPACE:"SPACE",LIVE:"LIVE",TAG:"TAG",GAME:"GAME"},r={NAV_INDEX:"nav_index",NAV_HEAD:"nav_head",NAV_IM:"nav_im",NAV_PUBLISH:"nav_publish",INFO_HEAD:"info_head",INFO_NICKNAME:"info_nickname",INFO_FOLLOW:"info_follow",INFO_FANS:"info_fans",INFO_DYNAMIC:"info_dynamic",TOPIC:"topic",MYTOPIC_SHOW:"mytopic_show",MYTOPIC_ITEMCLICK:"mytopic_itemclick",MYTOPIC_MORE:"mytopic_more",HOTTOPIC_SHOW:"hottopic_show",HOTTOPIC_ITEMCLICK:"hottopic_itemclick",HOTTOPIC_MORE:"hottopic_more",MYTOPIC_LISTCLICK:"mytopic_listclick",HOTTOPIC_LISTCLICK:"hottopic_listclick",LIVE_SHOW:"live_show",LIVE_HEAD:"live_head",LIVE_NICKNAME:"live_nickname",LIVE_MORE:"live_more",LIVE_TITLE:"live_title",LIVE_GROUP_TEST_VIEW:"live_group_test_view",LIVE_GROUP_TEST_CLICK:"live_group_test_click",NEWS_BANNER:"news_banner",NEWS_CONTENT:"news_content",PUBLICH_EMOJI_1:"publish_emoji1",PUBLICH_EMOJI_2:"publish_emoji2",PUBLICH_PIC_1:"publish_pic1",PUBLICH_PIC_2:"publish_pic2",PUBLICH_CLICK_1:"publish_click1",PUBLICH_CLICK_2:"publish_click2",PUBLISH_AT_LIST_SHOW_1:"publish_at_list_show1",PUBLISH_AT_LIST_SHOW_2:"publish_at_list_show2",TAB_CLICK:"tab_click",CARD_HEAD:"card_head",CARD_NICKNAME:"card_nickname",CARD_SHARE_NICKNAME:"card_share_nickname",CARD_SHARE_1:"card_share_1",CARD_COMMENT_1:"card_comment_1",CARD_LIKE_1:"card_like_1",CARD_SHARE_0:"card_share_0",CARD_COMMENT_0:"card_comment_0",CARD_LIKE_0:"card_like_0",CARD_COMMENT_2:"card_comment_2",CARD_COMMENT_3:"card_comment_3",CARD_SHARE_2:"card_share_2",CARD_SHARE_3:"card_share_3",CARD_BPM:"card_bpm",CARD_ORIGINAL_PIC:"card_original_pic",CARD_CLICK:"card_click",CARD_VC_PLAY:"card_vc_play",CARD_WATCH_LATER:"card_watch_later",CARD_SHOW:"card_show",CARD_WATCH_LATER_CANCEL:"card_watch_later_cancel",PUBLISH_AT_LIST_SHOW:"publish_at_list_show",CARD_ATCLICK:"card_atclick",CARD_RT_ATCLICK:"card_rt_atclick",PAGE_HOTSHOW:"page_hotshow",HOTFOLLOW:"hotfollow",LIVEVIEW:"liveview",TAGVIEW:"tagview",POLLCLICK:"pollclick",LOTTERY_RETWEET:"lottery_retweet",DETAIL_VISIT:"detail_visit",DETAIL_USERPIC_CLICK:"detail_userpic_click",DETAIL_NICKNAME_CLICK:"detail_nickname_click",DETAIL_FOLLOW_CLICK:"detail_follow_click",DETAIL_TAB_COMMENT_CLICK:"detail_tab_comment_click",DETAIL_TAB_COMMENT_USERPIC_CLICK:"detail_tab_comment_userpic_click",DETAIL_TAB_RETWEET_CLICK:"detail_tab_retweet_click",DETAIL_TAB_RETWEET_USERPIC_CLICK:"detail_tab_retweet_userpic_click",DETAIL_CONTENT_CLICK:"detail_content_click",DETAIL_AT_CLICK:"detail_at_click",DETAIL_LINK_CLICK:"detail_link_click",DETAIL_RETWEETUSER_CLICK:"detail_retweetuser_click",DETAIL_GOTOAPP_CLICK:"detail_gotoapp_click",DETAIL_UP_WORKS_SHOW:"Other_Video_Model_show",DETAIL_UP_WORK_CARD_SHOW:"Other_Video_Card_show",DETAIL_UP_WORK_CARD_CLICK:"Other_Video_Card_click",DETAIL_UP_WORKS_MORE_SHOW:"Other_Video_More_show",DETAIL_UP_WORKS_MORE_CLICK:"Other_Video_More_click",DETAIL_SHARE_CLICK:"Share_click",DT_DETAIL_PIC_CLICK:"dt_detail_pic_click",DT_DETAIL_PIC_CLICKOFF:"dt_detail_pic_clickoff",CARD_MORE_TOP:"card_more_top",CARD_MORE_UNTOP:"card_more_untop",TIMER_VISIT:"timer_visit",TIMER_ICON:"timer_icon",TIMER_SET:"timer_set",TIMER_EDIT:"timer_edit",TIMER_PUBLISH:"timer_publish",TIMER_DELETE:"timer_delete",FOLD_SHOW:"fold_show",FOLD_CLICK:"fold_click",MORETOPIC:"moretopic",NOLOGIN_TOPIC:"nologin_topic",NOLOGIN_LOGIN:"nologin_login",NOLOGIN_REGISTER:"nologin_register",LOGIN_SUCCESS:"login_success",ITEM_CLICK:"item_click",SHOP_CARD_SHOW:"itemcard_show",SHOP_CARD_CLICK:"itemcard_click",SUB_BTN_CLICK:"card_subcard-button_click",SUB_CARD_SHOW:"card_subcard_show",SUB_CARD_CLICK:"card_subcard_click",TOP_PROFILE_PICTURE:"top_profile_picture",TOP_PROFILE_PICTURE_CLICK:"top_profile_picture_click",TOP_PROFILE_PICTURE_PAGE_CLICK:"top_profile_picture_page_click"},s=(n(60),[{title:"全部",type:i.ALL,spmType:"sum"},{title:"投稿视频",type:i.VIDEO,spmType:"video"},{title:"追番追剧",type:[i.BANGUMI,i.PGC_BANGUMI,i.FILM,i.TV,i.GUOCHUANG,i.DOCUMENTARY].join(","),spmType:"bangumi"},{title:"专栏",type:i.ARTICLE,spmType:"article"}])},,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i={API_LIVE:"//api.live.bilibili.com",API_VC:"//api.vc.bilibili.com",API_MAIN:"//api.bilibili.com",API_VC_CO:"//api.vc.bilibili.co",API_MAIN_CO:"//api.bilibili.co",MAIN:"//www.bilibili.com",SPACE:"//space.bilibili.com",PASSPORT:"//passport.bilibili.com",BANGUMI:"//bangumi.bilibili.com",DATA:"//data.bilibili.com",T:"//t.bilibili.com",H:"//h.bilibili.com",VC:"//vc.bilibili.com",APP:"//app.bilibili.com",MESSAGE:"//message.bilibili.com",LINK:"//link.bilibili.com",M:"//m.bilibili.com",LIVE:"//live.bilibili.com"}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return s})),n.d(e,"h",(function(){return c})),n.d(e,"i",(function(){return l.b})),n.d(e,"m",(function(){return l.d})),n.d(e,"o",(function(){return d.d})),n.d(e,"n",(function(){return d.e})),n.d(e,"k",(function(){return d.b})),n.d(e,"l",(function(){return d.c})),n.d(e,"c",(function(){return u})),n.d(e,"q",(function(){return f})),n.d(e,"r",(function(){return C})),n.d(e,"j",(function(){return I})),n.d(e,"f",(function(){return w})),n.d(e,"e",(function(){return x})),n.d(e,"p",(function(){return k})),n.d(e,"g",(function(){return O.a}));n(14),n(34),n(28),n(25),n(60),n(219),n(48),n(13),n(12),n(24),n(32);var i=n(6),o={generateAtUsers:function(t,e,n){var o=[];if(n&&o.push(n),!e||""===e)return o;var a=Object(i.e)(e);return Array.isArray(a)||(a=[]),a.forEach((function(e){var n={uid:~~e.data,uname:t.substr(e.location+1,e.length-1)};0===o.filter((function(t){return t.uid===n.uid})).length&&o.push(n)})),o},generateAtParams:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i={};n.forEach((function(e){t.indexOf("@".concat(e.uname))>=0&&(i[e.uid]=e.uid)}));var o=[],a=n.concat(e),r={};a.forEach((function(t){r[t.uid]=t})),a=Object.values(r);var s=t;a.sort((function(t,e){return e.uname.length-t.uname.length})).forEach((function(t){var e=new RegExp("@".concat(t.uname.replace(/[.*?+$^[\](){}|\\]/g,"\\$&")),"g");s=s.replace(e,(function(e,n){var i={data:"".concat(t.uid),location:n,length:e.length,type:1};o.push(i);for(var a="",r=0;r<e.length;r++)a+="*";return a}))})),o.sort((function(t,e){return t.location-e.location}));var c=Object.values(i).join(","),l=JSON.stringify(o);return{atUids:c,ctrl:l}}},a=n(10),r=new(n.n(a).a)({}),s=function(t,e){var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return e},c=function t(e){var n=e.offsetTop;return null!==e.offsetParent&&(n+=t(e.offsetParent)),n},l=(n(15),n(22),n(23),n(16),n(37),n(36),n(46),n(9),n(18),n(49),n(20),n(4),n(8),n(31));var u=function(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")},d=n(42),f={set:function(t,e){localStorage.setItem(t,JSON.stringify(e)||"")},get:function(t){return localStorage.getItem(t)||""},add:function(t,e){var n=localStorage.getItem(t),o=[];n&&(o=Object(i.e)(n),Array.isArray(o)||(o=[])),o.unshift(e),localStorage.setItem(t,JSON.stringify(o))},addList:function(t,e){var n=localStorage.getItem(t),o=[];n&&(o=Object(i.e)(n),Array.isArray(o)||(o=[])),o=e.concat(o),localStorage.setItem(t,JSON.stringify(o))},delete:function(t,e){var n=localStorage.getItem(t);if(n){var o=Object(i.e)(n);Array.isArray(o)&&(o=o.filter((function(t){return t.desc.dynamic_id!==e.desc.dynamic_id})),localStorage.setItem(t,JSON.stringify(o)))}},replace:function(t,e){var n=localStorage.getItem(t);if(n){var o=Object(i.e)(n);if(Array.isArray(o)){for(var a=0;a<o.length;a++){o[a].desc.dynamic_id===e.desc.dynamic_id&&(o[a]=e)}localStorage.setItem(t,JSON.stringify(o))}}}},h=(n(61),{mid:0,uname:"",isLogin:!1}),p={card:{attention:0,face:"//static.hdslb.com/images/member/noface.gif",fans:0,mid:"0",name:"",sex:"",vip:{vipType:0,vipStatus:0}},space:{s_img:"//i2.hdslb.com/bfs/space/768cc4fd97618cf589d23c2711a1d1a729f42235.png"}},m=[],g=h,v=p,b=!1,y=!1,_=!1,C={setMyLoginInfo:function(t){g=t,b=!0},getMyLoginInfo:function(){return g},resetMyLoginInfo:function(){g=h,b=!1},setMyUserInfo:function(t){v=t,y=!0},getMyUserInfo:function(){return v},resetMyUserInfo:function(){v=p,y=!1},setMyAttentionList:function(t){m=t,_=!0},getMyAttentionList:function(){return m},insertToMyAttentionList:function(t){-1===m.indexOf(t)&&m.push(t)},deleteFromMyAttentionList:function(t){var e=m.indexOf(t);-1!==e&&m.splice(e,1)},resetMyAttentionList:function(){m=[],_=!1},getUid:function(){return g.mid},isInitMyLoginInfo:b,isInitMyUserInfo:y,isInitMyAttentionList:_};function w(t){if(!t)return"";var e=t.childNodes,n=e.length;e.length&&"BR"===e[e.length-1].nodeName&&(n-=1);for(var i="",o=0;o<n;o++)"#text"===e[o].nodeName?i+=e[o].nodeValue:"BR"===e[o].nodeName?i+="\n":"INPUT"===e[o].nodeName?i+=e[o].defaultValue:"DIV"===e[o].nodeName?i+="\n"+w(e[o]):"BUTTON"===e[o].nodeName?i+=w(e[o]):"IMG"===e[o].nodeName?i+=e[o].alt:(e[o].nodeName,i+=w(e[o]));return i}function I(t){var e,n;if(window.getSelection){if((e=window.getSelection()).getRangeAt&&e.rangeCount){(n=e.getRangeAt(0)).deleteContents();var i=document.createElement("div");i.innerHTML=t;for(var o,a,r=document.createDocumentFragment();o=i.firstChild;)a=r.appendChild(o);if(n.insertNode(r),a){n=n.cloneRange();try{n.setStartAfter(a)}catch(t){console.warn(t)}n.collapse(!0),e.removeAllRanges(),e.addRange(n)}}}else document.selection&&"Control"!==document.selection.type&&document.selection.createRange().pasteHTML(t)}function x(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,i=t.ownerDocument||t.document,o=i.defaultView||i.parentWindow;if("DIV"===t.tagName){if(o.getSelection().rangeCount>0){var a=o.getSelection().getRangeAt(0),r=a.cloneRange();r.selectNodeContents(t),r.setEnd(a.endContainer,a.endOffset);var s=r.cloneContents(),c=w(s);n=c.length,e&&(n=c.replace(/\n/g,"").length)}}else n=t.selectionEnd;return n}function k(t,e){var n,o,a=-1!==Object(i.d)().indexOf("Safari");"DIV"===t.tagName||a?((n=document.createRange()).selectNodeContents(t),t.innerHTML&&t.innerHTML.length>0&&n.collapse(t,e),n.collapse(!0),(o=window.getSelection()).removeAllRanges(),o.addRange(n)):t.setSelectionRange(e,e)}var O=n(66);n(76),n(40)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return d})),n.d(e,"h",(function(){return f}));n(21),n(48),n(13),n(12),n(24),n(45);var i={getItem:function(t){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(t,e,n,i,o,a){if(!t||/^(?:expires|max\-age|path|domain|secure)$/i.test(t))return!1;var r="";if(n)switch(n.constructor){case Number:r=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:r="; expires="+n;break;case Date:r="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)+r+(o?"; domain="+o:"")+(i?"; path="+i:"")+(a?"; secure":""),!0},removeItem:function(t,e,n){return!(!t||!this.hasItem(t))&&(document.cookie=encodeURIComponent(t)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(e?"; path="+e:""),!0)},hasItem:function(t){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var t=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),e=0;e<t.length;e++)t[e]=decodeURIComponent(t[e]);return t}},o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n={},i="debounce-key";return function(){for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];n[i]&&clearTimeout(n[i]),n[i]=setTimeout((function(){n[i]=null,t.apply(void 0,a)}),e)}};n(25),n(40);var a=function(){try{if("undefined"!=typeof navigator&&/Firefox\/(\d+)/i.test(navigator.userAgent))return navigator.userAgent.match(/Firefox\/(\d+)/i)[1]>=65;var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0===t.toDataURL("image/webp").indexOf("data:image/webp")}catch(t){return!1}}(),r=(n(51),"undefined"!=typeof window?window.navigator.userAgent:""),s={myBrowser:"unknown",behaviors:[function(){return!!r.match(/Maxthon\/[4]/)&&"Maxthon 4"},function(){return!!r.match(/TheWorld/)&&"TheWorld"},function(){return!!r.match(/Firefox\/\d.*/)&&"Firefox"},function(){return!(!r.match(/AppleWebKit\/\d.*.Chrome\/\d.*.Safari\/\d/)||"Google Inc."!==window.navigator.vendor||!window.chrome)&&"Chrome"},function(){return!!r.match(/Opera.\d.*.Presto\/\d/)&&"Opera Presto"},function(){return!!r.match(/OPR\/\d{2}/)&&"Opera Modern"},function(){return!!r.match(/MSIE [6-8].+/)&&"IE Legacy"},function(){return!(!r.match(/MSIE [9].+/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 9"},function(){return!(!r.match(/MSIE [10].+/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 10"},function(){return!(!r.match(/Trident\/[7].*.rv:11/)||"function"!=typeof window.ScriptEngine||"JScript"!==window.ScriptEngine())&&"IE 11"},function(){return!(!r.match(/Edge\/\d+\.\d+/)||"function"!=typeof window.StyleMedia)&&"Edge"},function(){return!(!r.match(/AppleWebKit\/\d.*.Mobile.*Safari\/\d+/)||"Apple Computer, Inc."!==window.navigator.vendor)&&"SafariMobile"},function(){return!(!r.match(/AppleWebKit\/\d.*.Safari\/\d+/)||"Apple Computer, Inc."!==window.navigator.vendor)&&"Safari"}]};var c=function(){return"undefined"==typeof window?"":(s.behaviors.some((function(t){var e=t();return s.myBrowser=e||"unknown",e})),s.myBrowser)},l=function(t){if("string"!=typeof t)return"";var e;try{e=JSON.parse(t)}catch(t){e=""}return e},u=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=!0;return function(){if(!i)return e;i=!1,setTimeout((function(){i=!0}),n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return e=t.apply(void 0,a)}},d=function(t){return"string"==typeof t?t.replace(/^https?:/g,""):""},f=(n(34),n(28),n(84),n(32),function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return{};var n={},i="";if(e){var o=t.href||"",a=o.match(/\?[^#/]*/g);a&&(i=a[a.length-1])}else i=t.search;if(~i.indexOf("?")){var r=i.split("?")[1]||"",s=r.split("&");s.forEach((function(t){if(t){var e=t.indexOf("=");if(e>0){var i=t.substring(0,e),o=t.substring(e+1);n[i]=o}}}))}var c=t.pathname.split(/\//g).filter((function(t){return""!==t}));return{params:n,path:c}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return l}));n(14);var i=n(6),o=n(0),a=function(t){var e,n,a=Object(i.e)(t.card);if(!a)return{card_type:"",card_id:"",dynamic_id:""};var r=t.desc.dynamic_id,s={};switch(t.desc.type){case o.a.ALL:n="sum";break;case o.a.REPOST:e=r,n="share";break;case o.a.PIC:e=a.item.id,n="ywh";break;case o.a.WORD:e=r,n="text";break;case o.a.VIDEO:e=a.aid,n="video";break;case o.a.CLIP:e=a.item.id,n="vc";break;case o.a.ARTICLE:e=a.id,n="article";break;case o.a.MUSIC:e=a.id,n="music";break;case o.a.BANGUMI:e="".concat(a.apiSeasonInfo.season_id,",").concat(a.episode_id),n="bangumi";break;case o.a.H5_SHARE:e=r,n="h5share";break;case o.a.FILM:e="".concat(a.apiSeasonInfo.season_id,",").concat(a.episode_id),n="movie";break;case o.a.TV:e="".concat(a.apiSeasonInfo.season_id,",").concat(a.episode_id),n="tv";break;case o.a.DOCUMENTARY:s=a.apiSeasonInfo||a.season||{},e="".concat(s.season_id,",").concat(a.episode_id),n="documentary";break;case o.a.LIVE:case o.a.LIVE_ROOM:e=a.roomid,n="live";break;case o.a.LIVE_PUSH:e=a.live_play_info&&a.live_play_info.uid||"",n="livepush";break;case o.a.COLLECTION:e=a.collection&&a.collection.id||"",n="collection";break;case o.a.SUBSCRIPTION:e=a.card_id||"",n="notification_type";break;case o.a.MEDIA_LIST:e=a.id,n="playlist";break;case o.a.CHEESE_SERIES:e=a.id,n="cheese";break;case o.a.CHEESE_UPDATE:e=a.id,n="cheese_update";break;default:e="",n=""}return{card_type:n,card_id:e,dynamic_id:r}},r=function(t){var e,n,a=Object(i.e)(t.card),r=t.desc.type===o.a.REPOST,s=r?t.desc.orig_type:t.desc.type,c=r?Object(i.e)(a.origin):a,l=r?t.desc.orig_dy_id:t.desc.dynamic_id;if(!c)return{card_type:"",card_id:"",dynamic_id:""};var u={};switch(s){case o.a.ALL:n="sum";break;case o.a.PIC:e=c.item.id,n="ywh";break;case o.a.WORD:e=l,n="text";break;case o.a.VIDEO:e=c.aid,n="video";break;case o.a.CLIP:e=c.item.id,n="vc";break;case o.a.ARTICLE:e=c.id,n="article";break;case o.a.MUSIC:e=c.id,n="music";break;case o.a.BANGUMI:e="".concat(c.apiSeasonInfo.season_id,",").concat(c.episode_id),n="bangumi";break;case o.a.H5_SHARE:e=l,n="h5share";break;case o.a.FILM:e="".concat(c.apiSeasonInfo.season_id,",").concat(c.episode_id),n="movie";break;case o.a.TV:e="".concat(c.apiSeasonInfo.season_id,",").concat(c.episode_id),n="tv";break;case o.a.DOCUMENTARY:u=c.apiSeasonInfo||c.season||{},e="".concat(u.season_id,",").concat(c.episode_id),n="documentary";break;case o.a.LIVE:case o.a.LIVE_ROOM:e=c.roomid,n="live";break;case o.a.LIVE_PUSH:e=c.uid,n="livepush";break;case o.a.COLLECTION:e=c.collection&&c.collection.id||"",n="collection";break;case o.a.SUBSCRIPTION:e=c.card_id||"",n="notification_type";break;case o.a.MEDIA_LIST:e=c.id,n="playlist";break;case o.a.CHEESE_SERIES:case o.a.CHEESE_UPDATE:e=c.id,n="cheese";break;default:e="",n=""}return{card_type:n,card_id:e,dynamic_id:l}},s=(n(36),"//s1.hdslb.com/bfs/seed/bplus-common/statistics-js/log-reporter.js"),c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(window.__bp_statisObserverConfig=Object.assign({spmId:t,baseURL:"//data.bilibili.com/log/web",selfDefMsgs:"",clickConfig:{isDoubleWrite:!0,logId:n,msgAttrName:"data-report"},pvConfig:{isDoubleWrite:!0,logId:e,selfDefMsg:i},selfConfig:{isDoubleWrite:!0,logId:n}},window.__bp_statisObserverConfig),void 0===window.__bp_statisObserver){var o=document.createElement("script");o.onload=function(){setTimeout((function(){if(window.__bp_preDefaultMsgObj&&window.__bp_defaultMsgObj&&window.__bp_statisObserver)for(var t=window.__bp_preDefaultMsgObj.length;t>0;){var e=window.__bp_preDefaultMsgObj[t-1];window.__bp_defaultMsgObj[e.key]=e.value,window.__bp_statisObserver.forceCommit(),t--}}),1e3)},o.src=s,document.getElementsByTagName("body")[0].appendChild(o)}},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(window.__bp_defaultMsgObj&&window.__bp_statisObserver){window.__bp_defaultMsgObj[t]=e;try{window.__bp_statisObserver.forceCommit()}catch(t){console.log(t)}}else window.__bp_preDefaultMsgObj?window.__bp_preDefaultMsgObj.push({key:t,value:e}):window.__bp_preDefaultMsgObj=[{key:t,value:e}]}},function(t,e,n){"use strict";n.r(e),n.d(e,"showVerifyPopup",(function(){return i})),n.d(e,"bfsImgLink",(function(){return r})),n.d(e,"bfsUrl",(function(){return d})),n.d(e,"bus",(function(){return h})),n.d(e,"checkLoginStatus",(function(){return C})),n.d(e,"fetchLoginInfo",(function(){return y})),n.d(e,"fetchLoginUid",(function(){return I})),n.d(e,"isBiliApp",(function(){return x})),n.d(e,"isOldBrowser",(function(){return O})),n.d(e,"longNumberToString",(function(){return S})),n.d(e,"numberFormat",(function(){return T})),n.d(e,"quickLogin",(function(){return D})),n.d(e,"randomEmoji",(function(){return H})),n.d(e,"getShowBvConfig",(function(){return W})),n.d(e,"getVideoLink",(function(){return G})),n.d(e,"protectDialog",(function(){return J})),n.d(e,"setDisturb",(function(){return K})),n.d(e,"clearHistory",(function(){return Y})),n.d(e,"attachSearch",(function(){return q})),n.d(e,"attachRight",(function(){return Z})),n.d(e,"attachPreview",(function(){return Q}));n(14);var i=function(t){var e="请先绑定手机",i="你还没有绑定手机哦~",o="去绑定",a="//passport.bilibili.com/site/site.html";t.bpPopup({title:e,html:'\n      <div style="margin: 20px 0; text-align: center; color: #999">\n        <img src="'.concat(n(260),'" style="margin-bottom: 10px">\n        <p>').concat(i,"</p>\n      </div>\n    "),button:{confirm:o,cancel:"以后再说"}}).onConfirm((function(t){window.open(a,"_blank"),t.close()}))},o=(n(34),n(60),n(13),n(40),n(24),n(6)),a=/\/bfs\//,r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=t;if(!o.c&&/\.webp$/.test(t)&&(/@/.test(t)?r=t.replace(/\.webp$/,".jpg"):r+="@.jpg"),"undefined"!=typeof window&&window&&window._bp_audit_mode||!t||"string"!=typeof t||!/\.(jpg|png|gif)(@\w*)?$/.test(t)||!a.test(t))return encodeURI(r);var c=(t=t.replace(/(\.\w+)@\w*$/,(function(t,e){return e}))).match(/\.(jpg|png|gif)$/)[0],l=!1===i.autoDpr||"undefined"==typeof window?1:parseInt(window.devicePixelRatio)||1,u=Math.ceil(e),d=Math.ceil(n),f=u?"".concat(u*l,"w"):"",h=d?"".concat(d*l,"h"):"",p=s(i.p,"p"),m=s(i.e,"e"),g=s(i.c,"c"),v=i.others?i.others:"",b=[f,h,p,m,g,v],y=b.filter((function(t){return""!==t})).join("_"),_=o.c&&!1!==i.useWebp,C=_?".webp":c,w=f||h||g||v||_;return encodeURI(w?"".concat(t,"@").concat(y).concat(C):"".concat(r))};function s(t,e){return"string"==typeof t?t:"number"==typeof t?"".concat(t).concat(e):""}var c,l=function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"center",a={};return i?a={}:"center"===o?(a.c=1,a.e=1):a.others="!header",r(t,e,i?0:n,a)},u=function(t){return/\.gif$/.test(t)},d=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o={url:"",width:0,height:0,gifTop:!1};if(!t)return o;var a=e/n,r=a<1/3?"top":"center",s=104,c=104,d=180,f=180,h=240,p=240,m=320,g=320;switch(i){case 0:switch(!0){case e<=360:switch(!0){case a>=1:o.width=d,o.height=Math.min(o.width/a,f);break;case a<1&&a>=.75:o.width=d,o.height=Math.min(o.width/a,p);break;case a<.75:o.height=h,o.width=Math.min(o.height*a,d)}break;case e>360&&e<=960:switch(!0){case a>=1:o.width=h,o.height=Math.min(o.width/a,p);break;case a<1&&a>=.75:o.width=h,o.height=Math.min(o.width/a,g);break;case a<.75:o.width=h,o.height=g,o.gifTop=u(t)}break;case e>960:switch(!0){case a>=1:o.width=m,o.height=Math.min(o.width/a,g);break;case a<1&&a>=.75:o.width=h,o.height=Math.min(o.width/a,g);break;case a<.75:o.width=h,o.height=g,o.gifTop=u(t)}}break;case 1:o.width=s,o.height=c}return o.width=Math.ceil(o.width),o.height=Math.ceil(o.height),o.url=l(t,o.width,o.height,o.gifTop,r),o},f=n(10),h=new(n.n(f).a)({}),p=(n(9),n(29),n(11)),m=n.n(p),g=(n(41),n(19)),v=n(4);function b(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var y=function(){var t,e=(t=m.a.mark((function t(e){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e||!c){t.next=2;break}return t.abrupt("return",c);case 2:return t.next=4,Object(g.a)({method:"get",url:"".concat(v.a.API_MAIN,"/x/web-interface/nav")}).then((function(t){c=t.data}),(function(t){c=t.data}));case 4:return t.abrupt("return",c);case 5:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){b(a,i,o,r,s,"next",t)}function s(t){b(a,i,o,r,s,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}();function _(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var C=function(){var t,e=(t=m.a.mark((function t(){var e;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y();case 2:return e=t.sent,t.abrupt("return",e.isLogin);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){_(a,i,o,r,s,"next",t)}function s(t){_(a,i,o,r,s,"throw",t)}r(void 0)}))});return function(){return e.apply(this,arguments)}}();function w(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var I=function(){var t,e=(t=m.a.mark((function t(e){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y(e);case 2:return n=t.sent,t.abrupt("return",n.mid);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){w(a,i,o,r,s,"next",t)}function s(t){w(a,i,o,r,s,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}(),x=function(){var t=!1;try{t=!(!window.biliInject&&!window.webkit.messageHandlers.biliInject)}catch(t){}return t},k=Object(o.d)(),O="IE 9"===k||"IE Legacy"===k,S=(n(49),function(t){return t.replace(/("\w*":)\s*(\d{16}\d*)/g,'$1"$2"').replace(/(\\"\w*\\":)\s*(\d{16}\d*)/g,'$1\\"$2\\"').replace(/("\w*":)\s*(\[\s*(\d{16}\d*)\s*(,\s*(\d{16}\d*)\s*)*])/g,(function(t,e,n){return"".concat(e).concat(n.trim().replace(/\[/,'["').replace(/]/,'"]').replace(/,/g,'","'))})).replace(/(\\"\w*\\":)\s*(\[\s*(\d{16}\d*)\s*(,\s*(\d{16}\d*)\s*)*])/g,(function(t,e,n){return"".concat(e).concat(n.trim().replace(/\[/,'[\\"').replace(/]/,'\\"]').replace(/,/g,'\\",\\"'))}))}),P=(n(51),n(21),n(230),n(36),[{unit:"亿",val:1e8},{unit:"万",val:1e4}]),T={autoParse:function(t){return function(t,e){if(!Array.isArray(t))return console.warn("[NumberFormat] 无法获取格式化列表.");var n;return t.some((function(t){if(e>=t.val)return n=L(t.val,{fixing:1,unit:t.unit})(e),!0})),n||"".concat(e)}(P,t)},create:L},j={fixing:1,unit:"",base:null};function L(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,e=arguments.length>1?arguments[1]:void 0;return function(n){var i=parseInt(n,10);if(t=parseInt(t,10),isNaN(i)||isNaN(t))return"undefined"!=typeof console&&console.warn("[NumberFormat] 创建格式化函数时 threshold 与 传入数字必须为数字类型."),n;var o=Object.assign({},j,e);return i<t?i:Number((i/(o.base||t)).toFixed(o.fixing))+"".concat(o.unit)}}var A=n(77),E=n.n(A);function M(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var D=function(){var t,e=(t=m.a.mark((function t(e){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!=typeof window){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,C();case 4:if(t.sent){t.next=13;break}return t.next=7,E()("https://s1.hdslb.com/bfs/seed/jinkela/short/mini-login/miniLogin.umd.min.js");case 7:return(n=new window.MiniLogin).showComponent(),n.addEventListener("success",(function(){e()})),t.abrupt("return",!1);case 13:return t.abrupt("return",!0);case 14:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){M(a,i,o,r,s,"next",t)}function s(t){M(a,i,o,r,s,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}(),R={angry:[",,Ծ‸Ծ,,","(╯‵□′)╯︵┻━┻"],happy:["=‿=✧","●ω●","(/ ▽ \\)","(=・ω・=)","(●'◡'●)ﾉ♥","<(▰˘◡˘▰)>","(⁄ ⁄•⁄ω⁄•⁄ ⁄)","(ง,,• ᴗ •,,)ง ✧",">ㅂ<ﾉ ☆"],shock:["Σ( ° △ °|||)︴","┌( ಠ_ಠ)┘","(ﾟДﾟ≡ﾟдﾟ)!?","∑(っ °Д °;)っ"],sad:["＞︿＜","＞△＜","●︿●","(´；ω；`)"],helpless:["◐▽◑","ʅ（´◔౪◔）ʃ","_(:3 」∠)_","_(┐「ε:)_","(°▽°)ﾉ","←◡←","_(•̀ᴗ•́ 」∠ ❀)_","_φ(･ω･` )"]},B={};for(var N in R)!function(t){B[t]=function(){return U(t)}}(N);var U=function(t){return R[t][Math.floor(Math.random()*R[t].length)]},H=B;n(15),n(22),n(23),n(16),n(18),n(20);function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var z=function(){return Object(g.a)({method:"get",url:"//api.vc.bilibili.com/dynamic_mix/v1/dynamic_mix/bvid_onoff",cache_key:"bpShowBvConfig",ttl:4e3,localCache:!0,throttleInterval:4e3,timeout:5e3}).then((function(t){var e=!0===t.data.show_bv||"true"===t.data.show_bv;W()!==e&&("object"===("undefined"==typeof window?"undefined":$(window))&&(window.__BILI_CONFIG__||(window.__BILI_CONFIG__={show_bv:e}),window.__BILI_CONFIG__.show_bv=e,localStorage.setItem("bili_config_show_bv",e)),h.$emit("ShowBvConfigUpdated"))}))},V=function(){var t=!1;return"object"!==("undefined"==typeof window?"undefined":$(window))||(window.__BILI_CONFIG__&&void 0!==window.__BILI_CONFIG__.show_bv?(t=window.__BILI_CONFIG__.show_bv,localStorage.setItem("bili_config_show_bv",t)):t="true"===localStorage.getItem("bili_config_show_bv")),t},F=!0,W=function(){return"undefined"!=typeof window&&(F?(F=!1,t=V(),z()):t=V(),t);var t},G=function(t,e){return W()&&e?"//www.bilibili.com/video/".concat(e):"//www.bilibili.com/video/av".concat(t)},J=function(t){return Object(g.a)({method:"get",url:"".concat(v.a.API_VC,"/x/im/anti_disturb/get_disturb"),data:{scene:t}})},K=function(t){var e=t.id,n=t.isOpen;return Object(g.a)({method:"post",url:"".concat(v.a.API_VC,"/x/im/anti_disturb/set_disturb"),data:{selected_id:e,is_open:n}})},Y=function(){return Object(g.a)({method:"get",url:"".concat(v.a.API_VC,"/x/im/anti_disturb/clean_disturb_session")})},q=function(t){var e=t.page,n=t.biz_name,i=t.biz_type,o=t.uid;return new Promise((function(t,a){Object(g.a)({method:"post",url:"".concat(v.a.API_MAIN,"/x/dynamic/feed/attach/search"),data:{biz_type:i,pn:e,uid:o,biz_name:n}}).then((function(e){e.code?a(e):t({result:e.data.attach_card_briefs})})).catch(a)}))},Z=function(t){return Object(g.a)({method:"get",url:"".concat(v.a.API_MAIN,"/x/dynamic/feed/attach/auth?uid=").concat(t)})},Q=function(t,e){return Object(g.a)({method:"get",url:"".concat(v.a.API_MAIN,"/x/dynamic/feed/attach/preview?biz_id=").concat(t,"&biz_type=").concat(e)})}},,,,,,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"i",(function(){return a})),n.d(e,"b",(function(){return l})),n.d(e,"d",(function(){return d})),n.d(e,"f",(function(){return m})),n.d(e,"g",(function(){return g})),n.d(e,"c",(function(){return p})),n.d(e,"e",(function(){return v.a})),n.d(e,"h",(function(){return v.b}));n(25);var i={};function o(t,e,n,o){i[e]&&i[e].indexOf(t)>-1||(t.addEventListener(e,n,o),i[e]||(i[e]=[]),i[e].push(t))}function a(t,e,n){t.removeEventListener(e,n),i[e]&&i[e].indexOf(t)>-1&&(i[e][i[e].indexOf(t)]=null)}var r=n(6),s=n(0),c=function(t,e){var n=Object(r.e)(t.card);if(n){switch(t.desc.type){case s.a.REPOST:case s.a.PIC:case s.a.WORD:case s.a.CLIP:n.item.reply+=e;break;case s.a.VIDEO:n.stat.reply+=e;break;case s.a.ARTICLE:n.stats.reply+=e;break;case s.a.MUSIC:n.replyCnt+=e;break;case s.a.H5_SHARE:t.desc.comment+=e;break;case s.a.BANGUMI:case s.a.PGC_BANGUMI:case s.a.GUOCHUANG:n.reply_count+=e}t.card=JSON.stringify(n)}},l={replyAdd:function(t){c(t,1)},replySub:function(t){c(t,-1)},repostAdd:function(t){t.desc.repost=t.desc.repost+1}};n(14);function u(t){return t<10?t="0"+t:t}function d(t){if(!+t)return t;var e=Math.floor((new Date).getTime()/1e3),n=new Date;if(n.setHours(0)&&n.setMinutes(0)&&n.setSeconds(0)&&(n=Math.floor(n.getTime()/1e3))&&t>n&&e-t>=0){if(e-t<=50){var i=10*Math.floor((e-t)%60/10);return(t>10?i:10)+"秒前"}return e-t<3600?Math.ceil((e-t)/60)+"分钟前":Math.ceil((e-t)/3600)+"小时前"}return function(t){var e=new Date;e.setTime(1e3*t);var n=[u(e.getMonth()+1),u(e.getDate()),u(e.getHours()),u(e.getMinutes())],i=n[0],o=n[1],a=n[2],r=n[3];return"".concat(e.getFullYear(),"-").concat(i,"-").concat(o," ").concat(a,":").concat(r)}(t)}n(28),n(60),n(36),n(32);var f=n(7),h={currentType:0,isNeedCardPopup:!0,pageType:""},p={setCurrentType:function(t){t===s.a.HOT?h.currentType="hot":t===s.a.QUICK?h.currentType="quick":h.currentType=t||0},getCurrentType:function(){return h.currentType},setIsNeedCardPopup:function(t){h.isNeedCardPopup=!!t},getIsNeedCardPopup:function(){return h.isNeedCardPopup},setPageType:function(t){h.pageType=t},getPageType:function(){return h.pageType}};function m(t,e){var n={},i=p.getPageType(),o=[];t.display&&t.display.highlight&&t.display.highlight.items&&t.display.highlight.items.forEach((function(t){o.push(t.item_id)}));var a=o.join(",");if(i===s.c.MAIN)n={tab_type:p.getCurrentType()};else if(i===s.c.TAG){n={type:"S"===t.desc.topic_board?3:"A"===t.desc.topic_board?2:1}}return n=Object.assign(n,{item_id:a},e),Object.assign(Object(f.a)(t),n)}function g(t,e){var n={},i=p.getPageType(),o=[];t.display&&t.display.origin&&t.display.origin.highlight&&t.display.origin.highlight.items&&t.display.origin.highlight.items.forEach((function(t){o.push(t.item_id)}));var a=o.join(",");if(i===s.c.MAIN)n={tab_type:p.getCurrentType()};else if(i===s.c.TAG){n={type:"S"===t.desc.topic_board?3:"A"===t.desc.topic_board?2:1}}return n=Object.assign({},{item_id:a},e),Object.assign(Object(f.b)(t),n)}var v=n(75)},,function(t,e,n){"use strict";n.d(e,"a",(function(){return H})),n.d(e,"b",(function(){return $}));n(9),n(29);var i=n(64),o=n(243),a=n.n(o).a.create({timeout:"undefined"==typeof window?1e3:0});n(15),n(22),n(23),n(14),n(16),n(18),n(20);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var c=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"对不起，服务器开小差了~ (ಥ﹏ಥ)",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"error",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-8888,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};if(s(this,t),"object"===r(o)){var u="对不起，服务器开小差了~ (ಥ﹏ಥ)";o.response?u="".concat(o.response.statusText," ").concat(o.response.status):"ECONNABORTED"===o.code&&(u="接口超时，稍后再试试吧~ (ಥ﹏ಥ)"),this.msg=u}else this.msg=o;this.type=a,this.code=c,this.data=l,this.url=n,this.payload=i,this.cost=e},l=n(6),u=Object(l.d)(),d="IE 9"===u||"IE Legacy"===u,f=d||"IE 10"===u||"IE 11"===u;n(13),n(40),n(24);var h={};var p={},m=function(){var t=Math.random();return p[t]=Date.now(),t},g=function(t){if(!t)return 0;if(p[t]){var e=Date.now()-p[t];return delete p[t],e}return 0};n(48),n(12);var v=function(t,e){var n=new RegExp("[?&]".concat(e,"=([^&#]+)"));return(t.match(n)||[])[1]||""},b=(n(36),n(4)),y=n(86),_=n.n(y);function C(t){if(!t)return t;var e=t;if(!("undefined"!=typeof FormData&&e instanceof FormData)){var n={};if("undefined"!=typeof window){var i=v(window.location.href,"lang");if(i){var o="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(o="android"),n.lang=i,n.mobi_app="".concat(o,"_i")}}t=e=Object.assign(n,e),f&&(t._=(new Date).getTime())}return t}n(49);function w(t,e){if("string"==typeof t){var n=t.replace(/("\w*":)\s*(\d{16}\d*)/g,'$1"$2"').replace(/(\\"\w*\\":)\s*(\d{16}\d*)/g,'$1\\"$2\\"').replace(/("\w*":)\s*(\[\s*(\d{16}\d*)\s*(,\s*(\d{16}\d*)\s*)*])/g,(function(t,e,n){return"".concat(e).concat(n.trim().replace(/\[\s*/,'["').replace(/\s*]\s*/,'"]').replace(/\s*,\s*/g,'","'))})).replace(/(\\"\w*\\":)\s*(\[\s*(\d{16}\d*)\s*(,\s*(\d{16}\d*)\s*)*])/g,(function(t,e,n){return"".concat(e).concat(n.trim().replace(/\[\s*/,'[\\"').replace(/\s*]/,'\\"]').replace(/\s*,\s*/g,'\\",\\"'))}));if(e)try{t=JSON.parse(n)}catch(t){}else t=n}return t}var I=function(t){return w(t,!0)},x=n(244),k=n.n(x);n(25);function O(t,e,n,i,o,a){var r=a?t:t.data;return new Promise((function(t,a){var s,l,u=function(){return 0===r[s]};e.indexOf(b.a.SPACE)>=0?(s="status",l="result",u=function(){return!0===r[s]}):e.indexOf(b.a.BANGUMI)>=0?(s="code",l="result"):e.indexOf(b.a.PASSPORT)>=0?(s="code",l="access_info"):(s="code",l="data"),void 0===r||void 0===r[s]?a(new c(o,e,n)):u()?t(new c(o,e,n,"请求成功","success",0,i?r:r[l])):a(new c(o,e,n,r.message||r.msg||"电波无法到达~ ".concat(r.message||r.msg||r.code),"caution",r[s],r[l]))}))}n(26),n(27);function S(t,e,n){return(S=P()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&T(o,n.prototype),o}).apply(null,arguments)}function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function T(t,e){return(T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t,e,n){for(var i=arguments.length,o=new Array(i>3?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];return Promise.reject(S(c,[t,e,n].concat(o)))}n(28),n(46),n(32);function L(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var A=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store={};var e={},n={};if("undefined"!=typeof window&&window.localStorage)try{e=JSON.parse(window.localStorage.getItem("bpapi_cache"))||e}catch(t){}var i=(new Date).getTime();Object.keys(e).forEach((function(t){var o=e[t];o&&i-o.ts<o.ttl&&i-o.ts<36e4&&(n[t]=o)})),n.uniqueKey=e.uniqueKey,this.store=n,this.setLocalCache()}var e,n,i;return e=t,(n=[{key:"set",value:function(t,e,n,i,o){var a=this;return(!o||this.store.uniqueKey!==o||"0"===o)&&n>0&&(this.clearCache(),this.store={}),o&&(this.uniqueKey=o,this.store.uniqueKey=o),new Promise((function(r,s){try{var c={};c.response=e,c.ttl=n>0?n:0,c.ts=(new Date).getTime(),a.store[t]=c,i&&n>0&&o&&"0"!==o&&a.setLocalCache(),r({status:"success"})}catch(t){s({status:"failed",data:t})}}))}},{key:"get",value:function(t,e,n){var i=this;return(!n||this.store.uniqueKey!==n||"0"===n)&&e>0&&(this.clearCache(),this.store={}),n&&(this.uniqueKey=n,this.store.uniqueKey=n),new Promise((function(n,o){try{var a=i.store[t],r=(new Date).getTime();a&&r-a.ts<(e>0?e:0)&&r-a.ts<36e4?n({status:"success",data:a.response}):o({status:"failed",data:a})}catch(t){o({status:"failed",data:t})}}))}},{key:"clearCache",value:function(){"undefined"!=typeof window&&window.localStorage&&window.localStorage.removeItem("bpapi_cache")}},{key:"setLocalCache",value:function(){this.uniqueKey&&(this.store.uniqueKey=this.uniqueKey),"undefined"!=typeof window&&window.localStorage&&this.uniqueKey&&window.localStorage.setItem("bpapi_cache",JSON.stringify(this.store))}}])&&L(e.prototype,n),i&&L(e,i),t}(),E=function(){return new A}(),M=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"!=typeof FormData&&t instanceof FormData){for(var n in e)e.hasOwnProperty(n)&&(FormData.prototype.set?t.set(n,e[n]):t.append(n,e[n]));return t}return Object.assign(t,e)},D=new("undefined"!=typeof window&&window.BiliAjax?window.BiliAjax.default:k.a)({transformResponse:function(t){return w(t,!1)},oldAppUseAxios:!0}),R=function(t){if("undefined"!=typeof FormData&&t.data instanceof FormData)return a(C(t));var e=Object.assign({},t);switch(delete e.data,delete e.url,t.method.toLowerCase()){case"get":return D.get(t.url,C(t.data),e);case"post":return D.post(t.url,C(t.data),e);default:return a(C(t))}};function B(t){var e=t.useBridgeProxy,n=m(),o=0,r=t.url+JSON.stringify(t.data||"");return E.get(r,t.ttl,String(t.cache_key||"")).then((function(i){return o=g(n),O(i.data,t.url,t.data,t.needOriginal,o,e)})).catch((function(){return function(t){return new Promise((function(e){t.addPlatInfo?i.inBiliApp?t.useBridgeProxy?e(t):i.biliBridge.callNative({method:"global.getContainerInfo",callback:function(n){t.data=M(t.data,{build:n.build,mobi_app:n.mobi_app}),e(t)}}):(t.data=M(t.data,{build:0,mobi_app:"web"}),e(t)):e(t)}))}(t).then((function(t){return function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(){if(h[t]&&i>0)return h[t];setTimeout((function(){h[t]=null}),i);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return h[t]=e.apply(n,a),h[t]}}(r,e?R:a,t.throttleInterval)(t)})).then((function(i){return E.set(r,i,t.ttl,t.localCache,String(t.cache_key||"")).then((function(){return o=g(n),O(i,t.url,t.data,t.needOriginal,o,e)}))}),(function(){o=g(n);for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return j.apply(void 0,[o,t.url,t.data].concat(i))}))}))}var N=n(245),U=n.n(N);i.inBiliApp&&(Object(i.initEnv)(),i.biliBridge.callNative({method:"global.import",data:{namespace:"net"}})),a.interceptors.request.use((function(t){if(!t)return t;var e=t.method,n=t.url,i=t.data;t.withCredentials=!0;var o=i||{},a="string"==typeof e&&"post"===e.toLowerCase();if(a){var r=l.a.getItem("bili_jct")||"";o.csrf_token=r,o.csrf=r}if(!("undefined"!=typeof FormData&&o instanceof FormData)){var s={};if("undefined"!=typeof window){var c=v(window.location.href,"lang");if(c){var u="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(u="android"),s.lang=c,s.mobi_app="".concat(u,"_i")}}o=Object.assign(s,o),a?t.data=Object(y.stringify)(o):(t.params=o,f&&(t.params._=(new Date).getTime()),delete t.data),"undefined"==typeof window&&/^\/\//.test(n)&&(t.url="http:".concat(n))}return t}));var H=function(t){"undefined"==typeof window||window.Promise||console.warn("No window.Promise. @bplus-common/components.bpapi need a promise polyfill.");var e=(t.method||"get").toLowerCase(),n=d&&!function(t){if("undefined"==typeof window)return!1;var e=t.replace(/^(https?:)?(\/\/)?/,"").match(window.location.hostname);return e&&0===e.index}(t.url),i="jsonp"===e;return!i&&n?j(t.url,t.data,"少年啊，你的浏览器太老了辣","caution",-8889):(t.method=e,t.transformResponse=t.transformResponse||[I],i?function(t){var e=m(),n=0,i=t.url,o=/^(http:|https:)?\/\/api\.(live)|(vc)/.test(i),a=t.data&&"[object Object]"===t.data.toString();t.jsonpCallback||!a||"type"in t.data||"jsonp"in t.data?t.jsonpCallback||a||(t.data={type:"jsonp",jsonp:"jsonp"}):(t.data.type="jsonp",t.data.jsonp="jsonp");var r=t.data||{},s={},c="zh_CN";if("undefined"!=typeof window&&(c=v(window.location.href,"lang"))){s.lang=c;var l="iphone";(/Android/i.test(navigator.userAgent)||/Linux/i.test(navigator.userAgent))&&(l="android"),"zh_CN"!==c&&(s.mobi_app="".concat(l,"_i"))}r=Object.assign(s,r);var u=t.data&&t.jsonpCallback||(o?"_cb":"callback"),d=_.a.stringify(r),f=d.length>0?"".concat(i,"?").concat(d):"".concat(i),h=i+JSON.stringify(t.data||"");return E.get(h,t.ttl,String(t.cache_key||"")).then((function(o){return n=g(e),O({data:o.data},i,t.data,t.needOriginal,n)})).catch((function(){return U()(f,{jsonpCallback:u}).then((function(o){return o.ok?o.json().then((function(o){return E.set(h,o,t.ttl,t.localCache,String(t.cache_key||"")).then((function(){return n=g(e),O({data:o},i,t.data,t.needOriginal,n)}))}),(function(){n=g(e);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return j.apply(void 0,[n,t.url,t.data].concat(o))})):j(n=g(e),t.url,t.data)}),(function(){n=g(e);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return j.apply(void 0,[n,t.url,t.data].concat(o))}))}))}(t):B(t))},$={install:function(t){t.prototype.bpapi||(t.prototype.bpapi=H)}}},,,,,,,,,,,,function(t,e,n){"use strict";n.d(e,"d",(function(){return i.a})),n.d(e,"e",(function(){return p})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return m.a})),n.d(e,"a",(function(){return a}));var i=n(220),o=(n(15),n(14),n(34),n(28),n(38),n(37),n(33),n(36),n(80),n(81),n(46),n(48),n(13),n(12),n(24),n(32),n(52));function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},n=[];return(n=n.concat(t.free||[]).concat(t.vip||[])).forEach((function(t){t.emojis.forEach((function(n){e[n.name]={url:n.url.replace(/^http:\/\//,"//"),size:t.size}}))})),e}var r={"哼":"嫌弃","色":"喜欢","泪":"大哭","黑线":"无语","怒":"生气","哈哈":"大笑","吃惊":"惊讶","允悲":"捂脸","骷髅":"灵魂出窍","挖鼻":"抠鼻",good:"点赞"},s={"色":"喜欢","流泪":"大哭","发怒":"生气","骷髅":"灵魂出窍","傲慢":"傲娇","惊恐":"吓","强":"点赞","便便":"屎"};var c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=new RegExp(/\[([^([.*?\])]+)\]/g),n=window.bp_emoji_data_v3&&window.bp_emoji_data_v3.mapping?window.bp_emoji_data_v3.mapping:{};return t.replace(e,(function(t){var e=t.slice(1,t.length-1);return e=n[e]||r[e]||s[e]||e,"[".concat(e,"]")}))};function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f={};function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;return'<img src="'.concat(e.replace(/^http:\/\//,"//"),'" alt="').concat(t,'" style="margin: 0 1px;width: ').concat(n.width,"px; height: ").concat(n.height,'px;vertical-align:-4px; display: inline-block">')}o.a.allEmojiDataNew.map((function(t){t.purl&&""!==t.purl&&t.emojis&&t.emojis.length&&t.emojis&&t.emojis.length>0&&t.emojis.forEach((function(t){f[t.name]=t.url}))}));var p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f=u(u({},f),a(window.bp_emoji_data_v3||{}));var n={width:20,height:20};e=Object.assign(n,e),t=c(t);var i=new RegExp(/\[([^([.*?\])]+)\]/g);return t.replace(i,(function(t){var n=t.slice(1,t.length-1);return f["[".concat(n,"]")]?h("[".concat(n,"]"),f["[".concat(n,"]")].url,e):"[".concat(n,"]")}))},m=n(91)},,,,,,,,function(t,e,n){"use strict";n(14),n(264);var i={},o=null,a=null;function r(t,e,n,r,c){t!==a&&(o=null);var l=String((new Date).getTime());"boolean"==typeof n&&(n="info");var u=document.createDocumentFragment(),d=document.createElement("div");if("success"!==(n=n||"info")&&"caution"!==n&&"error"!==n&&"info"!==n)throw new Error("".concat("[Bplus Message]"," 在使用 Link Toast 时必须指定正确的类型: success || caution || error || info"));if(d.innerHTML='<span class="toast-text">'.concat(e,"</span>"),d.className="link-toast ".concat(n," ").concat(r?"fixed":""," ").concat(c?"mobile":""),!c){if(!t||!t.className&&!t.attributes)throw new Error("".concat("[Bplus Message]"," 传入 element 不是有效节点."));var f=t.getBoundingClientRect(),h=f.left,p=f.top,m=f.width,g=f.height,v=document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft;d.style.left=h+m+v+"px";var b=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop;d.style.top=p+g+b+"px"}setTimeout((function(){s(l,d)}),c?2e3:4e3),d.addEventListener("click",(function(){s(l,d)})),function t(e,n){if(!e||!i[e])return;var o=i[e],a=o.top-50;n&&(a=0,s(e,o.instance));o.instance.style.transform="translateY("+a+"px)",o.top=o.top-50,t(o.lastHash,n)}(o,c),u.appendChild(d),document.body.appendChild(u);var y=document.body.offsetWidth,_=d.getBoundingClientRect().left,C=d.offsetWidth;y-C-_<0&&(d.style.left=y-C-10+v+"px"),i[l]={instance:d,lastHash:o,top:0},o=l,a=t}function s(t,e){e.className+=" out-fade",setTimeout((function(){e&&e.parentNode&&e.parentNode.removeChild(e),i[t]=null}),350)}e.a=function(){return{install:function(t){t.prototype.linkMsg||(t.prototype.linkMsg=r)}}}},,,function(t,e,n){"use strict";n.d(e,"d",(function(){return g})),n.d(e,"e",(function(){return y})),n.d(e,"b",(function(){return b})),n.d(e,"c",(function(){return _})),n.d(e,"a",(function(){return m}));n(15),n(22),n(23),n(14),n(34),n(28),n(25),n(16),n(37),n(46),n(9),n(29),n(48),n(13),n(12),n(18),n(40),n(24),n(45),n(49),n(239),n(32),n(20);var i=n(4),o=n(31),a=n(6),r=n(8);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c=function(t){return!(!t||"object"!==s(t)||"string"!=typeof t.data||"number"!=typeof t.length||"number"!=typeof t.location||"number"!=typeof t.type)},l="#178bcf",u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace('"',"&quot;")},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=t;return n=(n=e<0?n.replace(/^\s+(.+?)$/,"$1"):e>0?n.replace(/(.+?)\s+$/,"$1 "):t).replace(/\r/g,"").replace(/\s/g,"&nbsp")},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(/\n/g,"<br>")},h=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n="";return n=t.replace(/\n{2,}/g,"\n\n"),n=e<0?n.replace(/^\n+(.+?)$/,"$1"):e>0?n.replace(/(.+?)\n+$/,"$1"):t},p=0,m={TYPE_STRING:++p,TYPE_LOTTERY:++p,TYPE_VOTE:++p,TYPE_AT:++p,TYPE_COMMIC_REMARK:++p,TYPE_LINK_HTTP:++p,TYPE_LINK_AV:++p,TYPE_LINK_BV:++p,TYPE_LINK_CV:++p,TYPE_LINK_VC:++p,TYPE_TOPIC:++p,TYPE_LINK_SHOP:++p},g=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=[];if("string"!=typeof t||""===t)return i;var o=e.ctrlJson,s=void 0===o?"":o,l=e.extendCtrlJson,u=void 0===l?"":l,d=e.display,f=void 0===d?{}:d,h=e.dynamicId,p=void 0===h?"":h,g=e.isRemark,v=void 0!==g&&g,b=e.isClip,y=void 0!==b&&b,_=Object(r.getShowBvConfig)(),C=0;if(v){var w=t.replace(/\r\n/g,"\n").indexOf("\n"),I=t.slice(0,w),x=I.match(/(\[星])+(\[空星])*|(\[星])*(\[空星])+/g);x&&x[0]&&(i.push({type:m.TYPE_COMMIC_REMARK,text:x[0]}),C=w+1)}var k=Object(a.e)(u),O=s?Object(a.e)(s):[],S=k.ctrl||[],P={};[].concat(O,S).forEach((function(t){c(t)&&(P[t.location]||(P[t.location]=t))}));var T={};f.rich_text&&f.rich_text.rich_details&&f.rich_text.rich_details.forEach((function(t){T[t.orig_text]=t}));var j=function(t){var e=!1,n=t.text.split("#");n.length>1?n.forEach((function(t,o){if(""===t)e&&i.push({type:m.TYPE_STRING,text:"#"}),e=!0;else if(e)if(function(t){var e=t.replace(/(^ +)|( +$)/g,"");return!/[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e)&&/^[^\n\r#@↵]{1,32}$/.test(e)}(t)&&o+1!==n.length){var a=t.trim().replace(/\xa0/g," ");i.push({type:m.TYPE_TOPIC,text:"#".concat(t,"#"),id:a}),e=!1}else i.push({type:m.TYPE_STRING,text:"#".concat(t)});else i.push({type:m.TYPE_STRING,text:t}),e=!0})):i.push({type:m.TYPE_STRING,text:t.text})},L=function(t,e,n){return function(o){var a=!0,r=0;do{var s=t.exec(o.text);if(s){var c={};if(T[s[0]]){c={text:T[s[0]].text,icon:{1:"//i0.hdslb.com/bfs/activity-plat/static/20210115/c4e76bc8e911f2aa43bdb44a218dbc34/wu3~93TYcA.png",2:"//i0.hdslb.com/bfs/activity-plat/static/20210115/c4e76bc8e911f2aa43bdb44a218dbc34/gQvBjpFoAmv.png"}[T[s[0]].icon_type]}}s.index===r||n({type:m.TYPE_STRING,text:o.text.substring(r,s.index)}),i.push(e(s,c)),r=t.lastIndex}else n({type:m.TYPE_STRING,text:o.text.substring(r)}),a=!1}while(a)}},A=L(/vc(\d+)/gi,(function(t){return{type:m.TYPE_LINK_VC,text:t[0],id:t[1]}}),j),E=L(/cv\d+/gi,(function(t,e){return{type:m.TYPE_LINK_CV,text:e.text||t[0],id:"cv"+t[0].slice(2),icon:e.icon}}),A),M=L(/av\d+/gi,(function(t,e){return{type:m.TYPE_LINK_AV,text:e.text||t[0],id:"av"+t[0].slice(2),icon:e.icon}}),E),D=L(/(bv1[\d\w]{9})/gi,(function(t,e){return{type:m.TYPE_LINK_BV,text:e.text||t[0],id:t[0],icon:e.icon}}),M),R=/(((http:\/\/|https:\/\/)([a-zA-Z0-9_.-]+\.)*(bilibili|biligame)\.com(\.\.\.|(\/[/.$*?~=#!%@&\-\w]*)?))|((http:\/\/|https:\/\/)([a-zA-Z0-9_.-]+\.)*(acg|b23)\.tv(\.\.\.|(\/[/.$*?~=#!%@&\-\w]*)?))|((http:\/\/|https:\/\/)dl\.(hdslb)\.com(\.\.\.|(\/[/.$*?~=#!%@&\-\w]*)?))|((http:\/\/|https:\/\/)sugs\.(suning)\.com(\.\.\.|(\/[/.$*?~=#!%@&\-\w]*)?)))|(https:\/\/static\.cdsb\.com\/micropub\/Articles\/202006\/6906c79ac5f0d1650b60aadd31879e32\.html)|(https:\/\/mp\.weixin\.qq\.com\/s\/(LOCoQsggmtmGq16XhFtw8A|MbRh8YThHIwlzRDWQCe2CQ))|(http:\/\/www\.bjnews\.com\.cn\/news\/2020\/06\/03\/734592\.html)/g,B=L(n?new RegExp(n,"g"):R,(function(t,e){var n=t.filter((function(t){return!!t}));return y&&n.length>0&&/\.\.\.$/.test(n[0])?{type:m.TYPE_STRING,text:"..."}:{type:m.TYPE_LINK_HTTP,text:e.text||"网页链接",url:t[0],icon:e.icon}}),_?D:M);return Object.keys(P).sort((function(t,e){return parseInt(t)>parseInt(e)?1:-1})).forEach((function(e){var n=P[e],o=n.data,a=n.length,r=n.location,s=n.type,c=n.type_id,l=n.prefix_icon,u=k.vote||k.vote_cfg,d=f.highlight,h=0,g=function(e){r<C||(r+h>t.length?(r<t.length?(r>C&&B({type:m.TYPE_STRING,text:t.substring(C,r)}),i.push(e)):B({type:m.TYPE_STRING,text:t.substring(C,t.length)}),C=t.length):r===C?(i.push(e),C=r+h):r>C&&(B({type:m.TYPE_STRING,text:t.substring(C,r)}),i.push(e),C=r+h))};switch(s){case 1:h=a,g({type:m.TYPE_AT,text:t.substring(r,r+h),id:o,dynamicId:p});break;case 2:h=parseInt(o),g({type:m.TYPE_LOTTERY,text:t.substring(r,r+h),id:p,dynamicId:p});break;case 3:h=parseInt(o),u&&u.vote_id?g({type:m.TYPE_VOTE,text:t.substring(r,r+h),id:u.vote_id,dynamicId:p}):g({type:m.TYPE_STRING,text:t.substring(r,r+h)});break;case 4:if(h=parseInt(o),d&&Array.isArray(d.items)){for(var v={item_id:"",jump_url:"",source_type:void 0},b=0;b<d.items.length;b++)if(d.items[b].type_id===c){v=d.items[b];break}g({type:m.TYPE_LINK_SHOP,text:t.substring(r,r+h),id:v.item_id,dynamicId:p,url:v?v.jump_url:"",shopIcon:l,sourceType:v?v.source_type:0})}else g({type:m.TYPE_STRING,text:t.substring(r,r+h)})}})),C<t.length&&B({type:m.TYPE_STRING,text:t.substring(C,t.length)}),i},v=function(t,e,n,i,o,a){var r="";return t?(r="".concat(n,"&isWeb=1"),'<span click-href="'.concat(u(r),'" click-title="').concat(u(e),'" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(i,';">').concat(a).concat(o,"</span>")):'<a href="'.concat(u(r=n),'" class="dynamic-link-hover-bg" style="color:').concat(i,';">').concat(a).concat(o,"</a>")},b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r="";if(n)return t.forEach((function(t){r+=t.text||t.url||t.id})),r;var s=e.isWeb,c=void 0===s||s,p=e.verticalAlign,g=void 0===p?"text-bottom":p,b=e.width,y=void 0===b?20:b,_=e.height,C=void 0===_?20:_,w=e.extendCtrlJson,I=void 0===w?"":w,x=e.cardType,k=void 0===x?"":x,O=e.cardId,S=void 0===O?"":O,P=e.display,T=void 0===P?{}:P,j=T.emoji_info&&T.emoji_info.emoji_details||[];T.origin&&T.origin.emoji_info&&T.origin.emoji_info.emoji_details&&(j=j.concat(T.origin.emoji_info.emoji_details));var L=[];j.forEach((function(t){L.push({id:t.id,name:t.text,url:t.url,type:t.type})}));var A={free:[{emojis:L,pid:-1,pname:"当前卡片",type:1}],mapping:[],vip:[]},E=0,M=Object(a.e)(I).from;M&&(E=M.emoji_type);var D={};return T.topic_info&&T.topic_info.topic_details&&T.topic_info.topic_details&&T.topic_info.topic_details.length>0&&T.topic_info.topic_details.forEach((function(t){D[t.topic_name.trim()]=t.topic_link})),t.forEach((function(e,n){var a="",s="",p="",b="",_="",w=0;0===n?w=-1:n===t.length-1&&(w=1);var I=e.text?d(f(h(u(e.text),w)),w):"";switch(e.type){case m.TYPE_STRING:a=Object(o.d)(I,{width:y,height:C,verticalAlign:g,emojiType:E},A);break;case m.TYPE_LOTTERY:b="抽奖详情",s="".concat(i.a.T,"/lottery/h5/index/#/result?business_id=").concat(e.dynamicId,"&business_type=1"),a=v(c,b,s,l,I,c?'<i class="bp-svg-icon lottery-btn" click-href="'.concat(u(p),'" click-title="').concat(u(b),'" style="position:relative;top:-2px;margin-left:2px;margin-right:2px;"></i>'):'<i class="bp-svg-icon lottery-btn" style="position:relative;top:-2px;margin-left:2px;margin-right:2px;"></i>');break;case m.TYPE_VOTE:b="投票",s="".concat(i.a.T,"/vote/h5/index/#/result?vote_id=").concat(e.id,"&dynamic_id=").concat(e.dynamicId),a=v(c,b,s,l,I,c?'<i class="bp-svg-icon vote-btn" click-href="'.concat(u(p),'" click-title="').concat(u(b),'" style="position:relative;top:-1px;margin-left:2px;margin-right:2px;"></i>'):'<i class="bp-svg-icon vote-btn" style="position:relative;top:-1px;margin-left:2px;margin-right:2px;"></i>');break;case m.TYPE_AT:c?(p="".concat(i.a.SPACE,"/").concat(e.id,"/dynamic"),a='<a href="'.concat(u(p),'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(l,';">').concat(I,"</a>")):(p="".concat(i.a.M,"/space/").concat(e.id),a='<span click-href="'.concat(u(p),'" spm-type="at" card-type="').concat(k,'" card-id="').concat(S,'" class="dynamic-link-hover-bg" style="color:').concat(l,';">').concat(I,"</span>"));break;case m.TYPE_COMMIC_REMARK:a=(e.text||"").replace(/\[星]/g,'<i title="[星]" class="bp-svg-icon star" style="position:relative;top:-4px;margin-right:6px;"></i>').replace(/\[空星]/g,'<i title="[空星]" class="bp-svg-icon star-empty" style="position:relative;top:-4px;margin-right:6px;"></i>'),a="".concat(a,"<br>");break;case m.TYPE_LINK_HTTP:var x="//i0.hdslb.com/bfs/activity-plat/static/20210115/c4e76bc8e911f2aa43bdb44a218dbc34/gQvBjpFoAmv.png"===_?"position:relative;top:1px;":"";_=e.icon?'<img class="bp-img-icon" style="width:20px;height:20px;vertical-align:top;'.concat(x,'" src="').concat(e.icon,'">'):'<i class="bp-svg-icon link" style="position:relative;top:-1px;margin-left:2px;"></i>',a=c?'<a href="'.concat(e.url,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(l,';">').concat(_).concat(I,"</a>"):'<span click-href="'.concat(e.url,'" spm-type="link" card-type="').concat(k,'" card-id="').concat(S,'" click-target="_blank" class="dynamic-link-hover-bg" style="color:').concat(l,';">').concat(_).concat(I,"</span>");break;case m.TYPE_LINK_AV:case m.TYPE_LINK_BV:_=e.icon?'<img class="bp-img-icon" style="width:20px;height:20px;vertical-align:top;position:relative;top:1px;" src="'.concat(e.icon,'" />'):"",a='<a href="'.concat(i.a.MAIN,"/video/").concat(e.id,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(l,';">').concat(_).concat(I,"</a>");break;case m.TYPE_LINK_CV:_=e.icon?'<img class="bp-img-icon" style="width:20px;height:20px;vertical-align:top;" src="'.concat(e.icon,'" />'):"",a='<a href="'.concat(i.a.MAIN,"/read/").concat(e.id,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(l,';">').concat(_).concat(I,"</a>");break;case m.TYPE_LINK_VC:a='<a href="'.concat(i.a.VC,"/video/").concat(e.id,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(l,';">').concat(I,"</a>");break;case m.TYPE_TOPIC:var O=D[e.id.trim()]||"".concat(i.a.T,"/topic/name/").concat(encodeURIComponent(e.id),"/feed");a='<a href="'.concat(O,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(l,';">').concat(I,"</a>");break;case m.TYPE_LINK_SHOP:var P='<i class="bp-svg-icon link" style="position:relative;top:-1px;margin-left:2px;margin-right:2px;"></i>';1===e.sourceType&&(P='<i class="bp-svg-icon taobao-link" style="position:relative;top:-2px;margin-left:3px;margin-right: 3px;font-size: 38px;"></i>'),a=c?'<a href="'.concat(e.url,'" shop-item-id="').concat(e.id,'" target="_blank" class="dynamic-link-hover-bg" style="cursor:pointer;color:').concat(l,';">').concat(P).concat(e.text,"</a>"):'<span click-href="'.concat(e.url,'" shop-item-id="').concat(e.id,'" spm-type="link" card-type="').concat(k,'" card-id="').concat(S,'" click-target="_blank" class="dynamic-link-hover-bg" style="color:').concat(l,';">').concat(P).concat(e.text,"</span>")}r+=a})),r},y=function(t,e,n){return new Promise((function(i){try{i(g(t,e,n))}catch(e){i([{type:m.TYPE_STRING,text:t}])}}))},_=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n){n(b(t,e))}))}},function(t,e,n){"use strict";n(54),n(34),n(25),n(28),n(61),n(46),n(9),n(29),n(13),n(40),n(32);var i=n(10),o=n.n(i),a=[];n(12);function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=[],c=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.keys(e).forEach((function(t){n[t]=e[t]})),this.$id=e.$id?e.$id:"popup-".concat(Math.floor(1e4*Math.random()*Date.now()).toString(16)),this.$disabled=!1,this.$out=!1,this.type=e.type||"normal",this.lockWhenConfirm=e.lockWhenConfirm||!1,this.$keep=e.keep||!1}var e,n,i;return e=t,(n=[{key:"unlock",value:function(){this.$disabled=!1}},{key:"lock",value:function(){this.$disabled=!0}},{key:"close",value:function(){return this.removePopup()}},{key:"keep",value:function(){this.$keep=!0}},{key:"cancelKeep",value:function(){this.$keep=!1}},{key:"restore",value:function(){this.$out=!1}},{key:"removePopup",value:function(){var t=this;return new Promise((function(e){t.$out=!0,setTimeout((function(){if(a.splice(t.$index,1),t.$keep){var n=s.filter((function(e){return e.$id===t.$id}));n.length?s[s.indexOf(n[0])]=t:s.push(t)}else delete s[s.indexOf(t)];var i;(i=a).forEach((function(t,e){i[e].$index=e})),o.a.nextTick((function(){e(),window.navigator.userAgent.match(/Maxthon\/4.[0-4]/)&&(window.document.body.style.backgroundColor="#fefefe",setTimeout((function(){window.document.body.style.backgroundColor="#fff"}),1))}))}),200)}))}}])&&r(e.prototype,n),i&&r(e,i),t}();function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.param=e;var n=this.init();this.popup=n}var e,n,i;return e=t,(n=[{key:"onInited",value:function(t){return this.popup.onInitedCallback=t,this}},{key:"onConfirm",value:function(t){return this.popup.onConfirmCallback=t,this}},{key:"onCancel",value:function(t){return this.popup.onCancelCallback=t,this}},{key:"init",value:function(){var t=new c(this.param),e=t.$id;if(!a.filter((function(t){return t.$id===e})).length){if(s.length)for(var n=0,i=s.length;n<i;n++){var o=s[n];if(o){o.restore(),a.push(o);var r=a.indexOf(o);a[r].$index=r}}var l=a.push(t)-1;return a[l].$index=l,t.onInitedCallback=null,t.onInitedCallbackExeced=!1,t}console.caution('检测到 $id 相同 livePopup "'.concat(this.param.$id,'}", 请解决冲突.'))}}])&&l(e.prototype,n),i&&l(e,i),t}(),d=(n(15),n(22),n(23),n(16),n(33),n(18),n(20),n(67)),f=n(157);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var p=[],m={data:function(){return{popups:a}},computed:{currentPopup:function(){var t=this.popups[this.popups.length-1];if(!t)return{};var e=t.component;if("object"===h(e)){if(void 0===t.content&&void 0===t.html||("server"!==Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_ENV&&window.console&&console.warn("[BpPopup] 当使用 Component 方式构建弹窗时，传入的 html 与 content 属性无效."),t.html=null,t.content=null),"object"===h(e._Ctor)){var n=e.name;if("string"!=typeof n)throw new Error("[Error] 在使用 Component 创建弹窗时必须指定 name.");o.a.component(n,e),p.push(n),t.component.name=n}else{if("string"!=typeof e.name)throw new Error("[Error] 在使用 Component 创建弹窗时必须指定 name.");o.a.component(e.name,e),p.push(e.name)}t.$usingComponent=!0}return t}},components:{LinkBtn:d.a,Shell:f.a},methods:{init:function(t){this.$nextTick((function(){t.onInitedCallback&&!t.onInitedCallbackExeced&&setTimeout((function(){t.onInitedCallback(t),t.onInitedCallbackExeced=!0}),10)}))},confirm:function(t,e){var n=this.currentPopup;n.$disabled||(n.lockWhenConfirm&&n.lock(),n.confirmBtn||(n.confirmBtn=e.confirmBtn),n.cancelBtn||(n.cancelBtn=e.cancelBtn),n.closeBtn||(n.closeBtn=e.closeBtn),n.onConfirmCallback?n.onConfirmCallback(n):n.removePopup&&n.removePopup())},cancel:function(t,e){var n=this.currentPopup;n.$disabled||(n.confirmBtn||(n.confirmBtn=e.confirmBtn),n.cancelBtn||(n.cancelBtn=e.cancelBtn),n.closeBtn||(n.closeBtn=e.closeBtn),n.onCancelCallback&&n.onCancelCallback(n),n.removePopup&&n.removePopup())},close:function(t){t.removePopup&&t.removePopup()}},provide:function(){var t=this,e={};return Object.defineProperty(e,"popup",{get:function(){return t.currentPopup}}),e}},g=(n(263),n(2)),v=Object(g.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"fade-out"}},[t.popups.length?n("div",{staticClass:"bp-popup-ctnr dp-table w-100 h-100 p-fixed p-zero f-family",attrs:{role:"alertdialog"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.currentPopup.hideMask,expression:"!currentPopup.hideMask"}],staticClass:"body-merge w-100 h-100 p-absolute p-zero"}),n("div",{staticClass:"dp-table-cell bp-v-middle"},[n("shell",{attrs:{show:!t.currentPopup.$out,width:t.currentPopup.width,title:t.currentPopup.title,"title-center":t.currentPopup.titleCenter,button:t.currentPopup.button,disabled:t.currentPopup.$disabled,"on-confirm":t.confirm,"on-cancel":t.cancel,init:t.init(t.currentPopup)}},[t.currentPopup.$usingComponent?[n(t.currentPopup.component.name,{tag:"component"})]:["string"==typeof t.currentPopup.html?n("div",{staticClass:"popup-content-ctnr",attrs:{id:t.currentPopup.$id},domProps:{innerHTML:t._s(t.currentPopup.html)}}):n("div",{staticClass:"popup-content-ctnr",staticStyle:{"font-size":"13px"},attrs:{id:t.currentPopup.$id},domProps:{textContent:t._s(t.currentPopup.content)}})]],2)],1)]):t._e()])}),[],!1,null,"b38bf146",null).exports,b=!1,y={install:function(t){if(!b){if(t.prototype.bpPopup=function(t){return new u(t,a)},"undefined"!=typeof window){var e=document.createElement("div");document.body.appendChild(e),t.nextTick((function(){new t({template:'<div class="bp-popup-ctnr"><bp-popup></bp-popup></div>',components:{BpPopup:v}}).$mount(e)}))}b=!0}}};e.a=y},,,,function(t,e,n){"use strict";n(13),n(45),n(49);var i=n(66),o=n(76);e.a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;if("string"!=typeof t)return"";var n="",a=t.split(/[\n↵]/g),r=0,s=0;if(1===a.length)return Object(o.a)(t,35*e-6)+"...";for(var c=0;c<a.length;c++){var l=Math.ceil(Object(i.a)(a[c].trim())/35),u=r+(l>0?l:1);if(!(u<e)){s=c;break}r+=l>0?l:1,n+=a[c]+"\n"}var d=e-r,f=35*d-6;return(n+=Object(o.a)(a[s],f))+"..."}},,,function(t,e,n){"use strict";n.d(e,"a",(function(){return I}));n(26),n(9),n(27),n(12);var i=n(10),o=n.n(i),a=n(39),r=(n(14),n(21),n(6)),s=n(8),c=n(4),l=n(19),u=(n(13),n(24),{"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" ","&quot;":'"',"&copy;":"","&ldquo;":"“","&rdquo;":"”","&lsquo;":"‘","&rsquo;":"’","&hellip;":"…","&mdash;":"—"}),d=n(5),f={props:{mid:{type:Number,required:!0}},data:function(){return{loadingFail:!1,isLoading:!1,isLoaded:!1,isfollowed:!1,followIn:!1,cardRichInfo:{card:{mid:"",sex:"",face:"",sign:"",attention:0,fans:0}},following:!1,HOST:c.a}},computed:{followWord:function(){return this.followIn?"取消关注":"已关注"},encodeSign:function(){return function(t){return"string"!=typeof(t=void 0!==t?t:this.toString())?t:t.replace(/&\w+;|&#(\d+);/g,(function(t,e){var n=u[t];return void 0===n&&(n=isNaN(e)?t:String.fromCharCode(160===e?32:e)),n}))}(this.cardRichInfo.card.sign)},verifyType:function(){return this.cardRichInfo.card.official_verify.type},isBig:function(){return this.cardRichInfo.card.vip.vipType>0&&1===this.cardRichInfo.card.vip.vipStatus}},methods:{numberFormat:s.numberFormat.autoParse,followCut:function(){this.followIn=!this.followIn},getCardRichInfo:function(){var t=this;this.isLoading=!0;var e={url:c.a.API_MAIN+"/x/web-interface/card",method:"get",data:{mid:this.mid,photo:!0}};Object(l.a)(e).then((function(e){t.cardRichInfo=e.data,t.isLoading=!1,t.isLoaded=!0,t.$emit("update-position")}),(function(){t.loadingFail=!0}))},toBfsImg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{c:1};return Object(r.g)(Object(s.bfsImgLink)(t,e,n,i))},follow:function(){var t=this,e={url:c.a.API_MAIN+"/x/relation/modify?cross_domain=true",method:"post",data:{fid:this.mid,act:1,re_src:15}};Object(l.a)(e).then((function(){t.linkMsg(t.$refs.follow,"关注成功","success"),t.cardRichInfo.following=!0,d.r.insertToMyAttentionList(t.mid)}),(function(e){-665===e.code?t.linkMsg(t.$refs.follow,"已达到关注上限","error"):t.linkMsg(t.$refs.follow,e.msg,e.type)}))},unFollow:function(){var t=this,e={url:c.a.API_MAIN+"/x/relation/modify?cross_domain=true",method:"post",data:{fid:this.mid,act:2,re_src:15}};Object(l.a)(e).then((function(){t.linkMsg(t.$refs.follow,"取消关注成功！","success"),t.isfollowed=!0,t.cardRichInfo.following=!1,d.r.deleteFromMyAttentionList(t.mid)}),(function(e){t.linkMsg(t.$refs.follow,e.msg,e.type)}))}},mounted:function(){this.getCardRichInfo()}},h=(n(265),n(2)),p=Object(h.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"userinfo-content"},[t.loadingFail?n("div",{staticClass:"loadfail"},[t._v("加载失败")]):[t.isLoading?n("div",{staticClass:"loading"},[t._v("正在加载中...请稍后。")]):t._e(),t.isLoaded?[n("div",{staticClass:"bg",style:{backgroundImage:"url("+t.toBfsImg(t.cardRichInfo.space.s_img,null,120,{autoDpr:!1})+")"}}),n("a",{staticClass:"face",attrs:{href:t.HOST.SPACE+"/"+t.cardRichInfo.card.mid+"/dynamic",target:"_blank"}},[n("img",{attrs:{src:t.toBfsImg(t.cardRichInfo.card.face,50,50)}}),t.verifyType>-1||t.isBig?n("div",{staticClass:"verify-box",class:"type-"+t.verifyType+" type-"+(t.isBig?"big":"")}):t._e()]),n("div",{staticClass:"info"},[n("p",{staticClass:"user"},[n("a",{staticClass:"name",class:{vip:t.cardRichInfo.card.vip.vipStatus},attrs:{target:"_blank",href:t.HOST.SPACE+"/"+t.cardRichInfo.card.mid+"/dynamic"}},[t._v(t._s(t.cardRichInfo.card.name))]),"男"===t.cardRichInfo.card.sex||"女"===t.cardRichInfo.card.sex?n("i",{staticClass:"sex",class:{men:"男"===t.cardRichInfo.card.sex,women:"女"===t.cardRichInfo.card.sex}}):t._e(),n("a",{attrs:{target:"_blank",href:t.HOST.MAIN+"/html/help.html#k_5"}},[n("i",{staticClass:"level",class:"lv"+t.cardRichInfo.card.level_info.current_level})])]),n("p",{staticClass:"social"},[n("a",{attrs:{href:t.HOST.SPACE+"/"+t.cardRichInfo.card.mid+"/fans/follow",target:"_blank"}},[t._v("关注："),n("span",{staticClass:"like"},[t._v(t._s(t.cardRichInfo.card.attention))])]),n("a",{attrs:{href:t.HOST.SPACE+"/"+t.cardRichInfo.card.mid+"/fans/fans",target:"_blank"}},[t._v("粉丝："),n("span",{staticClass:"fans"},[t._v(t._s(t.numberFormat(t.cardRichInfo.card.fans)))])])]),t.cardRichInfo.card.sign?n("p",{staticClass:"sign"},[t._v(t._s(t.encodeSign))]):t._e()]),n("div",{staticClass:"btn-box"},[n("a",{ref:"follow",staticClass:"like",class:{liked:t.cardRichInfo.following}},[t.cardRichInfo.following?[n("span",{on:{click:t.unFollow,mouseenter:t.followCut,mouseleave:t.followCut}},[t._v(t._s(t.followWord))])]:[n("span",{on:{click:t.follow}},[t._v("+关注")])]],2),n("a",{staticClass:"message",attrs:{href:t.HOST.MESSAGE+"/#whisper/mid"+t.cardRichInfo.card.mid,target:"_blank"}},[t._v("发消息")])])]:t._e()]],2)}),[],!1,null,"1b25913d",null).exports,m={props:{mid:[Number,String],attachDomInstance:null,eventDom:null,top:Number,left:Number},data:function(){return{styleTop:0,styleLeft:0,parentStyle:{},targetStyle:{},cardStyle:{}}},computed:{positionStyle:function(){return"top: ".concat(this.styleTop,"px; left: ").concat(this.styleLeft,"px;")}},components:{UserinfoContent:p},mounted:function(){this.updatePosition(!0)},methods:{onmouseenter:function(t){this.$emit("mouseenter",t)},onmouseleave:function(t){this.$emit("mouseleave",t)},updatePosition:function(t){var e=this;this.$nextTick((function(){e.targetStyle=e.eventDom.getBoundingClientRect(),e.cardStyle=e.$refs.card.getBoundingClientRect(),t&&(e.parentStyle=e.attachDomInstance.$el.getBoundingClientRect()),e.styleLeft=e.targetStyle.left-e.parentStyle.left+e.targetStyle.width/2,e.targetStyle.top-40<300?e.styleTop=e.targetStyle.top-e.parentStyle.top+e.targetStyle.height:e.styleTop=e.targetStyle.top-e.parentStyle.top-e.cardStyle.height,void 0!==e.top&&(e.styleTop=e.top),void 0!==e.left&&(e.styleLeft=e.left)}))}}},g=(n(266),Object(h.a)(m,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"card",staticClass:"userinfo-wrapper",style:this.positionStyle,on:{mouseenter:this.onmouseenter,mouseleave:this.onmouseleave}},[e("userinfo-content",{attrs:{mid:Number(this.mid)},on:{"update-position":this.updatePosition}})],1)}),[],!1,null,"5e6ddf5c",null).exports);function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var y=function(){function t(e,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(v(this,t),!(n instanceof HTMLElement))return console.error("attachDom is not a HTMLElement");this.eventDom=i;var a=o||{};if(i instanceof HTMLElement||(a=i||a,this.eventDom=n),"true"!==this.eventDom.getAttribute("data-userinfo-popup-inited")){this.delay="delay"in a?a.delay:400,this.options=a,this.mid=e,this.timer=null,this.vueInstance=null,this.mountedDom=document.createElement("div"),this.mountedDom.addEventListener("click",(function(t){t.stopPropagation(),t.preventDefault()}),!0),this.attachDom=n;var r=window.getComputedStyle(this.attachDom);"relative"!==r.position&&this.attachDom.setAttribute("style","position: relative;"),this.init()}}var e,n,i;return e=t,(n=[{key:"init",value:function(){this.vueInstance=new o.a({template:'<userinfo-wrapper v-if="show" @mouseenter="onmouseenter" @mouseleave="onmouseleave" :mid="mid" :attach-dom-instance="attachDomInstance" :event-dom="eventDom" :top="top" :left="left"></userinfo-wrapper>',components:{UserinfoWrapper:g},data:function(){return{show:!1,mid:0,attachDomInstance:null,eventDom:null,top:void 0,left:void 0}},methods:{onmouseenter:function(t){this.$emit("mouseenter",t)},onmouseleave:function(t){this.$emit("mouseleave",t)}}}),this.vueInstance.$mount(this.mountedDom),this.mountedDom=this.vueInstance.$el,this.vueInstance.mid=this.mid,this.vueInstance.attachDomInstance=this.vueInstance,this.vueInstance.eventDom=this.eventDom,this.vueInstance.top=this.options.top,this.vueInstance.left=this.options.left,this.vueInstance.$on("mouseenter",this.mouseenter.bind(this)),this.vueInstance.$on("mouseleave",this.mouseleave.bind(this)),this.eventDom.addEventListener("mouseenter",this.mouseenter.bind(this),!1),this.eventDom.addEventListener("mouseleave",this.mouseleave.bind(this),!1);var t=this;this.destroy=function(){t.vueInstance.$destroy(),t.eventDom.removeEventListener("mouseenter",t.mouseenter),t.eventDom.removeEventListener("mouseleave",t.mouseleave)},this.eventDom.setAttribute("data-userinfo-popup-inited","true")}},{key:"mouseenter",value:function(){var t=this;this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((function(){t.show()}),this.delay)}},{key:"mouseleave",value:function(){var t=this;this.timer&&(clearTimeout(this.timer),this.timer=null),this.timer=setTimeout((function(){t.hide()}),200)}},{key:"show",value:function(){this.append(),this.vueInstance.show=!0}},{key:"hide",value:function(){this.vueInstance.show=!1}},{key:"append",value:function(){this.appended||(this.attachDom.appendChild(this.mountedDom),this.appended=!0)}}])&&b(e.prototype,n),i&&b(e,i),t}();function _(t,e,n){return(_=C()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&w(o,n.prototype),o}).apply(null,arguments)}function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function I(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return _(y,e)}o.a.use(Object(a.a)())},,function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));n(28),n(32);var i={kaomojis:[],dynamicEmojis:[],mainEmojis:[]};function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];i.mainEmojis=window.bp_emoji_data_v3?window.bp_emoji_data_v3.vip:[],i.dynamicEmojis=window.bp_emoji_data_v3?window.bp_emoji_data_v3.free:[];var e=[];return t.forEach((function(t){i[t].forEach((function(t){e.push(t)}))})),e}var a={allEmojiDataNew:[],allEmojiDataOld:[]}},,,function(t,e,n){"use strict";n(267)},function(t,e,n){"use strict";var i=n(157).a;e.a=i},function(t,e,n){"use strict";n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return m}));n(36),n(28),n(46),n(9),n(29),n(32),n(15),n(22),n(23),n(16),n(37),n(13),n(12),n(18),n(45),n(20);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o={pv:{},click:{},default:{}};function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(o).forEach((function(e){o[e]=Object.assign({},t[e])}))}function r(t){!function t(e,n,a){var r=function(t){return!!t&&(t instanceof Promise?"promise":"function"==typeof t?"function":"string"==typeof t?"string":"[object Object]"===String(t)?"object":void 0)}(n);if(!r)return;if("object"===r){var s=Object.assign({},o.default,o[e],{e:a},n);return void function(t,e){var n={logId:e.logId,sendStatus:e.sendStatus||"double",spmId:e.spmId,sendUrl:e.sendUrl};if(void 0!==e.data&&null!==e.data&&"{}"!==JSON.stringify(e.data)&&(n.msg={value:e.data,_rdm:Math.random().toString().split(".")[1].slice(0,5)}),e.event){var o=e.spmId+".selfDef."+e.event;n.spm_id=o,"object"===i(n.msg)?n.msg.event=e.event:n.msg={event:e.event,_rdm:Math.random().toString().split(".")[1].slice(0,5)}}"click"===t?window.__bp_statisObserver.sendClickEvent(n,e.e):"pv"===t&&window.__bp_statisObserver.sendPV(n)}(e,s)}if("string"===r){var c={};return c.event=n,void t(e,c,a)}if("function"===r){var l=n();return void t(e,l,a)}if("promise"===r)return void n.then((function(n){t(e,n,a)}))}(t.type,t.data,t.e)}var s=[];function c(){if(Object.assign)return!!(window.__bp_statisObserver&&window.__bp_statisObserver.sendClickEvent&&window.__bp_statisObserver.sendPV);console.error("No Object.assign. component.statistics needs Object.assign polyfill.")}function l(){c()&&s.forEach((function(){r(s.shift())}))}function u(t){s.push(t),setTimeout((function(){l()}),1e3)}function d(t){if(void 0===window.__bp_statisObserver){window.__bp_statisObserverConfig=Object.assign({loadPV:!0,loadEvent:!0,loadPerform:!1,loadSpecial:!1,loadBaidu:!1},window.__bp_statisObserverConfig);var e=document.createElement("script");e.onload=function(){l(),t&&t()},e.src="//s1.hdslb.com/bfs/seed/bplus-common/statistics-js/log-reporter.js",document.getElementsByTagName("body")[0].appendChild(e)}else t&&t()}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=Object.assign({},{data:t},{type:"click"},{e:e});if(!c())return u(n),void d();r(n)}function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object.assign({},{data:t},{type:"pv"});if(!c())return u(e),void d();r(e)}var p={click:f,event:f,pv:h,setDefault:a},m={install:function(t,e){a(e),t.prototype.$bpreport=p,t.directive("bpreport",{bind:function(t,e){"click"===e.arg&&t.addEventListener("click",(function(t){f(e.value,t)}))},inserted:function(t,e){"pv"===e.arg&&h(e.value)}})}}},,,,,function(t,e,n){"use strict";var i=n(10),o=n.n(i),a=n(57),r=(n(54),n(240),n(14),n(34),n(28),n(33),n(9),n(12),n(32),n(21),{props:{arrow:{type:Boolean,default:!1},width:{type:Number,default:300}},data:function(){return{}},methods:{onClose:function(t){this.$emit("close"),t.stopPropagation()}}}),s=(n(272),n(2)),c=Object(s.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"move-in"}},[e("div",{staticClass:"static-popup",class:{"bp-arrow":this.arrow},style:{width:this.width+"px"}},[e("div",{staticClass:"bp-icon-font icon-group-dynamic close-btn",on:{click:this.onClose}}),e("div",{staticClass:"title"},[this._t("title")],2),e("div",{staticClass:"content-ctnr"},[this._t("default")],2)])])}),[],!1,null,"b3d54e6c",null).exports,l=n(8),u=n(246),d={name:"emoji-item",props:{url:{type:String},title:{}},data:function(){return{imgStyle:"background-color: #e7e7e7;width:100%;height:100%;"}},mounted:function(){this.img=new Image,this.img.src=this.url,this.img.addEventListener("load",this.success),this.img.addEventListener("error",this.error)},destroyed:function(){this.img.removeEventListener("load",this.success),this.img.removeEventListener("error",this.error)},watch:{url:function(){this.img.src=this.url}},methods:{success:function(){this.img.complete&&(this.imgStyle="background-image: url(".concat(this.url,");background-size: cover;width:100%;height:100%;"))},error:function(){this.imgStyle="background-color: #e7e7e7;width:100%;height:100%;"}}},f=Object(s.a)(d,(function(){var t=this.$createElement;return(this._self._c||t)("div",{style:this.imgStyle,attrs:{title:this.title}})}),[],!1,null,null,null).exports,h={props:{emojiList:{type:Array,default:function(){return[]}}},components:{emojiItem:f},data:function(){return{perfectScrollbar:null,isOldBrowser:l.isOldBrowser}},watch:{emojiList:function(){this.isOldBrowser||this.updateScrollbar()}},mounted:function(){this.initScrollbar()},methods:{initScrollbar:function(){if(!this.isOldBrowser){var t=this.$el;this.perfectScrollbar=new u.a(t,{wheelSpeed:2,wheelPropagation:!0,minScrollbarLength:20,theme:"playlist-editor"}),this.updateScrollbar()}},updateScrollbar:function(){var t=this;this.$nextTick((function(){var e=t.$el;e.scrollTop=1,t.perfectScrollbar.update(e)}))}}},p=(n(273),Object(s.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"emoji-page",class:{ie:t.isOldBrowser},on:{mousedown:function(t){t.stopPropagation(),t.preventDefault()}}},[n("ul",{staticClass:"emoji-list f-clear"},t._l(t.emojiList,(function(e){return n("li",{key:e.url,staticClass:"emoji",class:{kaomoji:4===e.type},on:{click:function(n){return t.$emit("select",e.name)}}},[4!==e.type?n("emoji-item",{attrs:{title:e.name,url:e.url.replace(/^http:\/\//,"//")}}):t._e(),4===e.type?n("span",{staticClass:"dp-i-block"},[t._v(t._s(e.name))]):t._e()],1)})),0)])}),[],!1,null,"60ae9c4d",null).exports),m={props:{emojiLists:{type:Array,default:function(){return[]}},curPid:{type:Number,default:0}},components:{emojiItem:f},data:function(){return{lineHeight:36,curPage:1,totalPages:1}},computed:{marginTop:function(){return-(this.curPage-1)*this.lineHeight}},watch:{emojiLists:function(){this.update()}},mounted:function(){this.init(),this.update()},methods:{init:function(){this.lineHeight=this.$el.offsetHeight},update:function(){var t=this;this.$nextTick((function(){var e=t.$refs.list.offsetHeight;t.totalPages=Math.ceil(e/t.lineHeight)}))},select:function(t){this.$emit("select",t)},showPrev:function(){this.curPage>1&&this.curPage--},showNext:function(){this.curPage<this.totalPages&&this.curPage++}}},g=(n(274),Object(s.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pagination",style:{height:t.lineHeight+"px"}},[n("ul",{ref:"list",staticClass:"emoji-cover-list f-clear",style:{marginTop:t.marginTop+"px"}},t._l(t.emojiLists,(function(e){return n("li",{staticClass:"emoji-cover f-left",class:{selected:e.pid===t.curPid},style:{height:t.lineHeight+"px"},on:{click:function(n){return t.select(e.pid)}}},[n("emoji-item",{attrs:{url:e.purl.replace(/^http:\/\//,"//")}})],1)})),0),t.totalPages>1?n("div",{staticClass:"page-controller",style:{height:t.lineHeight+"px",lineHeight:t.lineHeight+"px"}},[n("span",{staticClass:"prev bp-icon-font icon-btn-triangle-left",class:{disabled:t.curPage<=1},on:{click:t.showPrev}}),n("span",{staticClass:"next bp-icon-font icon-btn-triangle-right",class:{disabled:t.curPage>=t.totalPages},on:{click:t.showNext}})]):t._e()])}),[],!1,null,"68831bbc",null).exports),v=n(52),b=n(31),y={MAIN:"444.41",TAG:"333.169",SPACE:"333.49",DETAIL:"444.42",MESSAGE:"444.1"},_={1:"emoji",1e3:"emotion",1001:"tv",1002:"cat"},C={props:{field:{required:!0},frozenElements:{type:Array,default:function(){return[]}},emojiType:{type:Array,default:function(){return[]}},spmType:{type:String},pubType:{type:String,default:""},selectHandler:{type:Function,default:function(){}},isFromMessage:{type:Boolean,default:!1},revert:null},data:function(){return{curPid:0,emojiLists:[]}},computed:{curEmojiList:function(){var t=this,e=this.emojiLists.filter((function(e){return e.pid===t.curPid}));return e.length>0&&e[0].emojis?e[0].emojis:[]}},created:function(){Object(b.b)(this.isFromMessage),this.emojiLists=Object(v.b)(this.emojiType)},mounted:function(){this.init(),this.bindEvents(),this.dataReport()},beforeDestroy:function(){this.removeEvents()},methods:{emojiIconId:function(t){var e=this.curEmojiList[0].id;return this.curEmojiList.forEach((function(n){n.name===t&&(e=n.id)})),e},getCursortPosition:function(t){var e=0,n=t.ownerDocument||t.document,i=n.defaultView||n.parentWindow;if("DIV"===t.tagName){if(i.getSelection().rangeCount>0){var o=i.getSelection().getRangeAt(0),a=o.cloneRange();a.selectNodeContents(t),a.setEnd(o.endContainer,o.endOffset),e=a.toString().length}}else e=t.selectionEnd;return e},setCaretPosition:function(t,e){var n,i;"DIV"===t.tagName?((n=document.createRange()).selectNodeContents(t),t.innerHTML.length>0&&n.collapse(t,e),n.collapse(!0),(i=window.getSelection()).removeAllRanges(),i.addRange(n)):t.setSelectionRange(e,e)},mousewheelFix:function(t){t.preventDefault()},init:function(){try{this.curPid=this.emojiLists[0]?this.emojiLists[0].pid:this.curPid,this.focusField()}catch(t){return}},dataReport:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;if(y.hasOwnProperty(this.spmType)){var n={};"_tab"===t?n={package_id:this.curPid}:"_icon"===t&&e&&(n={package_id:this.curPid,emoji_id:this.emojiIconId(e),emoji_name:1e3===this.curPid?"emotion":e}),this.$bpreport.click({logId:"000502",spmId:y[this.spmType],event:"".concat(this.pubType?"publish":"card_rt","_emoji").concat(t).concat("MAIN"===this.spmType?this.pubType:""),data:n})}},bindEvents:function(){var t=this;this.$el.addEventListener("mousewheel",this.mousewheelFix,!1),this.$el.addEventListener("DOMMouseScroll",this.mousewheelFix,!1),setTimeout((function(){document.body.addEventListener("click",t.close,!1),t.$el.addEventListener("click",t.stopPropagation),t.frozenElements.forEach((function(e){e.addEventListener("click",t.stopPropagation)}))}),100)},removeEvents:function(){var t=this;this.$el.removeEventListener("mousewheel",this.mousewheelFix),this.$el.removeEventListener("DOMMouseScroll",this.mousewheelFix),document.body.removeEventListener("click",this.close),this.$el.removeEventListener("click",this.stopPropagation),this.frozenElements.forEach((function(e){e.removeEventListener("click",t.stopPropagation)}))},stopPropagation:function(t){t.stopPropagation()},focusField:function(){this.field&&this.field.focus&&this.field.focus()},close:function(){this.$emit("close")},switchEmojiPage:function(t){this.curPid=t,this.dataReport("_tab",_[t])},insertText:function(t){if(this.dataReport("_icon",t),this.field&&"TEXTAREA"===this.field.tagName){if(this.$emit("update",t),!this.field)return;if(document.selection)this.field.focus(),document.selection.createRange().text=t;else if(this.field.selectionStart||0===parseInt(this.field.selectionStart)){var e=parseInt(this.field.selectionStart),n=this.field.selectionEnd;this.field.value=this.field.value.substring(0,e)+t+this.field.value.substring(n,this.field.value.length),this.field.setSelectionRange(e+t.length,e+t.length)}else this.field.value+=t;this.triggerTextareaInput(),this.focusField()}else this.selectHandler(t)},triggerTextareaInput:function(){var t=document.createEvent("HTMLEvents");t.initEvent("input",!1,!0),this.field.dispatchEvent(t)}},components:{StaticBox:c,EmojiPage:p,EmojiPagination:g}},w=(n(275),Object(s.a)(C,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"move-in"}},[n("div",{class:{revert:t.revert},on:{mousedown:function(t){t.stopPropagation(),t.preventDefault()}}},[n("static-box",{staticClass:"common-font",attrs:{arrow:!t.revert,width:380},on:{close:t.close}},[n("span",{attrs:{slot:"title"},slot:"title"},[t._v("表情")]),n("emoji-page",{attrs:{"emoji-list":t.curEmojiList},on:{select:t.insertText}}),n("emoji-pagination",{attrs:{"emoji-lists":t.emojiLists,"cur-pid":t.curPid},on:{select:t.switchEmojiPage}})],1)],1)])}),[],!1,null,"6bf73c3c",null).exports);o.a.use(a.b);var I=w;e.a=I},,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n(13),n(24);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("string"!=typeof t)return 0;var e=t.length;if(/[\u0000-\u00ff]/.test(t)){var n=t.replace(/[\u0000-\u00ff]/g,"").length;e=Math.ceil((e-n)/2)+n}return e}},function(t,e,n){"use strict";var i={name:"bl-button",props:{disabled:Boolean,type:{type:String,default:"primary"},size:{type:String,default:"size"}},methods:{handleClick:function(t){this.$emit("click",t)}}},o=(n(261),n(2)),a=Object(o.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"bl-button",class:[this.type?"bl-button--"+this.type:"",this.size?"bl-button--"+this.size:""],attrs:{disabled:this.disabled},on:{click:this.handleClick}},[e("span",{staticClass:"txt"},[this._t("default")],2)])}),[],!1,null,"65bda702",null).exports;e.a=a},,,,,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return p}));n(15),n(22),n(14),n(28),n(231),n(25),n(38),n(33),n(13),n(40),n(24),n(74),n(32);var i=n(6),o=n(8),a=n(5),r=n(47),s=n(0),c=n(4),l=function(t,e){var n=Object(i.e)(t),o=Object(i.e)(e),a=o.ctrl;Array.isArray(n)||(n=[]),Array.isArray(a)||(a=[]),n=a.concat(n);var r=!1,s=!1,c=o.dispute||"";return n.forEach((function(t){2===t.type?r=!0:3===t.type&&(s=!0)})),{hasLottery:r,hasVote:s,riskTip:c}},u=function(){if("undefined"==typeof window)return!1;try{return 0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch(t){return!1}}(),d=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.width,i=e.height,o=e.scale;if(!t)return"";var a=/^\/\//.test(t)?"https:".concat(t):/^http:/.test(t)?t.replace("http:","https:"):t;if(!n&&!i)return a;var r=o||window.devicePixelRatio;return"".concat(a,"@").concat(n*r|0,"w_").concat(0|(i?i*r:n*r),"h_1e_1c").concat(u?".webp":"")},f=["manga","pugv","ogv","game","decoration","official_activity"],h=function(t){return!f.includes(t)},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!h(t.type)){var e=t.button||{};return[{adMark:t.head_text||"相关漫画作品",adMarkPlain:1,brief:t.desc_first,img:t.cover_url,imgType:t.cover_type,itemsId:t.oid_str,jumpLink:t.jump_url,jumpLinkAction:t.type,jumpLinkColor:"",jumpLinkStatus:e.status,jumpButtonType:e.type,jumpLinkDesc:(e.uncheck||e.jump_style||{}).text,jumpLinkChecked:(e.check||{}).text,jumpLinkIcon:d((e.uncheck||{}).icon),name:t.title,desc2:t.desc_second}]}},m=function(t){var e={name_url:"",name:"",detail_url:"",face:"//static.hdslb.com/images/member/noface.gif",comment_count:0,detail_comment_url:"",more_comment_url:"",more_forw_url:"".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=1"),comment_id:0,comment_oid:0,hasVote:!1,hasLottery:!1,isSetTop:!1},n=Object(i.e)(t.card),a={},r={},u=Object(o.getVideoLink)(t.desc.rid,t.desc.bvid||t.desc.origin&&t.desc.origin.bvid);switch(t.extra&&(e.isSetTop=1==t.extra.is_space_top),t.desc.type){case s.a.REPOST:e.name_url="".concat(c.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.item.reply,e.more_comment_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.comment_id=17,e.comment_oid="".concat(t.desc.dynamic_id),r=l(n.item.ctrl,t.extend_json),e.hasVote=r.hasVote,e.hasLottery=r.hasLottery,e.riskTip=r.riskTip;break;case s.a.PIC:e.name_url="".concat(c.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.item.reply,e.detail_comment_url="".concat(c.a.T,"/").concat(t.desc.orig_dy_id||t.desc.dynamic_id,"?tab=2"),e.more_comment_url="".concat(c.a.T,"/").concat(t.desc.orig_dy_id||t.desc.dynamic_id,"?tab=2"),e.comment_id=11,e.comment_oid="".concat(n.item.id),r=l(n.item.at_control,t.extend_json),e.hasVote=r.hasVote,e.hasLottery=r.hasLottery,e.riskTip=r.riskTip;break;case s.a.WORD:e.name_url="".concat(c.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.item.reply,e.more_comment_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.comment_id=17,e.comment_oid="".concat(t.desc.dynamic_id),r=l(n.item.ctrl,t.extend_json),e.hasVote=r.hasVote,e.hasLottery=r.hasLottery,e.riskTip=r.riskTip;break;case s.a.VIDEO:e.name_url="".concat(c.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.stat.reply,e.detail_comment_url=u,e.more_comment_url=u,e.comment_id=1,e.comment_oid="".concat(n.aid),e.needPay=n.rights&&!!n.rights.ugc_pay,e.isCooperation=n.rights&&!!n.rights.is_cooperation,r=l(n.ctrl,t.extend_json),e.hasLottery=r.hasLottery,e.riskTip=r.riskTip;break;case s.a.CHEESE_SERIES:case s.a.CHEESE_UPDATE:e.name_url="".concat(c.a.SPACE,"/").concat(n.up_id,"/dynamic"),e.uid=n.up_id,e.name=n.up_info.name,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=n.up_info.avatar,e.comment_count=n.new_ep?n.new_ep.reply:0,e.detail_comment_url=n.url,e.more_comment_url=n.url,e.comment_id=33,e.comment_oid=n.new_ep?"".concat(n.new_ep.id):0,r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip;break;case s.a.CLIP:e.name_url="".concat(c.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.item.reply,e.detail_comment_url="".concat(c.a.VC,"/video/").concat(n.item.id),e.more_comment_url="".concat(c.a.VC,"/video/").concat(n.item.id),e.comment_id=5,e.comment_oid="".concat(n.item.id),r=l(n.item.at_control,t.extend_json),e.hasVote=r.hasVote,e.hasLottery=r.hasLottery,e.riskTip=r.riskTip;break;case s.a.ARTICLE:e.name_url="".concat(c.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.stats.reply,e.detail_comment_url="".concat(c.a.MAIN,"/read/cv").concat(n.id),e.more_comment_url="".concat(c.a.MAIN,"/read/cv").concat(n.id),e.comment_id=12,e.comment_oid="".concat(n.id),r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip;break;case s.a.MUSIC:e.name_url="".concat(c.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=n.replyCnt,e.detail_comment_url="".concat(c.a.MAIN,"/audio/au").concat(n.id,"?type=7"),e.more_comment_url="".concat(c.a.MAIN,"/audio/au").concat(n.id,"?type=7"),e.comment_id=14,e.comment_oid="".concat(n.id),r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip;break;case s.a.BANGUMI:case s.a.PGC_BANGUMI:case s.a.GUOCHUANG:a=n.apiSeasonInfo||n.season||{},e.name_url="".concat(c.a.BANGUMI,"/anime/").concat(t.desc.uid),e.name=a.title,e.face=a.cover,e.comment_count=n.reply_count,e.detail_comment_url=n.url,e.more_comment_url=n.url,e.comment_id=1,e.comment_oid="".concat(n.aid),4===a.bgm_type?(e.bangumi_desc="国创",e.tags=[{name:"国创"}]):(e.bangumi_desc="番剧",e.bangumi_url="".concat(c.a.BANGUMI,"/anime/timeline"),e.tags=[{name:"番剧"}]),r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip;break;case s.a.COMIC_SHARE:case s.a.H5_SHARE:e.name_url="".concat(c.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=t.desc.comment,e.more_comment_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.comment_id=17,e.comment_oid="".concat(t.desc.dynamic_id),r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip;break;case s.a.FILM:a=n.apiSeasonInfo||n.season||{},e.name_url="".concat(c.a.BANGUMI,"/anime/").concat(t.desc.uid),e.name=a.title,e.face=a.cover||n.cover,e.comment_count=n.reply_count,e.detail_comment_url=n.url,e.more_comment_url=n.url,e.comment_id=1,e.comment_oid="".concat(n.aid),e.bangumi_desc="电影",e.tags=[{name:"电影"}],r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip;break;case s.a.TV:a=n.apiSeasonInfo||n.season||{},e.name_url="".concat(c.a.BANGUMI,"/anime/").concat(t.desc.uid),e.name=a.title,e.face=a.cover||n.cover,e.comment_count=n.reply_count,e.detail_comment_url=n.url,e.more_comment_url=n.url,e.comment_id=1,e.comment_oid="".concat(n.aid),e.bangumi_desc=a.type_name||"电视剧",e.tags=[{name:a.type_name||"电视剧"}],r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip;break;case s.a.DOCUMENTARY:a=n.apiSeasonInfo||n.season||{},e.name_url="".concat(c.a.BANGUMI,"/anime/").concat(t.desc.uid),e.name=a.title,e.face=a.cover||n.cover,e.comment_count=n.reply_count,e.detail_comment_url=n.url,e.more_comment_url=n.url,e.comment_id=1,e.comment_oid="".concat(n.aid),"26484"===String(a.season_id)||"26481"===String(a.season_id)?e.bangumi_desc="":(e.bangumi_desc="纪录片",e.tags=[{name:"纪录片"}]),r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip;break;case s.a.SUBSCRIPTION:case s.a.LIVE_PUSH:case s.a.LIVE:case s.a.LIVE_ROOM:e.name_url="".concat(c.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face,e.comment_count=t.desc.comment,e.more_comment_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.comment_id=17,e.comment_oid="".concat(t.desc.dynamic_id),r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip;break;case s.a.COLLECTION:e.name_url=u,e.name=n.collection&&n.collection.title||"未知合集",e.face=n.collection&&n.collection.cover||"",e.comment_count=n.stat.reply,e.more_comment_url=u,e.comment_id=1,e.comment_oid="".concat(n.aid),e.bangumi_desc="合集",r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip;break;default:t.desc.user_profile?(e.name_url="".concat(c.a.SPACE,"/").concat(t.desc.uid,"/dynamic"),e.name=t.desc.user_profile.info.uname,e.detail_url="".concat(c.a.T,"/").concat(t.desc.dynamic_id,"?tab=2"),e.face=t.desc.user_profile.info.face):e.name="未知",r=l(n.ctrl,t.extend_json),e.riskTip=r.riskTip}return e},g=function(t,e,n){var u={uid:0,name:"",face:"",url:"",type_desc:"",contentArray:[],clipContentArray:[],voteInfo:null,hasLottery:!1},d=t.desc.type===s.a.REPOST,f=d?t.desc.orig_type:t.desc.type,h=t.desc.origin?t.desc.origin.stype:0,m=Object(i.e)(t.card),g=d?Object(i.e)(m.origin):m,v=g.user||{},b=d?m.origin_extend_json:t.extend_json,y=Object(i.e)(b),_={};_.vote_cfg=y.vote,_.lott_cfg=y.lott;var C=d?t.desc.orig_dy_id:t.desc.dynamic_id;_&&_.vote_cfg&&(u.voteInfo={title:_.vote_cfg.desc,desc:void 0!==_.vote_cfg.join_num?"".concat(_.vote_cfg.join_num,"人参与"):"",url:"".concat(c.a.T,"/vote/h5/index/#/result?vote_id=").concat(_.vote_cfg.vote_id,"&dynamic_id=").concat(t.desc.dynamic_id,"&isWeb=1")});var w="",I="",x={},k={},O=!1,S="",P="",T=t.display||{};if(d){var j=T.origin||{},L=T&&T.add_on_card_info&&T.add_on_card_info[0]||{},A=j&&j.add_on_card_info&&j.add_on_card_info[0]||{};1===A.add_on_card_show_type?u.shopCards=Object(i.e)(A.goods_card).list:2===A.add_on_card_show_type&&(u.originAttachCard=p(A.attach_card)),2===L.add_on_card_show_type&&(u.attachCard=p(L.attach_card))}else{var E=T&&T.add_on_card_info&&T.add_on_card_info[0]||{};1===E.add_on_card_show_type?u.shopCards=Object(i.e)(E.goods_card).list:2===E.add_on_card_show_type&&(u.attachCard=p(E.attach_card))}switch(f){case s.a.PIC:u.uid=~~v.uid,u.name=v.name,u.face=v.head_url,u.url=e?"":"".concat(c.a.T,"/").concat(C,"?tab=2"),u.type_desc="的图片",u.pureText=g.item.description||g.item.title,u.contentArray=Object(a.o)(g.item.description||g.item.title,{ctrlJson:g.item.at_control,extendCtrlJson:b,dynamicId:C,display:T},n),P=g.item.description||g.item.title,P=Object(r.a)(P,6),u.clipContentArray=Object(a.o)(P,{ctrlJson:g.item.at_control,extendCtrlJson:b,dynamicId:C,display:T,isClip:!0},n),u.renderOpts={ctrlJson:g.item.at_control,extendCtrlJson:b,dynamicId:C,display:T},k=l(g.item.at_control,b),u.hasLottery=k.hasLottery,u.riskTip=k.riskTip,u.images=g.item.pictures.map((function(t){return t.img_src=Object(i.g)(t.img_src),t}));break;case s.a.WORD:u.uid=~~v.uid,u.name=v.uname,u.face=v.face,u.url=e?"":"".concat(c.a.T,"/").concat(C,"?tab=2"),u.type_desc="的动态",u.pureText=g.item.content,u.contentArray=Object(a.o)(g.item.content,{ctrlJson:g.item.ctrl,extendCtrlJson:b,dynamicId:C,display:T},n),P=g.item.content,P=Object(r.a)(P,6),u.clipContentArray=Object(a.o)(P,{ctrlJson:g.item.ctrl,extendCtrlJson:b,dynamicId:C,display:T,isClip:!0},n),u.renderOpts={ctrlJson:g.item.ctrl,extendCtrlJson:b,dynamicId:C,display:T},k=l(g.item.ctrl,b),u.hasLottery=k.hasLottery,u.riskTip=k.riskTip;break;case s.a.VIDEO:u.uid=~~g.owner.mid,u.name=g.owner.name,u.face=g.owner.face,u.url=Object(o.getVideoLink)(g.aid,t.desc.bvid||t.desc.origin&&t.desc.origin.bvid),u.type_desc=2===h?"投稿的直播回放":"的投稿视频",u.pureText=g.dynamic,u.contentArray=Object(a.o)(g.dynamic,{ctrlJson:g.ctrl,extendCtrlJson:b,dynamicId:C,display:T},n),P=g.dynamic,P=Object(r.a)(P,6),u.clipContentArray=Object(a.o)(P,{ctrlJson:g.ctrl,extendCtrlJson:b,dynamicId:C,display:T,isClip:!0},n),u.renderOpts={ctrlJson:g.ctrl,extendCtrlJson:b,dynamicId:C,display:T},k=l(g.ctrl,b),u.hasLottery=k.hasLottery,u.riskTip=k.riskTip,u.image=g.pic,u.title=g.title,u.desc=g.desc,u.aid=g.aid,u.duration=g.duration,u.view=g.stat.view,u.danmaku=g.stat.danmaku,u.needPay=g.rights&&!!g.rights.ugc_pay,u.isCooperation=g.rights&&!!g.rights.is_cooperation;break;case s.a.CHEESE_SERIES:u.uid=~~g.up_id,u.name=g.up_info.name,u.face=g.up_info.avatar,u.url=g.url,u.type_desc="的付费课程",u.pureText=g.dynamic,u.contentArray=Object(a.o)(g.dynamic,{ctrlJson:g.ctrl,extendCtrlJson:b,dynamicId:C,display:T},n),P=g.dynamic,P=Object(r.a)(P,6),u.clipContentArray=Object(a.o)(P,{ctrlJson:g.ctrl,extendCtrlJson:b,dynamicId:C,display:T,isClip:!0},n),u.renderOpts={ctrlJson:g.ctrl,extendCtrlJson:b,dynamicId:C,display:T},k=l(g.ctrl,b),u.hasLottery=k.hasLottery,u.riskTip=k.riskTip,u.image=g.cover,u.title=g.title,u.subtitle=g.subtitle,u.desc=g.update_info||"",u.id=g.id||0;break;case s.a.CHEESE_UPDATE:u.uid=~~g.up_id,u.name=g.up_info.name,u.face=g.up_info.avatar,u.url=g.url,u.type_desc="的付费课程",u.pureText=g.dynamic,u.contentArray=Object(a.o)(g.dynamic,{ctrlJson:g.ctrl,extendCtrlJson:b,dynamicId:C,display:T},n),P=g.dynamic,P=Object(r.a)(P,6),u.clipContentArray=Object(a.o)(P,{ctrlJson:g.ctrl,extendCtrlJson:b,dynamicId:C,display:T,isClip:!0},n),u.renderOpts={ctrlJson:g.ctrl,extendCtrlJson:b,dynamicId:C,display:T},k=l(g.ctrl,b),u.hasLottery=k.hasLottery,u.riskTip=k.riskTip,u.image=g.cover,u.title=g.new_ep.title,u.subtitle=g.title;var M=g.update_count,D="等".concat(M,"个视频更新");u.desc=M>1?D:"",u.id=g.id||0;break;case s.a.CLIP:u.uid=~~v.uid,u.name=v.name,u.face=v.head_url,u.url="".concat(c.a.VC,"/video/").concat(g.item.id),u.type_desc="的小视频",u.pureText=g.item.description,u.contentArray=Object(a.o)(g.item.description,{ctrlJson:g.item.at_control,extendCtrlJson:b,dynamicId:C,display:T},n),P=g.item.description,P=Object(r.a)(P,6),u.clipContentArray=Object(a.o)(P,{ctrlJson:g.item.at_control,extendCtrlJson:b,dynamicId:C,display:T,isClip:!0},n),u.renderOpts={ctrlJson:g.item.at_control,extendCtrlJson:b,dynamicId:C,display:T},k=l(g.item.at_control,b),u.hasLottery=k.hasLottery,u.riskTip=k.riskTip,u.cover=g.item.cover.default,u.duration=g.item.video_time;break;case s.a.ARTICLE:u.uid=~~g.author.mid,u.name=g.author.name,u.face=g.author.face,u.url="".concat(c.a.MAIN,"/read/cv").concat(g.id),u.type_desc="的文章",u.pureText=g.dynamic,u.contentArray=Object(a.o)(g.dynamic,{dynamicId:t.desc.orig_dy_id||t.desc.dynamic_id,extendCtrlJson:b,display:T},n),P=g.dynamic,P=Object(r.a)(P,6),u.clipContentArray=Object(a.o)(P,{dynamicId:t.desc.orig_dy_id||t.desc.dynamic_id,extendCtrlJson:b,display:T,isClip:!0},n),u.renderOpts={dynamicId:t.desc.orig_dy_id||t.desc.dynamic_id,extendCtrlJson:b,display:T},k=l(g.ctrl,b),u.riskTip=k.riskTip,u.images=g.image_urls,u.title=g.title,u.desc=g.summary;break;case s.a.MUSIC:u.uid=~~g.upId,u.name=g.upper,u.face=g.upperAvatar,u.url="".concat(c.a.MAIN,"/audio/au").concat(g.id,"?type=7"),u.type_desc="的音频",u.pureText=g.intro,u.contentArray=Object(a.o)(g.intro),P=g.intro,P=Object(r.a)(P,6),u.clipContentArray=Object(a.o)(P,{isClip:!0},n),k=l(g.ctrl,b),u.riskTip=k.riskTip,u.title=g.title,u.cover=g.cover,u.desc=g.typeInfo;break;case s.a.BANGUMI:case s.a.PGC_BANGUMI:case s.a.GUOCHUANG:x=g.apiSeasonInfo||g.season||{},u.name=x.title,u.title_url="".concat(c.a.BANGUMI,"/anime/").concat(x.season_id),k=l(g.ctrl,b),u.riskTip=k.riskTip,u.cover=g.cover,u.play_count=g.play_count,u.bullet_count=g.bullet_count,u.url=g.url,4===x.bgm_type?u.tags=[{name:"国创"}]:u.tags=[{name:"番剧"}],g.new_desc?u.title=g.new_desc:(w=g.index.match(/第\S集/)?g.index:"第".concat(g.index,"集"),I=g.index_title,u.title=I&&""!==I?w+" - "+I:w);break;case s.a.COMIC_SHARE:case s.a.H5_SHARE:u.uid=~~v.uid,u.name=v.uname,u.face=v.face,u.url="".concat(c.a.T,"/").concat(C,"?tab=2"),u.type_desc="的分享",k=l(g.ctrl,b),u.riskTip=k.riskTip,O=101===g.sketch.biz_type,f===s.a.COMIC_SHARE&&(u.tagsText=g.sketch.text),S=g.vest.content,u.pureText=S,u.contentArray=Object(a.o)(S,{ctrlJson:g.vest.ctrl,extendCtrlJson:b,isRemark:O,display:T},n),P=S,P=Object(r.a)(P,6),u.clipContentArray=Object(a.o)(P,{ctrlJson:g.vest.ctrl,extendCtrlJson:b,isRemark:O,display:T,isClip:!0},n),u.renderOpts={ctrlJson:g.vest.ctrl,extendCtrlJson:b,isRemark:O,display:T},u.cover=g.sketch.cover_url,u.title=g.sketch.title,u.desc=g.sketch.desc_text,u.target_url=g.sketch.target_url,u.tag=g.sketch.tags||[];break;case s.a.FILM:g.apiSeasonInfo?(u.name=g.apiSeasonInfo.title,u.title_url="".concat(c.a.BANGUMI,"/anime/").concat(g.apiSeasonInfo.season_id),u.play_count=g.play_count,u.bullet_count=g.bullet_count):(u.name=g.show_title,u.title_url="".concat(c.a.BANGUMI,"/anime/").concat(g.season.season_id),u.play_count=g.stat.play,u.bullet_count=g.stat.danmaku),u.cover=g.cover,u.url=g.url,k=l(g.ctrl,b),u.riskTip=k.riskTip,u.tags=[{name:"电影"}],g.new_desc?u.title=g.new_desc:g.apiSeasonInfo?u.title=g.apiSeasonInfo.title:u.title=g.show_title;break;case s.a.TV:x=g.apiSeasonInfo||g.season||{},u.name=x.title,u.title_url="".concat(c.a.BANGUMI,"/anime/").concat(x.season_id),u.cover=g.cover,u.play_count=g.play_count,u.bullet_count=g.bullet_count,u.url=g.url,u.tags=[{name:x.type_name||"电视剧"}],k=l(g.ctrl,b),u.riskTip=k.riskTip,g.new_desc?u.title=g.new_desc:g.index_title?u.title=g.index_title:g.index&&g.index.match(/第\S集/)?u.title=g.index:u.title="第".concat(g.index||1,"集");break;case s.a.DOCUMENTARY:x=g.apiSeasonInfo||g.season||{},u.name=x.title,u.title_url="".concat(c.a.BANGUMI,"/anime/").concat(x.season_id),u.cover=g.cover,u.play_count=g.play_count,u.bullet_count=g.bullet_count,u.url=g.url,u.tags=[{name:"纪录片"}],k=l(g.ctrl,b),u.riskTip=k.riskTip,g.new_desc?u.title=g.new_desc:(w=g.index.match(/第\S集/)?g.index:"第".concat(g.index,"集"),I=g.index_title,u.title=I?w+" - "+I:w);break;case s.a.SUBSCRIPTION:if("live_room"!==g.type){m.origin_user?(u.uid=m.origin_user.info.uid,u.name=m.origin_user.info.uname,u.face=m.origin_user.info.face):(u.uid=t.desc.user_profile.info.uid,u.name=t.desc.user_profile.info.uname,u.face=t.desc.user_profile.info.face),u.type_desc="更新了";break}g.live_play_info=JSON.parse(g.live_info).live_play_info;case s.a.LIVE_PUSH:m.origin_user?(u.uid=m.origin_user.info.uid,u.name=m.origin_user.info.uname,u.face=m.origin_user.info.face):(u.uid=t.desc.user_profile.info.uid,u.name=t.desc.user_profile.info.uname,u.face=t.desc.user_profile.info.face),u.url=g.live_play_info.link,u.cover=g.live_play_info.cover,u.view_num="".concat(g.live_play_info.online,"人气"),u.title=g.live_play_info.title,u.area_name=g.live_play_info.area_name,u.status=1===g.live_play_info.live_status?"直播中":"直播结束",u.show_view_num=1===g.live_play_info.live_status;break;case s.a.LIVE_ROOM:case s.a.LIVE:m.origin_user?(u.uid=m.origin_user.info.uid,u.name=m.origin_user.info.uname,u.face=m.origin_user.info.face):(u.uid=~~g.uid,u.name=g.uname,u.face=g.face),u.url="//live.bilibili.com/".concat(g.roomid),u.type_desc="的直播间",u.cover=g.user_cover||g.cover,u.title=g.title,u.view_num="".concat(g.online,"人气"),u.area_name=g.area_v2_name,k=l(g.ctrl,b),u.riskTip=k.riskTip,u.status=1===g.live_status?"直播中":"直播结束",u.show_view_num=1===g.live_status;break;case s.a.MEDIA_LIST:u.uid=~~g.upper.mid,u.name=g.upper.name,u.face=g.upper.face,u.url="//www.bilibili.com/medialist/detail/ml".concat(g.id),u.type_desc="的收藏夹",u.cover=g.cover,u.coverType=g.cover_type,u.title=g.title,u.description=g.intro,u.contentCount=g.media_count,k=l(g.ctrl,b),u.riskTip=k.riskTip;break;case s.a.COLLECTION:d&&(u.name=g.collection&&g.collection.title||"未知合集",u.title_url=Object(o.getVideoLink)(g.aid),u.type_desc=t.display&&t.display.repost_source_action_txt||"更新了"),u.aid=g.aid,u.title=g.title,u.desc=g.desc,u.cover=g.pic,u.play_count=g.stat.view,u.bullet_count=g.stat.danmaku,u.duration=g.duration,u.url=Object(o.getVideoLink)(g.aid),u.tag="合集",u.needPay=g.rights&&!!g.rights.ugc_pay,k=l(g.ctrl,b),u.riskTip=k.riskTip}return u}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n(13),n(45);var i=n(66);function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("string"!=typeof t)return"";if(e<1)return t;var n=Object(i.a)(t);if(n<=e)return t+"";for(var o="",a=0,r=t.split(""),s=0;s<r.length&&(/[\u0000-\u00ff]/.test(r[s])?a+=.5:a+=1,!(a>e));s++)o+=r[s];return o}},,,,,,,,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return c}));n(28),n(9),n(29),n(32);var i=n(19),o=n(4),a="undefined"==typeof window?t:window,r=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={free:[],mapping:[],vip:[]};return t.forEach((function(t,i){var o=[];t.emote&&t.emote.forEach((function(t){o.push({id:t.id,name:t.text,url:e&&t.gif_url||t.url,gif_url:t.gif_url||"",type:t.type})})),n.free.push({emojis:o,pid:t.id,pname:t.text,purl:t.url,type:t.type,size:t.meta.size})})),n};function s(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(i.a)({method:"get",url:"".concat(o.a.API_MAIN,"/x/emote/user/panel/web"),data:{business:"reply"},throttleInterval:5e3,localCache:!0,ttl:9e5,cache_key:"emoji_big"}).then((function(n){var i=r(n.data.packages||[],e);a.localStorage&&a.localStorage.setItem("bp_emoji_data_v3",JSON.stringify(i)),a.bp_emoji_data_v3=i,t&&t(i)})).catch((function(e){a.bp_emoji_data_v3||(a.bp_emoji_data_v3={}),t&&t({})}))}function c(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(e){var n=a.localStorage?a.localStorage.getItem("bp_emoji_data_v3"):"{}";n?(a.bp_emoji_data_v3=JSON.parse(n),s(void 0,t),e(a.bp_emoji_data_v3)):s(e,t)}))}}).call(this,n(87))},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n(21);var i=n(67),o="undefined"!=typeof window?document.createElement("div"):null;function a(){}var r={props:{button:{default:function(){return{confirm:"确定",cancel:"取消"}}},width:{type:Number,default:500},title:{type:String,default:""},titleCenter:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},show:{type:Boolean,default:!1},onConfirm:{type:Function,default:a},onCancel:{type:Function,default:a}},components:{BpBtn:i.a},computed:{buttons:function(){return{confirmBtn:this.$refs.confirmBtn?this.$refs.confirmBtn.$el:o,cancelBtn:this.$refs.cancelBtn?this.$refs.cancelBtn.$el:o,closeBtn:this.$refs.closeBtn}}},methods:{onConfirmFunc:function(t){this.onConfirm(t,this.buttons)},onCancelFunc:function(t){this.onCancel(t,this.buttons)}}},s=(n(262),n(2)),c=Object(s.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"scale-out","leave-active-class":"a-scale-out"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"bp-popup-panel p-relative a-move-in-top a-forwards",style:{width:t.width+"px"||!1}},[n("div",{staticClass:"title-ctnr p-relative",class:{"t-center":t.titleCenter}},[n("h2",{staticClass:"popup-title",domProps:{textContent:t._s(t.title)}})]),n("div",{staticClass:"popup-content-ctnr"},[t._t("default"),!1!==t.button?n("div",{staticClass:"popup-btn-ctnr t-center"},[!1!==t.button.confirm?n("bp-btn",{ref:"confirmBtn",staticClass:"panel-btn",attrs:{disabled:t.disabled},nativeOn:{click:function(e){return t.onConfirmFunc(e)}}},[t._v(t._s(t.button.confirm||"确定"))]):t._e(),!1!==t.button.cancel?n("bp-btn",{ref:"cancelBtn",staticClass:"panel-btn",attrs:{type:"ghost"},nativeOn:{click:function(e){return t.onCancelFunc(e)}}},[t._v(t._s(t.button.cancel||"取消"))]):t._e()],1):t._e()],2),n("div",{ref:"closeBtn",staticClass:"close-btn p-absolute bg-center bg-no-repeat pointer t-center",attrs:{role:"button",title:"关闭面板"},on:{click:t.onCancelFunc}},[n("i",{staticClass:"bp-icon-font icon-close"})])])])}),[],!1,null,"3c863400",null);e.a=c.exports},,,,,function(t,e,n){"use strict";n(60),n(38),n(36);var i=n(0),o=n(7),a=n(17),r=(n(14),n(33),n(8)),s=n(6),c={methods:{getSpmData:function(){var t=Object(o.a)(this.cardInfo);return{dynamic_id:t.dynamic_id,dynamic_type:t.card_type,inner_dynamic_id:this.cardInfo.desc.orig_dy_id||"",sub_source:this.itemInfo.jumpLinkAction,oid:this.shopCardId}},reportItemClick:function(){if(this.itemInfo.jumpLinkAction)return Object(o.d)(i.d.SUB_CARD_CLICK,this.getSpmData());var t={item_id:this.shopCardId},e=Object(a.g)(this.cardInfo);Object(o.d)(i.d.SHOP_CARD_CLICK,Object.assign(e,t))}}},l=n(2),u=Object(l.a)(c,void 0,void 0,!1,null,null,null).exports,d={mixins:[u],props:["itemInfo","cardInfo"],data:function(){return{}},computed:{bgStyle:function(){var t=this.toBfsImg(this.itemInfo.img);return"background-image: url(".concat(t,");")},jumpLink:function(){return this.itemInfo.jumpLink},hoverContent:function(){return"".concat(this.subTitle?"".concat(this.title,"\n"):this.title).concat(this.priceDesc?"".concat(this.subTitle,"\n"):this.subTitle).concat(this.priceDesc)},title:function(){return this.itemInfo.name||""},subTitle:function(){return this.itemInfo.brief||""},priceDesc:function(){return this.itemInfo.priceStr||""},shopCardId:function(){return this.itemInfo.itemsId}},watch:{},components:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{toBfsImg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return Object(s.g)(Object(r.bfsImgLink)(t,e,n,{e:1,c:1}))}}},f=(n(269),Object(l.a)(d,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{class:["shop-item",{vertical:2===this.itemInfo.imgType}],style:this.bgStyle},[e("a",{staticClass:"shop-link",attrs:{href:this.jumpLink,target:"_blank",title:this.hoverContent},on:{click:this.reportItemClick}})])}),[],!1,null,"5f80cba5",null).exports),h=n(4),p={mixins:[u],props:["item-info","cardInfo","atPublishPanel"],data:function(){return{btnStatus:!!this.itemInfo&&2===this.itemInfo.jumpLinkStatus}},computed:{title:function(){return this.itemInfo.name||""},subTitle:function(){return this.itemInfo.brief||""},priceDesc:function(){return this.itemInfo.priceStr||""},subDesc:function(){return this.itemInfo.desc2||""},btnText:function(){return this.itemInfo.jumpLinkDesc||"去看看"},btnTextChecked:function(){return this.itemInfo.jumpLinkChecked},btnIcon:function(){return this.itemInfo.jumpLinkIcon},jumpLink:function(){return this.itemInfo.jumpLink},shopCardId:function(){return this.itemInfo.itemsId},isJumpBtn:function(){try{return 1===this.itemInfo.jumpButtonType}catch(t){return!1}},getPageSpmid:function(){try{if("official_activity"===this.cardInfo.display.attach_card.type)return document.querySelector("meta[name='spm_prefix']").content}catch(t){return""}return""}},watch:{"itemInfo.jumpLinkStatus":function(t){this.btnStatus=2===t}},methods:{actionHandler:function(t){var e=this;this.itemInfo.jumpLinkAction&&(t.stopPropagation(),Object(o.d)(i.d.SUB_BTN_CLICK,this.getSpmData()),this.bpapi({method:"post",url:"".concat(h.a.API_VC,"/dynamic_mix/v1/dynamic_mix/attach_card_button"),data:{cur_btn_status:this.btnStatus?2:1,dynamic_id:this.cardInfo.desc.orig_dy_id||this.cardInfo.desc.dynamic_id,attach_card_type:this.itemInfo.jumpLinkAction,spmid:this.getPageSpmid}}).then((function(t){t.code||t.data&&t.data.final_btn_status===(e.btnStatus?2:1)||(e.btnStatus=!e.btnStatus)}),(function(t){e.linkMsg(e.$el,t.msg,t.type)})))},handleClick:function(t){t.stopPropagation(),Object(o.d)(i.d.SUB_BTN_CLICK,this.getSpmData())}}},m=(n(270),{props:["shopCardList","isRepost","cardInfo","atPublishPanel"],data:function(){return{showAttachCard:!0}},computed:{cardCount:function(){return this.shopCardList.length},hasIcon:function(){return!this.shopCardList[0].adMarkPlain},panelDesc:function(){return this.shopCardList[0].adMark||""},shopCardIds:function(){return this.shopCardList.map((function(t){return t.itemsId}))}},watch:{},components:{ShopItem:f,ShopDesc:Object(l.a)(p,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shop-desc",on:{click:t.reportItemClick}},[n("a",{staticClass:"desc-box",attrs:{href:t.jumpLink,target:"_blank"}},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),t.subTitle?n("div",{staticClass:"sub-title"},[t._v(t._s(t.subTitle))]):t._e(),t.priceDesc||t.subDesc?n("div",{class:t.priceDesc?"price":"sub-title"},[n("span",[t._v(t._s(t.priceDesc||t.subDesc))]),n("span",{staticClass:"price-desc"},[t._v(t._s(t.priceDesc?"起":""))])]):t._e()]),t.btnText&&!t.atPublishPanel?n("a",{staticClass:"btn-box",attrs:{href:!t.btnTextChecked&&t.jumpLink,target:"_blank"}},[t.isJumpBtn?n("a",{staticClass:"jump-btn",attrs:{href:t.jumpLink,target:"_blank"},on:{click:t.handleClick}},[t._v("\n      "+t._s(t.btnText)+"\n    ")]):!t.isJumpBtn&&t.btnStatus?n("button",{staticClass:"jump-btn checked",on:{click:t.actionHandler}},[t._v("\n      "+t._s(t.btnTextChecked)+"\n    ")]):n("button",{staticClass:"jump-btn",style:{backgroundColor:t.itemInfo.jumpLinkColor},on:{click:t.actionHandler}},[t.btnIcon?n("i",{staticClass:"btn-icon",style:{backgroundImage:"url("+t.btnIcon+")"}}):t._e(),t._v("\n      "+t._s(t.btnText)+"\n    ")])]):t._e()])}),[],!1,null,"2f808133",null).exports},beforeCreate:function(){},beforeMount:function(){},mounted:function(){this.cardInfo&&this.reportItemShow()},beforeDestroy:function(){},destroyed:function(){},methods:{reportItemShow:function(){if(this.shopCardList[0].jumpLinkAction){var t=Object(o.a)(this.cardInfo),e=t.dynamic_id,n=t.card_type;if(window["".concat(e)])return;return window["".concat(e)]="flag",void Object(o.d)(i.d.SUB_CARD_SHOW,{dynamic_id:e,dynamic_type:n,inner_dynamic_id:this.cardInfo.desc.orig_dy_id||"",sub_source:this.shopCardList[0].jumpLinkAction,oid:this.shopCardList[0].itemsId})}var r={item_id:this.shopCardIds.join(",")},s=Object(a.g)(this.cardInfo);Object(o.d)(i.d.SHOP_CARD_SHOW,Object.assign(s,r))},handleClose:function(){this.$emit("empty-attach-data")}}}),g=(n(271),Object(l.a)(m,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.showAttachCard?i("div",{staticClass:"shop-panel",class:{"big-size":t.atPublishPanel}},[t.atPublishPanel?t._e():i("div",{staticClass:"panel-desc"},[t.hasIcon?i("i",{staticClass:"shop-icon"}):t._e(),i("span",[t._v(t._s(t.panelDesc))])]),i("div",{staticClass:"shop-list",class:{"is-repost":t.isRepost}},[t._l(t.shopCardList,(function(e){return i("shop-item",{key:e.itemsId,attrs:{"card-info":t.cardInfo,"item-info":e}})})),1===t.cardCount?i("shop-desc",{attrs:{"card-info":t.cardInfo,"item-info":t.shopCardList[0],"at-publish-panel":t.atPublishPanel}}):t._e(),t.atPublishPanel?i("div",{staticClass:"delete-btn",on:{click:t.handleClose}},[i("img",{staticClass:"delete-img",attrs:{src:n(268),alt:"删除"}})]):t._e()],2)]):t._e()}),[],!1,null,"faf6e0f0",null));e.a=g.exports},function(t,e,n){"use strict";n(15),n(22),n(23),n(14),n(28),n(63),n(25),n(16),n(82),n(38),n(37),n(33),n(230),n(46),n(9),n(13),n(12),n(18),n(40),n(24),n(49),n(32),n(20);var i=function t(e){if(!e)return"";var n=e.childNodes,i=n.length;n.length&&"BR"===n[n.length-1].nodeName&&(i-=1);for(var o="",a=0;a<i;a++)"#text"===n[a].nodeName?o+=n[a].nodeValue:"BR"===n[a].nodeName?o+="\n":"INPUT"===n[a].nodeName?o+=n[a].defaultValue:"DIV"===n[a].nodeName?o+="\n"+t(n[a]):"BUTTON"===n[a].nodeName?o+=t(n[a]):"IMG"===n[a].nodeName?o+=n[a].alt:(n[a].nodeName,o+=t(n[a]));return o};var o=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,o=t.ownerDocument||t.document,a=o.defaultView||o.parentWindow;if("DIV"===t.tagName){if(a.getSelection().rangeCount>0){var r=a.getSelection().getRangeAt(0),s=r.cloneRange();s.selectNodeContents(t),s.setEnd(r.endContainer,r.endOffset);var c=s.cloneContents(),l=i(c);n=l.length,e&&(n=l.replace(/\n/g,"").length)}}else n=t.selectionEnd;return n},a=n(6);var r,s,c,l=function(t,e){var n,i,o=-1!==Object(a.d)().indexOf("Safari");"DIV"===t.tagName||o?((n=document.createRange()).selectNodeContents(t),t.innerHTML&&t.innerHTML.length>0&&n.collapse(t,e),n.collapse(!0),(i=window.getSelection()).removeAllRanges(),i.addRange(n)):t.setSelectionRange(e,e)},u=["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"],d=function(t,e){(r=document.getElementById(t.nodeName+"--mirror-div"))||((r=document.createElement("div")).id=t.nodeName+"--mirror-div",document.body.appendChild(r)),c=r.style,s=getComputedStyle(t),c.whiteSpace="pre-wrap","INPUT"!==t.nodeName&&(c.wordWrap="break-word"),c.position="absolute",c.top=t.offsetTop+parseInt(s.borderTopWidth)+"px",c.left=t.offsetLeft+parseInt(s.borderLeftWidth)+"px",c.visibility="hidden",u.forEach((function(t){c[t]=s[t]})),window.navigator.userAgent.indexOf("Firefox")>-1?(c.width=parseInt(s.width)-2+"px",t.scrollHeight>parseInt(s.height)&&(c.overflowY="scroll")):c.overflow="hidden",r.textContent=t.value.substring(0,e),"INPUT"===t.nodeName&&(r.textContent=r.textContent.replace(/\s/g," "));var n=document.createElement("span");return n.textContent=t.value.substring(e)||".",r.appendChild(n),{top:n.offsetTop+parseInt(s.borderTopWidth)+parseInt(s["line-height"])-t.scrollTop,left:n.offsetLeft+parseInt(s.borderLeftWidth)}},f=(n(424),n(173)),h=n.n(f),p=(n(48),function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#00A1D6";if(!e)return t;var i=new RegExp("("+e+")","g");return t.replace(i,"<font style='color: ".concat(n,";'>$1</font>"))}),m=n(4);function g(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var b={isIE:!1,isSafari:!1,isInited:!1},y={input:"Input",focus:"Input",DOMNodeInserted:"Input",click:"Click",blur:"Blur",keydown:"Keydown",keyup:"Keyup"},_={name:"AtPopup",props:{inputEl:{required:!0},request:{required:!0},beforeShow:{type:Function,default:function(){return!0}}},data:function(){return{visible:!1,top:0,left:0,selectedIndex:[0,0],list:[],mouseOverEnabled:!0,needHide:!1}},computed:{atPopupStyle:function(){return{left:"".concat(this.left,"px"),top:"".concat(this.top,"px")}}},watch:{inputEl:{immediate:!0,handler:function(t,e){e&&this._removeEventListener(e),t&&this._addEventListener(t)}}},created:function(){this._initBrowser()},destroyed:function(){this._removeEventListener(this.inputEl)},methods:{_initBrowser:function(){if(!b.isInited){var t=Object(a.d)();b.isIE=-1!==t.indexOf("IE"),b.isSafari=-1!==t.indexOf("Safari"),b.isInited=!0}},_addEventListener:function(t){var e=this;Object.keys(y).forEach((function(n){t.addEventListener(n,e["_on".concat(y[n])])}))},_removeEventListener:function(t){var e=this;Object.keys(y).forEach((function(n){t.removeEventListener(n,e["_on".concat(y[n])])}))},_onInput:function(){setTimeout(this._scan,0)},_onKeydown:function(t){if(this.visible&&0!==this.list.length)switch(t.keyCode){case 13:t.preventDefault(),this._select(this.list[this.selectedIndex[0]].items[this.selectedIndex[1]]);break;case 38:t.preventDefault(),this._switchToPrev();break;case 40:t.preventDefault(),this._switchToNext()}},_onKeyup:function(t){[37,39].indexOf(t.keyCode)>-1&&this._scan()},_onBlur:function(){var t=this;setTimeout((function(){t.needHide&&t._hide()}),300),this.needHide=!0},_onClick:function(){this._scan()},_onMouseover:function(t,e){this.mouseOverEnabled&&(this.selectedIndex=[t,e])},_isSelected:function(t,e){return this.selectedIndex[0]===t&&this.selectedIndex[1]===e},_select:function(t){var e=this;if(t){var n=o(this.inputEl),i=this.inputEl.value;b.isIE||(i=i.replace(/\n/g,""));var a=i.substring(0,n),r=a.lastIndexOf("@"),s=a.substring(r,n);this.$emit("select",{item:t,matchString:s}),this._hide(),this.list=[],this.inputEl.focus(),"TEXTAREA"===this.inputEl.tagName&&setTimeout((function(){var n=r+t.uname.length+2;l(e.inputEl,n)}),0)}},_switchToPrev:function(){var t=g(this.selectedIndex);t[1]-1>=0?t[1]=t[1]-1:(t[0]-1>=0?t[0]=t[0]-1:t[0]=this.list.length-1,t[1]=this.list[t[0]].items.length-1),this.selectedIndex=t,this._updateListScrollTop()},_switchToNext:function(){var t=g(this.selectedIndex);t[1]+1<this.list[t[0]].items.length?t[1]=t[1]+1:(t[0]+1<this.list.length?t[0]=t[0]+1:t[0]=0,t[1]=0),this.selectedIndex=t,this._updateListScrollTop()},_updateListScrollTop:function(){if(0!==this.list.length){var t=this.$refs.list.children[this.selectedIndex[0]].children[1].children[this.selectedIndex[1]];this.$refs.list.offsetHeight+this.$refs.list.scrollTop<t.offsetTop?(this.$refs.list.scrollTop=t.offsetTop-this.$refs.list.offsetHeight+10,this._disableMouseOver()):t.offsetTop<=this.$refs.list.scrollTop+20+3&&(this.$refs.list.scrollTop=t.offsetTop-43-(0===this.selectedIndex[1]?20:0),this._disableMouseOver())}},_disableMouseOver:function(){this.mouseOverEnabled=!1,this._enableMouseOver()},_enableMouseOver:h()((function(){this.mouseOverEnabled=!0}),200),_scan:function(){var t=o(this.inputEl),e=this.inputEl.value;b.isIE||(e=e.replace(/\n/g,""));var n=e.substring(t-21,t),i=n.lastIndexOf("@");if(~i){var a=n.substring(i+1),r=/[#@\s]/;a.match(r)?this._hide():(this._show(),""!==a&&""===String(a).trim()||a.match(r)||" "===a.substring(0,1)?this.list=[]:this._search(a))}else this._hide()},_show:function(){this.visible?this._calculateCaretPosition():this.beforeShow&&"function"==typeof this.beforeShow&&!this.beforeShow()||(this.visible=!0,this.selectedIndex=[0,0],this._calculateCaretPosition(),this.$emit("active"))},_hide:function(){this.visible=!1,this.$emit("inactive")},_calculateCaretPosition:function(){var t=o(this.inputEl),e=this.inputEl.value.substring(0,t).lastIndexOf("@");if(b.isIE||b.isSafari){var n=d(this.inputEl,e);this.left=n.left,this.top=n.top}else{var i=this.inputEl.getBoundingClientRect(),a=i.top,r=i.left,s=window.getSelection().getRangeAt(0).getBoundingClientRect();this.left=s.left-r,this.top=s.top+18-a}var c=parseFloat(window.getComputedStyle(this.inputEl,null).getPropertyValue("height").replace(/px/,""));(this.top>c+10||this.top<-20)&&(this.top=c+10),this.left<-20&&(this.left=0)},_search:h()((function(t){var e=this,n="".concat(m.a.API_VC,"/dynamic_mix/v1/dynamic_mix/").concat(t?"at_search":"at_list");this.request(n,t).then((function(n){if(n.data&&n.data.groups){var i=n.data.groups.map((function(e){return{name:e.group_name,type:e.group_type,items:e.items.map((function(e){return{uid:e.uid,uname:e.uname,fans:e.fans>1e5?"".concat((e.fans/1e4).toFixed(1),"万粉丝"):"".concat(e.fans,"粉丝"),type:e.official_verify_type,name:p(e.uname,t),avatar:e.face?e.face.replace(/http(s)?:/,""):"//static.hdslb.com/images/member/noface.gif"}}))}}));e.list=i}else e.list=[]})).catch((function(){e.list=[]}))}),500),try:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;this.needHide=!1,setTimeout(this._scan,t)},forceHide:function(){this._hide()}}},C=(n(277),n(2)),w=Object(C.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"bili-at-popup",style:t.atPopupStyle},[n("div",{staticClass:"bili-at-popup__hint"},[t._v("选择或输入你想@的人")]),n("div",{ref:"list",staticClass:"bili-at-popup__list"},t._l(t.list,(function(e,i){return n("div",{key:i,staticClass:"bili-at-popup__group"},[n("div",{staticClass:"bili-at-popup__group-name"},[t._v(t._s(1===t.list.length&&"其他"===e.name?"":e.name))]),n("div",{staticClass:"bili-at-popup__group-list"},t._l(e.items,(function(e,o){return n("div",{key:e.uid,class:{"bili-at-popup__user":!0,"bili-at-popup__user--selected":t._isSelected(i,o)},on:{click:function(n){return t._select(e)},mouseover:function(e){return t._onMouseover(i,o)}}},[n("div",{staticClass:"bili-at-popup__user-avatar"},[n("img",{attrs:{src:e.avatar}}),-1!==e.type?n("span",{class:"bili-at-popup__user-auth bili-at-popup__user-auth--"+(1===e.type?"organization":"personal")}):t._e()]),n("div",{staticClass:"bili-at-popup__user-info"},[n("div",{staticClass:"bili-at-popup__user-name",domProps:{innerHTML:t._s(e.name)}}),n("div",{staticClass:"bili-at-popup__user-fans"},[t._v(t._s(e.fans))])])])})),0)])})),0)])}),[],!1,null,null,null).exports;e.a=w},function(t,e,n){"use strict";var i,o,a,r=n(19),s=n(10),c=n.n(s),l=(n(25),n(82),n(38),n(13),n(40),n(24),n(84),n(49),n(6)),u=(n(28),["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"]),d=function(t,e){(i=document.getElementById(t.nodeName+"--mirror-div"))||((i=document.createElement("div")).id=t.nodeName+"--mirror-div",document.body.appendChild(i)),a=i.style,o=getComputedStyle(t),a.whiteSpace="pre-wrap","INPUT"!==t.nodeName&&(a.wordWrap="break-word"),a.position="absolute",a.top=t.offsetTop+parseInt(o.borderTopWidth)+"px",a.left=t.offsetLeft+parseInt(o.borderLeftWidth)+"px",a.visibility="hidden",u.forEach((function(t){a[t]=o[t]})),window.navigator.userAgent.indexOf("Firefox")>-1?(a.width=parseInt(o.width)-2+"px",t.scrollHeight>parseInt(o.height)&&(a.overflowY="scroll")):a.overflow="hidden",i.textContent=t.value.substring(0,e),"INPUT"===t.nodeName&&(i.textContent=i.textContent.replace(/\s/g," "));var n=document.createElement("span");return n.textContent=t.value.substring(e)||".",i.appendChild(n),{top:n.offsetTop+parseInt(o.borderTopWidth)+parseInt(o["line-height"])-t.scrollTop,left:n.offsetLeft+parseInt(o.borderLeftWidth)}},f=n(5),h=n(4),p=/[#@\s]/,m={data:function(){return{isShow:!1,top:0,left:0,selectedIndex:0,userList:[],mouseOverEnabled:!0,needHide:!1,isSafari:!1,isIE:!1}},props:{inputElm:{required:!0},buttonElm:null,validate:{type:Function,default:function(){return!0}},selectHandler:{type:Function,default:function(){}},logHandler:{type:Function,default:function(){}}},beforeMount:function(){var t=Object(l.d)();this.isIE=-1!==t.indexOf("IE"),this.isSafari=-1!==t.indexOf("Safari")},computed:{topPx:function(){return this.top+"px"},leftPx:function(){return this.left+"px"},computedHeight:function(){return this.userList.length>0?"150px":"30px"}},mounted:function(){this.initEvents(),this.throttleShowLimitToast=Object(l.f)(this.showLimitToast,300),this.debounceSearch=Object(l.b)(this.search,500),this.debounceEnableMouseOver=Object(l.b)(this.enableMouseOver,200)},methods:{onMousedown:function(t){(t||window.event).preventDefault()},onClickItem:function(t){var e=this,n=Object(f.e)(this.inputElm),i=(this.isIE?this.inputElm.value:this.inputElm.value.replace(/\n/g,"")).substring(0,n),o=i.lastIndexOf("@"),a=i.substring(o,n);this.selectHandler(t,a),this.hide(),this.userList=[],this.inputElm.focus(),"TEXTAREA"===this.inputElm.tagName&&setTimeout((function(){var n=o+t.uname.length+2;Object(f.p)(e.inputElm,n)}),0)},show:function(){this.isShow?this.calculatePosition():this.validate()&&(this.inputElm.querySelectorAll(".bp-at-span").length>=10?this.throttleShowLimitToast():(this.isShow=!0,this.selectedIndex=0,this.calculatePosition()))},hide:function(){this.isShow=!1},updateView:function(){var t=Object(f.e)(this.inputElm),e=(this.isIE?this.inputElm.value:this.inputElm.value.replace(/\n/g,"")).substring(t-21,t),n=e.lastIndexOf("@");if(~n){var i=e.substring(n+1);i.match(p)?this.hide():(this.show(),""!==i&&""===String(i).trim()||i.match(p)||" "===i.substring(0,1)?this.userList=[]:this.debounceSearch(i))}else this.hide()},search:function(t){var e=this;this.bpapi({url:"".concat(h.a.API_VC,"/dynamic_repost/v1/dynamic_repost/name_search"),method:"get",data:{keyword:t}}).then((function(t){if(0===t.code){var n=Object(l.e)(t.data.content).result||[];Array.isArray(n)?e.userList=n.map((function(t){return{uname:t.uname,uid:t.mid}})):e.userList=[]}else e.userList=[]}),(function(){e.userList=[]}))},showLimitToast:function(){this.linkMsg(this.inputElm,"最多@10人~","caution")},calculatePosition:function(){var t,e=Object(f.e)(this.inputElm),n=this.inputElm.value.substring(0,e).lastIndexOf("@");if(this.isIE||this.isSafari)t=d(this.inputElm,n),this.left=t.left,this.top=t.top;else{var i=this.inputElm.getBoundingClientRect(),o=i.top,a=i.left;t=window.getSelection().getRangeAt(0).getBoundingClientRect(),this.left=t.left-a,this.top=t.top+18-o}var r=parseFloat(getComputedStyle(this.inputElm,null).getPropertyValue("height").replace(/px/,""));(this.top>r+10||this.top<-20)&&(this.top=r+10),this.left<-20&&(this.left=0)},initEvents:function(){this.inputElm&&(this.inputElm.addEventListener("input",this.textInputHandler),this.inputElm.addEventListener("keydown",this.keyDownHandler),this.inputElm.addEventListener("keyup",this.keyUpHandler),this.inputElm.addEventListener("focus",this.focusHandler),this.inputElm.addEventListener("blur",this.blurHandler),this.inputElm.addEventListener("click",this.clickHandler),this.inputElm.addEventListener("DOMNodeInserted",this.textInputHandler)),this.buttonElm&&this.buttonElm.addEventListener("click",this.buttonClickHandler)},removeEvents:function(){this.inputElm.removeEventListener("input",this.textInputHandler),this.inputElm.removeEventListener("keydown",this.keyDownHandler),this.inputElm.removeEventListener("keyup",this.keyUpHandler),this.inputElm.removeEventListener("focus",this.focusHandler),this.inputElm.removeEventListener("blur",this.blurHandler),this.inputElm.removeEventListener("click",this.clickHandler),this.inputElm.removeEventListener("DOMNodeInserted",this.textInputHandler),this.buttonElm&&this.buttonElm.removeEventListener("click",this.buttonClickHandler)},mouseOverHandler:function(t){this.mouseOverEnabled&&(this.selectedIndex=t)},textInputHandler:function(){var t=this;setTimeout((function(){t.updateView()}),0)},keyDownHandler:function(t){if(this.isShow)if(13===t.keyCode){var e=this.userList[this.selectedIndex];e&&(this.onClickItem(e),t.preventDefault())}else 38===t.keyCode?(t.preventDefault(),this.pickUp()):40===t.keyCode&&(t.preventDefault(),this.pickDown())},keyUpHandler:function(t){t.keyCode>=37&&t.keyCode<=40?this.updateView():50===t.keyCode&&!0===t.shiftKey&&this.logHandler()},blurHandler:function(){var t=this;setTimeout((function(){t.needHide&&t.hide()}),300),this.needHide=!0},focusHandler:function(){setTimeout(this.updateView,0)},buttonClickHandler:function(){var t=this;this.needHide=!1,this.clickButtonHandler&&this.clickButtonHandler(),setTimeout((function(){t.clickHandler()}),100)},clickHandler:function(){this.updateView()},pickUp:function(){this.selectedIndex-1>=0?this.selectedIndex--:this.selectedIndex=this.userList.length-1,this.updateListScrollTop()},pickDown:function(){this.selectedIndex+1<this.userList.length?this.selectedIndex++:this.selectedIndex=0,this.updateListScrollTop()},updateListScrollTop:function(){if(this.$refs.userList){var t=this.selectedIndex;24*t>this.$refs.userList.scrollTop+96?(this.$refs.userList.scrollTop=24*t-96,this.disableMouseOver()):24*t<this.$refs.userList.scrollTop&&(this.$refs.userList.scrollTop=24*t,this.disableMouseOver())}},disableMouseOver:function(){this.mouseOverEnabled=!1,this.debounceEnableMouseOver()},enableMouseOver:function(){this.mouseOverEnabled=!0}}},g=(n(276),n(2)),v=Object(g.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"at-popup bg-white",style:{top:t.topPx,left:t.leftPx,height:t.computedHeight}},[n("p",{staticClass:"hint ff-yahei fs-12 tc-slate ls-0 c-default"},[t._v("选择或输入你想@的人")]),t.userList.length>0?n("div",{ref:"userList",staticClass:"user-container w-100"},t._l(t.userList,(function(e,i){return n("a",{staticClass:"item ff-yahei fs-12 tc-black ls-0 d-block c-pointer",class:{"is-selected":i===t.selectedIndex},on:{mouseover:function(e){return t.mouseOverHandler(i)},click:function(n){return t.onClickItem(e)},mousedown:t.onMousedown}},[t._v(t._s(e.uname))])})),0):t._e()])}),[],!1,null,"9b2294ce",null).exports;n(55);c.a.use(r.b);var b=v;e.a=b},,,,,,,function(t,e,n){"use strict";var i=n(6),o={name:"BackTop",data:function(){return{isShowBtn:!1,right:0,timerPid:0}},methods:{getScrollTop:function(){return document.body.scrollTop||document.documentElement.scrollTop},backtop:function(){var t=window.requestAnimationFrame||function(t){setTimeout(t,17)},e=window.cancelAnimationFrame||clearTimeout,n=document.body.scrollTop?document.body:document.documentElement,i=n.scrollTop,o=this;!function a(){o.timerPid&&e(o.timerPid),(i+=(0-i)/4)<1?n.scrollTop=0:(n.scrollTop=i,o.timerPid=t(a))}()},resize:function(){this.right=document.documentElement.clientWidth>1460?(document.documentElement.clientWidth-1460)/4:0},scroll:function(){this.isShowBtn=(document.body.scrollTop||document.documentElement.scrollTop)>(window.innerHeight||document.body.clientHeight||document.documentElement.clientHeight)}},mounted:function(){this.scrollDebounce=Object(i.b)(this.scroll,100),window.addEventListener("scroll",this.scrollDebounce,{passive:!0}),window.addEventListener("resize",this.resize),this.resize()},destroyed:function(){window.removeEventListener("scroll",this.scrollDebounce,{passive:!0}),window.removeEventListener("resize",this.resize)}},a=(n(335),n(2)),r=Object(a.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"rocket-fade"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:this.isShowBtn,expression:"isShowBtn"}],staticClass:"back-top",style:{right:this.right+"px"},on:{click:this.backtop}})])}),[],!1,null,"37d58309",null);e.a=r.exports},function(t,e,n){"use strict";n(14),n(37),n(33),n(242);var i=n(71),o=n.n(i),a=n(35);function r(){var t=w(["\n      stroke: currentColor;\n      stroke-width: 1.4 !important;\n      fill: none;\n    "]);return r=function(){return t},t}function s(){var t=w(["\n      stroke: currentColor;\n      fill: none;\n    "]);return s=function(){return t},t}function c(){var t=w(["\n            stroke: #ffa726;\n            fill: #ffa726;\n          "]);return c=function(){return t},t}function l(){var t=w(["\n            fill: none;\n            stroke: #cccccc;\n          "]);return l=function(){return t},t}function u(){var t=w(["\n        .border {\n          fill: #fff;\n        }\n        .content {\n          fill: ",";\n        }\n      "]);return u=function(){return t},t}function d(){var t=w(["\n            .border {\n              fill: #d0d7dd;\n            }\n            .content {\n              fill: #e3e8ec;\n              fill-opacity: 0.3;\n            }\n            .dot {\n              fill: none;\n            }\n          "]);return d=function(){return t},t}function f(){var t=w(["\n            .border,\n            .dot {\n              fill: #23ade5;\n            }\n            .content {\n              fill: none;\n            }\n          "]);return f=function(){return t},t}function h(){var t=w(["\n            .highlight,\n            .content,\n            .heart {\n              fill: none;\n            }\n            .border {\n              fill: #999;\n            }\n          "]);return h=function(){return t},t}function p(){var t=w(["\n            .highlight {\n              fill: #fff;\n            }\n            .content {\n              fill: #ffd876;\n            }\n            .border,\n            .heart {\n              fill: #db8b20;\n            }\n          "]);return p=function(){return t},t}function m(){var t=w(["\n      .mark {\n        fill: #ea5c82;\n      }\n      .border {\n        fill: #ff94b1;\n      }\n      .content {\n        fill: #fff;\n      }\n    "]);return m=function(){return t},t}function g(){var t=w(["\n        .fill {\n          fill: ",";\n        }\n        .border {\n          fill: ",";\n        }\n      "]);return g=function(){return t},t}function v(){var t=w(["\n        fill: ",";\n      "]);return v=function(){return t},t}function b(){var t=w(["\n            .border {\n              fill: #999;\n            }\n            .content,\n            .content-star,\n            .highlight {\n              fill: none;\n            }\n          "]);return b=function(){return t},t}function y(){var t=w(["\n            .content {\n              fill: #fff;\n            }\n            .content-star {\n              fill: #ffd876;\n            }\n            .border,\n            .highlight {\n              fill: #db8b20;\n            }\n          "]);return y=function(){return t},t}function _(){var t=w(["\n        stroke: currentColor;\n        fill: none;\n        .path-2 {\n          stroke: currentColor;\n          fill: none;\n        }"]);return _=function(){return t},t}function C(){var t=w(["\n        stroke: currentColor;\n        fill: none;\n        .path-2 {\n          opacity: 0;\n          fill: none;\n\n        }"]);return C=function(){return t},t}function w(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var I={add:{viewBox:"0 0 40 40",shape:'<path d="M22.9,17.1V2.8a2.9,2.9,0,0,0-5.8,0V17.1H2.8a2.9,2.9,0,0,0,0,5.8H17.1V37.2A2.82,2.82,0,0,0,20,40a2.88,2.88,0,0,0,2.9-2.8V22.9H37.2A2.82,2.82,0,0,0,40,20a2.88,2.88,0,0,0-2.8-2.9Z"/>'},"arrow-left":{viewBox:"0 0 20 20",shape:'<g transform="translate(0,-277)"><path d="m 6.1595699,286.54933 8.6409671,8.11208 c 0.26595,0.24967 0.26595,0.65166 0,0.90134 -0.265949,0.24967 -0.694158,0.24967 -0.960108,0 l -8.6409667,-8.11208 c -0.2659497,-0.24967 -0.2659497,-0.65167 0,-0.90134 0.2659497,-0.24967 0.6941577,-0.24967 0.9601076,0 z m -0.9601076,0 8.6409667,-8.11208 c 0.26595,-0.24967 0.694159,-0.24967 0.960108,0 0.26595,0.24968 0.26595,0.65168 0,0.90134 l -8.6409671,8.11208 c -0.2659499,0.24967 -0.6941579,0.24967 -0.9601076,0 -0.2659497,-0.24967 -0.2659497,-0.65167 0,-0.90134 z"/></g>'},"arrow-right":{viewBox:"0 0 20 20",shape:'<g transform="translate(0,-277)"><path d="m 13.84043,286.54933 -8.6409675,8.11208 c -0.26595,0.24967 -0.26595,0.65166 0,0.90134 0.265949,0.24967 0.694158,0.24967 0.960108,0 l 8.6409665,-8.11208 c 0.26595,-0.24967 0.26595,-0.65167 0,-0.90134 -0.265949,-0.24967 -0.694157,-0.24967 -0.960107,0 z m 0.960107,0 -8.6409665,-8.11208 c -0.26595,-0.24967 -0.694159,-0.24967 -0.960108,0 -0.26595,0.24968 -0.26595,0.65168 0,0.90134 l 8.6409675,8.11208 c 0.26595,0.24967 0.694158,0.24967 0.960107,0 0.26595,-0.24967 0.26595,-0.65167 0,-0.90134 z"/></g>'},"bell-empty":{shape:'\n      <path d="M2.49999639,12.5 C3.16666305,12.5 3.49999639,11.8333333 3.49999639,10.5 L3.49999639,7.5 C3.49999639,5.01471863 5.51471501,3 7.99999639,3 C10.4852778,3 12.4999964,5.01471863 12.4999964,7.5 L12.4999964,10.5 C12.4999964,11.8333333 12.8333263,12.5 13.4999861,12.5" stroke-linecap="round" stroke-linejoin="round"></path>\n      <path d="M7.00022411,3 L7.00022411,2 C7.00022411,1.44771525 7.44793936,1 8.00022411,1 C8.55250886,1 9.00022411,1.44771525 9.00022411,2 L9.00022411,3" stroke-linecap="round" stroke-linejoin="round"></path>\n      <path d="M5.9999938,13 C5.9999938,14.1045695 6.89542338,15 7.9999938,15 C9.1045601,15 9.9999938,14.1045695 9.9999938,13" stroke-linecap="round" stroke-linejoin="round"></path>\n      <line x1="2.49999742" y1="12.5" x2="13.4999861" y2="12.5" stroke-linecap="round" stroke-linejoin="round"></line>\n      <line  class="path-2" x1="2.49999639" y1="3.5" x2="13.5002241" y2="14.5" stroke-linecap="round" stroke-linejoin="round"></line>\n    ',style:function(t){return"active"===(t.type||"default")?Object(a.a)(C()):Object(a.a)(_())}},"bell-full":{viewBox:"0 0 16 16",shape:'<path d="M8.92463374,1.78708136 C10.326202,2.03214939 11.5270583,2.86089597 12.2674576,4.01357591 L2.65785937,13.293457 L1.43819541,13.293457 C1.30779891,13.293457 1.18256131,13.2425165 1.08918684,13.1514976 C0.891446521,12.9587454 0.887402774,12.6421888 1.08015488,12.4444485 L3.05749512,10.4159368 L3.05749512,6.7121582 C3.05749512,4.26953696 4.80902697,2.2360079 7.12463379,1.79902792 L7.12463379,0.887304664 C7.12463379,0.390248402 7.5275775,-0.0126953125 8.02463377,-0.0126953125 C8.52169003,-0.0126953125 8.92463374,0.390248402 8.92463374,0.887304664 L8.92463374,1.78708136 Z M12.8759223,5.37221736 C12.9942553,5.79866279 13.0574951,6.24802527 13.0574951,6.7121582 L13.0574951,10.7198864 L14.5493504,12.4689868 C14.6265333,12.5594786 14.6689308,12.6745202 14.6689308,12.793457 C14.6689308,13.0695994 14.4450732,13.293457 14.1689308,13.293457 L4.6732385,13.293457 L12.8759223,5.37221736 Z M6,14 L10,14 C10,15.1045695 9.1045695,16 8,16 C6.8954305,16 6,15.1045695 6,14 Z"></path>'},close:{viewBox:"0 0 40 40",shape:'<path d="M13.4,9.4L4.9,0.8C3.8-0.3,2-0.3,0.8,0.8c-1.1,1.1-1.1,2.9,0,4.1l8.5,8.5 c1.1,1.1,2.9,1.1,4.1,0C14.6,12.3,14.6,10.5,13.4,9.4z M39.1,35.1l-8.6-8.5c-1.1-1.1-2.9-1.1-4,0s-1.1,3,0,4.1l8.6,8.5 c1.1,1.1,2.9,1.1,4,0C40.3,38.1,40.3,36.3,39.1,35.1z M35.1,0.8L0.8,35.2c-1.1,1.1-1.1,2.9,0,4s2.9,1.1,4,0L39.2,4.9 c1.1-1.1,1.1-2.9,0-4C38.1-0.3,36.3-0.3,35.1,0.8z"/>'},"close-circle":{viewBox:"0 0 10 10",shape:'<path d="M 5,1 A 3.9998191,4.0002721 0 0 0 1,4.999547 3.9998191,4.0002721 0 0 0 5,9 3.9998191,4.0002721 0 0 0 9,4.999547 3.9998191,4.0002721 0 0 0 5,1 Z M 2.6572333,2.450017 a 0.21966575,0.21969062 0 0 1 0.1684401,0.0643 L 5,4.688889 7.1743264,2.514317 a 0.21966575,0.21969062 0 0 1 0.3106183,0.310654 l -2.174327,2.174572 2.174327,2.175478 A 0.21966575,0.21969062 0 0 1 7.1743264,7.485675 L 5,5.310196 2.8256734,7.485675 A 0.2199608,0.21998571 0 0 1 2.5141498,7.175021 L 4.6893818,4.999543 2.5141498,2.824971 A 0.21966575,0.21969062 0 0 1 2.6572333,2.450012 Z"/>'},collection:{viewBox:"0 0 40 40",shape:'\n      <path\n        class="content"\n        d="M20,33.8,11.2,37c-1.9.7-3.3-.4-3.2-2.4l.5-9.2L2.5,18c-1.3-1.5-.7-3.2,1.2-3.7l9.2-2.4L18,4c1.1-1.7,2.8-1.7,3.9,0L27,12l9.2,2.4c1.9.5,2.5,2.2,1.2,3.7l-6,7.4.5,9.2c.1,2-1.3,3.1-3.2,2.4Z"\n        />\n      <path\n        class="content-star"\n        d="M23.6,33.1l-6.4,2.3c-1.9.7-3.3-.4-3.2-2.4l.4-6.6-4.3-5.3c-1.3-1.6-.7-3.2,1.2-3.7l6.6-1.7,3.7-5.8c1.1-1.7,2.9-1.7,3.9,0l3.7,5.8,6.6,1.7c1.9.5,2.5,2.2,1.2,3.7l-4.3,5.3.4,6.6c.1,2-1.3,3.1-3.2,2.4Z"\n        />\n      <path\n        class="border"\n        d="M19.4,32.1a2.44,2.44,0,0,1,1.2,0l8.8,3.2c.7.2.8.1.8-.6l-.5-9.2a2,2,0,0,1,.4-1.3l6-7.4c.4-.5.4-.6-.3-.8l-9.2-2.4a2.1,2.1,0,0,1-1.1-.8l-5.1-8c-.4-.6-.5-.6-.9,0l-5.1,8a1.55,1.55,0,0,1-1.1.8L4.1,16c-.6.2-.7.3-.3.8l6,7.4a2,2,0,0,1,.4,1.3l-.5,9.2c0,.7.1.8.8.6Zm-7.6,6.7a4,4,0,0,1-5.6-4.2l.5-8.5L1.1,19.3a3.93,3.93,0,0,1,2.2-6.6l8.5-2.2L16.5,3a4,4,0,0,1,7,0l4.8,7.4,8.5,2.2A3.94,3.94,0,0,1,39,19.2L33.4,26l.5,8.5a4,4,0,0,1-5.6,4.2l-8.2-3Z"\n        />\n      <path\n        class="highlight"\n        d="M 32.572266 0.9375 A 1.78 1.78 0 0 0 30.900391 2.3007812 L 29.699219 7.0996094 A 1.71 1.71 0 0 0 31 9.3007812 A 1.78 1.78 0 0 0 33.199219 8 L 34.400391 3.1992188 A 1.71 1.71 0 0 0 33.099609 1 A 1.78 1.78 0 0 0 32.572266 0.9375 z M 38.146484 4.6601562 A 1.7902514 1.7902514 0 0 0 36.699219 5.4003906 L 34.900391 7.8007812 A 1.7902514 1.7902514 0 0 0 37.800781 9.9003906 L 39.599609 7.5 A 1.7902514 1.7902514 0 0 0 38.146484 4.6601562 z M 19.882812 13.996094 A 2 2 0 0 0 19.800781 14 C 15.600781 14.6 12.700781 17.4 12.300781 21.5 A 1.811077 1.811077 0 1 0 15.900391 21.900391 C 16.100391 19.500391 17.700781 17.999609 20.300781 17.599609 A 1.81 1.81 0 0 0 21.900391 15.599609 A 2 2 0 0 0 19.882812 13.996094 z "\n        />\n    ',style:function(t){return"active"===(t.type||"default")?Object(a.a)(y()):Object(a.a)(b())}},comment:{viewBox:"0 0 40 40",shape:'<path d="M14.46,3.33H25.58c7.64,0,13.9,6,13.9,13.33S33.22,30,25.58,30h-.76l-7.28,6.67-2-6.67H14.46C6.81,30,.56,24,.56,16.67S6.81,3.33,14.46,3.33ZM36.7,16.67A10.91,10.91,0,0,0,25.58,6H14.46A10.91,10.91,0,0,0,3.34,16.67,10.91,10.91,0,0,0,14.46,27.33h3.19l.58,1.93.72,2.42,4-3.62.81-.74h1.88A10.91,10.91,0,0,0,36.7,16.67Z"/>',style:function(t){var e=t.type||"default";return Object(a.a)(v(),{active:"#fb7299",disabled:"#dadada",default:"#999"}[e])}},"danmu-a":{viewBox:"0 0 40 40",shape:'<path d="M32.86,2.84A7.08,7.08,0,0,1,40,10V30a7.08,7.08,0,0,1-7.14,7.15H7.14A7.08,7.08,0,0,1,0,30V10A7.08,7.08,0,0,1,7.14,2.84ZM37.14,30V10A4.21,4.21,0,0,0,32.86,5.7H7.14A4.21,4.21,0,0,0,2.86,10V30A4.21,4.21,0,0,0,7.14,34.3H32.86A4.21,4.21,0,0,0,37.14,30ZM7.86,17.14V14.28h2.86v2.86Zm2.86,8.58V22.86h2.86v2.86Zm5.71,0V22.86H32.14v2.86Zm-2.86-8.58V14.28H30.71v2.86Z"/>'},dianzan:{viewBox:"0 0 40 40",shape:'\n      <title>点赞</title>\n      <path\n        class="fill"\n        d="m 35.140937,15.170116 h -12.92 l 0.28,-2.92 0.42,-5.1400001 a 1.28,1.28 0 0 0 -1,-1.53 1.12,1.12 0 0 0 -1.25,0.42 l -6.36,8.1700001 -0.83,1.11 h -8.34 a 2,2 0 0 0 -0.83,0.28 2.29,2.29 0 0 0 -1.25,2.08 v 14.88 a 2,2 0 0 0 0.42,1.25 2,2 0 0 0 2.08,1.11 h 23.33 a 2.36,2.36 0 0 0 1.39,-0.41 3.6,3.6 0 0 0 2.08,-2.78 l 4.44,-14.59 2.5,0.56 -2.5,-0.56 a 2.4,2.4 0 0 0 -0.14,-1.39 2.91,2.91 0 0 0 -1.52,-0.54 l 0.28,-2.5 z"\n        />\n      <path\n        class="border"\n        d="M 21.402578,2.9572256 A 3.91,3.91 0 0 0 18.609609,4.1701163 L 11.810781,12.66035 H 5.5607807 a 8.43,8.43 0 0 0 -2.5,0.689454 4.91,4.91 0 0 0 -2.49999999,4.310546 v 14.859375 a 5.66,5.66 0 0 0 0.68945299,2.5 4.52,4.52 0 0 0 4.310547,2.361329 H 28.859609 a 6.37,6.37 0 0 0 6,-4.861329 l 4.451172,-14.71875 A 4.38,4.38 0 0 0 38.750234,14.330272 4.14,4.14 0 0 0 35.420156,12.66035 H 25.000234 l 0.25,-5.5605462 a 3.91,3.91 0 0 0 -1.25,-3.1894531 3.91,3.91 0 0 0 -2.597656,-0.9531251 z m 0.1875,2.5703126 a 1.12,1.12 0 0 1 0.330078,0.052734 1.28,1.28 0 0 1 1,1.5292969 l -0.419922,5.1406259 -0.279297,2.919921 h 12.919922 a 2.91,2.91 0 0 1 1.519531,0.539062 2.4,2.4 0 0 1 0.140625,1.390626 l -4.441406,14.589843 a 3.6,3.6 0 0 1 -2.080078,2.78125 2.36,2.36 0 0 1 -1.388672,0.410157 H 5.5607807 a 2,2 0 0 1 -2.080078,-1.111329 2,2 0 0 1 -0.419922,-1.25 V 17.640819 a 2.29,2.29 0 0 1 1.25,-2.080078 2,2 0 0 1 0.830078,-0.28125 h 5.8398443 v 19.580078 h 2.5 V 15.279491 l 0.830078,-1.109375 6.359375,-8.1699216 a 1.12,1.12 0 0 1 0.919922,-0.4726562 z"\n        />\n    ',style:function(t){var e=t.type||"default";return Object(a.a)(g(),"active-fill"===e?"#ffd9e5":"none",{active:"#fb7299","active-fill":"#fb7299",disabled:"#dadada",default:"#999"}[e])}},emoji:{viewBox:"0 0 24 24",shape:'<path d="M2.4,9.1v7.7a4.4,4.4,0,0,0,4.39,4.4H17.21a4.4,4.4,0,0,0,4.39-4.4V9.1a4.4,4.4,0,0,0-4.39-4.4H6.79A4.4,4.4,0,0,0,2.4,9.1Zm13.51,2.18,2.54-1.93a.59.59,0,0,0,.11-.84.6.6,0,0,0-.84-.12l-3.2,2.43a.6.6,0,0,0-.11.84.57.57,0,0,0,.16.15L17.7,14a.6.6,0,0,0,.83-.15.61.61,0,0,0-.15-.84Zm-7.82,0L5.62,13a.61.61,0,0,0-.15.84A.6.6,0,0,0,6.3,14l3.13-2.17a.57.57,0,0,0,.16-.15.6.6,0,0,0-.11-.84L6.28,8.39a.6.6,0,0,0-.84.12.59.59,0,0,0,.11.84ZM16.56,3.5h.65A5.6,5.6,0,0,1,22.8,9.1v7.7a5.6,5.6,0,0,1-5.59,5.6H6.79A5.6,5.6,0,0,1,1.2,16.8V9.1A5.6,5.6,0,0,1,6.79,3.5h.65l-1.06-2A.7.7,0,1,1,7.62.83L9,3.5h6L16.38.86a.7.7,0,0,1,1.24.66ZM12,18.5a3.52,3.52,0,0,0,3.34-2.45A.82.82,0,0,0,14.58,15H9.42a.81.81,0,0,0-.76,1.06A3.48,3.48,0,0,0,12,18.5Z"/>'},"emoji-face":{viewBox:"0 0 16 16",shape:'\n      <path d="M8,0.5 C12.1321656,0.5 15.5,3.86783439 15.5,8 C15.5,12.1321656 12.1321656,15.5 8,15.5 C3.86783439,15.5 0.5,12.1321656 0.5,8 C0.5,3.86783439 3.86783439,0.5 8,0.5 Z M8,1.42966262 C4.37937394,1.42966262 1.42966262,4.37937394 1.42966262,8 C1.42966262,11.6206261 4.37937394,14.5703374 8,14.5703374 C11.6206261,14.5703374 14.5703374,11.6206261 14.5703374,8 C14.5703374,4.37937394 11.6206261,1.42966262 8,1.42966262 Z M10.6512739,9.80334395 C10.7468153,9.62420382 10.9737261,9.5406051 11.1528662,9.6361465 C11.3320064,9.7316879 11.4156051,9.95859873 11.3200637,10.1377389 C11.2006369,10.3765924 10.9617834,10.6871019 10.5676752,11.0095541 C9.91082803,11.5230892 9.06289809,11.8335987 8,11.8335987 C6.93710191,11.8335987 6.08917197,11.5230892 5.43232484,11.0095541 C5.03821656,10.6871019 4.79936306,10.3765924 4.67993631,10.1377389 C4.5843949,9.94665605 4.65605096,9.7316879 4.84713376,9.6361465 C5.03821656,9.5406051 5.25318471,9.62420382 5.34872611,9.80334395 C5.36066879,9.83917197 5.40843949,9.89888535 5.46815287,9.98248408 C5.57563694,10.1257962 5.71894904,10.281051 5.89808917,10.4243631 C6.42356688,10.8423567 7.10429936,11.0931529 8,11.0931529 C8.89570064,11.0931529 9.5883758,10.8423567 10.1019108,10.4243631 C10.2691083,10.281051 10.4243631,10.1377389 10.5318471,9.98248408 C10.6035032,9.89888535 10.6393312,9.8272293 10.6512739,9.80334395 Z M10.9097208,5.12181529 C11.4789094,5.12181529 11.9422024,5.58510831 11.9422024,6.15429687 C11.9422024,6.72348544 11.4789094,7.18677846 10.9097208,7.18677846 C10.3405323,7.18677846 9.87723925,6.72348544 9.87723925,6.15429687 C9.87723925,5.58510831 10.3405323,5.12181529 10.9097208,5.12181529 Z M4.90255523,5.12181529 C5.4717438,5.12181529 5.93503682,5.58510831 5.93503682,6.15429687 C5.93503682,6.72348544 5.4717438,7.18677846 4.90255523,7.18677846 C4.33336667,7.18677846 3.87007365,6.72348544 3.87007365,6.15429687 C3.87007365,5.58510831 4.33336667,5.12181529 4.90255523,5.12181529 Z" fill-rule="nonzero"></path>\n    '},error:{viewBox:"0 0 40 40",shape:'\n      <path class="content" d="M20,37.33A17.33,17.33,0,1,0,2.67,20,17.33,17.33,0,0,0,20,37.33Z"/>\n      <path class="border" d="M20,40A20,20,0,1,1,40,20,20,20,0,0,1,20,40Zm0-2.67A17.33,17.33,0,1,0,2.67,20,17.33,17.33,0,0,0,20,37.33Z"/>\n      <path class="mark" d="M17.33,10.68a2.67,2.67,0,1,1,5.33,0V21.32a2.67,2.67,0,1,1-5.33,0ZM20,32a2.67,2.67,0,1,1,2.67-2.67A2.67,2.67,0,0,1,20,32Z"/>\n    ',style:function(){return Object(a.a)(m())}},"gantan-01":{viewBox:"0 0 40 40",shape:'\n      <path d="M20,27.12A2.85,2.85,0,1,0,22.85,30,2.84,2.84,0,0,0,20,27.12Z"/>\n      <path d="M35.73,15.68C32.1,9.16,25.82,1.54,20,1.49S7.91,9,4.27,15.53C2.71,18.32-2.13,27.83,1.08,33c2.57,4.1,11.4,5.56,19,5.56h.41C27.81,38.46,36.54,37,39,32.93,42.06,27.88,37.27,18.45,35.73,15.68Zm.35,15.48c-1.16,1.91-6.91,3.88-15.65,3.94-8.14,0-15-1.61-16.46-4s-.05-8,3.29-13.95c3.92-7,9.39-12.29,12.74-12.29h0c3.32,0,8.79,5.37,12.72,12.43C36,23.27,37.41,28.95,36.07,31.15Z"/>\n      <path d="M20,10a2.84,2.84,0,0,0-2.85,2.85v8.55a2.85,2.85,0,0,0,5.7,0V12.88A2.84,2.84,0,0,0,20,10Z"/>\n    '},good:{viewBox:"0 0 40 40",shape:'\n      <path\n        class="highlight"\n        d="M35.1,13.8c-1.3-.3-4.7-.3-9.6-.5,0-1,.3-2.1.3-3.6,0-4.2-3.1-7.8-5.7-7.8a3.5,3.5,0,0,0-3.4,3.4A9.2,9.2,0,0,1,12,13.6a3,3,0,0,0-1,.5h0a3.2,3.2,0,0,0-2.3-.8H5.2a3.5,3.5,0,0,0-3.4,3.4V34.9a3.5,3.5,0,0,0,3.4,3.4H8.6a3.35,3.35,0,0,0,3.1-2.1H12a28.53,28.53,0,0,0,4.7,1,21.11,21.11,0,0,0,6.8,1h6.2a4.86,4.86,0,0,0,4.2-2.1,5.21,5.21,0,0,0,.5-1.3,2.54,2.54,0,0,0,0-2.1,4.27,4.27,0,0,0,1.8-2.9,4.1,4.1,0,0,0,0-3.1,4.58,4.58,0,0,0,1.6-3.1,3,3,0,0,0-.5-2.6,4.9,4.9,0,0,0,1-2.6v-.8a4.3,4.3,0,0,0-3.2-3.8Z"\n        />\n      <path\n        class="content"\n        d="M35.5,17.4c-1.1-.2-4-.2-8.2-.4,0-.9.2-1.8.2-3.1,0-3.5-2.6-6.6-4.9-6.6a3,3,0,0,0-2.9,2.9,7.89,7.89,0,0,1-4,7.1,3.92,3.92,0,0,0-.9.4h0a2.82,2.82,0,0,0-2-.7H9.9A3,3,0,0,0,7,19.9V35.4a3,3,0,0,0,2.9,2.9H13a2.8,2.8,0,0,0,2.6-1.8h.2c.7.2,1.5.4,4,.9a19.06,19.06,0,0,0,5.7.9h5.3a4,4,0,0,0,3.5-1.8,7,7,0,0,0,.4-1.1,2.74,2.74,0,0,0,0-1.8,3.82,3.82,0,0,0,1.5-2.4,3.79,3.79,0,0,0,0-2.6A3.41,3.41,0,0,0,37.5,26a2.78,2.78,0,0,0-.4-2.2,4.31,4.31,0,0,0,.9-2.2V21a3.24,3.24,0,0,0-2.5-3.6Z"\n        />\n      <path\n        class="border"\n        d="M12.7,34.4c.8.2,1.9.5,4.2.9.2,0,.3.1.5.2a21.62,21.62,0,0,0,5.9.8h6.2A2.84,2.84,0,0,0,32,35.2a4.33,4.33,0,0,0,.4-1.1l.1-.2a3.2,3.2,0,0,0-.1-.7,1.77,1.77,0,0,1,.8-2.1,1.34,1.34,0,0,0,.6-.7c.1-.3.2-.5.5-1.3a3.07,3.07,0,0,0,0-1.9,1.76,1.76,0,0,1,.7-2.1c.3-.2.6-.8.8-2a1.19,1.19,0,0,0-.3-1.1,1.82,1.82,0,0,1,0-2c.6-.9.7-1.2.7-1.6v-.8a2.32,2.32,0,0,0-1.7-2.1c-.5-.1-1.4-.1-3.1-.2-.4,0-2.3-.1-2.8-.1-1.2,0-2.3-.1-3.4-.2a1.77,1.77,0,0,1-1.7-1.8,15.26,15.26,0,0,1,.1-1.8,12.13,12.13,0,0,0,.1-1.8c0-3-2.3-6-3.9-6a1.64,1.64,0,0,0-1.6,1.6,10.77,10.77,0,0,1-5.6,9.9h-.1V34.4ZM9.1,36.3V15.1H5.2a1.64,1.64,0,0,0-1.6,1.6V34.9a1.64,1.64,0,0,0,1.6,1.6H8.6A.76.76,0,0,1,9.1,36.3ZM14.8,5.2A5.29,5.29,0,0,1,20,0c3.9,0,7.5,4.7,7.5,9.6a12.1,12.1,0,0,1-.1,1.9,7.57,7.57,0,0,1,1.5.1c.5,0,2.4.1,2.8.1,2,.1,3,.2,3.7.3A5.93,5.93,0,0,1,40,17.7v.8a4.69,4.69,0,0,1-.8,2.7,3.89,3.89,0,0,1,.2,2.8,8.07,8.07,0,0,1-1.3,3.4,5.44,5.44,0,0,1-.3,3.1c-.2.6-.4,1.1-.6,1.7a6,6,0,0,1-.9,1.3,3.4,3.4,0,0,1-.3,2,7.74,7.74,0,0,1-.7,1.6,6.47,6.47,0,0,1-5.7,3H23.4A26.77,26.77,0,0,1,16.1,39c-1.6-.3-2.7-.5-3.6-.7a5.37,5.37,0,0,1-4,1.8H5.2A5.45,5.45,0,0,1,0,34.8V16.6a5.29,5.29,0,0,1,5.2-5.2H8.6a6,6,0,0,1,2.4.5,1,1,0,0,1,.3-.1A7.33,7.33,0,0,0,14.8,5.2ZM6.9,32.7a1.8,1.8,0,1,1,1.8-1.8A1.79,1.79,0,0,1,6.9,32.7Z"\n        />\n      <path\n        class="heart"\n        d="M33.1,8.3a15.23,15.23,0,0,1-1.7-3.2,3.81,3.81,0,0,1-.1-3.6c.5-.9,1.7-2,3-1.3A4.16,4.16,0,0,1,36,2.7a4.34,4.34,0,0,1,3-.1,2.3,2.3,0,0,1,.7,3.2,4.31,4.31,0,0,1-3,2A12.17,12.17,0,0,1,33.1,8.3Z"\n        />\n    ',style:function(t){return"active"===t.type?Object(a.a)(p()):Object(a.a)(h())}},"group-dynamic":{viewBox:"0 0 40 40",shape:'<path d="M22.83,20,38.42,4.41a2,2,0,1,0-2.83-2.83h0L20,17.17,4.41,1.58A2,2,0,0,0,1.58,4.41L17.17,20,1.58,35.59a2,2,0,0,0,2.83,2.83L20,22.83,35.59,38.42a2,2,0,1,0,2.83-2.83Z"/>'},"info-circle":{viewBox:"0 0 14 14",shape:'<path d="M7,14 C3.13400675,14 0,10.8659932 0,7 C0,3.13400675 3.13400675,0 7,0 C10.8659932,0 14,3.13400675 14,7 C14,10.8659932 10.8659932,14 7,14 Z M6.25,4.25 C6.25,4.66421356 6.58578644,5 7,5 C7.41421356,5 7.75,4.66421356 7.75,4.25 C7.75,3.83578644 7.41421356,3.5 7,3.5 C6.58578644,3.5 6.25,3.83578644 6.25,4.25 Z M7.375,6 L6.625,6 C6.55625,6 6.5,6.05625 6.5,6.125 L6.5,10.375 C6.5,10.44375 6.55625,10.5 6.625,10.5 L7.375,10.5 C7.44375,10.5 7.5,10.44375 7.5,10.375 L7.5,6.125 C7.5,6.05625 7.44375,6 7.375,6 Z"/>'},information_warning:{viewBox:"0 0 16 16",shape:'<path d="M8,0 C3.6,0 0,3.6 0,8 C0,12.4 3.6,16 8,16 C12.4,16 16,12.4 16,8 C16,3.6 12.4,0 8,0 Z M8,12.2857143 C7.54285714,12.2857143 7.14285714,11.8857143 7.14285714,11.4285714 C7.14285714,10.9714286 7.54285714,10.5714286 8,10.5714286 C8.45714286,10.5714286 8.85714286,10.9714286 8.85714286,11.4285714 C8.85714286,11.8857143 8.45714286,12.2857143 8,12.2857143 Z M8.74285714,8.97142857 C8.74285714,9.54285714 8.51428571,10 8,10 C7.48571429,10 7.25714286,9.54285714 7.25714286,8.97142857 L6.97142857,4.74285714 C6.97142857,4.17142857 7.42857143,3.71428571 7.94285714,3.71428571 C8.45714286,3.71428571 8.97142857,4.17142857 8.97142857,4.74285714 L8.74285714,8.97142857 Z"/>'},"jinz-01":{viewBox:"0 0 40 40",shape:'<path d="M20,0A20,20,0,1,0,40,20,20,20,0,0,0,20,0Zm0,3.43A16.49,16.49,0,0,1,30.43,7.14L7.14,30.43A16.56,16.56,0,0,1,20,3.43Zm0,33.14A16.49,16.49,0,0,1,9.57,32.86L32.86,9.57A16.56,16.56,0,0,1,20,36.57Z"/>'},"left-r-dynamic":{viewBox:"0 0 40 40",shape:'<path d="M30.25,9.9a14.43,14.43,0,0,1,0,20.2,13.93,13.93,0,0,1-19.91,0,2.79,2.79,0,0,0-4,0,2.89,2.89,0,0,0,0,4,19.51,19.51,0,0,0,27.87,0,20.21,20.21,0,0,0,0-28.28,19.5,19.5,0,0,0-26.84-1L5.6,3.07c-1.1-1.12-2.33-.78-2.74.75L.1,14.22c-.41,1.53.5,2.44,2,2l10.24-2.8c1.51-.41,1.84-1.66.74-2.78l-1.7-1.73A13.93,13.93,0,0,1,30.25,9.9Z" />'},"right-r-dynamic":{viewBox:"0 0 40 40",shape:'<path d="M9.75,9.9a14.43,14.43,0,0,0,0,20.2,13.93,13.93,0,0,0,19.91,0,2.79,2.79,0,0,1,4,0,2.89,2.89,0,0,1,0,4,19.51,19.51,0,0,1-27.87,0,20.21,20.21,0,0,1,0-28.28,19.5,19.5,0,0,1,26.84-1L34.4,3.07c1.1-1.12,2.33-.78,2.74.75l2.76,10.4c.41,1.53-.5,2.44-2,2l-10.24-2.8c-1.51-.41-1.84-1.66-.74-2.78l1.7-1.73A13.93,13.93,0,0,0,9.75,9.9Z" />'},link:{viewBox:"0 0 13 15",shape:'<path d="M6.096 7.404a.6.6 0 1 1-.849.849 3.1 3.1 0 0 1 0-4.384L7.37 1.747a3.1 3.1 0 0 1 4.384 4.384l-1.85 1.85a.6.6 0 0 1-.849-.848l1.85-1.85a1.9 1.9 0 1 0-2.687-2.687L6.096 4.717a1.9 1.9 0 0 0 0 2.687zm.808.192a.6.6 0 1 1 .849-.849 3.1 3.1 0 0 1 0 4.384L5.63 13.253a3.1 3.1 0 0 1-4.384-4.384l1.85-1.85a.6.6 0 1 1 .849.848l-1.85 1.85a1.9 1.9 0 0 0 2.687 2.687l2.121-2.121a1.9 1.9 0 0 0 0-2.687z" />'},lottery:{viewBox:"0 0 17 16",shape:'\n      <path d="M14.6,7.9H2.4c-1,0-1.8-0.8-1.8-1.8s0.8-1.8,1.8-1.8h12.2c1,0,1.8,0.8,1.8,1.8S15.6,7.9,14.6,7.9z M2.4,5.3 C2,5.3,1.6,5.7,1.6,6.1S2,6.9,2.4,6.9h12.2c0.4,0,0.8-0.4,0.8-0.8S15,5.3,14.6,5.3H2.4z"/>\n      <path d="M13.5,15.7H3.5C2.7,15.7,2,15,2,14.2V7.1H15v7.2C15,15,14.3,15.7,13.5,15.7z M3,8.1v6.2c0,0.2,0.2,0.4,0.4,0.4h10.1 c0.2,0,0.4-0.2,0.4-0.4V8.1H3z"/>\n      <rect x="8.1" y="4.2" width="1" height="11.5"/>\n      <path d="M8.9,5.2H6.3C5,5.2,3.8,4.1,3.8,2.7S5,0.2,6.3,0.2s2.5,1.1,2.5,2.5V5.2z M6.3,1.2c-0.8,0-1.5,0.7-1.5,1.5 s0.7,1.5,1.5,1.5h1.5V2.7C7.9,1.8,7.2,1.2,6.3,1.2z"/>\n      <path d="M10.6,5.2H8.1V2.7c0-1.4,1.1-2.5,2.5-2.5s2.5,1.1,2.5,2.5S12,5.2,10.6,5.2z M9.1,4.2h1.5c0.8,0,1.5-0.7,1.5-1.5 s-0.7-1.5-1.5-1.5S9.1,1.8,9.1,2.7V4.2z"/>\n    '},"more-1":{viewBox:"0 0 40 40",shape:'<path d="M20,8.89a4.44,4.44,0,1,1,4.44-4.44A4.44,4.44,0,0,1,20,8.89Zm0,15.56A4.44,4.44,0,1,1,24.44,20,4.44,4.44,0,0,1,20,24.44ZM20,40a4.44,4.44,0,1,1,4.44-4.44A4.44,4.44,0,0,1,20,40Z"/>'},pic:{viewBox:"0 0 24 24",shape:'<path d="M7.1,9.5A1.7,1.7,0,1,0,5.4,7.8,1.7,1.7,0,0,0,7.1,9.5Zm14.25,5.37V5.5A2.35,2.35,0,0,0,19,3.15H5A2.35,2.35,0,0,0,2.65,5.5v12a5.07,5.07,0,0,1,3.4-2,6.32,6.32,0,0,1,4.77,1.32c1.43-2.32,3.24-3.64,5.43-3.9A5.92,5.92,0,0,1,21.35,14.87Zm0,1.85c-1.46-2-3.09-2.82-5-2.59s-3.57,1.52-4.88,3.92a.59.59,0,0,1-.93.15A5.28,5.28,0,0,0,6.2,16.71a4.4,4.4,0,0,0-3.36,2.72A2.34,2.34,0,0,0,5,20.85H19a2.35,2.35,0,0,0,2.34-2.35ZM1.35,5.5A3.65,3.65,0,0,1,5,1.85H19A3.64,3.64,0,0,1,22.65,5.5v13A3.65,3.65,0,0,1,19,22.15H5A3.64,3.64,0,0,1,1.35,18.5Z"/>'},"play-a":{viewBox:"0 0 40 40",shape:'\n      <path d="M32.9,2.9H7.1C3.2,2.8,0,6,0,9.9c0,0,0,0.1,0,0.1v20c0,3.9,3.1,7.1,7,7.1c0,0,0.1,0,0.1,0h25.7 c3.9,0,7.1-3.1,7.1-7c0,0,0-0.1,0-0.1V10c0-3.9-3.1-7.1-7-7.2C33,2.8,32.9,2.8,32.9,2.9z M37.2,30c0,2.3-1.8,4.2-4.1,4.3 c-0.1,0-0.1,0-0.2,0H7.1c-2.3,0-4.2-1.8-4.3-4.1c0-0.1,0-0.1,0-0.2V10C2.8,7.7,4.6,5.8,7,5.7c0.1,0,0.1,0,0.2,0h25.7 c2.3,0,4.2,1.8,4.3,4.1c0,0.1,0,0.1,0,0.2V30z"/>\n      <path d="M27.7,18.7l-11.4-5c-0.7-0.3-1.5,0-1.9,0.7c-0.1,0.2-0.1,0.4-0.1,0.6v10c0,0.8,0.6,1.4,1.4,1.4 c0.2,0,0.4,0,0.6-0.1l11.4-5c0.7-0.3,1-1.1,0.7-1.8C28.3,19.1,28,18.9,27.7,18.7z"/>\n    '},radio:{viewBox:"0 0 40 40",shape:'\n      <path class="content" d="M20,0h0A20,20,0,0,1,40,20h0A20,20,0,0,1,20,40h0A20,20,0,0,1,0,20H0A20,20,0,0,1,20,0Z"/>\n      <path class="border" d="M2.5,20A17.5,17.5,0,1,0,20,2.5,17.51,17.51,0,0,0,2.5,20ZM0,20A20,20,0,1,1,20,40,20,20,0,0,1,0,20Z"/>\n      <path class="dot" d="M20,10h0A10,10,0,0,1,30,20h0A10,10,0,0,1,20,30h0A10,10,0,0,1,10,20h0A10,10,0,0,1,20,10Z"/>\n    ',style:function(t){return"selected"===t.type?Object(a.a)(f()):Object(a.a)(d())}},renzheng:{viewBox:"0 0 40 40",shape:'\n      <path class="border" d="M20,39.17A19.17,19.17,0,1,1,39.17,20,19.19,19.19,0,0,1,20,39.17Z"/>\n      <path class="content" d="M20,3.33A16.67,16.67,0,1,0,36.67,20,16.67,16.67,0,0,0,20,3.33ZM16.55,32.77l1.68-11.08-9.48-.1,14-14.36L21.16,18.37l10.09.14Z"/>\n      ',style:function(t){var e=t.type||"default";return Object(a.a)(u(),{yellow:"#ffba51",blue:"#4ac7ff",default:"#4ac7ff"}[e])}},reply:{viewBox:"0 0 40 40",shape:'<path d="M14.46,3.33H25.58c7.64,0,13.9,6,13.9,13.33S33.22,30,25.58,30h-.76l-7.28,6.67-2-6.67H14.46C6.81,30,.56,24,.56,16.67S6.81,3.33,14.46,3.33ZM36.7,16.67A10.91,10.91,0,0,0,25.58,6H14.46A10.91,10.91,0,0,0,3.34,16.67,10.91,10.91,0,0,0,14.46,27.33h3.19l.58,1.93.72,2.42,4-3.62.81-.74h1.88A10.91,10.91,0,0,0,36.7,16.67Z"/>'},routine_processing:{viewBox:"0 0 15 15",shape:'\n      <path d="M7.5,15C3.4,15,0,11.6,0,7.5C0,3.4,3.4,0,7.5,0C11.6,0,15,3.4,15,7.5C15,11.6,11.6,15,7.5,15z"/>\n\t\t\t<path d="M11.6,7.1C11.6,7.1,11.6,7.1,11.6,7.1c0.1,0.1,0.2,0.2,0.2,0.4c0,0.1-0.1,0.2-0.1,0.3c0,0,0,0,0,0 c0,0-3.5,3-3.5,3c-0.2,0.2-0.5,0.2-0.7,0c-0.2-0.2-0.2-0.5,0-0.7L9.9,8H3.7C3.5,8,3.2,7.8,3.2,7.5C3.2,7.2,3.5,7,3.7,7h6.2 L7.4,4.8c-0.2-0.2-0.2-0.5,0-0.7C7.6,4,7.9,4,8.1,4.1L11.6,7.1z"/>\n      '},search:{viewBox:"0 0 60 60",shape:'\n      <path d="M55.146,51.887L41.588,37.786c3.486-4.144,5.396-9.358,5.396-14.786c0-12.682-10.318-23-23-23s-23,10.318-23,23\n        s10.318,23,23,23c4.761,0,9.298-1.436,13.177-4.162l13.661,14.208c0.571,0.593,1.339,0.92,2.162,0.92\n        c0.779,0,1.518-0.297,2.079-0.837C56.255,54.982,56.293,53.08,55.146,51.887z M23.984,6c9.374,0,17,7.626,17,17s-7.626,17-17,17\n        s-17-7.626-17-17S14.61,6,23.984,6z"/>\n    '},"sq-dynamic":{viewBox:"0 0 40 40",shape:'\n      <path d="M20,35A15,15,0,1,0,5,20,15,15,0,0,0,20,35Zm0,5A20,20,0,1,1,40,20,20,20,0,0,1,20,40Z"/>\n      <path d="M16.67,16.67h6.67A3.33,3.33,0,0,1,26.67,20h0a3.33,3.33,0,0,1-3.33,3.33H16.67A3.33,3.33,0,0,1,13.33,20h0A3.33,3.33,0,0,1,16.67,16.67Z"/>\n      '},"ss-dynamic":{viewBox:"0 0 40 40",shape:'<path d="M36.24,40a3.73,3.73,0,0,1-2.65-1.1L27,32.27A17.63,17.63,0,1,1,32.27,27l6.62,6.63A3.76,3.76,0,0,1,36.25,40Zm-.64-3.11h0ZM17.53,4.67a12.86,12.86,0,1,0,6.91,23.67l2.37-1.52,1.53-2.38A12.82,12.82,0,0,0,17.53,4.67Z"/>'},star:{viewBox:"0 0 15 15",shape:'<path d="M 13.59873,5.1964432 11.001512,4.825412 C 10.352207,4.6398964 9.7956593,4.2688651 9.5173863,3.6195605 L 8.4042926,1.2078575 c -0.3710312,-0.83482022 -1.4841249,-0.83482022 -1.855156,0 L 5.4360429,3.6195605 C 5.1577694,4.2688651 4.6012227,4.6398964 3.951918,4.825412 L 1.3546995,5.1964432 C 0.61263702,5.289201 0.2416058,6.3095368 0.79815263,6.8660836 l 1.94791387,1.947914 c 0.463789,0.463789 0.6493046,1.1130935 0.5565469,1.7623984 l -0.4637891,2.782733 c -0.1855156,0.834821 0.7420624,1.484126 1.4841249,1.020337 l 2.2261874,-1.205852 c 0.5565467,-0.371032 1.2986092,-0.371032 1.9479139,0 l 2.2261875,1.205852 c 0.742062,0.37103 1.576883,-0.185516 1.484124,-1.020337 l -0.463788,-2.782733 c -0.09276,-0.6493049 0.09276,-1.2986094 0.556547,-1.7623984 l 1.947914,-1.947914 C 14.711823,6.3095368 14.340796,5.289201 13.59873,5.1964432"/>',style:function(t){return"empty"===t.type?Object(a.a)(l()):Object(a.a)(c())}},timer:{viewBox:"0 0 19.4 21.7",shape:'<path\n        d="M 7.3359375 -0.001953125 A 0.65 0.65 0 0 0 6.6992188 0.55078125 L 6.6992188 0.75 A 0.65 0.65 0 0 0 7.4003906 1.3007812 L 9.0507812 1.3007812 L 9.0507812 2.3300781 A 9.7 9.7 0 0 0 9.6992188 21.699219 A 9.7 9.7 0 0 0 19.400391 12 A 9.7 9.7 0 0 0 10.580078 2.3515625 L 10.580078 1.3007812 L 12 1.3007812 A 0.65 0.65 0 0 0 12.699219 0.75 L 12.699219 0.55078125 A 0.65 0.65 0 0 0 12 0 L 7.4003906 0 A 0.65 0.65 0 0 0 7.3359375 -0.001953125 z M 9.6992188 3.6992188 A 8.32 8.32 0 0 1 18 12 A 8.3 8.3 0 1 1 9.6992188 3.6992188 z M 9.6992188 6.1796875 A 0.65 0.65 0 0 0 9.0507812 6.8300781 L 9.0507812 12.089844 A 0.66 0.66 0 0 0 9 12.330078 L 9 12.560547 A 0.66 0.66 0 0 0 9.6992188 13.210938 L 14.050781 13.210938 A 0.59 0.59 0 0 0 14.619141 12.560547 L 14.650391 12.330078 A 0.66 0.66 0 0 0 14 11.679688 L 10.580078 11.679688 L 10.580078 6.8203125 A 0.65 0.65 0 0 0 9.9199219 6.1796875 L 9.6992188 6.1796875 z "\n      />'},top:{viewBox:"0 0 13 13",shape:'\n      <path d="M1.39285714,0.464285714 L11.6071429,0.464285714 C11.8635608,0.464285714 12.0714286,0.672153509 12.0714286,0.928571429 C12.0714286,1.18498935 11.8635608,1.39285714 11.6071429,1.39285714 L1.39285714,1.39285714 C1.13643922,1.39285714 0.928571429,1.18498935 0.928571429,0.928571429 C0.928571429,0.672153509 1.13643922,0.464285714 1.39285714,0.464285714 Z M6.96428571,3.71428571 L6.96428571,12.5357143 C6.96428571,12.7921322 6.75641792,13 6.5,13 C6.24358208,13 6.03571429,12.7921322 6.03571429,12.5357143 L6.03571429,3.71428571 C6.03571429,3.45786779 6.24358208,3.25 6.5,3.25 C6.75641792,3.25 6.96428571,3.45786779 6.96428571,3.71428571 Z"/>\n      <path d="M6.54124471,4.12719916 L0.885448102,9.78299577 C0.704133252,9.96431062 0.410163797,9.96431062 0.228848948,9.78299577 C0.047534098,9.60168092 0.047534098,9.30771147 0.228848948,9.12639662 L6.13824133,3.21700423 C6.24796441,3.10728116 6.39894263,3.06395724 6.54124471,3.08703248 C6.6835468,3.06395724 6.83452502,3.10728116 6.94424809,3.21700423 L12.8536405,9.12639662 C13.0349553,9.30771147 13.0349553,9.60168092 12.8536405,9.78299577 C12.6723256,9.96431062 12.3783562,9.96431062 12.1970413,9.78299577 L6.54124471,4.12719916 Z"/>\n      '},topic:{viewBox:"0 0 24 24",shape:'<path d="M14.2236009,16.5726304 L7.75711178,16.5726304 L6.55053795,22.2491139 C6.49312472,22.5192219 6.2276163,22.6916451 5.9575083,22.6342319 L5.4684345,22.530276 C5.1983265,22.4728628 5.02590332,22.2073544 5.08331655,21.9372464 L6.22360089,16.5726304 L1.5,16.5726304 C1.22385763,16.5726304 1,16.3487727 1,16.0726304 L1,15.5726304 C1,15.296488 1.22385763,15.0726304 1.5,15.0726304 L6.54243573,15.0726304 L7.92405338,8.57263036 L3.5,8.57263036 C3.22385763,8.57263036 3,8.34877274 3,8.07263036 L3,7.57263036 C3,7.29648799 3.22385763,7.07263036 3.5,7.07263036 L8.24288822,7.07263036 L9.44946205,1.39614679 C9.50687528,1.12603879 9.7723837,0.953615605 10.0424917,1.01102883 L10.5315655,1.11498468 C10.8016735,1.17239791 10.9740967,1.43790632 10.9166835,1.70801432 L9.77639911,7.07263036 L16.2428882,7.07263036 L17.4494621,1.39614679 C17.5068753,1.12603879 17.7723837,0.953615605 18.0424917,1.01102883 L18.5315655,1.11498468 C18.8016735,1.17239791 18.9740967,1.43790632 18.9166835,1.70801432 L17.7763991,7.07263036 L22.5,7.07263036 C22.7761424,7.07263036 23,7.29648799 23,7.57263036 L23,8.07263036 C23,8.34877274 22.7761424,8.57263036 22.5,8.57263036 L17.4575643,8.57263036 L16.0759466,15.0726304 L20.5,15.0726304 C20.7761424,15.0726304 21,15.296488 21,15.5726304 L21,16.0726304 C21,16.3487727 20.7761424,16.5726304 20.5,16.5726304 L15.7571118,16.5726304 L14.5505379,22.2491139 C14.4931247,22.5192219 14.2276163,22.6916451 13.9575083,22.6342319 L13.4684345,22.530276 C13.1983265,22.4728628 13.0259033,22.2073544 13.0833165,21.9372464 L14.2236009,16.5726304 Z M14.5424357,15.0726304 L15.9240534,8.57263036 L9.45756427,8.57263036 L8.07594662,15.0726304 L14.5424357,15.0726304 Z"/>'},"topic-add":{viewBox:"0 0 13 13",shape:'<path d="M6,6V.5a.5.5,0,0,1,1,0V6h5.5a.5.5,0,0,1,0,1H7v5.5a.5.5,0,0,1-1,0V7H.5a.5.5,0,0,1,0-1Z"/>'},"topic-cancel":{viewBox:"0 0 13 13",shape:'<path d="M7.17,6.5l4.69,4.69a.47.47,0,0,1-.67.67L6.5,7.17,1.81,11.86a.47.47,0,0,1-.67-.67L5.83,6.5,1.14,1.81a.47.47,0,0,1,.67-.67L6.5,5.83l4.69-4.69a.47.47,0,0,1,.67.67Z"/>'},trash:{viewBox:"0 0 16 16",shape:'<g fill-rule="nonzero">\n              <rect id="Rectangle" opacity="0" x="0" y="0" width="16" height="16"></rect>\n              <path d="M12.5146059,5.54590692 L12.5146059,12.5459069 C12.5146059,13.6504764 11.6191754,14.5459069 10.5146059,14.5459069 L5.51460589,14.5459069 C4.41003639,14.5459069 3.51460589,13.6504764 3.51460589,12.5459069 L3.51460589,5.54590692 L3.51460589,5.54590692" stroke-linecap="round" stroke-linejoin="round"></path>\n              <line x1="6" y1="1.85714286" x2="9.5" y2="1.85714286" id="Line" stroke-linecap="round" stroke-linejoin="round"></line>\n              <line x1="1.88309006" y1="3.6900534" x2="14.0338156" y2="3.6900534" stroke-linecap="round" stroke-linejoin="round"></line>\n              <line x1="5.71428571" y1="7.63739248" x2="5.71428571" y2="11.230495" stroke-linecap="round" stroke-linejoin="round"></line>\n              <line x1="8.01783774" y1="7.62825381" x2="8.01783774" y2="11.2213564" stroke-linecap="round" stroke-linejoin="round"></line>\n              <line x1="10.3396003" y1="7.63344062" x2="10.3396003" y2="11.2265432"  stroke-linecap="round" stroke-linejoin="round"></line>\n            </g>',style:function(){return Object(a.a)(s())}},transmit:{viewBox:"0 0 40 40",shape:'\n      <path d="M31.35,36.15H8.25A7.17,7.17,0,0,1,1,29.08V10.58A7.18,7.18,0,0,1,8.25,3.5h13v3h-13A4.17,4.17,0,0,0,4,10.58v18.5a4.17,4.17,0,0,0,4.25,4.08H31.35a4.17,4.17,0,0,0,4.25-4.07l0-8.89h3l0,8.9A7.17,7.17,0,0,1,31.35,36.15Z"/>\n      <path d="M15,23.64l-2.78-1.13.56-1.39C14.82,16.07,20.57,11,27.59,11h4L25.47,5l2.09-2.15L38.95,14H27.59c-5.63,0-10.4,4.27-12,8.3Z"/>\n    '},"triangle-left":{viewBox:"0 0 40 40",shape:'<path d="M32.2,1.3c0-1.1-1.3-1.7-2.1-1L8.2,19.7c-0.6,0.5-0.6,1.5,0,2L30,39.7c0.8,0.7,2.1,0.1,2.1-1 L32.2,1.3L32.2,1.3z M29.7,35.9L11,20.5L29.7,4.2V35.9z"/>'},"triangle-right":{viewBox:"0 0 40 40",shape:'<path  d="M29.1,20.6L10.4,36V4.2L29.1,20.6z M7.8,1.3v37.4c0,1.1,1.3,1.7,2.1,1l21.9-18.1 c0.6-0.5,0.6-1.4,0-2L10,0.3C9.2-0.4,7.8,0.2,7.8,1.3z"/>'},up:{viewBox:"0 0 12 10",shape:'\n    <path d="M11.1428571,7.91666667 C11.1428571,8.625 10.5857143,9.16666667 9.85714286,9.16666667 L2.14285714,9.16666667 C1.41428571,9.16666667 0.857142857,8.625 0.857142857,7.91666667 L0.857142857,2.08333333 C0.857142857,1.375 1.41428571,0.833333333 2.14285714,0.833333333 L9.85714286,0.833333333 C10.5857143,0.833333333 11.1428571,1.375 11.1428571,2.08333333 L11.1428571,7.91666667 Z M9.85714286,0 L2.14285714,0 C0.942857143,0 0,0.916666667 0,2.08333333 L0,7.91666667 C0,9.08333333 0.942857143,10 2.14285714,10 L9.85714286,10 C11.0571429,10 12,9.08333333 12,7.91666667 L12,2.08333333 C12,0.916666667 11.0571429,0 9.85714286,0 L9.85714286,0 Z"></path>\n    <path d="M8.48000004,4.91666667 L7.2371429,4.91666667 L7.2371429,3.33333333 L8.48000004,3.33333333 C8.90857147,3.33333333 9.29428576,3.5 9.29428576,4.125 C9.29428576,4.70833333 8.86571433,4.91666667 8.48000004,4.91666667 L8.48000004,4.91666667 Z M8.52285719,2.58333333 L6.42285719,2.58333333 L6.42285719,7.5 L7.2371429,7.5 L7.2371429,5.58333333 L8.52285719,5.58333333 C9.89428576,5.58333333 10.1514286,4.70833333 10.1514286,4.08333333 C10.1514286,3.5 9.89428576,2.58333333 8.52285719,2.58333333 L8.52285719,2.58333333 Z M4.92285714,5.41666667 C4.92285714,6.08333333 4.88,6.83333333 3.80857142,6.83333333 C2.73714285,6.83333333 2.69428571,6.08333333 2.69428571,5.41666667 L2.69428571,2.58333333 L1.88,2.58333333 L1.88,5.75 C1.88,7 2.56571428,7.58333333 3.76571428,7.58333333 C4.96571428,7.58333333 5.73714285,6.95833333 5.73714285,5.70833333 L5.73714285,2.58333333 L4.92285714,2.58333333 L4.92285714,5.41666667 Z"></path>\n    '},vote:{viewBox:"0 0 12 13",shape:'\n      <path d="M1.4,12C0.6,12,0,11.4,0,10.6V4.3c0-0.8,0.6-1.4,1.4-1.4s1.4,0.6,1.4,1.4v6.3C2.9,11.4,2.2,12,1.4,12z M1.4,4.1 c-0.1,0-0.2,0.1-0.2,0.2v6.3c0,0.3,0.5,0.3,0.5,0V4.3C1.7,4.2,1.6,4.1,1.4,4.1z"/>\n      <path d="M6,12c-0.8,0-1.4-0.6-1.4-1.4V1.4C4.6,0.6,5.2,0,6,0s1.4,0.6,1.4,1.4v9.1C7.4,11.4,6.8,12,6,12z M6,1.2 c-0.1,0-0.2,0.1-0.2,0.2v9.1c0,0.3,0.5,0.3,0.5,0V1.4C6.2,1.3,6.1,1.2,6,1.2z"/>\n      <path d="M10.6,12c-0.8,0-1.4-0.6-1.4-1.4V7.7c0-0.8,0.6-1.4,1.4-1.4c0.8,0,1.4,0.6,1.4,1.4v2.9C12,11.4,11.4,12,10.6,12z M10.6,7.5c-0.1,0-0.2,0.1-0.2,0.2v2.9c0,0.3,0.5,0.3,0.5,0V7.7C10.8,7.6,10.7,7.5,10.6,7.5z"/>\n      '},"vote-create":{viewBox:"0 0 22 22",shape:'\n      <rect x="0.7" y="5.7020752" width="3.6" height="14.5979248" rx="1.8"></rect>\n      <rect x="8.7" y="0.702075195" width="3.6" height="19.6" rx="1.8"></rect>\n      <rect x="16.7" y="11.7020752" width="3.6" height="8.6" rx="1.8"></rect>\n      ',style:function(){return Object(a.a)(r())}},before:{viewBox:"0 0 492 492",shape:'\n      <path d="M198.608,246.104L382.664,62.04c5.068-5.056,7.856-11.816,7.856-19.024c0-7.212-2.788-13.968-7.856-19.032l-16.128-16.12\n        C361.476,2.792,354.712,0,347.504,0s-13.964,2.792-19.028,7.864L109.328,227.008c-5.084,5.08-7.868,11.868-7.848,19.084\n        c-0.02,7.248,2.76,14.028,7.848,19.112l218.944,218.932c5.064,5.072,11.82,7.864,19.032,7.864c7.208,0,13.964-2.792,19.032-7.864\n        l16.124-16.12c10.492-10.492,10.492-27.572,0-38.06L198.608,246.104z"/>\n    '},next:{viewBox:"0 0 492 492",shape:'\n      <path d="M382.678,226.804L163.73,7.86C158.666,2.792,151.906,0,144.698,0s-13.968,2.792-19.032,7.86l-16.124,16.12\n        c-10.492,10.504-10.492,27.576,0,38.064L293.398,245.9l-184.06,184.06c-5.064,5.068-7.86,11.824-7.86,19.028\n        c0,7.212,2.796,13.968,7.86,19.04l16.124,16.116c5.068,5.068,11.824,7.86,19.032,7.86s13.968-2.792,19.032-7.86L382.678,265\n        c5.076-5.084,7.864-11.872,7.848-19.088C390.542,238.668,387.754,231.884,382.678,226.804z"/>\n    '},windmill:{viewBox:"0 0 24 24",shape:'\n      <path d="M12,1 C12.6032725,1 13.0923215,1.49015271 13.0923215,2.09478673 L13.0919415,7.34448672 C14.1405747,6.48008747 15.4863884,5.96064782 16.9538392,5.96064782 C20.299965,5.96064782 23.0136451,8.66144851 23.0136451,11.994424 C23.0136451,12.5976965 22.5234924,13.0867455 21.9188584,13.0867455 L21.9188584,13.0867455 L16.6490923,13.0860736 C17.5214136,14.1341909 18.0461608,15.4820004 18.0461608,16.9526066 C18.0461608,20.2931041 15.3385912,23 12,23 C11.3967275,23 10.9076785,22.5098473 10.9076785,21.9052133 L10.9076785,21.9052133 L10.9080585,16.6555133 C9.85942532,17.5199125 8.51361156,18.0393522 7.04616077,18.0393522 C3.70003499,18.0393522 0.986354862,15.3385515 0.986354862,12.005576 C0.986354862,11.4023035 1.47650758,10.9132545 2.08114159,10.9132545 L7.35090774,10.9139264 C6.47858642,9.86580905 5.95383923,8.51799956 5.95383923,7.04739336 C5.95383923,3.70689593 8.66140884,1 12,1 Z M13.0923215,13.2512833 L13.0923215,20.65393 C14.6933378,20.1831243 15.8615177,18.7037893 15.8615177,16.9526066 C15.8615177,15.2014239 14.6933378,13.7220889 13.0923215,13.2512833 L13.0923215,13.2512833 Z M10.7583198,13.0978976 L3.33400176,13.0978976 C3.80733493,14.6913696 5.28978206,15.8547091 7.04616077,15.8547091 C8.80253948,15.8547091 10.2849866,14.6913696 10.7583198,13.0978976 Z M16.9538392,8.14529092 C15.1974605,8.14529092 13.7150134,9.30863041 13.2416802,10.9021024 L13.2416802,10.9021024 L20.6659982,10.9021024 C20.1926651,9.30863041 18.7102179,8.14529092 16.9538392,8.14529092 Z M10.9076785,3.34607 C9.30666224,3.81687566 8.13848232,5.29621066 8.13848232,7.04739336 C8.13848232,8.79857607 9.30666224,10.2779111 10.9076785,10.7487167 L10.9076785,3.34607 Z" id="合并形状" fill-rule="nonzero"></path>\n    '}};function x(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n      fill: currentColor;\n      width: ",";\n      height: ",";\n    "]);return x=function(){return t},t}var k=Object({NODE_ENV:"production",BASE_URL:"/"}).HASH_SUFFIX||"0",O={name:"SVGIcon",props:{name:String,type:String,size:{type:String,default:""},singleInstance:{type:Boolean,default:!1},custom:Object},computed:{id:function(){return"".concat(this.name,"-").concat(k)},icon:function(){return this.custom?this.custom:I[this.name]}},created:function(){this.addDefs()},updated:function(){this.addDefs()},render:function(){var t=arguments[0],e=this.icon;if(!e)return t("svg",o()([{},this.$props]));var n=Object(a.a)(x(),this.size||"1em",this.size||"1em"),i=e.style?Object(a.b)(n,e.style(this.$props)):n;return this.singleInstance?t("svg",o()([{class:i},this.$props]),[t("use",{attrs:{href:"#".concat(this.id)}})]):t("svg",o()([{class:i},this.$props,{attrs:{viewBox:e.viewBox},domProps:{innerHTML:e.shape}}]))},methods:{addDefs:function(){if(this.singleInstance){var t=document.getElementById(this.id);if(!t){var e=document.getElementById("bp-svg-icons");e||((e=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.display="none",e.setAttribute("aria-hidden",!0),document.body.insertBefore(e,document.body.firstChild)),(t=document.createElementNS("http://www.w3.org/2000/svg","symbol")).id=this.id,this.icon&&this.icon.viewBox&&t.setAttribute("viewBox",this.icon&&this.icon.viewBox),t.innerHTML=this.icon.shape,e.appendChild(t)}}}}};e.a=O},,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},,,function(t,e,n){"use strict";n(25),n(13),n(84),n(45);e.a=function(t,e){e||(e=decodeURI(window.location.search.substring(1)));for(var n=e.substring(e.indexOf("?")+1).split("&"),i=0;i<n.length;i++){var o=n[i].split("=");if(o[0]===t)return o[1]}return""}},function(t,e,n){},function(t,e,n){},,,,function(t,e,n){"use strict";(function(t){n(15),n(14),n(34),n(28),n(38),n(33),n(36),n(80),n(81),n(46),n(48),n(13),n(12),n(24),n(32);var i=n(52),o=n(31);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c="undefined"==typeof window?t:window,l={},u={};function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;return'<img src="'.concat(e.replace(/^http:\/\//,"//"),'" alt="').concat(t,'" style="margin: -1px 1px 0 1px;display: inline-block; width: ').concat(n.width,"px; height: ").concat(n.height,"px; vertical-align: ").concat(n.verticalAlign||"baseline",';">')}i.a.allEmojiDataNew.map((function(t){t.purl&&""!==t.purl&&t.emojis&&t.emojis.length&&t.emojis&&t.emojis.length>0&&t.emojis.forEach((function(t){u[t.name]=t.url}))})),i.a.allEmojiDataOld.map((function(t){t.purl&&""!==t.purl&&t.emojis&&t.emojis.length&&t.emojis&&t.emojis.length>0&&t.emojis.forEach((function(t){l[t.name]=t.url}))})),e.a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i={};i=n||c.bp_emoji_data_v3||{},u=r(r({},u),Object(o.a)(i));var a={width:22,height:22};e=Object.assign(a,e);var s,f=new RegExp(/\[[^([.*?\])]+\]/g);return s=e.emojiType&&1===e.emojiType?u:l,t.replace(f,(function(t){return s[t]?d(t,s[t].url,e):u[t]?d(t,u[t].url,e):t}))}}).call(this,n(87))},function(t,e,n){"use strict";(function(t){n(15),n(14),n(34),n(28),n(38),n(33),n(36),n(80),n(81),n(46),n(48),n(13),n(12),n(24),n(239),n(32);var i=n(10),o=n.n(i),a=n(52),r=n(31),s=n(222);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d="undefined"==typeof window?t:window,f={},h={};a.a.allEmojiDataNew.map((function(t){t.purl&&""!==t.purl&&t.emojis&&t.emojis.length&&t.emojis&&t.emojis.length>0&&t.emojis.forEach((function(t){h[t.name]=t.url}))})),a.a.allEmojiDataOld.map((function(t){t.purl&&""!==t.purl&&t.emojis&&t.emojis.length&&t.emojis&&t.emojis.length>0&&t.emojis.forEach((function(t){f[t.name]=t.url}))})),e.a=o.a.component("renderJSX",{methods:{generateImageTag:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=this.$createElement,o=/\[(?:[^[\]]+)]/g.test(e)?s.a:e.replace(/^http:\/\//,"//");return i("img",{attrs:{src:o,contenteditable:"false",alt:t},style:"margin: -1px 1px 0 1px;display: inline-block; width: ".concat(n.width,"px; height: ").concat(n.height,"px; vertical-align: ").concat(n.verticalAlign||"baseline",";")})},renderEmoji:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=[],a={};a=n||d.bp_emoji_data_v3||{},h=l(l({},h),Object(r.a)(a));var s={width:22,height:22};e=Object.assign(s,e);var c,u=new RegExp(/\[[^([.*?\])]+\]/g);c=e.emojiType&&1===e.emojiType?h:f;var p=!0,m=0;do{var g=u.exec(t);if(g){if(g.index===m)o.push(this.pushItemCb(g,o,c,e,i));else{var v=t.substring(m,g.index);v&&o.push(v),o.push(this.pushItemCb(g,o,c,e,i))}m=u.lastIndex}else{var b=t.substring(m);b&&o.push(b),p=!1}}while(p);return o},pushItemCb:function(t,e,n,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t[0]||"";if(o){var r={width:h[a]&&h[a].size>1?42:22,height:h[a]&&h[a].size>1?42:22};i=l(l({},i),r)}e.push(n[a]?this.generateImageTag(a,n[a].url,i):h[a]?this.generateImageTag(a,h[a].url,i):a)}}})}).call(this,n(87))},function(t,e,n){"use strict";e.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQBAMAAAB8P++eAAAAGFBMVEUAAACbm5ucnJybm5uioqKampqdnZ2bm5smdd9FAAAACHRSTlMAMxMkBisMHUGvwZcAAAI6SURBVEjH5ZZNc5swEIYpxuTaLSZcsdy6V8uuJ1fHxek1asLk6nQy9BrHbfn7lWRgJehuk8kx78HjRc+g1X5oCd68onWyQSuWdxsC3AFco3UJsCBACZChpQA+ECBo5a1xpo2EAW9b454BpbMWKaC33uHeZmf6MDFoTXDndBMQmuLeZufzgNIItITRZ/Sip604rkroKb25eProJ+8TkPq+8Zyj5AfpK7D6EmBwWSXOYXkthh6W5arRulSOlxjc9ELMH/qZKCoxs4snM6SCi6v7zsUJgTVZf7T/3lEvxDq6bpsDjHdMTb1v350GjIxnLZhwoGoLbvofUOpAvgw8AGQceECQbDf/RdIBY9FWlDDZQNd8MJp1lbKDdEmCW2lbDxsyR9CN08wtqYM1/jRxRhD7a+LV6NLNnLKru6bsmzOEqivuSwNiLg+93ox/nzyxIDigNJX8K3D0U/0DtE5l+15xS70yAEewRAQvkHwABsWAsw/7ICUKjDo3Yx4cm8Sc5SbijzyYmPSZjKoFC450P0ag6RByBJ0U4r2w0LCGxtjBbq7PseWyK5lCVsks4MF70NYUR5hbZtIFYzNeQjtj6Faw2tb56YcAGU39LuTblehr+krJnge+/jZD8NkXaVcde5oLu6t5TH8U+Msj4I4dyW5oxF7nDxsRh4Zsx30txLyqHoriqqp+CFEf1wqMMixhXrd4Ll7O5cvIr1ZOqRPkbxyXe+E/KgK7Qw7Hvahr841QljcrrfpJzIvgbesvU3h9j3HYce0AAAAASUVORK5CYII="},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABOSURBVChTY9j65PN/mdW3/zMsvIYXg9SA1DKAGIdffv1PCIDUgA0G6SYWgG0DEcxEYrgGYgFlGqy3PwBjfGzKNBADyNNAcsSRljQ+/wcAjBTh4g09x4UAAAAASUVORK5CYII="},function(t,e,n){"use strict";var i=n(10),o=n.n(i),a=n(39),r=n(43),s=n(19),c=(n(85),n(54),n(55),n(278),n(15),n(22),n(23),n(14),n(25),n(16),n(21),n(30),n(26),n(9),n(27),n(12),n(18),n(20),n(3)),l=n(1),u=n(5),d=(n(38),n(37),n(13),n(24),n(31));n(63),n(33);function f(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw a}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var m=function(t){var e="";if(!t)return e;switch(t.nodeName){case"IMG":e=t.alt||"";break;case"INPUT":e=t.value||"";break;case"A":if(!t.getAttribute)return e;var n=t.getAttribute("alt");e=n||(t.textContent||"");break;default:e=t.textContent||""}return e},g=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.div=e}var e,n,i;return e=t,(n=[{key:"getRange",value:function(){var t=window.getSelection();if(t&&!(t.rangeCount<1))return t.getRangeAt(t.rangeCount-1)}},{key:"getTextOffset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.getRange();if(!e)return 0;var n=t?e.startContainer:e.endContainer,i=t?e.startOffset:e.endOffset,o=0;if(n===this.div){var a,r=0,s=f(this.div.childNodes);try{for(s.s();!(a=s.n()).done;){var c=a.value,l=m(c).length;if(!(r<i))return o>0?o-1:0;o+=l,r+=1}}catch(t){s.e(t)}finally{s.f()}return o>0?o-1:0}var u,d=f(this.div.childNodes);try{for(d.s();!(u=d.n()).done;){var h=u.value;if(h===n||h.firstChild===n)return(o+=i)>0?o-1:0;o+=m(h).length}}catch(t){d.e(t)}finally{d.f()}return o>0?o-1:0}},{key:"setCaret",value:function(t){var e=t+1;try{var n=window.getSelection();if(!n)return;for(var i=0,o=0;o<this.div.childNodes.length;o++){var a=this.div.childNodes[o],r=m(a).length;if(!(r<e-i)){if(r===e-i){n.collapse(this.div,o+1);break}1===a.nodeType?a.firstChild&&a.firstChild.getAttribute&&"false"!==a.firstChild.getAttribute("contenteditable")?n.collapse(a.firstChild,e-i):e-i==0?n.collapse(this.div,o):n.collapse(this.div,o+1):n.collapse(a,e-i);break}i+=r}}catch(t){}}}])&&p(e.prototype,n),i&&p(e,i),t}(),v=(n(28),n(29),n(32),n(6)),b=n(42),y=n(221),_=n(4),C=n(91),w=o.a.component("renderHTML",{mixins:[y.a],props:{bus:{type:Object}},methods:{onVoteClick:function(){this.bus.$emit("vote-item-click")},onLotteryClick:function(){this.bus.$emit("lottery-item-click")},renderHTML:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(o){Object(C.a)(i).then((function(a){o(t.renderHTMLSync(e,n,i,a))})).catch((function(n){console.error(n),o(t.renderHTMLSync(e,void 0,i,null,!0))}))}))},renderHTMLSync:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,r=this.$createElement,s=[];if(a)return e.forEach((function(t){s.push(t.url||t.text||t.id)})),s;var c=n.verticalAlign,l=void 0===c?"text-bottom":c,u=n.width,d=void 0===u?20:u,f=n.height,h=void 0===f?20:f,p=n.extendCtrlJson,m=void 0===p?"":p,g=0,y=Object(v.e)(m).from;return y&&(g=y.emoji_type),e.forEach((function(e){var n="",a="",c=e.url||e.text||e.id||"";switch(e.type){case b.a.TYPE_STRING:s.push(t.renderEmoji(c,{width:d,height:h,verticalAlign:l,emojiType:g},o,i));break;case b.a.TYPE_LOTTERY:a=e.text,s.push(r("span",{class:"dynamic-link-hover-bg",on:{click:t.onLotteryClick},attrs:{contenteditable:"false"},style:"cursor:pointer;color:#00a1d6;"},[r("i",{class:"bp-svg-icon lottery-btn",attrs:{contenteditable:"false"},style:"position:relative;top:-2px;margin-left:2px;margin-right:2px;"}),a]));break;case b.a.TYPE_VOTE:a=e.text,s.push(r("span",{class:"dynamic-link-hover-bg",on:{click:t.onVoteClick},attrs:{contenteditable:"false"},style:"cursor:pointer;color:#00a1d6;"},[r("i",{class:"bp-svg-icon vote-btn",attrs:{contenteditable:"false"},style:"position:relative;top:-1px;margin-left:2px;margin-right:2px;"}),a]));break;case b.a.TYPE_AT:n="".concat(_.a.SPACE,"/").concat(e.id,"/dynamic"),s.push(r("a",{attrs:{href:n,target:"_blank",contenteditable:"false"},class:"dynamic-link-hover-bg",style:"cursor:pointer;color:#00a1d6;"},[c]));break;case b.a.TYPE_LINK_AV:case b.a.TYPE_LINK_BV:s.push(r("a",{attrs:{href:"".concat(_.a.MAIN,"/video/").concat(e.id),target:"_blank",contenteditable:"false"},class:"dynamic-link-hover-bg",style:"cursor:pointer;color:#00a1d6;"},[c]));break;case b.a.TYPE_LINK_CV:s.push(r("a",{attrs:{href:"".concat(_.a.MAIN,"/read/").concat(e.id),target:"_blank",contenteditable:"false"},class:"dynamic-link-hover-bg",style:"cursor:pointer;color:#00a1d6;"},[c]));break;case b.a.TYPE_LINK_VC:s.push(r("a",{attrs:{href:"".concat(_.a.VC,"/video/").concat(e.id),target:"_blank",contenteditable:"false"},class:"dynamic-link-hover-bg",style:"cursor:pointer;color:#00a1d6;"},[c]));break;default:s.push(c)}})),s}}}),I=o.a.component("CoreEditor",{props:{value:{type:String,default:function(){return""}},bus:{type:Object,default:function(){return new o.a}},pasteHandler:{type:Function},extendCtrlJson:{type:String,default:function(){return"{}"}},chatPanel:{type:Boolean,default:!1}},mixins:[w],data:function(){return{textContent:this.value,domText:this.value,caretStart:0,caretPos:0,cm:void 0,recordStack:[],recordLen:0,ris:[],componsionSelection:{start:0,end:0,ok:!1}}},computed:{text:{get:function(){return this.textContent.replace(/\r\n|\r/g,"\n").replace(/\n{2,}/g,"\n\n").replace(/^\n+/,"").replace(/^ +/,"")},set:function(t){this.textContent=t}}},watch:{text:function(t,e){t!==e&&(this.record(),this.emitTextUpdate(),this.emitDomTextUpdate(),this.updateRis(),this.chatPanel&&this.$emit("inputMessage",t))},extendCtrlJson:function(t,e){t!==e&&this.updateRis()},value:function(t){this.text!==t&&(this.text=t)},caretPos:function(t){this.bus.$emit("caret-change",t)}},render:function(){var t=arguments[0];return t("div",{ref:"editor",attrs:{id:"editor"}},["‍",this.ris.map((function(t){return t||""})),"‍"])},created:function(){this.initBus()},mounted:function(){var t=this.$refs.editor;t.contentEditable="true",/MSIE |Trident/.test(window.navigator.userAgent)&&document.execCommand("AutoUrlDetect",!1,!1),this.cm=new g(t),this.cm.setCaret(this.text.length),this.recordStack=[],this.recordLen=0,this.record(),t.addEventListener("keypress",this.onKeypress),t.addEventListener("keydown",this.onKeydown),t.addEventListener("cut",this.onCut),t.addEventListener("paste",this.onPaste),t.addEventListener("compositionstart",this.onCompositionstart),t.addEventListener("compositionupdate",(function(t){return t.preventDefault()})),t.addEventListener("compositionend",this.onCompositionend),t.addEventListener("input",this.onInput),t.addEventListener("dragstart",(function(t){return t.preventDefault()})),t.addEventListener("drop",(function(t){return t.preventDefault()})),t.value="",this.bus.$emit("editor-dom-change",t),this.updateRis()},updated:function(){this.cm.setCaret(this.caretPos),this.fixSafariShadowText(),this.scrollIntoView()},methods:{initBus:function(){this.bus.$on("delete",this.deleteText),this.bus.$on("insert",this.insertText),this.bus.$on("replace",this.replaceText),this.bus.$on("reset",this.onReset),this.bus.$on("text-update",this.onTextUpdate)},updateRis:function(){var t=this,e={extendCtrlJson:this.extendCtrlJson};Object(u.n)(this.text,e).then((function(n){t.renderHTML(n,e,t.chatPanel).then((function(e){t.ris=e,t.$nextTick(t.emitDomTextUpdate)}))}))},emitTextUpdate:function(){this.bus.$emit("text-update",this.text);var t=this.$refs.editor;t.value="‍".concat(this.text),t.dispatchEvent(new CustomEvent("input"))},emitDomTextUpdate:function(){this.$emit("dom-update",{text:m(this.$refs.editor).replace(/\n+$/g,"").replace("‍","")})},onReset:function(){this.text="",this.recordStack=[],this.recordLen=0},onTextUpdate:function(t){this.text=t},record:function(){this.recordLen<this.recordStack.length+1&&this.recordStack.push({text:this.text,textOffset:this.caretPos}),this.recordLen=this.recordStack.length},onKeypress:function(t){if(!(t.ctrlKey||t.altKey||t.metaKey||t.isComposing||0===t.charCode)){var e=t.key;switch(e){case"Spacebar":e=" ";break;case"Esc":e="Escape"}t.preventDefault(),t.stopPropagation();var n,i=this.cm.getTextOffset(!0),o=this.cm.getTextOffset();if("Enter"===e)n=this.text.slice(0,i)+"\n"+this.text.slice(o);else{var a=t.keyCode?String.fromCharCode(t.keyCode):e;n=this.text.slice(0,i)+a+this.text.slice(o)}this.caretPos=i+1,this.text=n}},onKeydown:function(t){if(this.chatPanel&&!t.shiftKey&&"Enter"===t.key)return this.$emit("enterText",t),void t.preventDefault();if((t.ctrlKey||t.metaKey)&&"z"===t.key){if(t.preventDefault(),this.recordStack.length<=1)return;this.recordStack.pop();var e=this.recordStack[this.recordStack.length-1];this.caretPos=e.textOffset||e.text.length,this.text=e.text}t.isComposing||"Delete"!==t.key||(t.preventDefault(),this.backspaceDelete(!0)),t.isComposing||"Backspace"!==t.key||(t.preventDefault(),this.backspaceDelete(!1))},backspaceDelete:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.cm.getTextOffset(!0),i=this.cm.getTextOffset(),o=this.cm.getRange();if(o){n>this.text.length&&(n=this.text.length),i>this.text.length&&(i=this.text.length);var a=function(n,i){var o=m(n).length;if(e){if(i+o>t.text.length)return;var a=t.text.slice(0,i)+t.text.slice(i+o);t.caretPos=i,t.text=a}else{if(i-o<0)return;var r=t.text.slice(0,i-o)+t.text.slice(i);t.caretPos=i-o,t.text=r}},r=function(){if(e){if(i>=t.text.length)return;var o=t.text.slice(0,i)+t.text.slice(i+1);t.caretPos=n,t.text=o}else{if(i<1)return;var a=t.text.slice(0,i-1)+t.text.slice(i);t.caretPos=i-1,t.text=a}};if(n!==i){var s=this.text.slice(0,n)+this.text.slice(i);this.caretPos=n,this.text=s}else if(i>0)if(o.endContainer===this.$refs.editor){var c=this.$refs.editor.childNodes[e?0:o.endOffset-1];1===c.nodeType?a(c,i):r()}else{var l=o.endContainer,u=l.previousSibling,d=l.nextSibling;l.parentNode!==this.$refs.editor&&(!e&&o.endOffset===m(l).length||e&&o.startOffset===m(l).length)?a(l.parentNode,e?n:i):!e&&u&&1===u.nodeType&&0===o.endOffset?a(u,i):e&&d&&1===d.nodeType&&0===o.startOffset?a(d,n):r()}else r()}},deleteText:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=this.cm.getTextOffset(!0),i=this.cm.getTextOffset();n>this.text.length&&(n=this.text.length),i>this.text.length&&(i=this.text.length),t=e>0?this.text.slice(0,n-e)+this.text.slice(i):this.text.slice(0,n)+this.text.slice(i-e),this.caretPos=n-e,this.text=t},onInput:function(t){if(t.preventDefault(),"insertText"===t.inputType&&!t.isComposing){var e=this.cm.getTextOffset(!0)-t.data.length,n=this.cm.getTextOffset()-t.data.length,i=this.text.slice(0,e)+t.data+this.text.slice(n);this.caretPos=e+t.data.length,this.text=i}this.emitDomTextUpdate()},onCompositionstart:function(){var t=this.cm.getTextOffset(!0),e=this.cm.getTextOffset();this.componsionSelection.start=t,this.componsionSelection.end=e,this.componsionSelection.ok=!0},onCompositionend:function(t){t.preventDefault();var e=this.componsionSelection.ok?this.componsionSelection.start:this.cm.getTextOffset(!0)-t.data.length,n=this.componsionSelection.ok?this.componsionSelection.end:this.cm.getTextOffset()-t.data.length;this.componsionSelection.ok=!1;var i=this.text.slice(0,e)+t.data+this.text.slice(n);this.caretPos=e+t.data.length,this.text=i},onCut:function(t){t.stopPropagation(),t.preventDefault();var e=t.clipboardData||window.clipboardData,n=this.cm.getTextOffset(!0),i=this.cm.getTextOffset();e.setData("text/plain",this.text.slice(n,i));var o=this.text.slice(0,n)+this.text.slice(i);this.caretPos=n,this.text=o},onPaste:function(t){if(this.pasteHandler&&"function"==typeof this.pasteHandler)this.pasteHandler(t,this.insertText);else{t.stopPropagation(),t.preventDefault();var e=t.clipboardData||window.clipboardData,n="".concat(e.getData("Text")," ").replace(/ +$/," ");this.insertText(Object(d.c)(n))}},insertText:function(t){var e=this.cm.getTextOffset(!0),n=this.cm.getTextOffset(),i=this.text.slice(0,e)+t+this.text.slice(n);this.caretPos=e+t.length,this.text=i},replaceText:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{oldStr:"",newStr:""},e=t.oldStr,n=t.newStr,i=this.text.replace(e,n);this.caretPos=0,this.text=i},fixSafariShadowText:function(){var t=this.$refs.editor.childNodes;if(!(t.length<2)){var e=t[t.length-1],n=t[t.length-2];3===e.nodeType&&3===n.nodeType&&e.nodeValue&&n.nodeValue&&e.parentNode.removeChild(e)}},scrollIntoView:function(){var t=this.cm.getRange();if(t){var e=t.getBoundingClientRect().top,n=this.$refs.editor,i=n.getBoundingClientRect().top,o=n.getBoundingClientRect().bottom;(e<i||e>o)&&(n.scrollTop=e-i)}}}}),x=n(162);function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=L(t);if(e){var o=L(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return j(this,n)}}function j(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(a,t);var e,n,i,o=T(a);function a(){var t;return O(this,a),(t=o.apply(this,arguments)).text="",t.domText="",t.extendCtrlJson=JSON.stringify({from:{emoji_type:1}}),t}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("text-update",(function(e){t.text=e})),this.bus.$on("extend-json-changed",(function(e){t.extendCtrlJson=e}))}},{key:"onDomUpdate",value:function(t){var e=t.text;this.domText=e}},{key:"handleEmptyAttachData",value:function(){this.bus.$emit("empty-attach-data"),this.bus.$emit("update-extension",{attach:null})}},{key:"showPlaceholder",get:function(){return!this.domText.length&&!this.text.length}},{key:"textLength",get:function(){return Object(u.g)(this.text)}}])&&S(e.prototype,n),i&&S(e,i),a}(l.c);Object(c.a)([Object(l.b)({type:String,default:function(){return"有什么想和大家分享的？"}})],A.prototype,"placeholder",void 0),Object(c.a)([Object(l.b)()],A.prototype,"bus",void 0),Object(c.a)([Object(l.b)(Function)],A.prototype,"pasteHandler",void 0),Object(c.a)([Object(l.b)()],A.prototype,"withScheduleBar",void 0),Object(c.a)([Object(l.b)({type:Number,default:function(){return 1e3}})],A.prototype,"maxLength",void 0),Object(c.a)([Object(l.b)({type:String,default:function(){return""}})],A.prototype,"editorStyle",void 0),Object(c.a)([Object(l.b)(Boolean)],A.prototype,"isPopupPanel",void 0),Object(c.a)([Object(l.b)()],A.prototype,"attachData",void 0);var E=A=Object(c.a)([Object(l.a)({name:"editor",components:{CoreEditor:I,ShopPanel:x.a}})],A),M=(n(279),n(2)),D=Object(M.a)(E,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"editor",class:{"placeholder-shown":t.showPlaceholder},attrs:{placeholder:t.placeholder}},[n("core-editor",{staticClass:"core-style",class:{"with-schedule-bar":t.withScheduleBar,"too-long":t.textLength>t.maxLength,"in-popup":t.isPopupPanel},style:t.editorStyle,attrs:{bus:t.bus,"paste-handler":t.pasteHandler,"extend-ctrl-json":t.extendCtrlJson},on:{"dom-update":t.onDomUpdate}})],1),n("div",{staticClass:"attach-card"},[t.attachData?n("shop-panel",{attrs:{"at-publish-panel":"true","shop-card-list":t.attachData,"is-repost":!1},on:{"empty-attach-data":t.handleEmptyAttachData}}):t._e()],1)])}),[],!1,null,"23e5f326",null).exports;n(83),n(51),n(45);function R(t){var e=t.path||t.composedPath&&t.composedPath();if(!e){e=[];for(var n=t.target;n!==document;)e.unshift(n),n=n.parentNode}return e}var B=n(223),N=n.n(B);function U(t,e,n){return(U=H()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&$(o,n.prototype),o}).apply(null,arguments)}function H(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function $(t,e){return($=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function z(t){return function(t){if(Array.isArray(t))return V(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return V(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var F={props:{date:{type:Date},min:{type:Date,required:!1},max:{type:Date,required:!1}},data:function(){return{weekDays:["日","一","二","三","四","五","六"],year:NaN,month:NaN,day:NaN,inputText:this.getFormatedDate(this.date),panelVisible:!1,dateIcon:N.a}},computed:{monthDays:function(){var t=new Date(this.year,this.month+1,0).getDate(),e=new Date(this.year,this.month);e.setDate(0);var n=e.getDay(),i=[];if(6!==n)for(var o=n;o>=0;o--)i.push(" ");for(var a=1;a<=t;a++)i.push(a);return i}},watch:{date:function(t){this.inputText=this.getFormatedDate(t)}},created:function(){var t=this.date;t||(t=new Date),this.year=t.getFullYear(),this.month=t.getMonth(),this.day=t.getDate()},methods:{commit:function(t){this.min&&t<this.min?this.$emit("change",new Date(this.min)):this.max&&t>this.max?this.$emit("change",new Date(this.max)):this.$emit("change",t)},setDate:function(t){if(!this.isDisabled(t)){this.day=t;var e=new Date(this.year,this.month,t);this.inputText=this.getFormatedDate(e),this.panelVisible=!1,this.$refs.dateInput.firstChild.blur(),this.commit(e)}},changeMonth:function(t){this.month+t<0?(this.year-=1,this.month=12+this.month+t):this.month+t>11?(this.year+=1,this.month=this.month+t-12):this.month+=t},isSelected:function(t){return this.date&&this.year===this.date.getFullYear()&&this.month===this.date.getMonth()&&t===this.date.getDate()},isDisabled:function(t){return!(!this.min&&!this.max)&&(!(!this.min||!(this.min.getFullYear()>this.year||this.min.getFullYear()===this.year&&this.min.getMonth()>this.month||this.min.getFullYear()===this.year&&this.min.getMonth()===this.month&&this.min.getDate()>t))||!(!this.max||!(this.max.getFullYear()<this.year||this.max.getFullYear()===this.year&&this.max.getMonth()<this.month||this.max.getFullYear()===this.year&&this.max.getMonth()===this.month&&this.max.getDate()<t)))},handleBulr:function(){var t=this.inputText.split("-").slice(0,3);t[1]-=1;var e=U(Date,z(t));Number.isNaN(e.getTime())||this.date&&e.getTime()===this.date.getTime()?this.inputText=this.getFormatedDate(this.date):this.commit(e)},handleEnter:function(t){"Enter"===t.key&&t.target.blur()},showPanel:function(t){var e=this,n=R(t);n.some((function(t){return t===e.$refs.dateInput}))&&!n.some((function(t){return t===e.$refs.datePanel}))&&!1===this.panelVisible&&(this.panelVisible=!0,this.closeHandler=this.handleClickOutside(this.$refs.dateInput),window.addEventListener("click",this.closeHandler))},handleClickOutside:function(t){var e=this;return function(n){R(n).some((function(e){return e===t}))||(e.panelVisible=!1,window.removeEventListener("click",e.closeHandler),e.closeHandler=void 0)}},getFormatedDate:function(t){if(t&&!Number.isNaN(t.getTime())){var e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return"".concat(e,"-").concat(n,"-").concat(i)}return""}}},W=(n(280),Object(M.a)(F,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"dateInput",staticClass:"date-input",on:{click:t.showPanel}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.inputText,expression:"inputText"}],class:{active:t.panelVisible},attrs:{placeholder:"选择日期"},domProps:{value:t.inputText},on:{blur:t.handleBulr,keyup:t.handleEnter,input:function(e){e.target.composing||(t.inputText=e.target.value)}}}),n("img",{attrs:{src:t.dateIcon}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.panelVisible,expression:"panelVisible"}],ref:"datePanel",staticClass:"date-panel"},[n("div",{staticClass:"ym"},[n("button",{on:{click:function(e){return t.changeMonth(-1)}}},[n("span",{staticClass:"arrow left"})]),n("span",[t._v(t._s(t.year+"年 "+(t.month+1)+"月"))]),n("button",{on:{click:function(e){return t.changeMonth(1)}}},[n("span",{staticClass:"arrow right"})])]),n("div",{staticClass:"md"},[n("div",{staticClass:"week"},t._l(t.weekDays,(function(e){return n("span",{key:e,domProps:{textContent:t._s(e)}})})),0),n("div",{staticClass:"days"},t._l(t.monthDays,(function(e,i){return n("div",{key:i,staticClass:"day",class:{active:t.isSelected(e),disabled:t.isDisabled(e)},domProps:{textContent:t._s(e)},on:{click:function(n){return t.setDate(e)}}})})),0)])])])}),[],!1,null,"c2aeee6e",null).exports),G={model:{prop:"value",event:"change"},props:{value:{type:Number},label:{type:String,default:"时"},min:{type:Number,default:0},max:{type:Number,default:23}},data:function(){return{currentValue:this.value,panelVisible:!1}},computed:{isActive:function(){return this.panelVisible||this.$refs.sInput&&this.$refs.sInput===document.activeElement},range:function(){for(var t=[],e=this.min;e<=this.max;e++)t.push(e);return t},scrollBarLength:function(){return"".concat(32400/(30*this.range.length),"px")}},watch:{value:function(t){t!==this.currentValue&&(this.currentValue=t)},currentValue:function(t,e){this.commit()}},methods:{showPanel:function(t){var e=this,n=R(t);n.some((function(t){return t===e.$refs.sInput}))&&!n.some((function(t){return t===e.$refs.sPanel}))&&!1===this.panelVisible&&(this.panelVisible=!0,this.closeHandler=this.handleClickOutside(this.$refs.sInput),window.addEventListener("click",this.closeHandler))},select:function(t){this.panelVisible=!1,this.currentValue=t,this.commit()},handleBlur:function(t){this.handleChange(t),this.commit()},handleEnter:function(t){"Enter"===t.key&&this.$refs.sInput.firstChild.blur()},handleChange:function(t){var e=parseInt(t.target.value);e!==this.currentValue&&(Number.isNaN(e)?t.target.value=void 0===this.value?null:this.value:this.currentValue=e)},commit:function(){if(this.isActive||(this.panelVisible=!1),this.currentValue<this.min)throw new Error("value ".concat(this.currentValue," lt min ").concat(this.min));if(this.currentValue>this.max)throw new Error("value ".concat(this.currentValue," gt max ").concat(this.max));this.value!==this.currentValue&&this.$emit("change",this.currentValue)},handleClickOutside:function(t){var e=this;return function(n){R(n).some((function(e){return e===t}))||(e.panelVisible=!1,window.removeEventListener("click",e.closeHandler),e.closeHandler=void 0)}}}},J=(n(281),{name:"DatePicker",components:{DateInput:W,ScrollInput:Object(M.a)(G,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"sInput",staticClass:"scroll-input",class:{active:t.isActive}},[n("input",{staticClass:"s-input",attrs:{type:"number"},domProps:{value:t.currentValue},on:{click:t.showPanel,blur:t.handleBlur,keyup:t.handleEnter,change:t.handleChange}}),n("span",{staticClass:"arrow-down",class:{active:t.panelVisible}}),n("span",{staticClass:"s-label",domProps:{textContent:t._s(t.label)}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.panelVisible,expression:"panelVisible"}],ref:"sPanel",staticClass:"s-panel"},t._l(t.range,(function(e){return n("div",{key:e,staticClass:"s-item",class:{active:e===t.value},domProps:{textContent:t._s(e)},on:{click:function(n){return t.select(e)}}})})),0)])}),[],!1,null,"4ea87ec1",null).exports},props:{value:{type:[Date,String],required:!1},min:{type:Date,required:!1},max:{type:Date,required:!1},withTime:{type:Boolean,default:!0}},data:function(){return{date:void 0,hour:void 0,minute:void 0,minHour:0,maxHour:23,minMinute:0,maxMinute:59}},watch:{value:function(t){t?(this.checkLimit(t),this.date=t,this.hour=this.date.getHours(),this.minute=this.date.getMinutes()):(this.date=void 0,this.hour=void 0,this.minute=void 0),this.computeLimit()}},created:function(){this.value&&(this.checkLimit(this.value),this.date=new Date(this.value),this.hour=this.date.getHours(),this.minute=this.date.getMinutes(),this.computeLimit())},methods:{commit:function(){if(void 0!==this.date&&!Number.isNaN(this.date.getTime())){var t,e=this.date.getFullYear(),n=this.date.getMonth(),i=this.date.getDate();if(this.withTime){if(void 0===this.hour||Number.isNaN(this.hour)||void 0===this.minute||Number.isNaN(this.minute))return;t=new Date(e,n,i,this.hour,this.minute)}else t=new Date(e,n,i,0,0);this.checkLimit(t),(!this.value||Math.abs(new Date(this.value).getTime()-t.getTime())/6e4>=.1)&&this.$emit("input",new Date(t))}},computeLimit:function(){if(this.min&&this.date&&this.min.getFullYear()===this.date.getFullYear()&&this.min.getMonth()===this.date.getMonth()&&this.min.getDate()===this.date.getDate()){var t=this.min.getHours();this.hour<t&&(this.hour=t),this.minHour=t}else this.minHour=0;if(this.max&&this.date&&this.max.getFullYear()===this.date.getFullYear()&&this.max.getMonth()===this.date.getMonth()&&this.max.getDate()===this.date.getDate()){var e=this.max.getHours();this.hour>e&&(this.hour=e),this.maxHour=e}else this.maxHour=23;if(this.min&&this.min.getDate()===(this.date&&this.date.getDate())&&this.min.getHours()===this.hour){var n=this.min.getMinutes();this.minute<n&&(this.minute=n),this.minMinute=n}else this.minMinute=0;if(this.max&&this.max.getDate()===(this.date&&this.date.getDate())&&this.max.getHours()===this.hour){var i=this.max.getMinutes();this.minute>i&&(this.minute=i),this.maxMinute=i}else this.maxMinute=59},handleDateChange:function(t){this.date=t,this.computeLimit(),this.commit()},handleHourChange:function(t){this.hour=t,this.computeLimit(),this.commit()},handleMinuteChange:function(t){this.minute=t,this.computeLimit(),this.commit()},checkLimit:function(t){if(this.min&&(this.min.setSeconds(0),this.min.setMilliseconds(0),t<this.min))throw new Error("DatePicker: value ".concat(t," less then min limit ").concat(this.min));if(this.max&&(this.max.setSeconds(59),this.max.setMilliseconds(999),t>this.max))throw new Error("DatePicker: value ".concat(t," greater then max limit ").concat(this.max))}}}),K=(n(282),Object(M.a)(J,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"date-picker"},[n("DateInput",{attrs:{date:t.date,min:t.min,max:t.max},on:{change:t.handleDateChange}}),t.withTime?n("ScrollInput",{attrs:{value:t.hour,label:"时",min:t.minHour,max:t.maxHour},on:{change:t.handleHourChange}}):t._e(),t.withTime?n("ScrollInput",{attrs:{value:t.minute,label:"分",min:t.minMinute,max:t.maxMinute},on:{change:t.handleMinuteChange}}):t._e()],1)}),[],!1,null,"8e11382e",null).exports),Y=o.a.component("DatePicker",K);function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function X(t,e){return(X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=nt(t);if(e){var o=nt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return et(this,n)}}function et(t,e){return!e||"object"!==q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nt(t){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var it=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(a,t);var e,n,i,o=tt(a);function a(){var t;return Z(this,a),(t=o.apply(this,arguments)).publishTime=new Date,t.currentTime=Date.now(),t.updateTimeInterval=0,t}return e=a,(n=[{key:"onPublishTimeChange",value:function(t){this.bus.$emit("schedule-time-update",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){var t=this;this.initBus(),this.updateTimeInterval=setInterval((function(){t.currentTime=Date.now()}),6e4)}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){clearInterval(this.updateTimeInterval)}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("schedule-time-update",(function(e){e&&t.publishTime&&e.getTime()!==t.publishTime.getTime()&&(t.publishTime=e)}))}}])&&Q(e.prototype,n),i&&Q(e,i),a}(l.c);Object(c.a)([Object(l.b)()],it.prototype,"bus",void 0),Object(c.a)([Object(l.d)("publishTime")],it.prototype,"onPublishTimeChange",null);var ot=it=Object(c.a)([Object(l.a)({name:"schedule-bar",components:{DatePicker:Y}})],it),at=(n(283),Object(M.a)(ot,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"transition-box"},[n("div",{staticClass:"schedule-bar"},[n("span",{staticClass:"dp-label"},[t._v("发布时间：")]),n("date-picker",{attrs:{min:new Date(t.currentTime),max:new Date(t.currentTime+1296e6)},model:{value:t.publishTime,callback:function(e){t.publishTime=e},expression:"publishTime"}})],1)])}),[],!1,null,"af5aaec4",null).exports),rt=n(11),st=n.n(rt),ct=(n(41),n(62));function lt(t){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ft(t,e){return(ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=mt(t);if(e){var o=mt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return pt(this,n)}}function pt(t,e){return!e||"object"!==lt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var gt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ft(t,e)}(a,t);var e,n,i,o=ht(a);function a(){var t;return ut(this,a),(t=o.apply(this,arguments)).field=null,t.topicName="",t.emojiBoxShown=!1,t}return e=a,(n=[{key:"onEmojiBoxShownChange",value:function(t){this.$emit("showUpdate",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("editor-dom-change",(function(e){t.inputElement=e}))}},{key:"triggerEmojiShow",value:function(){this.emojiBoxShown=!this.emojiBoxShown,this.emojiBoxShown&&this.inputElement.focus()}},{key:"emojiSelectHandler",value:function(t){this.bus.$emit("insert",t)}},{key:"onEmojiBoxClose",value:function(){this.emojiBoxShown=!1,this.inputElement.focus()}},{key:"frozenElements",get:function(){return[this.inputElement,this.$refs.btn]}}])&&dt(e.prototype,n),i&&dt(e,i),a}(l.c);Object(c.a)([Object(l.b)()],gt.prototype,"bus",void 0),Object(c.a)([Object(l.b)()],gt.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)(Boolean)],gt.prototype,"isPopupPanel",void 0),Object(c.a)([Object(l.b)(Boolean)],gt.prototype,"revert",void 0),Object(c.a)([Object(l.d)("emojiBoxShown")],gt.prototype,"onEmojiBoxShownChange",null);var vt=gt=Object(c.a)([Object(l.a)({name:"emoji",components:{EmojiBox:ct.a}})],gt),bt=(n(284),Object(M.a)(vt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-emoji-box-container"},[n("button",{ref:"btn",staticClass:"emoji-btn d-i-block bp-v-middle bp-icon-font icon-emoji-btn box-toggle",class:{active:t.emojiBoxShown},attrs:{title:"表情"},on:{click:t.triggerEmojiShow}}),t.emojiBoxShown?n("emoji-box",{staticClass:"bp-emoji-box",attrs:{revert:t.revert,field:t.field,"select-handler":t.emojiSelectHandler,"frozen-elements":t.frozenElements,"emoji-type":["kaomojis","dynamicEmojis"],"spm-type":t.topicName?"TAG":"MAIN","pub-type":t.isPopupPanel?"2":"1"},on:{close:t.onEmojiBoxClose}}):t._e()],1)}),[],!1,null,"24b8ccaa",null).exports),yt=(n(34),{props:{arrow:{type:Boolean,default:!1},width:{type:Number,default:300}},data:function(){return{}},methods:{onClose:function(t){this.$emit("close"),t.stopPropagation()}}}),_t=(n(285),Object(M.a)(yt,(function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"move-in"}},[e("div",{staticClass:"static-popup",class:{"bp-arrow":this.arrow},style:{width:this.width+"px"}},[e("div",{staticClass:"bp-icon-font icon-group-dynamic close-btn",attrs:{title:"放弃图片上传"},on:{click:this.onClose}}),e("div",{staticClass:"title"},[this._t("title")],2),e("div",{staticClass:"content-ctnr"},[this._t("default")],2)])])}),[],!1,null,"268b12ee",null).exports),Ct=(n(61),n(70),n(8)),wt={data:function(){return{isShow:!0}},props:{status:{type:String,default:""},errorText:{type:String,default:""},imgUrl:{type:String,default:""}},computed:{bgImg:function(){var t=Object(v.g)(Object(Ct.bfsImgLink)(this.imgUrl,80,80,{e:1,c:1}));return/\.gif$/.test(t)&&(t+="@1s.jpg"),t}}},It=(n(286),Object(M.a)(wt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload-status"},["loading"===t.status?n("div",{staticClass:"loading-wrapper"},[n("span",{staticClass:"loading"})]):t._e(),"error"===t.status?n("div",{staticClass:"error-wrapper b-box"},[n("span",{staticClass:"bp-svg-icon error"}),n("span",{staticClass:"reason",domProps:{textContent:t._s(t.errorText)}})]):t._e(),t.imgUrl?n("div",{staticClass:"success-wrapper bg-center bg-cover",style:{backgroundImage:"url("+t.bgImg+")"}}):t._e(),t._t("editBtn"),t._t("close")],2)}),[],!1,null,"29129d22",null).exports),xt=n(165),kt=n.n(xt);n(241);function Ot(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function St(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){Ot(a,i,o,r,s,"next",t)}function s(t){Ot(a,i,o,r,s,"throw",t)}r(void 0)}))}}function Pt(t){return new Promise((function(e){var n=new FileReader;n.onload=function(t){var n=new DataView(t.target.result);65496!==n.getUint16(0,!1)&&e(-2);for(var i=n.byteLength,o=2;o<i;){n.getUint16(o+2,!1)<=8&&e(-1);var a=n.getUint16(o,!1);if(o+=2,65505===a){1165519206!==n.getUint32(o+=2,!1)&&e(-1);var r=18761===n.getUint16(o+=6,!1);o+=n.getUint32(o+4,r);var s=n.getUint16(o,r);o+=2;for(var c=0;c<s;c++)274===n.getUint16(o+12*c,r)&&e(n.getUint16(o+12*c+8,r))}else{if(65280!=(65280&a))break;o+=n.getUint16(o,!1)}}e(-1)},n.readAsArrayBuffer(t)}))}function Tt(){return(Tt=St(st.a.mark((function t(e){var i,o,a,r,s,c,l,u;return st.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Pt(e);case 2:if(!((i=t.sent)<2||i>8)){t.next=5;break}return t.abrupt("return",e);case 5:return(o=new Image).src=window.URL?window.URL.createObjectURL(e):window.webkitURL.createObjectURL(e),t.next=9,new Promise((function(t){o.onload=function(){return t()}}));case 9:if(s=0,c=!1,[5,6,7,8].some((function(t){return t===i}))?(a=o.height,r=o.width):(a=o.width,r=o.height),[7,8].some((function(t){return t===i}))&&(s=1.5*Math.PI),[3,4].some((function(t){return t===i}))&&(s=Math.PI),[5,6].some((function(t){return t===i}))&&(s=.5*Math.PI),[2,4,5,7].some((function(t){return t===i}))&&(c=!0),l=document.createElement("canvas"),u=l.getContext("2d"),l.width=a,l.height=r,c&&(u.translate(a,0),u.scale(-1,1)),u.translate(a/2,r/2),u.rotate(s),u.drawImage(o,-o.width/2,-o.height/2),l.toBlob){t.next=27;break}return t.next=27,n.e(2).then(n.t.bind(null,588,7));case 27:return t.abrupt("return",new Promise((function(t){l.toBlob((function(e){return t(e)}),"image/jpeg")})));case 28:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var jt={data:function(){return{uid:"",localUploadList:[],gifMaxMByte:8,errorType:{common:"上传失败",mbyte:"文件大小请勿超过".concat(this.maxMByte,"M"),gifbype:"请上传小于".concat(8,"M的gif图"),size:"宽高均不得小于".concat(this.minWidth,"像素"),format:"仅支持JPG PNG GIF"},uploadBtnStyle:{}}},mounted:function(){var t=this;this.initBus(),this.setInitFiles(),new kt.a(this.$refs.uploadList,{filter:".close",draggable:".draggable",animation:500,onMove:function(t){return t.related&&t.related.className.indexOf("draggable")>=0},onEnd:function(e){t.localUploadList.splice(e.newIndex,0,t.localUploadList.splice(e.oldIndex,1)[0])}})},watch:{localUploadList:function(t){this.$emit("update",t)},draftPic:function(){this.setInitFiles()}},props:{bus:null,initFiles:{},draftPic:{type:Array,default:function(){return[]}},editStatus:{type:Boolean,default:!0},maxAmount:{type:Number,default:20},formatList:{type:Array,default:function(){return["jpg","jpeg","png","gif"]}},maxMByte:{type:Number,default:20},minWidth:{type:Number,default:10},minHeight:{type:Number,default:10}},components:{UploadStatus:It},methods:{initBus:function(){var t=this;this.bus.$on("emit-image-upload-click",this.emitClick),this.bus.$on("image-list-clear",(function(){t.localUploadList=[]}))},emitClick:function(){this.$refs.uploadInput.click()},setInitFiles:function(){this.localUploadList=this.localUploadList.concat(this.draftPic),this.initFiles.length>0&&(this.checkFilesAmount(this.initFiles),this.selectImage(this.initFiles))},selectImage:function(t){var e=this,n=Array.prototype.map.call(t,(function(){return{status:"loading",errorText:"",imgUrl:""}})),i=this.localUploadList.length;this.localUploadList=this.localUploadList.concat(n),this.localUploadList.length>this.maxAmount&&this.localUploadList.splice(this.maxAmount,this.localUploadList.length-this.maxAmount);for(var o=function(n,o){var a=t[n-i];e.checkFormat(a.type)||e.$set(e.localUploadList,n,{status:"error",errorText:e.errorType.format,id:e.randomNum()});var r=function(t){var i=new Image;i.src=URL.createObjectURL(t),i.onload=function(){var o=e.checkImage(a.type,a.size,i.width,i.height);o?e.$set(e.localUploadList,n,{status:"error",errorText:o,id:e.randomNum()}):e.uploadImage(t,n)}};["jpg","jpeg"].some((function(t){return a.type.indexOf(t)>-1}))?function(t){return Tt.apply(this,arguments)}(a).then((function(t){r(t)})):r(a)},a=i,r=this.localUploadList.length;a<r;a++)o(a)},uploadImage:function(t,e){var n=this,i=new FormData;i.append("file_up",t),i.append("biz","draw"),i.append("category","daily"),this.bpapi({url:"".concat(_.a.API_VC,"/api/v1/drawImage/upload"),method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}}).then((function(i){n.$set(n.localUploadList,e,{img_src:i.data.image_url,img_width:i.data.image_width,img_height:i.data.image_height,img_size:t.size/1024,id:n.randomNum()})}),(function(){n.$set(n.localUploadList,e,{status:"error",errorText:"上传失败",id:n.randomNum()})}))},clickSelect:function(t){var e=t.target||t.srcElement,n=e.files;this.checkFilesAmount(n),this.selectImage(n),e.value=""},dropSelect:function(t){t.stopPropagation(),t.preventDefault();var e=t.dataTransfer.files;this.checkFilesAmount(e),this.selectImage(e)},checkFilesAmount:function(t){this.localUploadList.length+t.length>this.maxAmount&&this.linkMsg(this.$refs.uploadBtn,"上传图片不得超过".concat(this.maxAmount,"张（￣∞￣）"),"caution")},dragover:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},checkImage:function(t,e,n,i){return this.checkFormat(t)?t.indexOf("gif")>-1&&Math.floor(e/1024/1024)>=this.gifMaxMByte?this.errorType.gifbype:Math.floor(e/1024/1024)>=this.maxMByte?this.errorType.mbyte:(n<this.minWidth||i<this.minHeight)&&this.errorType.size:this.errorType.format},checkFormat:function(t){for(var e=0,n=this.formatList.length;e<n;e++)if(t.indexOf(this.formatList[e])>-1)return!0},removeUploadItem:function(t){this.localUploadList.splice(t,1)},randomNum:function(){return Date.now()*Math.ceil(1e5*Math.random())}}},Lt=(n(287),Object(M.a)(jt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload-image-wrapper"},[n("div",{ref:"dropZone",staticClass:"upload-image",class:{center:!t.localUploadList.length},on:{dragover:t.dragover,drop:t.dropSelect}},[n("div",{ref:"uploadList",staticClass:"f-clear upload-list"},[t._l(t.localUploadList,(function(e,i){return n("upload-status",{key:e.id||e.img_src,staticClass:"draggable f-left",attrs:{status:e.status,"error-text":e.errorText,"img-url":e.img_src}},[n("span",{staticClass:"close pointer a-fade-in",attrs:{slot:"close"},on:{click:function(e){return t.removeUploadItem(i)}},slot:"close"},[n("i",{staticClass:"bp-icon-font icon-group-dynamic c-pointer"})])])})),n("div",{directives:[{name:"show",rawName:"v-show",value:t.localUploadList.length<parseInt(t.maxAmount),expression:"localUploadList.length < parseInt(maxAmount)"}],ref:"uploadBtn",staticClass:"f-left upload-btn b-box"},[n("input",{ref:"uploadInput",staticClass:"upload pointer",attrs:{type:"file",accept:"image/png, image/jpeg, image/jpg, image/gif",multiple:""},on:{change:t.clickSelect}}),n("i",{staticClass:"bp-icon-font icon-add pointer"})])],2)])])}),[],!1,null,"97be31ae",null).exports),At={props:{bus:null,initFiles:{},draftPic:{type:Array,default:function(){return[]}}},data:function(){return{imageList:[],selectedFiles:this.initFiles}},components:{StaticBox:_t,ImageUploader:Lt},methods:{updateImageList:function(t){this.imageList=t,this.$emit("update",t)},close:function(){this.$emit("close"),this.imageList=[],this.selectedFiles=[]}}},Et=(n(288),Object(M.a)(At,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("static-box",{staticClass:"upload-image-box",attrs:{width:290,arrow:!0},on:{close:t.close}},[n("span",{attrs:{slot:"title"},slot:"title"},[t._v("图片上传"),n("span",{staticClass:"d-i-block hint"},[t._v(t._s(t.imageList.length)+" / 9")])]),n("image-uploader",{attrs:{bus:t.bus,"max-amount":9,"init-files":t.selectedFiles,"draft-pic":t.draftPic},on:{update:t.updateImageList}})],1)}),[],!1,null,"2453fd06",null).exports),Mt=n(7),Dt=n(0);function Rt(t){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ut(t,e){return(Ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=zt(t);if(e){var o=zt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return $t(this,n)}}function $t(t,e){return!e||"object"!==Rt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ut(t,e)}(a,t);var e,n,i,o=Ht(a);function a(){var t;return Bt(this,a),(t=o.apply(this,arguments)).imageBoxShown=!1,t.selectedFiles=[],t.draftPic=[],t.imageList=[],t}return e=a,(n=[{key:"onImageListChange",value:function(t){this.bus.$emit("image-list-update",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){this.bus.$on("reset",this.onReset),this.bus.$on("image-draft-update",this.onImageDraftUpdate)}},{key:"onReset",value:function(){this.onImageBoxClose()}},{key:"triggerImageBoxShow",value:function(){this.imageBoxShown=!this.imageBoxShown,this.imageBoxShown&&(this.bus.$emit("emit-image-upload-click"),this.isPopupPanel?Object(Mt.d)(Dt.d.PUBLICH_PIC_2,""):Object(Mt.d)(Dt.d.PUBLICH_PIC_1,""))}},{key:"updateImageList",value:function(t){this.imageList=t}},{key:"onImageDraftUpdate",value:function(t){t.length>0&&(this.imageBoxShown=!0),this.draftPic=t}},{key:"onImageBoxClose",value:function(){this.bus.$emit("image-list-clear"),this.draftPic=[],this.imageList=[],this.selectedFiles=[],this.imageBoxShown=!1}},{key:"validDraftPic",get:function(){return this.draftPic.filter((function(t){return t&&void 0!==t.img_src}))}}])&&Nt(e.prototype,n),i&&Nt(e,i),a}(l.c);Object(c.a)([Object(l.b)()],Vt.prototype,"bus",void 0),Object(c.a)([Object(l.b)()],Vt.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)(Boolean)],Vt.prototype,"isPopupPanel",void 0),Object(c.a)([Object(l.d)("imageList")],Vt.prototype,"onImageListChange",null);var Ft=Vt=Object(c.a)([Object(l.a)({name:"image-box",components:{UploadImageBox:Et}})],Vt),Wt=(n(289),Object(M.a)(Ft,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"image-box"},[n("button",{staticClass:"d-i-block bp-v-middle bp-icon-font icon-pic-btn box-toggle",class:{active:t.imageBoxShown},attrs:{title:"上传图片"},on:{click:t.triggerImageBoxShow}}),n("div",{staticClass:"image-popup"},[n("upload-image-box",{directives:[{name:"show",rawName:"v-show",value:t.imageBoxShown,expression:"imageBoxShown"}],attrs:{bus:t.bus,"init-files":t.selectedFiles,"draft-pic":t.validDraftPic},on:{update:t.updateImageList,close:t.onImageBoxClose}})],1)])}),[],!1,null,"370500a3",null).exports),Gt=n(163);function Jt(t){return(Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function qt(t,e){return(qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Zt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Xt(t);if(e){var o=Xt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Qt(this,n)}}function Qt(t,e){return!e||"object"!==Jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xt(t){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var te=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qt(t,e)}(a,t);var e,n,i,o=Zt(a);function a(){var t;return Kt(this,a),(t=o.apply(this,arguments)).field=null,t.inputElement=null,t.atCount=0,t.unameToUid={},t.caretPos=0,t}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.debounceFetchNameToUid=Object(v.b)(this.fetchNameToUid,1),this.debounceAtHandler=Object(v.b)(this.atHandler,1),this.initBus()}},{key:"initBus",value:function(){var t=this;this.bus.$on("text-update",this.debounceAtHandler),this.bus.$on("editor-dom-change",(function(e){t.inputElement=e})),this.bus.$on("caret-change",(function(e){t.caretPos=e})),this.bus.$on("at-update",(function(e){t.atCount=e}))}},{key:"requestAt",value:function(t,e){var n=this;return new Promise((function(i,o){var a={uid:n.loginUid};e&&(a.keyword=e),n.bpapi({url:t,method:"get",data:a}).then(i).catch(o)}))}},{key:"atHandler",value:function(t){var e=/@[^\n\r\s@↵]{1,20}(?=\s)/g,n=[],i=!0;do{var o=e.exec(t);if(o){var a=o[0];oe(a)&&n.push({text:a,index:o.index})}else i=!1}while(i);this.debounceFetchNameToUid(n)}},{key:"generateCtrl",value:function(t){var e=this,n=[];t.forEach((function(t){e.unameToUid[t.text]&&n.push({location:t.index,type:1,length:t.text.length+1,data:String(e.unameToUid[t.text])})})),this.bus.$emit("update-ctrl",{at:n})}},{key:"fetchNameToUid",value:function(t){var e=this,n="",i={};t.forEach((function(t){e.unameToUid[t.text]||i[t.text]||(i[t.text]=!0,n+=",".concat(t.text.slice(1)))})),(n=n.replace(/^,/,""))?this.bpapi({method:"get",url:"".concat(_.a.API_VC,"/dynamic_mix/v1/dynamic_mix/name_to_uid"),data:{names:n,teenagers_mode:0}}).then((function(n){n.data&&n.data.uid_list&&n.data.uid_list.forEach((function(t){e.unameToUid["@".concat(t.name)]=t.uid})),e.generateCtrl(t)})).catch((function(n){console.error(n),e.generateCtrl(t)})):this.generateCtrl(t)}},{key:"triggerAtBoxShow",value:function(t){t.stopPropagation(),t.preventDefault(),this.bus.$emit("insert","@"),this.$refs.atPopup.try()}},{key:"selectHandler",value:function(t){var e=this,n=t.uid,i=t.uname,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.unameToUid["@".concat(i)]=n,this.bus.$emit("delete",o.length),setTimeout((function(){e.bus.$emit("insert","@".concat(i," ")),20===e.atCount&&e.linkMsg(e.inputElement,"最多支持@ 20位用户","caution")}),0)}},{key:"logHandler",value:function(){var t=this.isPopupPanel?Dt.d.PUBLISH_AT_LIST_SHOW_2:Dt.d.PUBLISH_AT_LIST_SHOW_1;Object(Mt.d)(t)}}])&&Yt(e.prototype,n),i&&Yt(e,i),a}(l.c);Object(c.a)([Object(l.b)()],te.prototype,"bus",void 0),Object(c.a)([Object(l.b)()],te.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)(Boolean)],te.prototype,"isPopupPanel",void 0),te=Object(c.a)([Object(l.a)({name:"at-box",components:{AtPopup:Gt.a}})],te);var ee,ne,ie,oe=function(t){var e=t.replace(/^@/,"");return!!e&&!/[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e)&&/^[^\n\r\s@↵]{1,20}$/.test(e)},ae=te,re=(n(290),Object(M.a)(ae,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"at-box"},[n("button",{staticClass:"d-i-block bp-v-middle bp-icon-font box-toggle at-icon",on:{click:t.triggerAtBoxShow}},[t._v("@\n  ")]),n("at-popup",{ref:"atPopup",attrs:{"input-el":t.inputElement,request:t.requestAt},on:{active:t.logHandler,select:function(e){var n=e.item,i=e.matchString;return t.selectHandler(n,i)}}})],1)}),[],!1,null,"9c0e8b8a",null).exports),se=(n(82),n(40),n(84),n(49),["boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"]),ce=function(t,e){(ee=document.getElementById(t.nodeName+"--mirror-div"))||((ee=document.createElement("div")).id=t.nodeName+"--mirror-div",document.body.appendChild(ee)),ie=ee.style,ne=getComputedStyle(t),ie.whiteSpace="pre-wrap","INPUT"!==t.nodeName&&(ie.wordWrap="break-word"),ie.position="absolute",ie.top=t.offsetTop+parseInt(ne.borderTopWidth)+"px",ie.left=t.offsetLeft+parseInt(ne.borderLeftWidth)+"px",ie.visibility="hidden",se.forEach((function(t){ie[t]=ne[t]})),navigator.userAgent.indexOf("Firefox")>-1?(ie.width=parseInt(ne.width)-2+"px",t.scrollHeight>parseInt(ne.height)&&(ie.overflowY="scroll")):ie.overflow="hidden",ee.textContent=t.value.substring(0,e),"INPUT"===t.nodeName&&(ee.textContent=ee.textContent.replace(/\s/g," "));var n=document.createElement("span");return n.textContent=t.value.substring(e)||".",ee.appendChild(n),{top:n.offsetTop+parseInt(ne.borderTopWidth)+parseInt(ne["line-height"])-t.scrollTop,left:n.offsetLeft+parseInt(ne.borderLeftWidth)}},le=/^ |\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]|@|\n| $/,ue={data:function(){return{isShow:!1,top:0,left:0,selectedIndex:0,topicList:[],mouseOverEnabled:!0,needHide:!1,isSafari:!1,isIE:!1}},props:{inputElm:{required:!0},buttonElm:{},clickButtonHandler:{type:Function,default:function(){}},selectHandler:{type:Function,default:function(){}},logHandler:{type:Function,default:function(){}},loginUid:{type:Number,default:0},emojiBoxShown:{type:Boolean,default:function(){return!1}}},computed:{topPx:function(){return this.top+"px"},leftPx:function(){return this.left+"px"},computedHeight:function(){return this.topicList.length>0?"150px":"30px"}},beforeMount:function(){var t=Object(v.d)();this.isIE=-1!==t.indexOf("IE"),this.isSafari=-1!==t.indexOf("Safari")},mounted:function(){this.initEvents(),this.debounceSearch=Object(v.b)(this.search,500),this.debounceEnableMouseOver=Object(v.b)(this.enableMouseOver,200)},watch:{emojiBoxShown:function(t){t&&(this.isShow=!1)}},methods:{onMousedown:function(t){(t||window.event).preventDefault()},onClickItem:function(t){var e=this,n=Object(u.e)(this.inputElm),i=(this.isIE?this.inputElm.value:this.inputElm.value.replace(/\n/g,"")).substring(0,n),o=i.lastIndexOf("#"),a=i.substring(o,n);this.selectHandler(t,a),this.hide(),this.topicList=[],this.inputElm.focus(),"TEXTAREA"===this.inputElm.tagName&&setTimeout((function(){var n=o+t.length+3;Object(u.p)(e.inputElm,n)}),0)},show:function(){this.emojiBoxShown||(this.isShow||(this.isShow=!0,this.selectedIndex=0),this.calculatePosition())},hide:function(){this.isShow=!1},updateView:function(){var t=Object(u.e)(this.inputElm,!1),e=this.inputElm.value.substring(t-33,t),n=e.lastIndexOf("#");if(~n){var i=e.substring(n+1);""!==i&&""===String(i).trim()||i.match(le)||" "===i.substring(0,1)?this.hide():(this.show(),this.debounceSearch(i))}else this.hide()},search:function(t){var e=this;""===t?this.loginUid?this.bpapi({url:"".concat(_.a.API_VC,"/topic_svr/v1/topic_svr/get_rcmd_topic"),method:"get"}).then((function(t){if(0===t.code){var n=t.data.rcmds||[];Array.isArray(n)?e.topicList=n.slice(0,10).map((function(t){return t.topic_name})):e.topicList=[]}else e.topicList=[]}),(function(){e.topicList=[]})):this.topicList=[]:this.bpapi({url:"".concat(_.a.API_VC,"/dynamic_topic/v1/Topic/search"),method:"get",data:{s:t}}).then((function(t){if(0===t.code){var n=t.data.list||[];Array.isArray(n)?e.topicList=n.slice(0,10):e.topicList=[]}else e.topicList=[]}),(function(){e.topicList=[]}))},calculatePosition:function(){var t,e=Object(u.e)(this.inputElm),n=(this.isIE?this.inputElm.value:this.inputElm.value.replace(/\n/g,"")).substring(0,e).lastIndexOf("#");if(this.isIE||this.isSafari)t=ce(this.inputElm,n),this.left=t.left,this.top=t.top;else{var i=this.inputElm.getBoundingClientRect(),o=i.top,a=i.left,r=window.getSelection().getRangeAt(0);if(0===r.getClientRects().length){var s=this.inputElm.value,c=document.createTextNode(" ");r.insertNode(c),r.selectNode(c),t=r.getBoundingClientRect(),r.deleteContents(),r.collapse(!0),this.inputElm.value=s}else t=r.getBoundingClientRect();this.left=t.left-a,this.top=t.top+18-o}var l=parseFloat(getComputedStyle(this.inputElm,null).getPropertyValue("height").replace(/px/,""));(this.top>l+10||this.top<-20)&&(this.top=l+10),this.left<-20&&(this.left=0)},initEvents:function(){this.inputElm&&(this.inputElm.addEventListener("input",this.textInputHandler),this.inputElm.addEventListener("keydown",this.keyDownHandler),this.inputElm.addEventListener("keyup",this.keyUpHandler),this.inputElm.addEventListener("focus",this.focusHandler),this.inputElm.addEventListener("blur",this.blurHandler),this.inputElm.addEventListener("click",this.clickHandler)),this.buttonElm&&this.buttonElm.addEventListener("click",this.buttonClickHandler)},removeEvents:function(){this.inputElm.removeEventListener("input",this.textInputHandler),this.inputElm.removeEventListener("keydown",this.keyDownHandler),this.inputElm.removeEventListener("keyup",this.keyUpHandler),this.inputElm.removeEventListener("focus",this.focusHandler),this.inputElm.removeEventListener("blur",this.blurHandler),this.inputElm.removeEventListener("click",this.clickHandler),this.buttonElm&&this.buttonElm.removeEventListener("click",this.buttonClickHandler)},mouseOverHandler:function(t){this.mouseOverEnabled&&(this.selectedIndex=t)},textInputHandler:function(){var t=this;setTimeout((function(){t.updateView()}),0)},keyDownHandler:function(t){if(this.isShow)if(13===t.keyCode){var e=this.topicList[this.selectedIndex];e&&(this.onClickItem(e),t.preventDefault())}else 38===t.keyCode?(t.preventDefault(),this.pickUp()):40===t.keyCode&&(t.preventDefault(),this.pickDown())},keyUpHandler:function(t){t.keyCode>=37&&t.keyCode<=40?this.updateView():51===t.keyCode&&!0===t.shiftKey&&this.logHandler()},blurHandler:function(){var t=this;setTimeout((function(){t.needHide&&t.hide()}),300),this.needHide=!0},focusHandler:function(){setTimeout(this.updateView,0)},buttonClickHandler:function(){var t=this;this.needHide=!1,this.clickButtonHandler&&this.clickButtonHandler(),setTimeout((function(){t.clickHandler()}),100)},clickHandler:function(){this.updateView()},pickUp:function(){this.selectedIndex-1>=0?this.selectedIndex--:this.selectedIndex=this.topicList.length-1,this.updateListScrollTop()},pickDown:function(){this.selectedIndex+1<this.topicList.length?this.selectedIndex++:this.selectedIndex=0,this.updateListScrollTop()},updateListScrollTop:function(){if(this.$refs.topicList){var t=this.selectedIndex;24*t>this.$refs.topicList.scrollTop+96?(this.$refs.topicList.scrollTop=24*t-96,this.disableMouseOver()):24*t<this.$refs.topicList.scrollTop&&(this.$refs.topicList.scrollTop=24*t,this.disableMouseOver())}},disableMouseOver:function(){this.mouseOverEnabled=!1,this.debounceEnableMouseOver()},enableMouseOver:function(){this.mouseOverEnabled=!0}}},de=(n(291),Object(M.a)(ue,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"hash-popup bg-white",style:{top:t.topPx,left:t.leftPx,height:t.computedHeight}},[n("p",{staticClass:"hint ff-yahei fs-12 tc-slate ls-0 c-default"},[t._v("选择你想用的话题")]),t.topicList.length>0?n("div",{ref:"topicList",staticClass:"topic-container w-100"},t._l(t.topicList,(function(e,i){return n("a",{staticClass:"item ff-yahei fs-12 tc-black ls-0 d-block c-pointer",class:{"is-selected":i===t.selectedIndex},on:{mouseover:function(e){return t.mouseOverHandler(i)},mousedown:t.onMousedown,click:function(n){return t.onClickItem(e)}}},[t._v(t._s("#"+e+"#"))])})),0):t._e()])}),[],!1,null,"9f192432",null).exports);o.a.use(s.b);var fe=de;function he(t){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function me(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ge(t,e){return(ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ve(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ye(t);if(e){var o=ye(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return be(this,n)}}function be(t,e){return!e||"object"!==he(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _e=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ge(t,e)}(a,t);var e,n,i,o=ve(a);function a(){var t;return pe(this,a),(t=o.apply(this,arguments)).text="",t.field=null,t.inputElement=null,t.isMounted=!1,t.caretPos=0,t}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){this.isMounted=!0,this.buttonElement=this.$refs.button}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("text-update",(function(e){t.text=e})),this.bus.$on("editor-dom-change",(function(e){t.inputElement=e})),this.bus.$on("caret-change",(function(e){t.caretPos=e}))}},{key:"triggerTopicBoxShow",value:function(t){t.stopPropagation(),t.preventDefault(),this.bus.$emit("insert","#")}},{key:"selectHandler",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.bus.$emit("delete",n.length),"#"===this.text.substring(this.caretPos-1,this.caretPos)&&setTimeout((function(){e.bus.$emit("delete",-1)}),0),setTimeout((function(){e.bus.$emit("insert","#".concat(t,"# "))}),0)}},{key:"logHandler",value:function(){var t=this.isPopupPanel?Dt.d.PUBLISH_AT_LIST_SHOW_2:Dt.d.PUBLISH_AT_LIST_SHOW_1;Object(Mt.d)(t)}}])&&me(e.prototype,n),i&&me(e,i),a}(l.c);Object(c.a)([Object(l.b)()],_e.prototype,"bus",void 0),Object(c.a)([Object(l.b)()],_e.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)(Boolean)],_e.prototype,"isPopupPanel",void 0);var Ce=_e=Object(c.a)([Object(l.a)({name:"topic-box",components:{HashPopup:fe}})],_e),we=Object(M.a)(Ce,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic-box"},[n("button",{ref:"button",staticClass:"d-i-block bp-v-middle bp-icon-font icon-topic box-toggle",attrs:{title:"参与话题"},on:{click:t.triggerTopicBoxShow}}),t.isMounted?n("hash-popup",{attrs:{buttonElm:t.buttonElement,"input-elm":t.inputElement,"select-handler":t.selectHandler,"login-uid":t.loginUid,"log-handler":t.logHandler}}):t._e()],1)}),[],!1,null,"5a5dc85c",null).exports,Ie=(n(292),n(57));function xe(t){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Se(t,e){return(Se=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=je(t);if(e){var o=je(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Te(this,n)}}function Te(t,e){return!e||"object"!==xe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function je(t){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Le=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Se(t,e)}(a,t);var e,n,i,o=Pe(a);function a(){return ke(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}}])&&Oe(e.prototype,n),i&&Oe(e,i),a}(l.c),Ae=Le=Object(c.a)([Object(l.a)({name:"bp-add-button",components:{}})],Le),Ee=(n(293),Object(M.a)(Ae,(function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"bp-add-button",on:{click:this.onClick}},[e("i",{staticClass:"add-icon"}),this._t("default")],2)}),[],!1,null,"f69b0614",null).exports);function Me(t){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function De(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Re(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Be(t,e){return(Be=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ne(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=He(t);if(e){var o=He(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Ue(this,n)}}function Ue(t,e){return!e||"object"!==Me(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function He(t){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $e=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Be(t,e)}(a,t);var e,n,i,o=Ne(a);function a(){return De(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}},{key:"buttonClassArray",get:function(){var t=[];switch(this.status){case"active":t=t.concat(["active","no-border"])}return t}}])&&Re(e.prototype,n),i&&Re(e,i),a}(l.c);Object(c.a)([Object(l.b)(String)],$e.prototype,"status",void 0);var ze=$e=Object(c.a)([Object(l.a)({name:"bp-button",components:{}})],$e),Ve=(n(294),Object(M.a)(ze,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"bp-button",class:this.buttonClassArray,on:{click:this.onClick}},[this._t("default")],2)}),[],!1,null,"b26b5ce0",null).exports);function Fe(t){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function We(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ge(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Je(t,e){return(Je=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=qe(t);if(e){var o=qe(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Ye(this,n)}}function Ye(t,e){return!e||"object"!==Fe(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qe(t){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ze=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Je(t,e)}(a,t);var e,n,i,o=Ke(a);function a(){var t;return We(this,a),(t=o.apply(this,arguments)).isOnFocus=!1,t}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onInput",value:function(t){var e=t.target;this.$emit("input",e.value)}},{key:"onFocus",value:function(){this.isOnFocus=!0}},{key:"onBlur",value:function(){this.isOnFocus=!1}},{key:"currentlength",get:function(){return String(this.value).length||0}}])&&Ge(e.prototype,n),i&&Ge(e,i),a}(l.c);Object(c.a)([Object(l.b)({type:String,default:"text"})],Ze.prototype,"type",void 0),Object(c.a)([Object(l.b)([String,Number])],Ze.prototype,"maxlength",void 0),Object(c.a)([Object(l.b)([String,Number])],Ze.prototype,"value",void 0),Object(c.a)([Object(l.b)(String)],Ze.prototype,"placeholder",void 0);var Qe=Ze=Object(c.a)([Object(l.a)({name:"bp-input",components:{}})],Ze),Xe=(n(295),Object(M.a)(Qe,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"bp-input"},["textarea"===t.type?[n("div",{staticClass:"content-box textarea-box",class:{"on-focus":t.isOnFocus}},[n("textarea",{staticClass:"textarea",attrs:{placeholder:t.placeholder,maxlength:t.maxlength},domProps:{value:t.value},on:{input:t.onInput,focus:t.onFocus,blur:t.onBlur}}),n("div",{staticClass:"indicator"},[t._v(t._s(t.currentlength)+"/"+t._s(t.maxlength))])])]:t._e(),"textarea"!==t.type?[n("div",{staticClass:"content-box input-box",class:{"on-focus":t.isOnFocus}},[t._t("prefix"),n("input",{staticClass:"input",class:"input-"+t.type,attrs:{type:t.type,placeholder:t.placeholder,maxlength:t.maxlength},domProps:{value:t.value},on:{input:t.onInput,focus:t.onFocus,blur:t.onBlur}}),n("div",{staticClass:"indicator"},[t._v(t._s(t.currentlength)+"/"+t._s(t.maxlength))])],2),t._t("suffix")]:t._e()],2)}),[],!1,null,"793bb182",null).exports);function tn(t){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function en(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function on(t,e){return(on=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function an(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=sn(t);if(e){var o=sn(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return rn(this,n)}}function rn(t,e){return!e||"object"!==tn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sn(t){return(sn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&on(t,e)}(a,t);var e,n,i,o=an(a);function a(){return en(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}}])&&nn(e.prototype,n),i&&nn(e,i),a}(l.c);Object(c.a)([Object(l.b)(Boolean)],cn.prototype,"checked",void 0),Object(c.a)([Object(l.b)(String)],cn.prototype,"value",void 0),Object(c.a)([Object(l.b)(String)],cn.prototype,"name",void 0);var ln=cn=Object(c.a)([Object(l.a)({name:"bp-radio",components:{}})],cn),un=(n(296),Object(M.a)(ln,(function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"bp-radio",on:{click:this.onClick}},[e("div",{staticClass:"radio-icon",class:{checked:this.checked}}),e("input",{staticClass:"radio-input",attrs:{type:"radio",name:this.name},domProps:{value:this.value,checked:this.checked}}),this._t("default")],2)}),[],!1,null,"55c64c29",null).exports);function dn(t){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function pn(t,e){return(pn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=vn(t);if(e){var o=vn(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return gn(this,n)}}function gn(t,e){return!e||"object"!==dn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vn(t){return(vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pn(t,e)}(a,t);var e,n,i,o=mn(a);function a(){return fn(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"onValueChange",value:function(t){var e=t.target;this.$emit("input",e.value)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}}])&&hn(e.prototype,n),i&&hn(e,i),a}(l.c);Object(c.a)([Object(l.b)([String,Number])],bn.prototype,"value",void 0),Object(c.a)([Object(l.b)(Array)],bn.prototype,"options",void 0);var yn=bn=Object(c.a)([Object(l.a)({name:"bp-selector",components:{}})],bn),_n=(n(297),Object(M.a)(yn,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"bp-selector"},[n("select",{staticClass:"selector",domProps:{value:t.value},on:{change:t.onValueChange}},t._l(t.options,(function(e){return n("option",{key:e.value,domProps:{value:e.value}},[t._v(t._s(e.label)+"\n    ")])})),0),n("i",{staticClass:"more-icon"})])}),[],!1,null,"6aaa05f4",null).exports);function Cn(t){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function In(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function xn(t,e){return(xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Sn(t);if(e){var o=Sn(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return On(this,n)}}function On(t,e){return!e||"object"!==Cn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Sn(t){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xn(t,e)}(a,t);var e,n,i,o=kn(a);function a(){var t;return wn(this,a),(t=o.apply(this,arguments)).formatList=["jpg","jpeg","png"],t.maxMByte=20,t.minWidth=10,t.minHeight=10,t.errorType={mbyte:"图片大小请勿超过20M",size:"图片宽高均不得小于10像素",format:"仅支持JPG PNG格式的图片"},t}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"imageBoxUrl",value:function(){var t=this.url;return"string"==typeof t&&"loading"!==t&&"error"!==t?(t=Object(Ct.bfsImgLink)(t.replace(/^(https?:)|^(\/\/)/,""),56,56,{c:1}),"background-image: url(".concat(t,"); background-size: cover;")):""}},{key:"checkFormat",value:function(t){for(var e=0,n=this.formatList.length;e<n;e+=1)if(t.indexOf(this.formatList[e])>-1)return!0;return!1}},{key:"checkImage",value:function(t,e,n,i){return this.checkFormat(t)?Math.floor(e/1024/1024)>=this.maxMByte?this.errorType.mbyte:(n<this.minWidth||i<this.minHeight)&&this.errorType.size:this.errorType.format}},{key:"callFileDialog",value:function(){var t=this,e=document.createElement("input");e.type="file",e.accept="image/png, image/jpeg, image/jpg, image/gif",e.name="upload",e.addEventListener("change",(function(e){var n=e.target||e.srcElement,i=n&&n.files||[];if(i&&i.length>0){var o=i[0],a=t.checkImage(o.type,o.size,20,20);if(a)return void t.linkMsg(null,a,"error",!0,!0);var r=new Image;r.src=window.URL?window.URL.createObjectURL(o):window.webkitURL.createObjectURL(o),r.onload=function(){var e=t.checkImage(o.type,o.size,r.width,r.height);e?t.linkMsg(null,e,"error",!0,!0):(t.$emit("loading",{index:t.index}),t.uploadImage(i[0]).then((function(e){t.$emit("success",{index:t.index,bres:e})}),(function(e){t.$emit("fail",{index:t.index,berr:e})})))}}})),e.click(),window.upload_input=e,e=null}},{key:"uploadImage",value:function(t){var e=new FormData;return e.append("file_up",t),e.append("biz","draw"),e.append("category","daily"),this.bpapi({url:"//api.vc.bilibili.com/api/v1/drawImage/upload",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}}])&&In(e.prototype,n),i&&In(e,i),a}(l.c);Object(c.a)([Object(l.b)(Number)],Pn.prototype,"index",void 0),Object(c.a)([Object(l.b)(String)],Pn.prototype,"url",void 0);var Tn=Pn=Object(c.a)([Object(l.a)({name:"bp-upload",components:{}})],Pn),jn=(n(298),Object(M.a)(Tn,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-upload",on:{click:function(e){return t.callFileDialog(t.index)}}},[t.url?n("div",{staticClass:"image-box",class:t.url,style:t.imageBoxUrl(t.index)}):t._e(),t.url?t._e():n("div",{staticClass:"image-box"}),n("div",{staticClass:"bg-color"})])}),[],!1,null,"2be57f3e",null).exports);function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function An(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function En(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Mn(t,e){return(Mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Bn(t);if(e){var o=Bn(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Rn(this,n)}}function Rn(t,e){return!e||"object"!==Ln(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bn(t){return(Bn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Nn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mn(t,e)}(a,t);var e,n,i,o=Dn(a);function a(){return An(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}}])&&En(e.prototype,n),i&&En(e,i),a}(l.c),Un=Nn=Object(c.a)([Object(l.a)({name:"bp-title",components:{}})],Nn),Hn=(n(299),Object(M.a)(Un,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("div",{staticClass:"title-content"},[this._t("default")],2),e("div",{staticClass:"slot-right"},[this._t("right")],2)])}),[],!1,null,"47d56164",null).exports);var $n=function(t){var e="";return t.msg&&"非法请求"!==t.msg&&"电波无法到达~"!==t.msg&&(e=t.msg),e||{100:"诶呦，似乎你还没有登录呢",1e3:"诶呦，似乎你还不能发布投票呢"}[t.code]||"电波无法到达~ ".concat(t.code)};function zn(t){return(zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vn(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function Fn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Gn(t,e){return(Gn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Jn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Yn(t);if(e){var o=Yn(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Kn(this,n)}}function Kn(t,e){return!e||"object"!==zn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yn(t){return(Yn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gn(t,e)}(s,t);var e,n,i,o,a,r=Jn(s);function s(){var t;return Fn(this,s),(t=r.apply(this,arguments)).voteTitle="",t.typeList=[{name:"文字投票",value:"text"},{name:"图片投票",value:"image"}],t.type="text",t.optionsCount=2,t.optionsList=["",""],t.optionsImageList=["",""],t.moreConfigShow=!1,t.hasIntroduction=!1,t.introduction="",t.choiceCount="1",t.durationList=[{label:"三天",value:String(259200)},{label:"一周",value:String(604800)},{label:"一个月",value:String(2592e3)}],t.duration=String(604800),t.voteId="",t.errorList=[],t.defaultText="我发起了一个投票",t.canUploadIOS=!0,t.canUploadAndroid=!0,t.maxOptionsCount=20,t.maxTextLength=20,t}return e=s,(n=[{key:"onOptionsCountChange",value:function(t){"1"!==this.choiceCount&&parseInt(this.choiceCount,10)>t&&(this.choiceCount=String(t))}},{key:"onShowChange",value:function(t){t&&this.init()}},{key:"onConfigChange",value:function(){this.init()}},{key:"mounted",value:(o=st.a.mark((function t(){var e,n;return st.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.init(),t.next=3,Object(Ct.fetchLoginInfo)(!1);case 3:e=t.sent,"928123"!==(n=String(e.mid))&&"32708587"!==n&&"5552021"!==n||(this.maxOptionsCount=9999),this.$bpreport.pv({spmId:"444.41",logId:"000391",event:"poll_visit",data:{type:"web"}});case 7:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,e=arguments;return new Promise((function(n,i){var a=o.apply(t,e);function r(t){Vn(a,n,i,r,s,"next",t)}function s(t){Vn(a,n,i,r,s,"throw",t)}r(void 0)}))},function(){return a.apply(this,arguments)})},{key:"clear",value:function(){this.voteTitle="",this.typeList=[{name:"文字投票",value:"text"},{name:"图片投票",value:"image"}],this.type="text",this.optionsCount=2,this.optionsList=["",""],this.optionsImageList=["",""],this.moreConfigShow=!1,this.hasIntroduction=!1,this.introduction="",this.choiceCount="1",this.duration=String(604800),this.voteId="",this.errorList=[]}},{key:"init",value:function(){this.config&&this.config.vote_id?(this.voteId=this.config.vote_id,this.fetchConfig()):this.clear()}},{key:"getOptionsList",value:function(){var t=this;return this.optionsList.map((function(e,n){var i={desc:e.trim()};return"image"===t.type&&(i.img_url=t.optionsImageList[n]),i}))}},{key:"setErrorList",value:function(t){this.errorList=t}},{key:"setTypeValue",value:function(t){this.type=t.value}},{key:"addIntroduction",value:function(){this.hasIntroduction=!0}},{key:"addOption",value:function(){this.optionsCount+=1,this.optionsList.push(""),this.optionsImageList.push("")}},{key:"deletePrize",value:function(t){this.optionsCount>2&&(this.optionsCount-=1,this.optionsList.splice(t-1,1),this.optionsImageList.splice(t-1,1))}},{key:"showMoreConfig",value:function(){this.moreConfigShow=!0}},{key:"onImgLoading",value:function(t){var e=t.index;this.optionsImageList[e-1]="loading",this.$forceUpdate()}},{key:"onImgSuccess",value:function(t){var e=t.index,n=t.bres;this.optionsImageList[e-1]=n.data.image_url,this.$forceUpdate();var i=this.errorList;this.errorList=[],this.errorList=i}},{key:"onImgFail",value:function(t){var e=t.index,n=t.berr;this.optionsImageList[e-1]="error",this.$forceUpdate(),this.linkMsg(null,"".concat(n.msg," ").concat(n.code),"error",!0,!0)}},{key:"fetchConfig",value:function(){var t=this;this.bpapi({method:"get",url:"//api.vc.bilibili.com/vote_svr/v1/vote_svr/vote_info",data:{vote_id:this.voteId}}).then((function(e){var n=e.data.info,i=[],o=[];n.options.forEach((function(t){i[t.idx-1]=t.desc,1===n.type&&(o[t.idx-1]=t.img_url)})),t.optionsList=i,t.optionsImageList=o,t.voteTitle=n.title,n.desc&&(t.introduction=n.desc,t.hasIntroduction=!0),t.type=0===n.type?"text":"image",t.optionsCount=i.length,t.choiceCount=String(n.choice_cnt);var a=n.endtime-(new Date).getTime()/1e3,r=Math.floor(a/86400);t.duration=String(r<3?259200:r<7?604800:2592e3),t.moreConfigShow=!0,t.optionsList=i}),(function(e){var n=$n(e);t.linkMsg(null,n,"error",!0,!0)}))}},{key:"onSubmit",value:function(){if(this.$bpreport.pv({spmId:"444.41",logId:"000391",event:"dt_poll_submit",data:{from:"create_vote.".concat(this.from||"dynamic",".web")}}),this.isActive)this.apiSubmit();else{var t=this.errorList[0];this.linkMsg(null,t||"请检查您所填写的全部内容","success",!0,!0)}}},{key:"apiSubmit",value:function(){var t=this,e=this.getOptionsList(),n={title:this.voteTitle.trim(),desc:this.introduction,type:"text"===this.type?0:1,choice_cnt:this.choiceCount,duration:parseInt(this.duration,10),options:e},i="//api.vc.bilibili.com/vote_svr/v1/vote_svr/create_vote";this.voteId&&(i="//api.vc.bilibili.com/vote_svr/v1/vote_svr/update_vote",n.vote_id=this.voteId),this.bpapi({method:"post",url:i,data:{info:n},useBridgeProxy:!0}).then((function(e){t.callNative(e.data.vote_id)}),(function(e){var n=$n(e);t.linkMsg(null,n,"error",!0,!0)}))}},{key:"callNative",value:function(t){var e={vote_id:t,default_text:this.voteId?"":this.defaultText,title:this.voteTitle};this.postMessage(e)}},{key:"postMessage",value:function(t){this.$emit("vote-create",t)}},{key:"onCancel",value:function(){this.$emit("cancel")}},{key:"isActive",get:function(){var t=[],e=this.voteTitle.trim();e||t.push("请填写标题"),e.length>32&&t.push("标题请不要超过32个字"),this.introduction.length>100&&t.push("描述请不要超过100个字");for(var n=this.optionsImageList,i=Math.max(this.optionsCount,this.optionsImageList.length,this.optionsList.length),o=0;o<i;o+=1)"image"!==this.type||n[o]&&"loading"!==n[o]&&"error"!==n[o]||t.push("请上传图片"),this.optionsList[o].trim()||t.push("请填写完所有选项");return this.setErrorList(t),!(this.errorList.length>0)}},{key:"choiceCountList",get:function(){for(var t=[{label:"单选",value:"1"}],e=1;e<this.optionsCount;e+=1)t.push({label:"最多选".concat(e+1,"项"),value:String(e+1)});return t}},{key:"zIndexStyle",get:function(){return"z-index: ".concat(this.zIndex||2,";")}}])&&Wn(e.prototype,n),i&&Wn(e,i),s}(l.c);Object(c.a)([Object(l.b)(Number)],qn.prototype,"zIndex",void 0),Object(c.a)([Object(l.b)(Object)],qn.prototype,"config",void 0),Object(c.a)([Object(l.b)(Boolean)],qn.prototype,"show",void 0),Object(c.a)([Object(l.b)(String)],qn.prototype,"from",void 0),Object(c.a)([Object(l.d)("optionsCount")],qn.prototype,"onOptionsCountChange",null),Object(c.a)([Object(l.d)("show")],qn.prototype,"onShowChange",null),Object(c.a)([Object(l.d)("config")],qn.prototype,"onConfigChange",null);var Zn=qn=Object(c.a)([Object(l.a)({name:"create",components:{BpAddButton:Ee,BpButton:Ve,BpInput:Xe,BpRadio:un,BpSelector:_n,BpUpload:jn,BpTitle:Hn}})],qn),Qn=(n(300),Object(M.a)(Zn,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-vote-container"},[n("transition",{attrs:{name:"move-in"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"create-vote",style:t.zIndexStyle},[n("div",{staticClass:"main-content"},[n("div",{staticClass:"group"},[n("bp-title",[t._v("投票标题")]),n("bp-input",{attrs:{placeholder:"请填写标题",maxlength:"32","data-model":"voteTitle"},model:{value:t.voteTitle,callback:function(e){t.voteTitle=e},expression:"voteTitle"}}),t.hasIntroduction?t._e():n("bp-add-button",{on:{click:t.addIntroduction}},[t._v("添加说明\n          ")]),t.hasIntroduction?n("bp-title",[t._v("投票说明")]):t._e(),t.hasIntroduction?n("bp-input",{attrs:{type:"textarea",maxlength:"100",placeholder:"请填写投票说明(选填)","data-model":"introduction"},model:{value:t.introduction,callback:function(e){t.introduction=e},expression:"introduction"}}):t._e()],1),n("div",{staticClass:"group"},[n("bp-title",[n("span",[t._v("投票类型")]),t._l(t.typeList,(function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.type,value:e.value,name:"at-config"},on:{click:function(n){return t.setTypeValue(e)}},slot:"right"},[t._v("\n              "+t._s(e.name)+"\n            ")])}))],2)],1),n("div",{staticClass:"group"},[n("bp-title",[t._v("投票选项")]),t._l(t.optionsCount,(function(e){return n("bp-input",{key:e,attrs:{placeholder:"请填写选项内容"+e,type:"text",maxlength:t.maxTextLength,"data-model":"number"+(e-1)},model:{value:t.optionsList[e-1],callback:function(n){t.$set(t.optionsList,e-1,n)},expression:"optionsList[index - 1]"}},["image"===t.type?n("bp-upload",{attrs:{slot:"prefix",index:e,url:t.optionsImageList[e-1]},on:{loading:t.onImgLoading,success:t.onImgSuccess,fail:t.onImgFail},slot:"prefix"}):t._e(),t.optionsCount>2?n("div",{staticClass:"option-delete",attrs:{slot:"suffix"},on:{click:function(n){return n.preventDefault(),n.stopPropagation(),t.deletePrize(e)}},slot:"suffix"}):t._e()],1)})),t.optionsCount<t.maxOptionsCount?n("bp-add-button",{on:{click:t.addOption}},[t._v("添加选项\n          ")]):t._e()],2),n("div",{staticClass:"group"},[n("bp-title",[t._v("更多设置")]),n("bp-title",[n("span",[t._v("单选/多选")]),n("bp-selector",{attrs:{slot:"right",options:t.choiceCountList},slot:"right",model:{value:t.choiceCount,callback:function(e){t.choiceCount=e},expression:"choiceCount"}})],1),n("bp-title",[n("span",[t._v("投票时长")]),n("bp-selector",{attrs:{slot:"right",options:t.durationList},slot:"right",model:{value:t.duration,callback:function(e){t.duration=e},expression:"duration"}})],1)],1)]),n("div",{staticClass:"button-bar"},[n("bp-button",{on:{click:t.onCancel}},[t._v("取消")]),n("bp-button",{attrs:{status:t.isActive?"active":"disable"},on:{click:t.onSubmit}},[t._v(t._s(t.voteId?"更新投票":"发起投票")+"\n        ")])],1)])])],1)}),[],!1,null,"4b97839a",null).exports);o.a.use(Object(a.a)()),o.a.use(s.b),o.a.use(Ie.b,{click:{spmId:"444.41",logId:"000391"},pv:{spmId:"444.41",logId:"000391"}});var Xn=Qn;function ti(t){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ei(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ni(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ii(t,e){return(ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function oi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ri(t);if(e){var o=ri(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return ai(this,n)}}function ai(t,e){return!e||"object"!==ti(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ri(t){return(ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var si=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ii(t,e)}(a,t);var e,n,i,o=oi(a);function a(){var t;return ei(this,a),(t=o.apply(this,arguments)).text="",t.voteBoxShown=!1,t.voteConfig={},t}return e=a,(n=[{key:"onVoteIndexChanged",value:function(t){t<0?this.clearCtrl():this.updateCtrl()}},{key:"onLotteryBoxShown",value:function(t){this.bus.$emit("vote-trigger",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("text-update",(function(e){t.text=e})),this.bus.$on("vote-restore",this.restoreFromDraft),this.bus.$on("vote-item-click",(function(){t.voteBoxShown=!0}))}},{key:"triggerVoteBoxShow",value:function(){this.voteBoxShown=!0}},{key:"onVoteCreate",value:function(t){var e=this,n=t.default_text,i=t.title,o=t.vote_id,a=this.voteConfig.vote_id===o,r=this.voteConfig.title||"";if(this.voteConfig=t,this.onVoteCancel(),a)this.bus.$emit("replace",{oldStr:"​".concat(r),newStr:"​".concat(i)}),setTimeout((function(){e.updateCtrl()}));else{var s="".concat(n," ​").concat(i," ");this.bus.$emit("insert",s),setTimeout((function(){e.updateCtrl()}))}}},{key:"clearCtrl",value:function(){this.voteConfig={},this.onVoteCancel(),this.bus.$emit("update-ctrl",{vote:[]}),this.bus.$emit("update-extension",{vote:null})}},{key:"updateCtrl",value:function(){var t=[{data:String(this.voteConfig.title.length+1),length:0,location:this.voteIndex,type:3}],e={vote_id:this.voteConfig.vote_id,title:this.voteConfig.title};this.bus.$emit("update-ctrl",{vote:t}),this.bus.$emit("update-extension",{vote:e})}},{key:"onVoteCancel",value:function(){this.voteBoxShown=!1}},{key:"restoreFromDraft",value:function(t){var e=t.ctrl,n=t.extension;if(e&&n){var i=e.location+1,o=Number(e.data)-1,a=this.text.substring(i,i+o);this.voteConfig={vote_id:n.vote_id,title:a}}}},{key:"voteIndex",get:function(){return this.voteConfig.title?this.text.indexOf("​".concat(this.voteConfig.title)):-1}}])&&ni(e.prototype,n),i&&ni(e,i),a}(l.c);Object(c.a)([Object(l.b)()],si.prototype,"bus",void 0),Object(c.a)([Object(l.b)()],si.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)(Boolean)],si.prototype,"isPopupPanel",void 0),Object(c.a)([Object(l.d)("voteIndex")],si.prototype,"onVoteIndexChanged",null),Object(c.a)([Object(l.d)("voteBoxShown")],si.prototype,"onLotteryBoxShown",null);var ci=si=Object(c.a)([Object(l.a)({name:"vote-box",components:{Vote:Xn}})],si),li=(n(301),Object(M.a)(ci,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vote-box"},[e("button",{staticClass:"d-i-block bp-v-middle bp-icon-font vote-create-btn box-toggle",class:{active:this.voteBoxShown},attrs:{title:"发起投票"},on:{click:this.triggerVoteBoxShow}}),e("vote",{staticClass:"vote-popup",attrs:{show:this.voteBoxShown,config:this.voteConfig},on:{"vote-create":this.onVoteCreate,cancel:this.onVoteCancel}})],1)}),[],!1,null,"e47c66e2",null).exports);n(302);function ui(t){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function di(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function hi(t,e){return(hi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=gi(t);if(e){var o=gi(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return mi(this,n)}}function mi(t,e){return!e||"object"!==ui(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gi(t){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var vi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hi(t,e)}(a,t);var e,n,i,o=pi(a);function a(){return di(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}}])&&fi(e.prototype,n),i&&fi(e,i),a}(l.c),bi=vi=Object(c.a)([Object(l.a)({name:"bp-add-button",components:{}})],vi),yi=(n(303),Object(M.a)(bi,(function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"bp-add-button",on:{click:this.onClick}},[e("i",{staticClass:"add-icon"}),this._t("default")],2)}),[],!1,null,"da335d44",null).exports);function _i(t){return(_i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ci(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ii(t,e){return(Ii=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function xi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Oi(t);if(e){var o=Oi(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return ki(this,n)}}function ki(t,e){return!e||"object"!==_i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Oi(t){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Si=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ii(t,e)}(a,t);var e,n,i,o=xi(a);function a(){return Ci(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}},{key:"buttonClassArray",get:function(){var t=[];switch(this.status){case"active":t=t.concat(["active","no-border"])}return t}}])&&wi(e.prototype,n),i&&wi(e,i),a}(l.c);Object(c.a)([Object(l.b)(String)],Si.prototype,"status",void 0);var Pi=Si=Object(c.a)([Object(l.a)({name:"bp-button",components:{}})],Si),Ti=(n(304),Object(M.a)(Pi,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"bp-button",class:this.buttonClassArray,on:{click:this.onClick}},[this._t("default")],2)}),[],!1,null,"791cd12a",null).exports);function ji(t){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Li(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ai(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ei(t,e){return(Ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ri(t);if(e){var o=Ri(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Di(this,n)}}function Di(t,e){return!e||"object"!==ji(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ri(t){return(Ri=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ei(t,e)}(a,t);var e,n,i,o=Mi(a);function a(){var t;return Li(this,a),(t=o.apply(this,arguments)).isOnFocus=!1,t}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onInput",value:function(t){var e=t.target;this.$emit("input",e.value)}},{key:"onFocus",value:function(t){this.isOnFocus=!0,this.$emit("focus",t)}},{key:"onBlur",value:function(t){this.isOnFocus=!1,this.$emit("blur",t)}},{key:"onTextInput",value:function(t){this.$emit("textInput",t)}},{key:"onKeydown",value:function(t){this.$emit("keyDown",t)}},{key:"currentlength",get:function(){return String(this.value).length||0}}])&&Ai(e.prototype,n),i&&Ai(e,i),a}(l.c);Object(c.a)([Object(l.b)({type:String,default:"text"})],Bi.prototype,"type",void 0),Object(c.a)([Object(l.b)([String,Number])],Bi.prototype,"maxlength",void 0),Object(c.a)([Object(l.b)([String,Number])],Bi.prototype,"max",void 0),Object(c.a)([Object(l.b)([String,Number])],Bi.prototype,"value",void 0),Object(c.a)([Object(l.b)(String)],Bi.prototype,"placeholder",void 0);var Ni=Bi=Object(c.a)([Object(l.a)({name:"bp-input",components:{}})],Bi),Ui=(n(305),Object(M.a)(Ni,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"bp-input"},["textarea"===t.type?[n("div",{staticClass:"content-box textarea-box",class:{"on-focus":t.isOnFocus}},[n("textarea",{staticClass:"textarea",attrs:{placeholder:t.placeholder,maxlength:t.maxlength},domProps:{value:t.value},on:{input:t.onInput,focus:t.onFocus,blur:t.onBlur}}),n("div",{staticClass:"indicator"},[t._v(t._s(t.currentlength)+"/"+t._s(t.maxlength))])])]:t._e(),"textarea"!==t.type?[n("div",{staticClass:"content-box input-box",class:{"on-focus":t.isOnFocus}},[t._t("prefix"),n("input",{staticClass:"input",class:"input-"+t.type,attrs:{type:t.type,placeholder:t.placeholder,maxlength:t.maxlength,max:t.max},domProps:{value:t.value},on:{input:t.onInput,textInput:t.onTextInput,keydown:t.onKeydown,focus:t.onFocus,blur:t.onBlur}}),"number"!==t.type?n("div",{staticClass:"indicator"},[t._v(t._s(t.currentlength)+"/"+t._s(t.maxlength)+"\n      ")]):t._e()],2),t._t("suffix")]:t._e()],2)}),[],!1,null,"54972c91",null).exports);function Hi(t){return(Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Vi(t,e){return(Vi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Gi(t);if(e){var o=Gi(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Wi(this,n)}}function Wi(t,e){return!e||"object"!==Hi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Gi(t){return(Gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ji=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vi(t,e)}(a,t);var e,n,i,o=Fi(a);function a(){return $i(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"onClick",value:function(t){this.$emit("click",t)}}])&&zi(e.prototype,n),i&&zi(e,i),a}(l.c);Object(c.a)([Object(l.b)(Boolean)],Ji.prototype,"checked",void 0),Object(c.a)([Object(l.b)([String,Number,Boolean])],Ji.prototype,"value",void 0),Object(c.a)([Object(l.b)(String)],Ji.prototype,"name",void 0);var Ki=Ji=Object(c.a)([Object(l.a)({name:"bp-radio",components:{}})],Ji),Yi=(n(306),Object(M.a)(Ki,(function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"bp-radio",on:{click:this.onClick}},[e("div",{staticClass:"radio-icon",class:{checked:this.checked}}),e("input",{staticClass:"radio-input",attrs:{type:"radio",name:this.name},domProps:{value:this.value,checked:this.checked}}),this._t("default")],2)}),[],!1,null,"1f0bb9fe",null).exports);function qi(t){return(qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Xi(t,e){return(Xi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function to(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=no(t);if(e){var o=no(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return eo(this,n)}}function eo(t,e){return!e||"object"!==qi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function no(t){return(no=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var io=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xi(t,e)}(a,t);var e,n,i,o=to(a);function a(){return Zi(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"onValueChange",value:function(t){var e=t.target;this.$emit("input",e.value)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}}])&&Qi(e.prototype,n),i&&Qi(e,i),a}(l.c);Object(c.a)([Object(l.b)([String,Number])],io.prototype,"value",void 0),Object(c.a)([Object(l.b)(Array)],io.prototype,"options",void 0);var oo=io=Object(c.a)([Object(l.a)({name:"bp-selector",components:{}})],io),ao=(n(307),Object(M.a)(oo,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"bp-selector"},[n("select",{staticClass:"selector",domProps:{value:t.value},on:{change:t.onValueChange}},t._l(t.options,(function(e){return n("option",{key:e.value,domProps:{value:e.value}},[t._v(t._s(e.label)+"\n    ")])})),0),n("i",{staticClass:"more-icon"})])}),[],!1,null,"1d49d04b",null).exports);function ro(t){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function so(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function co(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function lo(t,e){return(lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function uo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ho(t);if(e){var o=ho(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return fo(this,n)}}function fo(t,e){return!e||"object"!==ro(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ho(t){return(ho=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var po=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lo(t,e)}(a,t);var e,n,i,o=uo(a);function a(){var t;return so(this,a),(t=o.apply(this,arguments)).formatList=["jpg","jpeg","png"],t.maxMByte=20,t.minWidth=10,t.minHeight=10,t.errorType={mbyte:"图片大小请勿超过20M",size:"图片宽高均不得小于10像素",format:"仅支持JPG PNG格式的图片"},t}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"imageBoxUrl",value:function(){var t=this.url;return"string"==typeof t&&"loading"!==t&&"error"!==t?(t=Object(Ct.bfsImgLink)(t.replace(/^(https?:)|^(\/\/)/,""),56,56,{c:1}),"background-image: url(".concat(t,"); background-size: cover;")):""}},{key:"checkFormat",value:function(t){for(var e=0,n=this.formatList.length;e<n;e+=1)if(t.indexOf(this.formatList[e])>-1)return!0;return!1}},{key:"checkImage",value:function(t,e,n,i){return this.checkFormat(t)?Math.floor(e/1024/1024)>=this.maxMByte?this.errorType.mbyte:(n<this.minWidth||i<this.minHeight)&&this.errorType.size:this.errorType.format}},{key:"callFileDialog",value:function(){var t=this,e=document.createElement("input");e.type="file",e.accept="image/png, image/jpeg, image/jpg, image/gif",e.name="upload",e.addEventListener("change",(function(e){var n=e.target||e.srcElement,i=n&&n.files||[];if(i&&i.length>0){var o=i[0],a=t.checkImage(o.type,o.size,20,20);if(a)return void t.linkMsg(null,a,"error",!0,!0);var r=new Image;r.src=window.URL?window.URL.createObjectURL(o):window.webkitURL.createObjectURL(o),r.onload=function(){var e=t.checkImage(o.type,o.size,r.width,r.height);e?t.linkMsg(null,e,"error",!0,!0):(t.$emit("loading",{index:t.index}),t.uploadImage(i[0]).then((function(e){t.$emit("success",{index:t.index,bres:e})}),(function(e){t.$emit("fail",{index:t.index,berr:e})})))}}})),e.click(),window.upload_input=e,e=null}},{key:"uploadImage",value:function(t){var e=new FormData;return e.append("file_up",t),e.append("biz","draw"),e.append("category","daily"),this.bpapi({url:"//api.vc.bilibili.com/api/v1/drawImage/upload",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}}])&&co(e.prototype,n),i&&co(e,i),a}(l.c);Object(c.a)([Object(l.b)(Number)],po.prototype,"index",void 0),Object(c.a)([Object(l.b)(String)],po.prototype,"url",void 0);var mo=po=Object(c.a)([Object(l.a)({name:"bp-upload",components:{}})],po),go=(n(308),Object(M.a)(mo,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-upload",on:{click:function(e){return t.callFileDialog(t.index)}}},[t.url?n("div",{staticClass:"image-box",class:t.url,style:t.imageBoxUrl(t.index)},[n("div",{staticClass:"change-tip"},[t._v("更改")])]):t._e(),t.url?t._e():n("div",{staticClass:"image-box"}),n("div",{staticClass:"bg-color"})])}),[],!1,null,"17892e73",null).exports);function vo(t){return(vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _o(t,e){return(_o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Co(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Io(t);if(e){var o=Io(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return wo(this,n)}}function wo(t,e){return!e||"object"!==vo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Io(t){return(Io=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_o(t,e)}(a,t);var e,n,i,o=Co(a);function a(){return bo(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}}])&&yo(e.prototype,n),i&&yo(e,i),a}(l.c),ko=xo=Object(c.a)([Object(l.a)({name:"bp-title",components:{}})],xo),Oo=(n(309),Object(M.a)(ko,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("div",{staticClass:"title-content"},[this._t("default")],2),e("div",{staticClass:"slot-right"},[this._t("right")],2)])}),[],!1,null,"28adec7b",null).exports);function So(t){return(So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Po(t,e,n){return(Po=Ro()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&Mo(o,n.prototype),o}).apply(null,arguments)}function To(t){return function(t){if(Array.isArray(t))return jo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return jo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jo(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Lo(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function Ao(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Eo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Mo(t,e){return(Mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Do(t,e){return!e||"object"!==So(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ro(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Bo(t){return(Bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var No={dynamic:1,comment:9,article:64,archive:8},Uo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mo(t,e)}(l,t);var e,n,i,o,a,r,s,c=(e=l,n=Ro(),function(){var t,i=Bo(e);if(n){var o=Bo(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return Do(this,t)});function l(){var t;return Ao(this,l),(t=c.apply(this,arguments)).loaded=!1,t.maxCount=100,t.isSpecial=!1,t.lid=0,t.atConfig=0,t.followList=[{name:"不限制",value:0},{name:"关注我",value:1}],t.followConfig=1,t.prizeCount=1,t.firstPrizeNum="",t.secondPrizeNum="",t.thirdPrizeNum="",t.firstPrizeInfo={needMail:"",desc:"",imgUrl:""},t.secondPrizeInfo={needMail:"",desc:"",imgUrl:""},t.thirdPrizeInfo={needMail:"",desc:"",imgUrl:""},t.mailRadioList=[{name:"需邮寄",value:!0},{name:"不需邮寄",value:!1}],t.time=null,t.errorList=[],t.formatList=["jpg","jpeg","png"],t.maxMByte=20,t.minWidth=10,t.minHeight=10,t.errorType={mbyte:"图片大小请勿超过20M",size:"图片宽高均不得小于10像素",format:"仅支持JPG PNG格式的图片"},t.maxTimes=1,t.lotteryTimes=0,t.minDatetime="",t.maxDatetime="",t.realShow=!1,t.datePickerMinDate=Date.now()+3e5,t.datePickerMaxDate=Date.now()+7776e6,t.updateTimePid=0,t.datePickerShown=!0,t}return i=l,(o=[{key:"onShowChange",value:function(t){var e=this;t?this.fetchLotteryTimes().then((function(){e.haveLeftTimes?(e.realShow=t,e.init()):(e.linkMsg(null,"本月您发起抽奖次数已达到上限\n（每月上限为1次），下月再来吧~","error",!0,!0),e.onCancel())})).catch((function(){e.linkMsg(null,"本月您发起抽奖次数已达到上限\n（每月上限为1次），下月再来吧~","error",!0,!0),e.onCancel()})):this.realShow=t}},{key:"onConfigChange",value:function(){this.init()}},{key:"created",value:function(){var t=this;this.updateTimePid=setInterval((function(){t.datePickerMinDate=Date.now()+3e5,t.datePickerMaxDate=Date.now()+7776e6}),6e4)}},{key:"beforeDestroy",value:function(){clearInterval(this.updateTimePid)}},{key:"mounted",value:(r=st.a.mark((function t(){var e,n;return st.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.updateMinMaxDatetime(),t.next=3,Object(Ct.fetchLoginInfo)(!1);case 3:e=t.sent,"208259"!==(n=String(e.mid))&&"167388493"!==n&&"6810576"!==n||(this.maxCount=1e4,this.isSpecial=!0),this.isFromComment&&(this.followConfig=0);case 7:case"end":return t.stop()}}),t,this)})),s=function(){var t=this,e=arguments;return new Promise((function(n,i){var o=r.apply(t,e);function a(t){Lo(o,n,i,a,s,"next",t)}function s(t){Lo(o,n,i,a,s,"throw",t)}a(void 0)}))},function(){return s.apply(this,arguments)})},{key:"init",value:function(){var t=this;this.config&&this.config.lottery_id?(this.lid=this.config.lottery_id,this.bpapi({method:"get",url:"//api.vc.bilibili.com/lottery_svr/v1/lottery_svr/lottery_notice",data:{lottery_id:this.lid}}).then((function(e){var n=e.data;t.followConfig=n.lottery_feed_limit,t.firstPrizeNum=n.first_prize,t.secondPrizeNum=n.second_prize,t.thirdPrizeNum=n.third_prize,t.firstPrizeInfo={needMail:!!(1&n.need_post),desc:n.first_prize_cmt,imgUrl:n.first_prize_pic},t.secondPrizeInfo={needMail:!!(2&n.need_post),desc:n.second_prize_cmt,imgUrl:n.second_prize_pic},t.thirdPrizeInfo={needMail:!!(4&n.need_post),desc:n.third_prize_cmt,imgUrl:n.third_prize_pic},t.prizeCount=1,Number(t.secondPrizeNum)>0&&(t.prizeCount+=1),Number(t.thirdPrizeNum)>0&&(t.prizeCount+=1)}),(function(e){var n="电波无法到达~ ".concat(e.code);t.linkMsg(null,e.msg||n,"error",!0,!0),window.console.error(e)}))):(this.clear(),this.resetDatetime())}},{key:"clear",value:function(){this.followConfig=1,this.prizeCount=1,this.firstPrizeNum="",this.secondPrizeNum="",this.thirdPrizeNum="",this.lid=0,this.firstPrizeInfo={needMail:"",desc:"",imgUrl:""},this.secondPrizeInfo={needMail:"",desc:"",imgUrl:""},this.thirdPrizeInfo={needMail:"",desc:"",imgUrl:""}}},{key:"getRealDate",value:function(t){if("string"==typeof t){var e=t.split(/-|T|:/g);return e[1]=String(parseInt(e[1],10)-1),Po(Date,To(e))}return new Date(t)}},{key:"toISOString",value:function(t,e){var n=new Date;return t&&(n=this.getRealDate(t)),new Date(n.getTime()-6e4*n.getTimezoneOffset()+e).toISOString().match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}/)[0]}},{key:"updateMinMaxDatetime",value:function(){this.minDatetime=this.toISOString(0,3e5),this.maxDatetime=this.toISOString(0,7776e6)}},{key:"resetDatetime",value:function(){var t=this;this.time=null,this.datePickerShown=!1,setTimeout((function(){t.datePickerShown=!0}),0)}},{key:"setFollowValue",value:function(t){this.followConfig=t.value}},{key:"setPrizeRadio",value:function(t,e){this[t].needMail=e.value}},{key:"addPrize",value:function(){this.prizeCount+=1}},{key:"deletePrize",value:function(t){2===t&&2===this.prizeCount?(this.secondPrizeNum="",this.secondPrizeInfo={needMail:"",desc:"",imgUrl:""},this.thirdPrizeNum="",this.thirdPrizeInfo={needMail:"",desc:"",imgUrl:""}):2===t&&3===this.prizeCount?(this.secondPrizeNum=this.thirdPrizeNum,this.secondPrizeInfo=this.thirdPrizeInfo,this.thirdPrizeNum="",this.thirdPrizeInfo={needMail:"",desc:"",imgUrl:""}):3===t&&(this.thirdPrizeNum="",this.thirdPrizeInfo={needMail:"",desc:"",imgUrl:""}),this.prizeCount-=1}},{key:"onDatetimeOnChange",value:function(){return this.updateMinMaxDatetime(),!this.time||this.time.getTime()<this.getRealDate(this.minDatetime).getTime()?(this.linkMsg(null,"开奖不可早于当前时间后5分钟","info",!0,!0),!1):!(this.time.getTime()>this.getRealDate(this.maxDatetime).getTime()&&(this.linkMsg(null,"最长可设置90天后","info",!0,!0),1))}},{key:"onNumberBlur",value:function(){(Number(this.firstPrizeNum)||0)>this.maxCount?(this.firstPrizeNum=this.maxCount,this.linkMsg(null,"最大可设置为".concat(this.maxCount),"info",!0,!0)):(Number(this.firstPrizeNum)||0)<=0&&(this.firstPrizeNum=""),this.prizeCount>1&&(Number(this.secondPrizeNum)||0)>this.maxCount?(this.secondPrizeNum=this.maxCount,this.linkMsg(null,"最大可设置为".concat(this.maxCount),"info",!0,!0)):this.prizeCount>1&&(Number(this.secondPrizeNum)||0)<=0&&(this.secondPrizeNum=""),this.prizeCount>2&&(Number(this.thirdPrizeNum)||0)>this.maxCount?(this.thirdPrizeNum=this.maxCount,this.linkMsg(null,"最大可设置为".concat(this.maxCount),"info",!0,!0)):this.prizeCount>2&&(Number(this.thirdPrizeNum)||0)<=0&&(this.thirdPrizeNum="")}},{key:"onTextInput",value:function(t){Number(t.data)||0===t.data||"0"===t.data||t.preventDefault()}},{key:"onKeyDown",value:function(t){"ArrowDown"!==t.key&&"ArrowUp"!==t.key||t.preventDefault()}},{key:"filterImgError",value:function(t){return"loading"===t||"error"===t?"":t}},{key:"fetchLotteryTimes",value:function(){var t=this,e={business_type:No[this.from]||1};return this.bpapi({method:"get",url:"//api.vc.bilibili.com/lottery_svr/v1/lottery_svr/query_lottery_times",data:e}).then((function(e){t.loaded=!0,t.lotteryTimes=e.data.lottery_times,t.maxTimes=e.data.max_times,t.lotteryTimes>=t.maxTimes&&t.$router.replace("/noTimes")})).catch((function(){t.loaded=!0}))}},{key:"onSubmit",value:function(t){if(this.isActive){if(!0!==t){if(!this.isActive)return;if(!this.onDatetimeOnChange())return}var e=this;this.bpPopup({title:"本月还剩".concat(e.maxTimes-e.lotteryTimes,"次发布抽奖机会，确认发起抽奖吗？"),content:"发起抽奖动态将消耗1次抽奖机会",button:{confirm:"发起抽奖",cancel:"取消"}}).onConfirm((function(t){e.doSubmit(),t.close()})).onCancel((function(t){t.close()}))}else{var n=this.errorList[0];this.linkMsg(null,n||"请检查您所填写的全部内容","success",!0,!0)}}},{key:"doSubmit",value:function(){var t=this,e=0;this.firstPrizeInfo.needMail&&(e+=1),this.secondPrizeInfo.needMail&&(e+=2),this.thirdPrizeInfo.needMail&&(e+=4);var n={at_num:parseInt(String(this.atConfig),10),feed_limit:parseInt(String(this.followConfig),10),first_prize:parseInt(String(this.firstPrizeNum),10)||void 0,second_prize:parseInt(String(this.secondPrizeNum),10)||void 0,third_prize:parseInt(String(this.thirdPrizeNum),10)||void 0,lottery_time:this.getRealDate(this.time).getTime()/1e3,need_post:e,first_prize_cmt:this.firstPrizeInfo.desc||void 0,second_prize_cmt:this.secondPrizeInfo.desc||void 0,third_prize_cmt:this.thirdPrizeInfo.desc||void 0,first_prize_pic:this.filterImgError(this.firstPrizeInfo.imgUrl)||void 0,second_prize_pic:this.filterImgError(this.secondPrizeInfo.imgUrl)||void 0,third_prize_pic:this.filterImgError(this.thirdPrizeInfo.imgUrl)||void 0,business_type:No[this.from]||1},i="create";this.lid&&(n.lottery_id=this.lid,i="update"),this.bpapi({method:"post",url:"//api.vc.bilibili.com/lottery_svr/v1/lottery_svr/".concat(i,"_lottery"),data:n}).then((function(e){var i={lottery_id:e.data.lottery_id,lottery_time:n.lottery_time,title:t.isFromComment?"评论抽奖":"互动抽奖"};t.$emit("lottery-create",i)}),(function(e){var n="";n=4100003===e.code?"本月您发起抽奖次数已达到上限\n（每月上限为1次），下月再来吧~":e.msg,t.linkMsg(null,n||e.msg,"error",!0,!0),window.console.error(e)}))}},{key:"onCancel",value:function(){this.$emit("cancel")}},{key:"onImgLoading",value:function(t,e){this[e].imgUrl="loading"}},{key:"onImgSuccess",value:function(t,e){var n=t.bres;this[e].imgUrl=n.data.image_url,this.$forceUpdate();var i=this.errorList;this.errorList=[],this.errorList=i}},{key:"onImgFail",value:function(t,e){var n=t.berr;this[e].imgUrl="error",this.$forceUpdate(),this.linkMsg(null,"".concat(n.msg," ").concat(n.code),"error",!0,!0)}},{key:"deleteImg",value:function(t){this[t].imgUrl="",this.$forceUpdate()}},{key:"haveLeftTimes",get:function(){return this.lotteryTimes<this.maxTimes}},{key:"isActive",get:function(){var t=[];return this.haveLeftTimes||t.push("本月您发起抽奖次数已达到上限\n（每月上限为1次），下月再来吧~"),(1===this.prizeCount&&(Number(this.firstPrizeNum)<1||Number(this.firstPrizeNum)>this.maxCount)||2===this.prizeCount&&(Number(this.secondPrizeNum)<1||Number(this.secondPrizeNum)>this.maxCount)||3===this.prizeCount&&(Number(this.thirdPrizeNum)<1||Number(this.thirdPrizeNum)>this.maxCount))&&t.push("获奖人数最少1人，最多".concat(this.maxCount,"人")),(1===this.prizeCount&&""===this.firstPrizeInfo.needMail||2===this.prizeCount&&""===this.secondPrizeInfo.needMail||3===this.prizeCount&&""===this.thirdPrizeInfo.needMail)&&t.push("请选择奖品发放方式"),(1===this.prizeCount&&!this.firstPrizeInfo.desc||2===this.prizeCount&&!this.secondPrizeInfo.desc||3===this.prizeCount&&!this.thirdPrizeInfo.desc)&&t.push("请填写奖品描述"),this.errorList=t,!!(1===this.prizeCount&&Number(this.firstPrizeNum)>0&&Number(this.firstPrizeNum)<=this.maxCount&&""!==this.firstPrizeInfo.needMail&&this.firstPrizeInfo.desc&&this.haveLeftTimes)||!!(2===this.prizeCount&&Number(this.firstPrizeNum)>0&&Number(this.firstPrizeNum)<=this.maxCount&&""!==this.firstPrizeInfo.needMail&&this.firstPrizeInfo.desc&&Number(this.secondPrizeNum)>0&&Number(this.secondPrizeNum)<=this.maxCount&&""!==this.secondPrizeInfo.needMail&&this.secondPrizeInfo.desc&&this.haveLeftTimes)||!!(3===this.prizeCount&&Number(this.firstPrizeNum)>0&&Number(this.firstPrizeNum)<=this.maxCount&&""!==this.firstPrizeInfo.needMail&&this.firstPrizeInfo.desc&&Number(this.secondPrizeNum)>0&&Number(this.secondPrizeNum)<=this.maxCount&&""!==this.secondPrizeInfo.needMail&&this.secondPrizeInfo.desc&&Number(this.thirdPrizeNum)>0&&Number(this.thirdPrizeNum)<=this.maxCount&&""!==this.thirdPrizeInfo.needMail&&this.thirdPrizeInfo.desc&&this.haveLeftTimes)}},{key:"prizeNumPlaceholder",get:function(){return"最多".concat(this.maxCount,"人")}},{key:"isFromComment",get:function(){return"comment"===this.from}},{key:"conditionDetail",get:function(){return this.isFromComment?"评论稿件即可参与抽奖":"转发本动态，并符合下列条件可参与抽奖"}},{key:"zIndexStyle",get:function(){return"z-index: ".concat(this.zIndex||2,";")}}])&&Eo(i.prototype,o),a&&Eo(i,a),l}(l.c);Object(c.a)([Object(l.b)(Number)],Uo.prototype,"zIndex",void 0),Object(c.a)([Object(l.b)(Object)],Uo.prototype,"config",void 0),Object(c.a)([Object(l.b)(Boolean)],Uo.prototype,"show",void 0),Object(c.a)([Object(l.b)({type:String,default:function(){return"dynamic"}})],Uo.prototype,"from",void 0),Object(c.a)([Object(l.d)("show")],Uo.prototype,"onShowChange",null),Object(c.a)([Object(l.d)("config")],Uo.prototype,"onConfigChange",null);var Ho=Uo=Object(c.a)([Object(l.a)({name:"create",components:{BpAddButton:yi,BpButton:Ti,BpInput:Ui,BpRadio:Yi,BpSelector:ao,BpUpload:go,BpTitle:Oo,DatePicker:Y}})],Uo),$o=(n(310),Object(M.a)(Ho,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-lottery-container"},[n("transition",{attrs:{name:"move-in"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.realShow,expression:"realShow"}],staticClass:"create-lottery",style:t.zIndexStyle},[n("div",{staticClass:"main-content"},[n("div",{staticClass:"group"},[n("div",{staticClass:"tip condition-title"},[t._v(t._s(t.conditionDetail))]),n("bp-title",{staticClass:"condition-title"},[n("span",[t._v("关注条件")]),t._l(t.followList,(function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.followConfig,value:e.value,name:"follow-config"},on:{click:function(n){return t.setFollowValue(e)}},slot:"right"},[t._v("\n              "+t._s(e.name)+"\n            ")])}))],2)],1),n("div",{staticClass:"group"},[t.prizeCount>1?n("bp-title",[n("span",{staticClass:"bold-title"},[t._v("一等奖")])]):t._e(),n("bp-title",[n("div",[n("span",[t._v("获奖人数")]),n("div",{staticClass:"tip"},[t._v(t._s(t.prizeNumPlaceholder))])]),n("template",{slot:"right"},[n("bp-input",{staticClass:"number-input",attrs:{type:"number",max:t.maxCount,placeholder:"0"},on:{blur:t.onNumberBlur,textInput:t.onTextInput,keyDown:t.onKeyDown},model:{value:t.firstPrizeNum,callback:function(e){t.firstPrizeNum=e},expression:"firstPrizeNum"}}),t._v("\n              人\n            ")],1)],2),n("bp-title",[n("span",[t._v("奖品发放")]),t._l(t.mailRadioList,(function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.firstPrizeInfo.needMail,value:e.value,name:"first-prize-radio"},on:{click:function(n){return t.setPrizeRadio("firstPrizeInfo",e)}},slot:"right"},[t._v("\n              "+t._s(e.name)+"\n            ")])}))],2),n("bp-title",[n("span",[t._v("奖品描述")]),n("bp-input",{attrs:{slot:"right",type:"text",maxlength:20,placeholder:"奖品描述信息"},slot:"right",model:{value:t.firstPrizeInfo.desc,callback:function(e){t.$set(t.firstPrizeInfo,"desc",e)},expression:"firstPrizeInfo.desc"}})],1),n("bp-title",[n("div",[n("span",[t._v("奖品图片")]),n("div",{staticClass:"tip"},[t._v("可选")])]),n("template",{slot:"right"},[n("bp-upload",{attrs:{url:t.firstPrizeInfo.imgUrl},on:{loading:function(e){return t.onImgLoading(e,"firstPrizeInfo")},success:function(e){return t.onImgSuccess(e,"firstPrizeInfo")},fail:function(e){return t.onImgFail(e,"firstPrizeInfo")}}}),t.firstPrizeInfo.imgUrl?n("button",{staticClass:"delete-button",on:{click:function(e){return t.deleteImg("firstPrizeInfo")}}},[t._v("删除\n              ")]):t._e()],1)],2)],1),t.prizeCount>1?n("div",{staticClass:"group"},[n("bp-title",[n("span",{staticClass:"bold-title"},[t._v("二等奖")]),n("div",{staticClass:"delete-button-box",attrs:{slot:"right"},slot:"right"},[n("button",{staticClass:"delete-button",on:{click:function(e){return t.deletePrize(2)}}},[t._v("删除奖项\n              ")])])]),n("bp-title",[n("div",[n("span",[t._v("获奖人数")]),n("div",{staticClass:"tip"},[t._v(t._s(t.prizeNumPlaceholder))])]),n("template",{slot:"right"},[n("bp-input",{staticClass:"number-input",attrs:{type:"number",max:t.maxCount,placeholder:"0"},on:{blur:t.onNumberBlur,textInput:t.onTextInput,keyDown:t.onKeyDown},model:{value:t.secondPrizeNum,callback:function(e){t.secondPrizeNum=e},expression:"secondPrizeNum"}}),t._v("\n              人\n            ")],1)],2),n("bp-title",[n("span",[t._v("奖品发放")]),t._l(t.mailRadioList,(function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.secondPrizeInfo.needMail,value:e.value,name:"second-prize-radio"},on:{click:function(n){return t.setPrizeRadio("secondPrizeInfo",e)}},slot:"right"},[t._v("\n              "+t._s(e.name)+"\n            ")])}))],2),n("bp-title",[n("span",[t._v("奖品描述")]),n("bp-input",{attrs:{slot:"right",type:"text",maxlength:20,placeholder:"奖品描述信息"},slot:"right",model:{value:t.secondPrizeInfo.desc,callback:function(e){t.$set(t.secondPrizeInfo,"desc",e)},expression:"secondPrizeInfo.desc"}})],1),n("bp-title",[n("div",[n("span",[t._v("奖品图片")]),n("div",{staticClass:"tip"},[t._v("可选")])]),n("template",{slot:"right"},[n("bp-upload",{attrs:{slot:"right",url:t.secondPrizeInfo.imgUrl},on:{loading:function(e){return t.onImgLoading(e,"secondPrizeInfo")},success:function(e){return t.onImgSuccess(e,"secondPrizeInfo")},fail:function(e){return t.onImgFail(e,"secondPrizeInfo")}},slot:"right"}),t.secondPrizeInfo.imgUrl?n("button",{staticClass:"delete-button",on:{click:function(e){return t.deleteImg("secondPrizeInfo")}}},[t._v("删除\n              ")]):t._e()],1)],2)],1):t._e(),t.prizeCount>2?n("div",{staticClass:"group"},[n("bp-title",[n("span",{staticClass:"bold-title"},[t._v("三等奖")]),n("div",{staticClass:"delete-button-box",attrs:{slot:"right"},slot:"right"},[n("button",{staticClass:"delete-button",on:{click:function(e){return t.deletePrize(3)}}},[t._v("删除奖项\n              ")])])]),n("bp-title",[n("div",[n("span",[t._v("获奖人数")]),n("div",{staticClass:"tip"},[t._v(t._s(t.prizeNumPlaceholder))])]),n("template",{slot:"right"},[n("bp-input",{staticClass:"number-input",attrs:{type:"number",max:t.maxCount,placeholder:"0"},on:{blur:t.onNumberBlur,textInput:t.onTextInput,keyDown:t.onKeyDown},model:{value:t.thirdPrizeNum,callback:function(e){t.thirdPrizeNum=e},expression:"thirdPrizeNum"}}),t._v("\n              人\n            ")],1)],2),n("bp-title",[n("span",[t._v("奖品发放")]),t._l(t.mailRadioList,(function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.thirdPrizeInfo.needMail,value:e.value,name:"third-prize-radio"},on:{click:function(n){return t.setPrizeRadio("thirdPrizeInfo",e)}},slot:"right"},[t._v("\n              "+t._s(e.name)+"\n            ")])}))],2),n("bp-title",[n("span",[t._v("奖品描述")]),n("bp-input",{attrs:{slot:"right",type:"text",maxlength:20,placeholder:"奖品描述信息"},slot:"right",model:{value:t.thirdPrizeInfo.desc,callback:function(e){t.$set(t.thirdPrizeInfo,"desc",e)},expression:"thirdPrizeInfo.desc"}})],1),n("bp-title",[n("div",[n("span",[t._v("奖品图片")]),n("div",{staticClass:"tip"},[t._v("可选")])]),n("template",{slot:"right"},[n("bp-upload",{attrs:{slot:"right",url:t.thirdPrizeInfo.imgUrl},on:{loading:function(e){return t.onImgLoading(e,"thirdPrizeInfo")},success:function(e){return t.onImgSuccess(e,"thirdPrizeInfo")},fail:function(e){return t.onImgFail(e,"thirdPrizeInfo")}},slot:"right"}),t.thirdPrizeInfo.imgUrl?n("button",{staticClass:"delete-button",on:{click:function(e){return t.deleteImg("thirdPrizeInfo")}}},[t._v("删除\n              ")]):t._e()],1)],2)],1):t._e(),n("div",{staticClass:"group no-border"},[t.prizeCount<3?n("bp-add-button",{on:{click:t.addPrize}},[t._v("添加选项\n          ")]):t._e(),n("div",{staticClass:"tip button-tip"},[t._v("\n            最多支持3个奖项，每个奖项人数最多100人\n            "),n("br"),t._v("\n            奖品选择需邮寄的，发奖人可在抽奖结果页面查看中奖人收货地址\n          ")])],1),t.datePickerShown?n("div",{staticClass:"group"},[n("bp-title",{staticClass:"datepicker-aligntop"},[n("span",{staticClass:"datepicker-title"},[t._v("开奖时间")]),n("div",{attrs:{slot:"right"},slot:"right"},[n("date-picker",{attrs:{min:new Date(t.datePickerMinDate),max:new Date(t.datePickerMaxDate)},on:{change:t.onDatetimeOnChange},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}}),n("div",{staticClass:"tip button-tip"},[t._v("\n                开奖后将自动通过该账号发布开奖公示动态，并通过私信提醒中奖用户\n              ")])],1)])],1):t._e(),n("div",{staticClass:"group datepicker-minheight"},[n("div",{staticClass:"tip button-tip"},[t._v("\n            查看\n            "),n("a",{staticClass:"btn",attrs:{href:"https://www.bilibili.com/blackboard/help.html#/?qid=2ddd463b778747d790ce1708ae55b4dc&pid=5b43558f91584f08888ce9c5fd6cb69c",target:"_blank"}},[t._v("《动态抽奖服务协议》")]),n("a",{staticClass:"btn",attrs:{href:"https://www.bilibili.com/blackboard/help.html#/?qid=b65809ab0d924b3487c6f6a2a9303f22&pid=5b43558f91584f08888ce9c5fd6cb69c",target:"_blank"}},[t._v("《动态抽奖工具说明》")])])])]),n("div",{staticClass:"button-bar"},[n("bp-button",{on:{click:t.onCancel}},[t._v("取消")]),n("bp-button",{attrs:{status:t.isActive?"active":"disable"},on:{click:t.onSubmit}},[t._v(t._s(t.lid?"更新抽奖":"发起抽奖")+"\n        ")])],1)])])],1)}),[],!1,null,"4e90cad6",null).exports);o.a.use(Object(a.a)()),o.a.use(s.b),o.a.use(r.a);var zo=$o;function Vo(t){return(Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Go(t,e){return(Go=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Jo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Yo(t);if(e){var o=Yo(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Ko(this,n)}}function Ko(t,e){return!e||"object"!==Vo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yo(t){return(Yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Go(t,e)}(a,t);var e,n,i,o=Jo(a);function a(){var t;return Fo(this,a),(t=o.apply(this,arguments)).text="",t.lotteryBoxShown=!1,t.lotteryConfig={},t}return e=a,(n=[{key:"onLotteryIndexChanged",value:function(t){t<0?this.clearCtrl():this.updateCtrl()}},{key:"onLotteryBoxShown",value:function(t){this.bus.$emit("lottery-trigger",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("text-update",(function(e){t.text=e})),this.bus.$on("lottery-restore",this.restoreFromDraft),this.bus.$on("lottery-item-click",(function(){t.lotteryBoxShown=!0}))}},{key:"triggerLotteryBoxShow",value:function(){this.lotteryBoxShown=!0}},{key:"onLotteryCreate",value:function(t){var e=this,n=this.lotteryConfig.lottery_id===t.lottery_id;this.lotteryConfig=t,this.onLotteryCancel();var i=t.title;if(!n){var o="​".concat(i," ");this.bus.$emit("insert",o),setTimeout((function(){e.updateCtrl()}))}}},{key:"clearCtrl",value:function(){this.lotteryConfig={},this.onLotteryCancel(),this.bus.$emit("update-ctrl",{lottery:[]}),this.bus.$emit("update-extension",{lottery:null})}},{key:"updateCtrl",value:function(){var t=[{data:String(this.lotteryConfig.title.length+1),length:0,location:this.lotteryIndex,type:2}],e={lottery_id:this.lotteryConfig.lottery_id};this.bus.$emit("update-ctrl",{lottery:t}),this.bus.$emit("update-extension",{lottery:e})}},{key:"onLotteryCancel",value:function(){this.lotteryBoxShown=!1}},{key:"restoreFromDraft",value:function(t){var e=t.ctrl,n=t.extension;if(e&&n){var i=e.location+1,o=Number(e.data)-1,a=this.text.substring(i,i+o);this.lotteryConfig={lottery_id:n.lottery_id,title:a}}}},{key:"lotteryIndex",get:function(){return this.lotteryConfig.title?this.text.indexOf("​".concat(this.lotteryConfig.title)):-1}}])&&Wo(e.prototype,n),i&&Wo(e,i),a}(l.c);Object(c.a)([Object(l.b)()],qo.prototype,"bus",void 0),Object(c.a)([Object(l.b)()],qo.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)(Boolean)],qo.prototype,"isPopupPanel",void 0),Object(c.a)([Object(l.d)("lotteryIndex")],qo.prototype,"onLotteryIndexChanged",null),Object(c.a)([Object(l.d)("lotteryBoxShown")],qo.prototype,"onLotteryBoxShown",null);var Zo=qo=Object(c.a)([Object(l.a)({name:"lottery-box",components:{Lottery:zo}})],qo),Qo=(n(311),Object(M.a)(Zo,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"lottery-box"},[e("button",{staticClass:"d-i-block bp-v-middle bp-icon-font lottery-create-btn box-toggle",class:{active:this.lotteryBoxShown},attrs:{title:"发起抽奖"},on:{click:this.triggerLotteryBoxShow}}),e("lottery",{staticClass:"lottery-popup",attrs:{show:this.lotteryBoxShown,config:this.lotteryConfig},on:{"lottery-create":this.onLotteryCreate,cancel:this.onLotteryCancel}})],1)}),[],!1,null,"309d9658",null).exports);function Xo(t){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ta(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ea(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function na(t,e){return(na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ia(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=aa(t);if(e){var o=aa(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return oa(this,n)}}function oa(t,e){return!e||"object"!==Xo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function aa(t){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ra=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&na(t,e)}(a,t);var e,n,i,o=ia(a);function a(){var t;return ta(this,a),(t=o.apply(this,arguments)).scheduleBarShow=!1,t.schPubTipsVisable=!1,t}return e=a,(n=[{key:"onScheduleBarShow",value:function(t,e){t!==e&&this.bus.$emit("schedule-trigger",t)}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){this.scheduledPublishTips()}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("schedule-trigger",(function(e){t.scheduleBarShow=e}))}},{key:"triggerSchedule",value:function(){if(this.isLockedAsScheduled)this.scheduleBarShow=!0;else{this.scheduleBarShow=!this.scheduleBarShow;var t=this.editDraft?2:this.isPopupPanel?1:0;Object(Mt.d)(Dt.d.TIMER_ICON,t)}}},{key:"scheduledPublishTips",value:function(){var t=this;"undefined"!=typeof window&&"true"!==window.localStorage.getItem("dynamic_scheduled_publish_intro_".concat(this.loginUid))&&(t.schPubTipsVisable=!0,window.localStorage.setItem("dynamic_scheduled_publish_intro_".concat(t.loginUid),String(!0)),setTimeout((function(){t.schPubTipsVisable=!1}),5e3))}}])&&ea(e.prototype,n),i&&ea(e,i),a}(l.c);Object(c.a)([Object(l.b)()],ra.prototype,"bus",void 0),Object(c.a)([Object(l.b)()],ra.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)()],ra.prototype,"isLockedAsScheduled",void 0),Object(c.a)([Object(l.b)(Boolean)],ra.prototype,"isPopupPanel",void 0),Object(c.a)([Object(l.b)()],ra.prototype,"editDraft",void 0),Object(c.a)([Object(l.d)("scheduleBarShow")],ra.prototype,"onScheduleBarShow",null);var sa=ra=Object(c.a)([Object(l.a)({name:"schedule-btn",components:{}})],ra),ca=(n(312),Object(M.a)(sa,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"schedule-btn"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.schPubTipsVisable,expression:"schPubTipsVisable"}],staticClass:"sch-pub-tips"},[n("span",[t._v("可以设置定时发布动态啦")]),n("i",{staticClass:"bp-icon-font icon-group-dynamic",on:{click:function(e){t.schPubTipsVisable=!1}}})]),n("button",{staticClass:"d-i-block bp-v-middle bp-icon-font icon-ic_timer box-toggle",class:{active:t.scheduleBarShow},attrs:{title:"定时发布"},on:{click:t.triggerSchedule}})])}),[],!1,null,"3a26abfb",null).exports),la=n(72),ua=n.n(la),da=n(247),fa={props:{value:{type:String,required:!0},type:{type:String,default:"text"},maxLength:{type:Number,default:30},placeholder:{type:String,default:"请输入关键词进行检索"}},data:function(){return{isOnFocus:!1,text:this.value}},watch:{text:function(t){this.$emit("input",t),this.realtime&&this.submit(!0)},value:function(t){this.text=t}},methods:{onFocus:function(t){this.isOnFocus=!0,this.$emit("inputFocused",t)},onBlur:function(t){this.isOnFocus=!1,this.$emit("inputBlur",t)},submit:Object(da.a)(300,(function(t){this.$emit(t?"change":"submit")}))}},ha=(n(313),Object(M.a)(fa,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bp-input"},[n("form",{staticClass:"input-form",attrs:{method:"get",action:"#"},on:{submit:function(e){return e.preventDefault(),t.submit(!1)}}},["checkbox"===t.type?n("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"input",class:"input-"+t.type,attrs:{placeholder:t.placeholder,maxlength:t.maxLength,type:"checkbox"},domProps:{checked:Array.isArray(t.text)?t._i(t.text,null)>-1:t.text},on:{focus:t.onFocus,blur:t.onBlur,change:function(e){var n=t.text,i=e.target,o=!!i.checked;if(Array.isArray(n)){var a=t._i(n,null);i.checked?a<0&&(t.text=n.concat([null])):a>-1&&(t.text=n.slice(0,a).concat(n.slice(a+1)))}else t.text=o}}}):"radio"===t.type?n("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"input",class:"input-"+t.type,attrs:{placeholder:t.placeholder,maxlength:t.maxLength,type:"radio"},domProps:{checked:t._q(t.text,null)},on:{focus:t.onFocus,blur:t.onBlur,change:function(e){t.text=null}}}):n("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"input",class:"input-"+t.type,attrs:{placeholder:t.placeholder,maxlength:t.maxLength,type:t.type},domProps:{value:t.text},on:{focus:t.onFocus,blur:t.onBlur,input:function(e){e.target.composing||(t.text=e.target.value)}}})])])}),[],!1,null,null,null).exports),pa={name:"bp-title"},ma=(n(314),Object(M.a)(pa,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"popularize-title"},[e("div",{staticClass:"title-content"},[this._t("default")],2),e("div",{staticClass:"slot-right"},[this._t("right")],2)])}),[],!1,null,null,null).exports),ga={props:{value:{type:[String,Boolean,Number],default:""},name:{type:String,default:""},checked:{type:Boolean,default:!1}},data:function(){return{}},methods:{onClick:function(){this.$emit("clickType")}}},va=(n(315),Object(M.a)(ga,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"bp-radio",on:{click:function(e){return e.stopPropagation(),t.onClick(e)}}},[n("div",{staticClass:"radio-icon",class:{checked:t.checked}}),n("input",{staticClass:"radio-input",attrs:{type:"radio",name:t.name},domProps:{value:t.value,checked:t.checked}}),t._t("default")],2)}),[],!1,null,null,null).exports),ba={props:{name:{type:String,required:!0},id:{type:[String,Number],required:!0},keyword:{type:String,default:""}},methods:{hightLightKeywords:function(t,e){var n=t.toString();return""===e?n:-1!==n.indexOf(e)&&""!==e?n.replace(e,'<font color="#00A1D6">'+e+"</font>"):n}}},ya=(n(316),Object(M.a)(ba,(function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"course-item"},[e("span",{staticClass:"course-id"},[this._v(this._s(this.id))]),e("span",{staticClass:"course-name",domProps:{innerHTML:this._s(this.hightLightKeywords(this.name,this.keyword))}})])}),[],!1,null,null,null).exports);function _a(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var Ca={1:"漫画",2:"课程",3:"ogv",4:"帮推"},wa={name:"popularize",components:{BpTitle:ma,BpRadio:va,BpInput:ha,BpCourseItem:ya},props:{types:{type:Array,default:function(){return[2]}},bus:{type:Object,default:function(){return{}}}},data:function(){return{selectedType:this.types[0]||2,value:"",uid:""}},created:function(){this.getUid()},computed:{isSimple:function(){return!this.types[0]||1===this.types.length&&2===this.types[0]},title:function(){return this.isSimple?"添加推广课程":"添加推广内容"},query:function(){return{biz_name:this.value.toString(),biz_type:this.selectedType,uid:this.uid,page:1}},typeInfo:function(){return this.types.map((function(t){return{name:Ca[t],value:t}}))},placeHolder:function(){return Ca[this.selectedType]?"请输入".concat(Ca[this.selectedType],"名进行检索"):"请选择推广内容进行检索"}},methods:{getUid:function(){var t,e=this;return(t=st.a.mark((function t(){return st.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Ct.fetchLoginUid)(!1);case 2:e.uid=t.sent;case 3:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){_a(a,i,o,r,s,"next",t)}function s(t){_a(a,i,o,r,s,"throw",t)}r(void 0)}))})()},handleToggleType:function(t){this.selectedType=t,this.$refs.loader.initData()},selectedCourse:function(t){this.bus.$emit("click-selected-item",[t,this.selectedType])}}},Ia=(n(317),Object(M.a)(wa,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"popularize-container"},[n("div",{staticClass:"popularize__title",class:{"only-course":t.isSimple}},[t._v(t._s(t.title))]),t.isSimple?t._e():n("bp-title",{staticClass:"condition-title"},[n("span",[t._v("类型：")]),t._l(t.typeInfo,(function(e){return n("bp-radio",{key:e.value,attrs:{slot:"right",checked:e.value===t.selectedType,value:e.value,name:"type-config"},on:{clickType:function(n){return t.handleToggleType(e.value)}},slot:"right"},[t._v("\n      "+t._s(e.name)+"\n    ")])}))],2),n("bp-input",{attrs:{placeholder:t.placeHolder},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),n("div",{staticClass:"popularize__course",class:{"only-course":t.isSimple}},[t.uid?n("flow-loader",{ref:"loader",attrs:{func:"attachSearch",query:t.query,type:"page","retry-on-error":""},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.flow;return[n("ul",t._l(i,(function(e){return n("bp-course-item",{key:e.biz_id,attrs:{name:e.biz_name,id:e.biz_id,keyword:t.value},nativeOn:{click:function(n){return t.selectedCourse(e.biz_id)}}})})),1)]}},{key:"loading",fn:function(){return[n("div",{staticClass:"_notice"},[t._v('("▔□▔)/ loading...')])]},proxy:!0},{key:"nothing",fn:function(){return[n("div",{staticClass:"_notice"},[t._v("这里还什么都没有呢～")])]},proxy:!0}],null,!1,1132371268)}):t._e()],1)],1)}),[],!1,null,null,null).exports);o.a.use(Object(a.a)()),o.a.use(s.b),o.a.use(r.a),o.a.component(ua.a.FlowLoader.name,ua.a.FlowLoader);var xa={components:{Popularize:Ia},props:{bus:{type:Object},attachTypes:{type:Array}},data:function(){return{popularizeBoxShown:!1}},methods:{triggerPopularizeBoxShow:function(){this.popularizeBoxShown=!this.popularizeBoxShown}}},ka=(n(318),Object(M.a)(xa,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"popularize-box"},[e("button",{staticClass:"d-i-block bp-v-middle bp-icon-font popularize-create-btn box-toggle",class:{active:this.popularizeBoxShown},attrs:{title:"添加附加卡"},on:{click:this.triggerPopularizeBoxShow}}),this.popularizeBoxShown?e("popularize",{staticClass:"popularize-popup",attrs:{types:this.attachTypes,bus:this.bus}}):this._e()],1)}),[],!1,null,null,null).exports);function Oa(t){return(Oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sa(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function Pa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ta(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ja(t,e){return(ja=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function La(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ea(t);if(e){var o=Ea(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Aa(this,n)}}function Aa(t,e){return!e||"object"!==Oa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ea(t){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ma=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ja(t,e)}(s,t);var e,n,i,o,a,r=La(s);function s(){var t;return Pa(this,s),(t=r.apply(this,arguments)).lotteryBoxShown=!1,t.voteBoxShown=!1,t.ifShowScheduleBar=!1,t.hasLottery=!1,t.hasVote=!1,t.hasSchedule=!1,t.hasPopularize=!1,t.attachTypes=[],t.hasPopularizeRight=!1,t.uid="",t}return e=s,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.initBus(),this.initUid()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("lottery-trigger",(function(e){t.lotteryBoxShown=e})),this.bus.$on("vote-trigger",(function(e){t.voteBoxShown=e,t.hasPopularize=!t.hasPopularize})),this.bus.$on("schedule-trigger",(function(e){t.ifShowScheduleBar=e})),this.bus.$on("has-lottery",(function(e){t.hasLottery=e})),this.bus.$on("has-vote",(function(e){t.hasVote=e}))}},{key:"initUid",value:(o=st.a.mark((function t(){return st.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Ct.fetchLoginUid)(!1);case 2:this.uid=t.sent,this.isShowPopularize();case 4:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,e=arguments;return new Promise((function(n,i){var a=o.apply(t,e);function r(t){Sa(a,n,i,r,s,"next",t)}function s(t){Sa(a,n,i,r,s,"throw",t)}r(void 0)}))},function(){return a.apply(this,arguments)})},{key:"isShowPopularize",value:function(){var t=this;Object(Ct.attachRight)(this.uid).then((function(e){e.code||(t.hasPopularize=1===e.data.state,t.hasPopularizeRight=1===e.data.state,t.attachTypes=e.data.types)}))}},{key:"showLotteryBtn",get:function(){return this.canLottery&&!this.ifShowScheduleBar}},{key:"showVoteBtn",get:function(){return this.canVote&&!this.ifShowScheduleBar&&this.canPopularize}},{key:"showScheduleBtn",get:function(){return this.canBeScheduled&&!(this.lotteryBoxShown||this.voteBoxShown||this.hasVote||this.hasLottery)}},{key:"showPopularize",get:function(){return this.hasPopularizeRight&&this.hasPopularize&&this.canPopularize&&!(this.lotteryBoxShown||this.voteBoxShown||this.hasVote||this.hasLottery)}}])&&Ta(e.prototype,n),i&&Ta(e,i),s}(l.c);Object(c.a)([Object(l.b)()],Ma.prototype,"bus",void 0),Object(c.a)([Object(l.b)()],Ma.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)(Boolean)],Ma.prototype,"canLottery",void 0),Object(c.a)([Object(l.b)(Boolean)],Ma.prototype,"canVote",void 0),Object(c.a)([Object(l.b)(Boolean)],Ma.prototype,"canBeScheduled",void 0),Object(c.a)([Object(l.b)()],Ma.prototype,"isLockedAsScheduled",void 0),Object(c.a)([Object(l.b)(Boolean)],Ma.prototype,"isPopupPanel",void 0),Object(c.a)([Object(l.b)()],Ma.prototype,"editDraft",void 0),Object(c.a)([Object(l.b)(Boolean)],Ma.prototype,"canPopularize",void 0);var Da=Ma=Object(c.a)([Object(l.a)({name:"toolbar",components:{Emoji:bt,ImageBox:Wt,AtBox:re,TopicBox:we,VoteBox:li,LotteryBox:Qo,ScheduleBtn:ca,Popularize:ka}})],Ma),Ra=(n(319),Object(M.a)(Da,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"toolbar-box"},[n("emoji",{staticClass:"toolbar-item",attrs:{bus:t.bus,"login-uid":t.loginUid}}),n("image-box",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,bus:t.bus,"login-uid":t.loginUid}}),n("at-box",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,bus:t.bus,"login-uid":t.loginUid}}),n("topic-box",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,bus:t.bus,"login-uid":t.loginUid}}),t.showVoteBtn?n("vote-box",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,bus:t.bus,"login-uid":t.loginUid}}):t._e(),t.showLotteryBtn?n("lottery-box",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,bus:t.bus,"login-uid":t.loginUid}}):t._e(),t.showPopularize?n("popularize",{attrs:{attachTypes:t.attachTypes,bus:t.bus}}):t._e(),t.showScheduleBtn?n("schedule-btn",{staticClass:"toolbar-item",attrs:{"is-popup-panel":t.isPopupPanel,"is-locked-as-scheduled":t.isLockedAsScheduled,"edit-draft":t.editDraft,bus:t.bus,"login-uid":t.loginUid}}):t._e()],1)}),[],!1,null,"4bb2b4ac",null).exports),Ba=(n(60),n(440),n(441),n(172)),Na="",Ua="close",Ha="choose";function $a(t){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function za(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Va(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Fa(t,e){return(Fa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Wa(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ja(t);if(e){var o=Ja(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Ga(this,n)}}function Ga(t,e){return!e||"object"!==$a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ja(t){return(Ja=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ka=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fa(t,e)}(a,t);var e,n,i,o=Wa(a);function a(){var t;return za(this,a),(t=o.apply(this,arguments)).ifPanelShow=!1,t.selection="",t.settingOptions=[{value:Na,label:"允许评论"},{value:Ua,label:"关闭评论"},{value:Ha,label:"评论精选"}],t}return e=a,(n=[{key:"setPanelShow",value:function(t){var e=this;t&&this.$nextTick((function(){e.$el.focus()}))}},{key:"created",value:function(){this.initBus()}},{key:"handleSelect",value:function(t){this.selection=t,this.bus.$emit("comment-setting-update",t)}},{key:"initBus",value:function(){var t=this;this.bus.$on("set-comment-setting",(function(e){t.selection=e}))}},{key:"filteredSettingOptions",get:function(){var t=this;return this.settingOptions.filter((function(e){return e.value===Na||t.settings.some((function(t){return t===e.value}))}))}},{key:"activeLabel",get:function(){var t,e=this;return(null===(t=this.settingOptions.find((function(t){return t.value===e.selection})))||void 0===t?void 0:t.label)||""}}])&&Va(e.prototype,n),i&&Va(e,i),a}(l.c);Object(c.a)([Object(l.b)()],Ka.prototype,"bus",void 0),Object(c.a)([Object(l.b)()],Ka.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)()],Ka.prototype,"settings",void 0),Object(c.a)([Object(l.d)("ifPanelShow")],Ka.prototype,"setPanelShow",null);var Ya=Ka=Object(c.a)([Object(l.a)({name:"comment-setting",components:{SvgIcon:Ba.a}})],Ka),qa=(n(320),Object(M.a)(Ya,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-setting",attrs:{tabindex:"1"},on:{blur:function(e){t.ifPanelShow=!1}}},[n("div",{staticClass:"d-i-block bp-v-middle comment-setting__btn",class:{active:t.ifPanelShow},on:{click:function(e){t.ifPanelShow=!t.ifPanelShow}}},[t._v("\n      "+t._s(t.activeLabel)+"\n      "),n("svg-icon",{staticClass:"comment-setting__icon",class:t.ifPanelShow&&"comment-setting__icon--reverse",attrs:{name:"next"}})],1),n("transition",{attrs:{name:"move-in"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.ifPanelShow,expression:"ifPanelShow"}],staticClass:"settings-panel"},t._l(t.filteredSettingOptions,(function(e,i){return n("div",{key:i,staticClass:"settings-panel__option",class:t.selection===e.value?"settings-panel__option--active":"",on:{click:function(n){return t.handleSelect(e.value)}}},[t._v(t._s(e.label))])})),0)])],1)}),[],!1,null,"9a452248",null).exports),Za=n(56),Qa={},Xa=(n(321),Object(M.a)(Qa,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"specification p-rel"},[e("iframe",{staticClass:"iframe",attrs:{src:"//t.bilibili.com/h5/dynamic/specification"}})])}],!1,null,"2fd23f66",null).exports);function tr(t){return(tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function er(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){o=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ir(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ir(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ir(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function or(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ar(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function rr(t,e){return(rr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function sr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=lr(t);if(e){var o=lr(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return cr(this,n)}}function cr(t,e){return!e||"object"!==tr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lr(t){return(lr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ur=1,dr={},fr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rr(t,e)}(a,t);var e,n,i,o=sr(a);function a(){var t;return or(this,a),(t=o.apply(this,arguments)).publishTime=new Date,t.text="",t.ctrlObj={},t.cacheAtCount=0,t.ctrlKeys=["at","vote","lottery"],t.extensionObj={},t.extendCtrlJson="{}",t.commentSetting="",t.isPublishing=!1,t.specificationShown=!1,t.specificationAgreed=!1,t.schConfirmVisible=!1,t.isScheduled=Boolean(t.editDraft||t.isLockedAsScheduled),t.imageList=[],t.textPublishParam={},t.albumPublishParam={},t.schConfirmText="",t.articleMinTextCount=400,t.articleMaxTextCount=2e4,t.articlePubConfirmVisible=!1,t.articlePubTipsVisable=!1,t}return e=a,(n=[{key:"onExtendCtrlJson",value:function(t){this.bus.$emit("extend-json-changed",t)}},{key:"onLockedAsScheduledChange",value:function(t){this.bus.$emit("schedule-trigger",t)}},{key:"onScheduleModeChange",value:function(t){var e=this.editDraft?2:this.isPopupPanel?1:0;Object(Mt.d)(Dt.d.TIMER_ICON,e),this.isScheduled=t}},{key:"onLoginUidChange",value:function(){this.initLocalStorage(),this.onTopicPageInit(),this.checkSpecification(),this.scheduleEditDraftRecovery()}},{key:"onPublishImageListChange",value:function(){this.debounceGenerateExtendCtrlJson()}},{key:"onPublishTime",value:function(t){this.bus.$emit("schedule-time-update",t)}},{key:"onIfShowArticleBtn",value:function(t){t&&(this.checkIfShowArticlePubTips(),this.articlePubShowReport())}},{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.debounceGenerateExtendCtrlJson=Object(v.b)(this.generateExtendCtrlJson,1),this.initBus()}},{key:"beforeMount",value:function(){}},{key:"mounted",value:function(){this.initLocalStorage(),this.onTopicPageInit(),this.checkSpecification(),this.scheduleEditDraftRecovery(),this.getArticleMaxLength()}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("schedule-time-update",(function(e){t.publishTime=e})),this.bus.$on("comment-setting-update",(function(e){t.commentSetting=e,t.debounceGenerateExtendCtrlJson()})),this.bus.$on("update-ctrl",(function(e){t.ctrlKeys.forEach((function(n){e[n]&&e[n]instanceof Array&&(t.ctrlObj[n]=e[n])})),t.debounceGenerateExtendCtrlJson()})),this.bus.$on("update-extension",(function(e){e.vote?t.extensionObj.vote=e.vote:null===e.vote&&delete t.extensionObj.vote,e.lottery?t.extensionObj.lottery=e.lottery:null===e.lottery&&delete t.extensionObj.lottery,e.attach?t.extensionObj.attach=e.attach:null===e.attach&&delete t.extensionObj.attach,t.debounceGenerateExtendCtrlJson()})),this.bus.$on("text-update",(function(e){t.text=e,t.debounceGenerateExtendCtrlJson()})),this.bus.$on("image-list-update",(function(e){t.imageList=e,t.debounceGenerateExtendCtrlJson()}))}},{key:"getArticleMaxLength",value:function(){var t=this;this.bpapi({method:"get",url:"//api.bilibili.com/x/article/conf"}).then((function(e){t.articleMaxTextCount=e.content_max||t.articleMaxTextCount}))}},{key:"onPublishBtnClick",value:function(){if(this.disabled)this.textLength>this.articleMaxTextCount?this.linkMsg(this.$refs.publishBtn,"超过规定字数了哦~","caution"):this.ifArticleBtnActive&&this.showArticlePubConfirm();else{var t=this.schConfirmVisible?this.$refs.schPubConfirm.buttons.confirmBtn:this.$refs.publishBtn;if(this.isPopupPanel?Object(Mt.d)(Dt.d.PUBLICH_CLICK_2,""):Object(Mt.d)(Dt.d.PUBLICH_CLICK_1,""),!this.isPublishing){if(!this.specificationAgreed)return void this.showSpecification();this.isPublishing=!0,this.publishImageList.length>0?this.publishAlbum(t):this.publishText(t)}}}},{key:"showSpecification",value:function(){if(this.specificationAgreed||this.specificationShown)return!1;this.specificationShown=!0}},{key:"generateExtendCtrlJson",value:function(){var t={from:{emoji_type:1}},e=this.ctrlObj.lottery,n=this.ctrlObj.vote,i=(this.ctrlObj.at||[]).slice(0,20);this.ctrlObj.at&&this.cacheAtCount!==this.ctrlObj.at.length&&(this.cacheAtCount=Math.min(this.ctrlObj.at.length,20),this.bus.$emit("at-update",this.cacheAtCount));var o=e?e.slice():[],a=[],r=function(t,e){for(var n=!0,i=0;i<a.length;i++){var o=nr(a[i],2),r=o[0];if(!(n=!!(t>=o[1]||e<=r)))break}return n};e instanceof Array&&e.length>0?(this.bus.$emit("has-lottery",!0),e.forEach((function(t){a.push([t.location,t.location+Number(t.data)])}))):this.bus.$emit("has-lottery",!1),n instanceof Array&&n.length>0?(this.bus.$emit("has-vote",!0),n.forEach((function(t){r(t.location,t.location+Number(t.data))&&(a.push([t.location,t.location+Number(t.data)]),o.push(t))}))):this.bus.$emit("has-vote",!1);var s=[];i instanceof Array&&i.forEach((function(t){r(t.location,t.location+t.length)&&(o.push(t),s.push(t.data))})),t.ctrl=o,this.extensionObj.vote&&(t.vote=this.extensionObj.vote),this.extensionObj.lottery&&(t.lottery=this.extensionObj.lottery),this.extensionObj.attach&&(t.attach={type:{1:"manga",2:"pugv",3:"ogv",4:"activity"}[this.extensionObj.attach.type],id:this.extensionObj.attach.id}),this.extendCtrlJson=JSON.stringify(t);var c=Object(d.c)(this.content),l={dynamic_id:0,type:4,rid:0,content:c,up_choose_comment:this.commentSetting===Ha?1:0,up_close_comment:this.commentSetting===Ua?1:0},u={biz:3,category:3,type:0,pictures:JSON.stringify(this.publishImageList),title:"",tags:"",description:c,content:c,setting:this.isScheduled?void 0:JSON.stringify({copy_forbidden:0,cachedTime:0}),from:"create.dynamic.web",up_choose_comment:this.commentSetting===Ha?1:0,up_close_comment:this.commentSetting===Ua?1:0};if(t.attach&&t.attach.type)try{dr=er({},t.attach.type,er({},"".concat(t.attach.type,"_id"),parseInt(t.attach.id)))}catch(t){dr={}}var f={emoji_type:1,from:{emoji_type:1},vote_cfg:t.vote,lott_cfg:t.lottery,flag_cfg:dr},h=JSON.stringify(t.ctrl);l.extension=JSON.stringify(f),l.at_uids=s.join(","),l.ctrl=h,u.extension=JSON.stringify(f),u.at_uids=s.join(","),u.at_control=h,this.textPublishParam=l,this.albumPublishParam=u,this.setLocalStorage()}},{key:"onTopicPageInit",value:function(){this.topicName&&""===this.text&&this.bus.$emit("text-update","#".concat(this.topicName,"# "))}},{key:"checkSpecification",value:function(){this.specificationAgreed=1===parseInt(v.a.getItem("dy_spec_agreed"))}},{key:"publishText",value:function(t){var e=this;this.bpapi({url:"".concat(_.a.API_VC,"/dynamic_svr/v1/dynamic_svr/create"),method:"post",data:this.textPublishParam}).then((function(n){0===n.data.result?(e.bus.$emit("empty-attach-data"),e.linkMsg(t,"发布成功 ".concat(Ct.randomEmoji.happy()),"success"),e.dispatchFeedUpdate(n.data.dynamic_id),e.$emit("succeed",{isScheduled:!1}),e.handlePublishComplete()):2===n.data.result?Object(Ct.showVerifyPopup)(e):e.linkMsg(t,n.data.errmsg,"caution"),e.publishHandler&&e.publishHandler(),e.isPublishing=!1}),(function(n){e.linkMsg(t,n.msg,n.type),e.isPublishing=!1}))}},{key:"publishAlbum",value:function(t){var e=this;this.bpapi({url:"".concat(_.a.API_VC,"/dynamic_svr/v1/dynamic_svr/create_draw"),method:"post",data:this.albumPublishParam}).then((function(n){e.bus.$emit("empty-attach-data"),e.linkMsg(t,"发布成功 ".concat(Ct.randomEmoji.happy()),"success"),setTimeout((function(){e.dispatchFeedUpdate(n.data.dynamic_id)}),1e3),e.$emit("succeed",{isScheduled:!1}),e.handlePublishComplete(),e.publishHandler&&e.publishHandler()}),(function(n){e.linkMsg(t,n.msg,n.type),e.isPublishing=!1}))}},{key:"showArticlePubConfirm",value:function(){this.ifArticleBtnActive&&(this.articlePubConfirmVisible=!0)}},{key:"articlePubConfirm",value:function(){if(this.ifArticleBtnActive){var t=this.content,e={infoDescription:t=t.replace(/\r\n/g,"\n").replace(/%/g,"%25"),images:this.publishImageList.map((function(t){return t.img_src.replace(/^http:/,"https:")})),vote:null},n="https://member.bilibili.com/v2#/upload/text/edit?config=".concat(encodeURIComponent(JSON.stringify(e)));window.open(n),this.articlePubConfirmVisible=!1,this.articlePubClickReport(),this.handlePublishComplete()}else this.textLength>this.articleMaxTextCount&&this.linkMsg(this.$refs.publishBtn,"超过规定字数了哦~","caution")}},{key:"handlePublishComplete",value:function(){this.resetPublishBox(),this.isPublishing=!1,this.schConfirmVisible=!1,u.b.$emit("textChange","")}},{key:"schPubConfirm",value:function(){var t,e,n,i=this,o=this.$refs.schPubConfirm.buttons.confirmBtn;this.editDraft?(n=i.editDraft.draft_id,i.publishImageList.length>0?(e=2,t=i.albumPublishParam):(e=4,t=i.textPublishParam),i.bpapi({url:"".concat(_.a.API_VC,"/dynamic_draft/v1/dynamic_draft/publish_now"),method:"post",data:{draft_id:n,type:e,request:JSON.stringify(t)}}).then((function(t){i.linkMsg(o,"发送成功",t.type),i.schConfirmVisible=!1,i.$emit("succeed",{isScheduled:!1}),i.handlePublishComplete(),i.publishHandler&&i.publishHandler()}),(function(t){i.linkMsg(o,t.msg,"error"),i.schConfirmVisible=!1,i.$emit("failed",t)}))):this.onPublishBtnClick()}},{key:"scheduledPublish",value:function(){var t=this;if(this.schPubDisabled)this.textLength>this.articleMaxTextCount?this.linkMsg(this.$refs.publishBtn,"超过规定字数了哦~","caution"):this.ifArticleBtnActive&&this.showArticlePubConfirm();else{var e=this.editDraft?2:this.isPopupPanel?1:0;Object(Mt.d)(Dt.d.TIMER_SET,e);var n=this.$refs.publishBtn;if(this.specificationAgreed){var i,o,a,r,s=function(e){t.schConfirmText=e,t.schConfirmVisible=!0},c=new Date;this.publishTime.getTime()-c.getTime()<-6e4||this.publishTime.getTime()-c.getTime()<0&&this.publishTime.getMinutes()!==c.getMinutes()?s("设置的时间点已过，是否直接发布？"):this.publishTime.getTime()-c.getTime()<3e5?s("设置的时间点过于接近当前时间，是否直接发布？"):(r=function(){t.$emit("succeed",{isScheduled:!0,draft:{draft_id:a,publish_time:Math.ceil(t.publishTime.getTime()/1e3),type:o,request:JSON.stringify(i),publish_status:0}})},t.publishImageList.length>0?(o=2,i=t.albumPublishParam):(o=4,i=t.textPublishParam),t.editDraft?t.bpapi({url:"".concat(_.a.API_VC,"/dynamic_draft/v1/dynamic_draft/modify_draft"),method:"post",data:{draft_id:t.editDraft.draft_id,type:o,publish_time:Math.ceil(t.publishTime.getTime()/1e3),request:JSON.stringify(i)}}).then((function(){t.bus.$emit("empty-attach-data"),u.b.$emit("refresh-draft-feed",!0),t.linkMsg(n,"编辑定时发布成功","success"),a=t.editDraft.draft_id,r(),t.handlePublishComplete(),t.publishHandler&&t.publishHandler()}),(function(e){t.linkMsg(n,e.msg,"error"),t.$emit("failed",e)})):t.bpapi({url:"".concat(_.a.API_VC,"/dynamic_draft/v1/dynamic_draft/add_draft"),method:"post",data:{type:o,publish_time:Math.ceil(t.publishTime.getTime()/1e3),request:JSON.stringify(i)}}).then((function(e){t.bus.$emit("empty-attach-data"),t.linkMsg(n,"定时发布成功","success"),a=e.data.draft_id,r(),t.handlePublishComplete(),t.publishHandler&&t.publishHandler()}),(function(e){t.linkMsg(n,e.msg,"error"),t.$emit("failed",e)})))}else this.showSpecification()}}},{key:"dispatchFeedUpdate",value:function(t){t&&this.bpapi({url:"".concat(_.a.API_VC,"/dynamic_svr/v1/dynamic_svr/get_dynamic_detail"),method:"get",data:{dynamic_id:t}}).then((function(t){u.b.$emit(Dt.b.ADD,t.data.card)}))}},{key:"generateAlbumFakeCard",value:function(t,e){try{var n={at_control:t.at_control,category:"daily",description:t.description,pictures:t.pictures,pictures_count:t.pictures.length,reply:0,role:"",source:"",title:"",id:e.doc_id},i=u.r.getMyUserInfo(),o={head_url:i.card.face,uid:i.card.mid,name:i.card.name},a={type:Dt.a.PIC,uid:~~i.card.mid,dynamic_id:"-".concat(ur),user_profile:{card:{},info:{face:i.card.face,uid:i.card.mid,uname:i.card.name,platform_user_level:(i.card.level_info||{}).current_level}},timestamp:Date.now()};ur+=1;var r={card:JSON.stringify({item:n,user:o}),desc:a,extend_json:t.extension,did:e.dynamic_id_str};u.b.$emit(Dt.b.ADD,r)}catch(t){console.error(t)}}},{key:"resetPublishBox",value:function(){this.bus.$emit("reset"),this.bus.$emit("set-comment-setting",""),this.editDraft||this.isLockedAsScheduled||this.bus.$emit("schedule-trigger",!1)}},{key:"specificationConfirm",value:function(){v.a.setItem("dy_spec_agreed",1,1/0,"/",".bilibili.com"),this.specificationAgreed=!0,this.specificationShown=!1,this.isScheduled?this.scheduledPublish():this.onPublishBtnClick()}},{key:"specificationCancel",value:function(){this.specificationShown=!1}},{key:"scheduleEditDraftRecovery",value:function(){if(this.editDraft){var t=Number(this.editDraft.publish_time);Number.isNaN(t)||(this.publishTime=new Date(1e3*t)),this.bus.$emit("schedule-trigger",!0);var e=Object(v.e)(this.editDraft.request);if(e.pictures){var n=[];n="string"==typeof e.pictures?Object(v.e)(e.pictures):e.pictures,this.bus.$emit("image-draft-update",n)}var i=e.content||"";this.bus.$emit("text-update",i),e.up_choose_comment?this.bus.$emit("set-comment-setting",Ha):e.up_close_comment?this.bus.$emit("set-comment-setting",Ua):this.bus.$emit("set-comment-setting",Na)}}},{key:"setLocalStorage",value:function(){if("undefined"!=typeof window&&this.loginUid&&!this.isLockedAsScheduled)if(this.content.length>0||this.publishImageList.length>0){if(this.topicName)return;var t={text:this.content,ctrlObj:this.ctrlObj,extensionObj:this.extensionObj,imageList:this.publishImageList};window.localStorage.setItem("bp_publish_draft_v2_".concat(this.loginUid),JSON.stringify(t))}else window.localStorage.removeItem("bp_publish_draft_v2_".concat(this.loginUid))}},{key:"initLocalStorage",value:function(){if(this.storeInput&&!this.isLockedAsScheduled&&"undefined"!=typeof window&&this.loginUid){var t=window.localStorage.getItem("bp_publish_draft_v2_".concat(this.loginUid));if(t){var e=Object(v.e)(t);this.bus.$emit("text-update",e.text);var n=e.ctrlObj.vote?e.ctrlObj.vote[0]:null,i=e.extensionObj.vote;this.bus.$emit("vote-restore",{ctrl:n,extension:i});var o=e.ctrlObj.lottery?e.ctrlObj.lottery[0]:null,a=e.extensionObj.lottery;this.bus.$emit("lottery-restore",{ctrl:o,extension:a})}}}},{key:"checkIfShowArticlePubTips",value:function(){var t=this;"undefined"!=typeof window&&"true"!==window.localStorage.getItem("dynamic_article_publish_intro_".concat(this.loginUid))&&(t.articlePubTipsVisable=!0,window.localStorage.setItem("dynamic_article_publish_intro_".concat(t.loginUid),String(!0)),setTimeout((function(){t.articlePubTipsVisable=!1}),5e3))}},{key:"articlePubShowReport",value:function(){var t="444.41",e="publish_article_show1";this.isPopupPanel&&(e="publish_article_show2"),this.topicName&&(e="publish_article_show",t="333.169"),Ie.a.event({spmId:t,event:e})}},{key:"articlePubClickReport",value:function(){var t="444.41",e="publish_article_click1";this.isPopupPanel&&(e="publish_article_click2"),this.topicName&&(e="publish_article_click",t="333.169"),Ie.a.event({spmId:t,event:e})}},{key:"content",get:function(){return this.text.replace(/\n{2,}/g,"\n\n").replace(/^\n+/,"").replace(/\n+$/,"").replace(/^ +/,"").replace(/ +$/," ")}},{key:"settings",get:function(){var t=[];return this.canCloseComment&&t.push(Ua),this.canPickComment&&t.push(Ha),t}},{key:"hasSettingPermission",get:function(){return this.settings.length>0}},{key:"textLength",get:function(){return Object(u.g)(this.content)}},{key:"leftTextCount",get:function(){return this.maxLength-this.textLength}},{key:"indicatorShowTextCount",get:function(){return this.leftTextCount<0?this.leftTextCount:this.textLength}},{key:"ifShowArticleBtn",get:function(){return this.textLength>=this.articleMinTextCount&&!this.editDraft&&!this.isLockedAsScheduled}},{key:"ifArticleBtnActive",get:function(){return this.textLength>=this.articleMinTextCount&&this.textLength<=this.articleMaxTextCount}},{key:"publishBtnText",get:function(){var t="发布";return this.isScheduled?t=!this.editDraft&&this.scheduledCount>20?"已满上限":"定时发布":this.isPublishing&&(t="发布中"),t}},{key:"publishImageList",get:function(){return this.imageList.filter((function(t){return!t.status&&t.img_src&&""!==t.img_src})).map((function(t){return{img_src:t.img_src,img_width:t.img_width,img_height:t.img_height,img_size:t.img_size}}))}},{key:"disabled",get:function(){return 0===this.textLength&&0===this.publishImageList.length||this.textLength>this.maxLength||this.imageList.length!==this.publishImageList.length||this.topicName&&this.content==="#".concat(this.topicName,"#")}},{key:"schPubDisabled",get:function(){return this.disabled||!this.editDraft&&this.scheduledCount>=20}}])&&ar(e.prototype,n),i&&ar(e,i),a}(l.c);Object(c.a)([Object(l.b)()],fr.prototype,"bus",void 0),Object(c.a)([Object(l.b)()],fr.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)({type:Number,default:function(){return 1e3}})],fr.prototype,"maxLength",void 0),Object(c.a)([Object(l.b)(String)],fr.prototype,"topicName",void 0),Object(c.a)([Object(l.b)()],fr.prototype,"editDraft",void 0),Object(c.a)([Object(l.b)(Number)],fr.prototype,"scheduledCount",void 0),Object(c.a)([Object(l.b)(Boolean)],fr.prototype,"storeInput",void 0),Object(c.a)([Object(l.b)(Boolean)],fr.prototype,"isPopupPanel",void 0),Object(c.a)([Object(l.b)(Boolean)],fr.prototype,"onScheduleMode",void 0),Object(c.a)([Object(l.b)(Function)],fr.prototype,"publishHandler",void 0),Object(c.a)([Object(l.b)(Boolean)],fr.prototype,"isLockedAsScheduled",void 0),Object(c.a)([Object(l.b)(Boolean)],fr.prototype,"canPickComment",void 0),Object(c.a)([Object(l.b)(Boolean)],fr.prototype,"canCloseComment",void 0),Object(c.a)([Object(l.d)("extendCtrlJson")],fr.prototype,"onExtendCtrlJson",null),Object(c.a)([Object(l.d)("isLockedAsScheduled")],fr.prototype,"onLockedAsScheduledChange",null),Object(c.a)([Object(l.d)("onScheduleMode")],fr.prototype,"onScheduleModeChange",null),Object(c.a)([Object(l.d)("loginUid")],fr.prototype,"onLoginUidChange",null),Object(c.a)([Object(l.d)("publishImageList")],fr.prototype,"onPublishImageListChange",null),Object(c.a)([Object(l.d)("publishTime")],fr.prototype,"onPublishTime",null),Object(c.a)([Object(l.d)("ifShowArticleBtn")],fr.prototype,"onIfShowArticleBtn",null);var hr,pr=fr=Object(c.a)([Object(l.a)({name:"publish-launcher",components:{DynamicSpecification:Xa,BpPopup:Za.a,CommentSetting:qa}})],fr),mr=(n(322),Object(M.a)(pr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"publish-launcher",class:{"is-popup-panel":t.isPopupPanel}},[n("span",{directives:[{name:"show",rawName:"v-show",value:0!==t.indicatorShowTextCount,expression:"indicatorShowTextCount !== 0"}],staticClass:"indicator",class:{"too-long":t.textLength>t.maxLength},attrs:{title:"全角字符计数为1\n半角字符计数为0.5，不足1时记为1"}},[t._v(t._s(t.indicatorShowTextCount))]),t.hasSettingPermission?n("comment-setting",{attrs:{settings:t.settings,bus:t.bus,"login-uid":t.loginUid}}):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:t.ifShowArticleBtn,expression:"ifShowArticleBtn"}],staticClass:"article-pub-btn-box"},[t.articlePubTipsVisable&&t.ifShowArticleBtn?n("div",{staticClass:"article-pub-tips"},[n("span",[t._v("字数较多，点击可以快速发布专栏")]),n("i",{staticClass:"bp-icon-font icon-group-dynamic",on:{click:function(e){t.articlePubTipsVisable=!1}}})]):t._e(),n("button",{staticClass:"publish-btn d-i-block bp-v-middle to-article",class:{disabled:!t.ifArticleBtnActive},on:{click:t.articlePubConfirm}},[t._v("转为专栏\n    ")])]),t.isScheduled?t._e():n("button",{ref:"publishBtn",staticClass:"publish-btn d-i-block bp-v-middle",class:{publishing:t.isPublishing,disabled:t.disabled&&!t.ifArticleBtnActive},on:{click:t.onPublishBtnClick}},[t._v(t._s(t.publishBtnText)+"\n  ")]),t.isScheduled?n("button",{ref:"publishBtn",staticClass:"publish-btn d-i-block bp-v-middle",class:{publishing:t.isPublishing,disabled:t.schPubDisabled&&!t.ifArticleBtnActive},on:{click:t.scheduledPublish}},[t._v(t._s(t.publishBtnText)+"\n  ")]):t._e(),n("bp-popup",{staticClass:"dynamic-specification-popup",class:{"is-popup":t.isPopupPanel},attrs:{show:t.specificationShown,width:796,button:{confirm:"确认并发送"},"on-confirm":t.specificationConfirm,"on-cancel":t.specificationCancel}},[n("dynamic-specification")],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.schConfirmVisible,expression:"schConfirmVisible"}],staticClass:"sch-confirm-wrapper"},[n("bp-popup",{ref:"schPubConfirm",staticClass:"sch-confirm",attrs:{show:t.schConfirmVisible,button:{confirm:"是",cancel:"否"},width:360,onConfirm:t.schPubConfirm,onCancel:function(){t.schConfirmVisible=!1}}},[n("p",[t._v(t._s(t.schConfirmText))])])],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.articlePubConfirmVisible,expression:"articlePubConfirmVisible"}],staticClass:"sch-confirm-wrapper"},[n("bp-popup",{ref:"artPubConfirm",staticClass:"sch-confirm",attrs:{title:"动态字数过多",show:t.articlePubConfirmVisible,button:{confirm:"发布专栏",cancel:"取消"},width:360,onConfirm:t.articlePubConfirm,onCancel:function(){t.articlePubConfirmVisible=!1}}},[n("p",[t._v("是否转为专栏发布？")])])],1)],1)}),[],!1,null,"d0fcfa2c",null).exports);n(219),n(323);function gr(t){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function br(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function yr(t,e){return(yr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _r(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=wr(t);if(e){var o=wr(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Cr(this,n)}}function Cr(t,e){return!e||"object"!==gr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wr(t){return(wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ir(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var xr=[{type:"comment-setting",active:"default",config:(hr={},Ir(hr,"default",""),Ir(hr,Ha,"动态发布后评论内容在经过你的精选后向所有用户展示"),Ir(hr,Ua,"动态发布后将关闭评论区"),hr)}],kr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yr(t,e)}(a,t);var e,n,i,o=_r(a);function a(){var t;return vr(this,a),(t=o.apply(this,arguments)).config={},t}return e=a,(n=[{key:"created",value:function(){this.init()}},{key:"init",value:function(){var t=this;xr.forEach((function(e){t.$set(t.config,e.type,e),t.bus.$on("".concat(e.type,"-update"),(function(n){var i=n||"default";t.config[e.type].active=i}))}))}},{key:"render",value:function(){var t=arguments[0],e=Object.values(this.config).map((function(t){return t.config[t.active]})).filter(Boolean);return t("div",{class:"publish-tip"},[e.map((function(e){return t("div",[e])}))])}}])&&br(e.prototype,n),i&&br(e,i),a}(l.c);Object(c.a)([Object(l.b)()],kr.prototype,"bus",void 0);var Or=kr=Object(c.a)([Object(l.a)({name:"publish-tip"})],kr),Sr=(n(80),n(81),n(46),n(164)),Pr={},Tr=(n(324),Object(M.a)(Pr,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"specification p-rel"},[e("iframe",{staticClass:"iframe",attrs:{src:"//t.bilibili.com/h5/dynamic/specification"}})])}],!1,null,"7f2da7ec",null).exports),jr={props:{arrow:{type:Boolean,default:!1},width:{type:Number,default:300}},data:function(){return{}},methods:{onClose:function(t){this.$emit("close"),t.stopPropagation()}}},Lr=(n(325),Object(M.a)(jr,(function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"move-in"}},[e("div",{staticClass:"static-popup",class:{"bp-arrow":this.arrow},style:{width:this.width+"px"}},[e("div",{staticClass:"bp-icon-font icon-group-dynamic close-btn",on:{click:this.onClose}}),e("div",{staticClass:"title"},[this._t("title")],2),e("div",{staticClass:"content-ctnr"},[this._t("default")],2)])])}),[],!1,null,"3bcd26f6",null).exports),Ar={data:function(){return{isShow:!0}},props:{status:{type:String,default:""},errorText:{type:String,default:""},imgUrl:{type:String,default:""}},computed:{bgImg:function(){var t=Object(v.g)(Object(Ct.bfsImgLink)(this.imgUrl,80,80,{e:1,c:1}));return/\.gif$/.test(t)&&(t+="@1s.jpg"),t}}},Er=(n(326),Object(M.a)(Ar,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload-status"},["loading"===t.status?n("div",{staticClass:"loading-wrapper"},[n("span",{staticClass:"loading"})]):t._e(),"error"===t.status?n("div",{staticClass:"error-wrapper b-box"},[n("span",{staticClass:"bp-svg-icon error"}),n("span",{staticClass:"reason",domProps:{textContent:t._s(t.errorText)}})]):t._e(),t.imgUrl?n("div",{staticClass:"success-wrapper bg-center bg-cover",style:{backgroundImage:"url("+t.bgImg+")"}}):t._e(),t._t("editBtn"),t._t("close")],2)}),[],!1,null,"20c6bfae",null).exports);function Mr(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function Dr(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){Mr(a,i,o,r,s,"next",t)}function s(t){Mr(a,i,o,r,s,"throw",t)}r(void 0)}))}}function Rr(t){return new Promise((function(e){var n=new FileReader;n.onload=function(t){var n=new DataView(t.target.result);65496!==n.getUint16(0,!1)&&e(-2);for(var i=n.byteLength,o=2;o<i;){n.getUint16(o+2,!1)<=8&&e(-1);var a=n.getUint16(o,!1);if(o+=2,65505===a){1165519206!==n.getUint32(o+=2,!1)&&e(-1);var r=18761===n.getUint16(o+=6,!1);o+=n.getUint32(o+4,r);var s=n.getUint16(o,r);o+=2;for(var c=0;c<s;c++)274===n.getUint16(o+12*c,r)&&e(n.getUint16(o+12*c+8,r))}else{if(65280!=(65280&a))break;o+=n.getUint16(o,!1)}}e(-1)},n.readAsArrayBuffer(t)}))}function Br(){return(Br=Dr(st.a.mark((function t(e){var i,o,a,r,s,c,l,u;return st.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Rr(e);case 2:if(!((i=t.sent)<2||i>8)){t.next=5;break}return t.abrupt("return",e);case 5:return(o=new Image).src=window.URL?window.URL.createObjectURL(e):window.webkitURL.createObjectURL(e),t.next=9,new Promise((function(t){o.onload=function(){return t()}}));case 9:if(s=0,c=!1,[5,6,7,8].some((function(t){return t===i}))?(a=o.height,r=o.width):(a=o.width,r=o.height),[7,8].some((function(t){return t===i}))&&(s=1.5*Math.PI),[3,4].some((function(t){return t===i}))&&(s=Math.PI),[5,6].some((function(t){return t===i}))&&(s=.5*Math.PI),[2,4,5,7].some((function(t){return t===i}))&&(c=!0),l=document.createElement("canvas"),u=l.getContext("2d"),l.width=a,l.height=r,c&&(u.translate(a,0),u.scale(-1,1)),u.translate(a/2,r/2),u.rotate(s),u.drawImage(o,-o.width/2,-o.height/2),l.toBlob){t.next=27;break}return t.next=27,n.e(2).then(n.t.bind(null,588,7));case 27:return t.abrupt("return",new Promise((function(t){l.toBlob((function(e){return t(e)}),"image/jpeg")})));case 28:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Nr={data:function(){return{uid:"",localUploadList:[],gifMaxMByte:8,errorType:{common:"上传失败",mbyte:"文件大小请勿超过".concat(this.maxMByte,"M"),gifbype:"请上传小于".concat(8,"M的gif图"),size:"宽高均不得小于".concat(this.minWidth,"像素"),format:"仅支持JPG PNG GIF"},uploadBtnStyle:{}}},mounted:function(){var t=this;this.localUploadList=this.localUploadList.concat(this.draftPic),this.setInitFiles(),new kt.a(this.$refs.uploadList,{filter:".close",draggable:".draggable",animation:500,onMove:function(t){return t.related&&t.related.className.indexOf("draggable")>=0},onEnd:function(e){t.localUploadList.splice(e.newIndex,0,t.localUploadList.splice(e.oldIndex,1)[0])}})},watch:{localUploadList:function(t){this.$emit("update",t)}},props:{initFiles:{},draftPic:{type:Array,default:function(){return[]}},editStatus:{type:Boolean,default:!0},maxAmount:{type:Number,default:20},formatList:{type:Array,default:function(){return["jpg","jpeg","png","gif"]}},maxMByte:{type:Number,default:20},minWidth:{type:Number,default:10},minHeight:{type:Number,default:10}},components:{UploadStatus:Er},methods:{setInitFiles:function(){this.initFiles.length>0&&(this.checkFilesAmount(this.initFiles),this.selectImage(this.initFiles))},selectImage:function(t){var e=this,n=Array.prototype.map.call(t,(function(){return{status:"loading",errorText:"",imgUrl:""}})),i=this.localUploadList.length;this.localUploadList=this.localUploadList.concat(n),this.localUploadList.length>this.maxAmount&&this.localUploadList.splice(this.maxAmount,this.localUploadList.length-this.maxAmount);for(var o=function(n,o){var a=t[n-i];e.checkFormat(a.type)||e.$set(e.localUploadList,n,{status:"error",errorText:e.errorType.format,id:e.randomNum()});var r=function(t){var i=new Image;i.src=URL.createObjectURL(t),i.onload=function(){var o=e.checkImage(a.type,a.size,i.width,i.height);o?e.$set(e.localUploadList,n,{status:"error",errorText:o,id:e.randomNum()}):e.uploadImage(t,n)}};["jpg","jpeg"].some((function(t){return a.type.indexOf(t)>-1}))?function(t){return Br.apply(this,arguments)}(a).then((function(t){r(t)})):r(a)},a=i,r=this.localUploadList.length;a<r;a++)o(a)},uploadImage:function(t,e){var n=this,i=new FormData;i.append("file_up",t),i.append("biz","draw"),i.append("category","daily"),this.bpapi({url:"".concat(_.a.API_VC,"/api/v1/drawImage/upload"),method:"post",data:i,headers:{"Content-Type":"multipart/form-data"}}).then((function(i){n.$set(n.localUploadList,e,{img_src:i.data.image_url,img_width:i.data.image_width,img_height:i.data.image_height,img_size:t.size/1024,id:n.randomNum()})}),(function(){n.$set(n.localUploadList,e,{status:"error",errorText:"上传失败",id:n.randomNum()})}))},clickSelect:function(t){var e=t.target||t.srcElement,n=e.files;this.checkFilesAmount(n),this.selectImage(n),e.value=""},dropSelect:function(t){t.stopPropagation(),t.preventDefault();var e=t.dataTransfer.files;this.checkFilesAmount(e),this.selectImage(e)},checkFilesAmount:function(t){this.localUploadList.length+t.length>this.maxAmount&&this.linkMsg(this.$refs.uploadBtn,"上传图片不得超过".concat(this.maxAmount,"张（￣∞￣）"),"caution")},dragover:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},checkImage:function(t,e,n,i){return this.checkFormat(t)?t.indexOf("gif")>-1&&Math.floor(e/1024/1024)>=this.gifMaxMByte?this.errorType.gifbype:Math.floor(e/1024/1024)>=this.maxMByte?this.errorType.mbyte:(n<this.minWidth||i<this.minHeight)&&this.errorType.size:this.errorType.format},checkFormat:function(t){for(var e=0,n=this.formatList.length;e<n;e++)if(t.indexOf(this.formatList[e])>-1)return!0},removeUploadItem:function(t){this.localUploadList.splice(t,1)},randomNum:function(){return Date.now()*Math.ceil(1e5*Math.random())}}},Ur=(n(327),Object(M.a)(Nr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload-image-wrapper"},[n("div",{ref:"dropZone",staticClass:"upload-image",class:{center:!t.localUploadList.length},on:{dragover:t.dragover,drop:t.dropSelect}},[n("div",{ref:"uploadList",staticClass:"f-clear upload-list"},[t._l(t.localUploadList,(function(e,i){return n("upload-status",{key:e.id||e.img_src,staticClass:"draggable f-left",attrs:{status:e.status,"error-text":e.errorText,"img-url":e.img_src}},[n("span",{staticClass:"close pointer a-fade-in",attrs:{slot:"close"},on:{click:function(e){return t.removeUploadItem(i)}},slot:"close"},[n("i",{staticClass:"bp-icon-font icon-group-dynamic c-pointer"})])])})),n("div",{directives:[{name:"show",rawName:"v-show",value:t.localUploadList.length<parseInt(t.maxAmount),expression:"localUploadList.length < parseInt(maxAmount)"}],ref:"uploadBtn",staticClass:"f-left upload-btn b-box"},[n("input",{ref:"uploadInput",staticClass:"upload pointer",attrs:{type:"file",accept:"image/png, image/jpeg, image/jpg, image/gif",multiple:""},on:{change:t.clickSelect}}),n("i",{staticClass:"bp-icon-font icon-add pointer"})])],2)])])}),[],!1,null,"14a3591d",null).exports),Hr={props:{initFiles:{},draftPic:{type:Array,default:function(){return[]}}},data:function(){return{imageList:[],selectedFiles:this.initFiles}},components:{StaticBox:Lr,ImageUploader:Ur},methods:{updateImageList:function(t){this.imageList=t,this.$emit("update",t)},close:function(){this.$emit("close")}}},$r=(n(328),Object(M.a)(Hr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("static-box",{staticClass:"upload-image-box",attrs:{width:290,arrow:!0},on:{close:t.close}},[n("span",{attrs:{slot:"title"},slot:"title"},[t._v("图片上传"),n("span",{staticClass:"d-i-block hint"},[t._v(t._s(t.imageList.length)+" / 9")])]),n("image-uploader",{attrs:{"max-amount":9,"init-files":t.selectedFiles,"draft-pic":t.draftPic},on:{update:t.updateImageList}})],1)}),[],!1,null,"64344f08",null).exports),zr={props:{size:{type:Number,default:16},value:{type:Boolean,default:!1}},data:function(){return{}},computed:{checkboxStyle:function(){return"width: ".concat(this.size,"px; height: ").concat(this.size,"px")}},watch:{},components:{},created:function(){},methods:{}},Vr=(n(329),Object(M.a)(zr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"c-pointer",on:{click:function(e){return t.$emit("input",!t.value)}}},[n("div",{staticClass:"checkbox",class:{checked:t.value},style:t.checkboxStyle},[n("input",{staticClass:"hidden",attrs:{type:"checkbox"}})]),t._t("default")],2)}),[],!1,null,"873af74a",null).exports),Fr={name:"div-edit",props:{value:{type:String,default:""},placeholder:{type:String,default:"有什么想和大家分享的？"},divClass:{type:Object},loginUid:{type:Number},storeInput:{tpye:Boolean,default:!1}},data:function(){return{waitInput:!1,isLocked:!1,content:"",nodes:[]}},computed:{},created:function(){Object(d.b)()},mounted:function(){var t=this;this.$refs.div.focus(),this.$emit("input",Object(u.f)(this.$refs.div)),setTimeout((function(){t.$refs.div.value=Object(u.f)(t.$refs.div),t.content=t.$refs.div.value}))},watch:{value:function(){this.isLocked&&this.value||(this.content=this.$refs.div.value,this.$refs.div.value=Object(u.f)(this.$refs.div)),""===this.value&&(this.$refs.div.textContent="",this.$refs.div.value="",this.content="")}},methods:{changeText:function(){var t=this,e=Object(u.f)(this.$refs.div);if(!this.waitInput&&e&&""===e.trim())return this.$refs.div.textContent="",this.$refs.div.value="",void(this.content="");this.$refs.div.value=e,this.content=this.$refs.div.value,this.$emit("input",e),this.$nextTick((function(){var e=t.$refs.div.childNodes;t.nodes=[];for(var n=0;n<e.length;n++)"#text"===e[n].nodeName?t.nodes.push(Object(u.c)(e[n].nodeValue)):t.nodes.push(e[n].outerHTML);t.storeInput&&localStorage.setItem("dynamic_publisher_div_html_".concat(t.loginUid),JSON.stringify(t.nodes))}))},onPaste:function(t){var e="";(e=window.clipboardData&&window.clipboardData.setData?window.clipboardData.getData("text"):(t.originalEvent||t).clipboardData.getData("text/plain")||"")&&(window.getSelection().deleteFromDocument(),Object(u.f)(this.$refs.div).trim()||e.trim()?(e=(e=Object(u.c)(e).replace(/ /g,"&nbsp")).replace(/\r\n/g,"<br>").replace(/\r/g,"<br>").replace(/\n/g,"<br>"),e=Object(d.e)(e),this.insertHtmlAtCaret(e)):this.$emit("input",""))},insertHtmlAtCaret:function(t){Object(u.j)(t),this.$refs.div.value=Object(u.f)(this.$refs.div),this.content=this.$refs.div.value}}},Wr=(n(330),Object(M.a)(Fr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{"placeholder-shown":!t.content},attrs:{placeholder:t.placeholder}},[n("div",{ref:"div",staticClass:"editor",class:t.divClass,attrs:{contenteditable:"true"},on:{input:t.changeText,DOMNodeInserted:t.changeText,compositionstart:function(e){t.waitInput=!0},compositionend:function(e){t.waitInput=!1},focus:function(e){t.isLocked=!0},blur:function(e){t.isLocked=!1},paste:function(e){return e.preventDefault(),t.onPaste(e)}}})])}),[],!1,null,"00414ad8",null).exports);function Gr(t){return function(t){if(Array.isArray(t))return Jr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Jr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jr(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Kr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Yr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Kr(Object(n),!0).forEach((function(e){qr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function qr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Zr=1;var Qr={data:function(){return{isPopupPanel:!1,emojiBoxShown:!1,imageBoxShown:!1,settingShown:!1,userInput:"",maxLength:233,textarea:null,emojiTrigger:null,imageList:[],selectedFiles:{},isPublishing:!1,supportFileUpload:!1,specificationAgreed:!1,specificationShown:!1,uid:"",draftPic:[],isMounted:!1,atItems:[],voteShow:!1,voteConfig:{},lotteryShow:!1,lotteryConfig:{},pickCommentOn:!1,nodes:[],isSafari:!1,isIE:!1,isScheduled:Boolean(this.editDraft||this.isLockedAsScheduled),publishTime:void 0,schPubTipsVisable:!1,schConfirmVisible:!1,schConfirmText:""}},computed:{content:function(){return this.userInput.replace(/\n{2,}/g,"\n\n").replace(/^\n+/,"").replace(/\n+$/,"").trim()},validDraftPic:function(){return this.draftPic.filter((function(t){return t&&void 0!==t.img_src}))},contentLength:function(){return this.content.length},publishedImages:function(){return this.imageList.filter((function(t){return!t.status&&t.img_src&&""!==t.img_src})).map((function(t){return{img_src:t.img_src,img_width:t.img_width,img_height:t.img_height,img_size:t.img_size}}))},disabled:function(){return(0===this.contentLength||this.contentLength>this.maxLength)&&0===this.publishedImages.length||this.imageList.length>this.publishedImages.length||this.topicName&&this.content==="#".concat(this.topicName,"#")},schPubDisabled:function(){return this.disabled||!this.publishTime||!this.editDraft&&this.scheduledCount>=20},textareaActive:function(){return this.emojiBoxShown},voteIndex:function(){return this.voteConfig.title?this.content.indexOf("​".concat(this.voteConfig.title)):-1},lotteryIndex:function(){return this.lotteryConfig.title?this.content.indexOf("​".concat(this.lotteryConfig.title)):-1}},props:{topicName:{type:String},loginUid:{type:Number,default:0},storeInput:{tpye:Boolean,default:!1},publishHandler:{type:Function},canVote:{type:Boolean},canLottery:{type:Boolean},canPickComment:{type:Boolean},canBeScheduled:{type:Boolean,default:!1},scheduledCount:{type:Number,default:0},editDraft:{type:Object,default:null},isLockedAsScheduled:{type:Boolean,default:!1}},components:{EmojiBox:ct.a,ImageBox:$r,BpPopup:Za.a,DynamicSpecification:Tr,AtPopup:Sr.a,HashPopup:fe,DivEdit:Wr,Vote:Xn,Lottery:zo,CheckBox:Vr,DatePicker:Y},beforeMount:function(){var t=Object(v.d)();this.isIE=-1!==t.indexOf("IE"),this.isSafari=-1!==t.indexOf("Safari"),this.supportFileUpload="IE 9"!==t&&"IE Legacy"!==t},created:function(){var t=this;Object(d.b)(),u.b.$on("textChange",(function(e){t.userInput=e})),this.topicName&&""===this.userInput&&(this.isIE?this.userInput="#".concat(this.topicName,"# "):setTimeout((function(){t.textarea.focus(),Object(u.j)(Object(u.c)("#".concat(t.topicName,"#&nbsp;")))})))},mounted:function(){var t=this;this.specificationAgreed=1===parseInt(v.a.getItem("dy_spec_agreed")),this.isMounted=!0,this.isIE?(this.textarea=this.$refs.textarea,this.autoHeight(this.textarea,200)):this.textarea=this.$refs.textarea.$refs.div,this.emojiTrigger=this.$refs.emojiTrigger;var e=this.getPopupPanel();if(this.isPopupPanel=!!e,this.setPopupOffset(e),setTimeout((function(){t.addVoteClick(),t.addLotteryClick()}),0),this.throttleShowLimitToast=Object(v.f)(this.showLimitToast,300),this.throttleShowLimitToast2=Object(v.f)(this.showLimitToast2,300),this.editDraft){var n=Number(this.editDraft.publish_time);Number.isNaN(n)||(this.publishTime=new Date(1e3*n));var i=Object(v.e)(this.editDraft.request);i.pictures&&(this.imageBoxShown=!0,"string"==typeof i.pictures?this.draftPic=Object(v.e)(i.pictures):this.draftPic=i.pictures),this.pickCommentOn=!!i.up_choose_comment,this.textarea.innerHTML="",this.textarea.focus();var o=this.restoreFromEditDraft();this.insertHtmlAtCaret(o)}},watch:{loginUid:function(t){t&&(this.initLocalStorage(),this.scheduledPublishTips())},userInput:function(t){var e=this;this.storeInput&&localStorage.setItem("dynamic_publisher_".concat(this.loginUid),t),this.$nextTick((function(){var t=e.textarea.getElementsByClassName("bp-vote-span");0===t.length&&(e.voteConfig={}),0===(t=e.textarea.getElementsByClassName("bp-lottery-span")).length&&(e.lotteryConfig={}),0===(t=e.textarea.getElementsByClassName("bp-at-span")).length&&(e.atItems=[])})),""!==t&&""===t.trim()&&(this.userInput="",u.b.$emit("textChange",""))},atItems:function(t){localStorage.setItem("dynamic_publisher_at_".concat(this.loginUid,"_config"),JSON.stringify(t))},voteIndex:function(t){t<0&&(this.clearVote(),this.onVoteCancel(),this.voteConfig={},localStorage.setItem("dynamic_publisher_vote_".concat(this.loginUid,"_config"),"{}"))},lotteryIndex:function(t){t<0&&(this.clearLottery(),this.onLotteryCancel(),this.lotteryConfig={},localStorage.setItem("dynamic_publisher_lottery_".concat(this.loginUid,"_config"),"{}"))},isLockedAsScheduled:function(t){this.isScheduled=!!t},schConfirmVisible:function(t){var e=this;this.$nextTick((function(){var n=e.$refs.schPubConfirm;if(t&&e.isPopupPanel&&n){var i=n.$el.parentNode.parentNode.getBoundingClientRect();n.$el.parentNode.style="top: -".concat(i.top,"px;left: -").concat(i.left,"px")}}))}},methods:{showLimitToast:function(){this.linkMsg(this.textarea,"您的浏览器暂不支持投票发起功能","caution")},showLimitToast2:function(){this.linkMsg(this.textarea,"您的浏览器暂不支持推广功能","caution")},restoreDraft:function(){var t=this;this.nodes.forEach((function(e){""===e||/^(<\/?div\/?>)*(<br\/?>)*(<\/?div\/?>)*$/.test(e)||t.insertHtmlAtCaret(e)})),this.$nextTick((function(){t.addVoteClick(),t.addLotteryClick()}))},onMousedown:function(){this.textarea.focus();var t=arguments[0]||window.event;t.preventDefault()},validate:function(){return!0},selectHandler:function(t){if(this.isIE){var e=this.userInput,n=Object(u.e)(this.textarea),i=e.substring(0,n),o=e.substring(n),a=i.lastIndexOf("@");i=i.substring(0,a+1),this.userInput="".concat(i).concat(t.uname," ").concat(o)}else{var r;r='<input type="button" class="bp-at-span" readonly value="@'.concat(t.uname,'&nbsp;" style="color:#00a1d6;"></input>');var s,c,l=window.getSelection().getRangeAt(0),d=l.endContainer,f=d;3!==d.nodeType&&(f=d.childNodes[l.endOffset-1]);var h=function t(e){var n=0,i=e;if(3===e.nodeType){if(-1===(n=e.nodeValue.lastIndexOf("@"))){var o=t(e.previousSibling);n=o.index,i=o.node}}else{var a=e.childNodes;if(a.length){var r=t(a[a.length-1]);n=r.index,i=r.node}}return{index:n,node:i}}(f);s=h.index,c=h.node,l.setStart(c,s),l.deleteContents(),this.insertHtmlAtCaret(r)}this.atItems.push(t)},getEmojiSrc:function(t){return Object(d.e)(t,{emojiType:1})},emojiSelectHandler:function(t){var e=this.getEmojiSrc(t),n=this.userInput,i=Object(u.e)(this.textarea),o=n.substring(0,i),a=n.substring(i);if(this.isIE)this.userInput="".concat(o).concat(t).concat(a);else{var r=e;this.insertHtmlAtCaret(r)}},initLocalStorage:function(){var t=this;if(this.storeInput&&"undefined"!=typeof window&&this.loginUid){this.loginUid&&null===localStorage.getItem("dynamic_publisher_".concat(this.loginUid))&&localStorage.setItem("dynamic_publisher_".concat(this.loginUid),""),this.loginUid&&null===localStorage.getItem("dynamic_publisher_pic_".concat(this.loginUid))&&localStorage.setItem("dynamic_publisher_pic_".concat(this.loginUid),"[]");var e=localStorage.getItem("dynamic_publisher_".concat(this.loginUid)||!1).trim();/^(<\/?div\/?>)*(<br\/?>)*(<\/?div\/?>)*$/.test(e)||(this.userInput=e),this.draftPic=Object(v.e)(localStorage.getItem("dynamic_publisher_pic_".concat(this.loginUid)))||[],this.atItems=Object(v.e)(localStorage.getItem("dynamic_publisher_at_".concat(this.loginUid,"_config")))||[],this.voteConfig=Object(v.e)(localStorage.getItem("dynamic_publisher_vote_".concat(this.loginUid,"_config")))||{},this.lotteryConfig=Object(v.e)(localStorage.getItem("dynamic_publisher_lottery_".concat(this.loginUid,"_config")))||{},this.nodes=Object(v.e)(localStorage.getItem("dynamic_publisher_div_html_".concat(this.loginUid)))||[],this.$nextTick((function(){t.validDraftPic.length>0&&t.showImageBox(),t.restoreDraft()}))}},callFileDialog:function(){var t=this;if(this.isPopupPanel?Object(Mt.d)(Dt.d.PUBLICH_PIC_2,""):Object(Mt.d)(Dt.d.PUBLICH_PIC_1,""),"IE 10"===Object(v.d)()||"IE 11"===Object(v.d)())return this.showImageBox();if(this.validDraftPic.length>0&&this.storeInput&&this.showImageBox(),!this.imageBoxShown){var e=document.createElement("input");e.type="file",e.accept="image/png, image/jpeg, image/jpg, image/gif",e.multiple="multiple",e.addEventListener("change",(function(e){var n=(e.target||e.srcElement).files;n&&n.length>0&&(t.selectedFiles=n,t.showImageBox())})),e.click(),window.upload_input=e,e=null}},clickButtonHandler:function(t){var e=this,n=this.textarea,i=Object(u.e)(n);this.$nextTick((function(){if(e.isIE){var o=e.userInput;e.userInput="".concat(o.slice(0,i),"##").concat(o.slice(i))}else{e.insertHtmlAtCaret("#"),e.insertHtmlAtCaret("".concat("#","&nbsp;"))}setTimeout((function(){if(e.isIE)n.setSelectionRange(i+1,i+1);else try{e.setHashPos("before")}catch(t){return}n.focus(),t&&t()}),0)}))},selectTopicHandler:function(t){var e,n=this;e=this.isIE?this.userInput:this.textarea.value.replace(/\n/g,"");var i=Object(u.e)(this.textarea),o=e.substring(0,i),a=e.substring(i),r=o.lastIndexOf("#"),s=o.substring(0,r+1),c="after2";if(this.isIE)a=!a||a&&"#"!==a.slice(0,1)?"# ".concat(a):"# ".concat(a.slice(1)),this.userInput="".concat(s).concat(t).concat(a);else{var l=Object(u.c)(t);o.length===s.length&&(c="after1"),this.setSelectText(i,r),this.insertHtmlAtCaret(l),(!a||a&&"#"!==a.slice(0,1))&&(l="#&nbsp;",this.insertHtmlAtCaret(l),c="static"),setTimeout((function(){try{n.setHashPos(c)}catch(t){return}}),0)}},logTopicHandler:function(){var t=this.isPopupPanel?Dt.d.PUBLISH_AT_LIST_SHOW_2:Dt.d.PUBLISH_AT_LIST_SHOW_1;Object(Mt.d)(t)},publish:function(){if(!this.disabled){var t=this.schConfirmVisible?this.$refs.schPubConfirm.buttons.confirmBtn:this.$refs.publishBtn;if(this.isPopupPanel?Object(Mt.d)(Dt.d.PUBLICH_CLICK_2,""):Object(Mt.d)(Dt.d.PUBLICH_CLICK_1,""),!this.isPublishing&&this.validatePublish(t)){if(!this.specificationAgreed)return void this.showSpecification();this.isPublishing=!0,this.publishedImages.length>0?this.publishAlbum(t):this.publishText(t)}}},getPublishTextParams:function(){var t=Object(d.c)(this.content),e={dynamic_id:0,type:4,rid:0,content:t,up_choose_comment:+this.pickCommentOn},n=u.a.generateAtParams(t,void 0,this.atItems),i=n.atUids,o=n.ctrl,a={emoji_type:1};return this.voteConfig.vote_id&&(o=JSON.stringify(JSON.parse(o).concat({data:String(this.voteConfig.title.length+1),length:0,location:this.voteIndex,type:3})),a.vote_cfg={vote_id:this.voteConfig.vote_id}),this.lotteryConfig.lottery_id&&(o=JSON.stringify(JSON.parse(o).concat({data:String(this.lotteryConfig.title.length+1),length:0,location:this.lotteryIndex,type:2})),a.lott_cfg={lottery_id:this.lotteryConfig.lottery_id}),e.extension=JSON.stringify(a),e.at_uids=i,e.ctrl=o,e},publishText:function(t){var e=this,n=this.getPublishTextParams();this.bpapi({url:"".concat(_.a.API_VC,"/dynamic_svr/v1/dynamic_svr/create"),method:"post",data:n}).then((function(n){0===n.data.result?(e.linkMsg(t,"发布成功 ".concat(Ct.randomEmoji.happy()),"success"),e.dispatchFeedUpdate(n.data.dynamic_id),e.$emit("succeed",{isScheduled:!1}),e.handlePublishComplete()):2===n.data.result?Object(Ct.showVerifyPopup)(e):e.linkMsg(t,n.data.errmsg,"caution"),e.publishHandler&&e.publishHandler(),e.isPublishing=!1}),(function(n){e.linkMsg(t,n.msg,n.type),e.isPublishing=!1}))},getPublishAlbumParams:function(){var t=this.contentLength>0?this.content:void 0;t=Object(d.c)(t);var e={biz:3,category:3,type:0,pictures:JSON.stringify(this.publishedImages),title:"",tags:"",description:t,content:t,up_choose_comment:+this.pickCommentOn,setting:this.isScheduled?void 0:JSON.stringify({copy_forbidden:0,cachedTime:0}),from:"create.dynamic.web"},n=u.a.generateAtParams(t,void 0,this.atItems),i=n.atUids,o=n.ctrl,a={emoji_type:1};return this.voteConfig.vote_id&&(o=JSON.stringify(JSON.parse(o).concat({data:String(this.voteConfig.title.length+1),length:0,location:this.voteIndex,type:3})),a.vote_cfg={vote_id:this.voteConfig.vote_id}),this.lotteryConfig.lottery_id&&(o=JSON.stringify(JSON.parse(o).concat({data:String(this.lotteryConfig.title.length+1),length:0,location:this.lotteryIndex,type:2})),a.lott_cfg={lottery_id:this.lotteryConfig.lottery_id}),e.extension=JSON.stringify(a),e.at_uids=i,e.at_control=o,e},publishAlbum:function(t){var e=this,n=this.getPublishAlbumParams();this.bpapi({url:"".concat(_.a.API_VC,"/dynamic_svr/v1/dynamic_svr/create_draw"),method:"post",data:n}).then((function(i){e.linkMsg(t,"发布成功 ".concat(Ct.randomEmoji.happy()),"success");var o=Yr(Yr({},n),{},{setting:{copy_forbidden:0,cachedTime:0},pictures:e.publishedImages});e.generateAlbumFakeCard(o,i.data),e.$emit("succeed",{isScheduled:!1}),e.handlePublishComplete(),e.publishHandler&&e.publishHandler()}),(function(n){e.linkMsg(t,n.msg,n.type),e.isPublishing=!1}))},handlePublishComplete:function(){this.resetPublishBox(),this.isPublishing=!1,this.schConfirmVisible=!1,u.b.$emit("textChange","")},schPubConfirm:function(){var t,e,n,i=this,o=this.$refs.schPubConfirm.buttons.confirmBtn;this.editDraft?(n=i.editDraft.draft_id,i.publishedImages.length>0?(e=2,t=i.getPublishAlbumParams()):(e=4,t=i.getPublishTextParams()),i.bpapi({url:"".concat(_.a.API_VC,"/dynamic_draft/v1/dynamic_draft/publish_now"),method:"post",data:{draft_id:n,type:e,request:JSON.stringify(t)}}).then((function(t){i.linkMsg(o,"发送成功",t.type),i.schConfirmVisible=!1,i.$emit("succeed",{isScheduled:!1}),i.handlePublishComplete(),i.publishHandler&&i.publishHandler()}),(function(t){i.linkMsg(o,t.msg,"error"),i.schConfirmVisible=!1,i.$emit("failed",t)}))):this.publish()},scheduledPublish:function(){var t=this;if(!this.schPubDisabled){var e=this.editDraft?2:this.isPopupPanel?1:0;Object(Mt.d)(Dt.d.TIMER_SET,e);var n=this.$refs.publishBtn;if(this.publishTime&&this.validatePublish(n))if(this.specificationAgreed){var i,o,a,r,s=function(e){t.schConfirmText=e,t.schConfirmVisible=!0},c=new Date;this.publishTime.getTime()-c<-6e4||this.publishTime.getTime()-c<0&&this.publishTime.getMinutes()!==c.getMinutes()?s("设置的时间点已过，是否直接发布？"):this.publishTime.getTime()-c<3e5?s("设置的时间点过于接近当前时间，是否直接发布？"):(r=function(){t.$emit("succeed",{isScheduled:!0,draft:{draft_id:a,publish_time:Math.ceil(t.publishTime.getTime()/1e3),type:o,request:JSON.stringify(i),publish_status:0}})},t.publishedImages.length>0?(o=2,i=t.getPublishAlbumParams()):(o=4,i=t.getPublishTextParams()),t.editDraft?t.bpapi({url:"".concat(_.a.API_VC,"/dynamic_draft/v1/dynamic_draft/modify_draft"),method:"post",data:{draft_id:t.editDraft.draft_id,type:o,publish_time:Math.ceil(t.publishTime.getTime()/1e3),request:JSON.stringify(i)}}).then((function(){t.linkMsg(n,"编辑定时发布成功","success"),a=t.editDraft.draft_id,r(),t.handlePublishComplete(),t.publishHandler&&t.publishHandler()}),(function(e){t.linkMsg(n,e.msg,"error"),t.$emit("failed",e)})):t.bpapi({url:"".concat(_.a.API_VC,"/dynamic_draft/v1/dynamic_draft/add_draft"),method:"post",data:{type:o,publish_time:Math.ceil(t.publishTime.getTime()/1e3),request:JSON.stringify(i)}}).then((function(e){t.linkMsg(n,"定时发布成功","success"),a=e.data.draft_id,r(),t.handlePublishComplete(),t.publishHandler&&t.publishHandler()}),(function(e){t.linkMsg(n,e.msg,"error"),t.$emit("failed",e)})))}else this.showSpecification()}},dispatchFeedUpdate:function(t){t&&this.bpapi({url:"".concat(_.a.API_VC,"/dynamic_svr/v1/dynamic_svr/get_dynamic_detail"),method:"get",data:{dynamic_id:t}}).then((function(t){u.b.$emit(Dt.b.ADD,t.data.card)}))},generateAlbumFakeCard:function(t,e){try{var n={at_control:t.at_control,category:"daily",description:t.description,pictures:t.pictures,pictures_count:t.pictures.length,reply:0,role:"",source:"",title:"",id:e.doc_id},i=u.r.getMyUserInfo(),o={head_url:i.card.face,uid:i.card.mid,name:i.card.name},a={type:Dt.a.PIC,uid:~~i.card.mid,dynamic_id:"-".concat(Zr),user_profile:{card:{},info:{face:i.card.face,uid:i.card.mid,uname:i.card.name,platform_user_level:(i.card.level_info||{}).current_level}},timestamp:Date.now()};Zr+=1;var r={card:JSON.stringify({item:n,user:o}),desc:a,extend_json:JSON.stringify({from:{emoji_type:1}}),did:e.dynamic_id_str};u.b.$emit(Dt.b.ADD,r)}catch(t){console.error(t)}},resetPublishBox:function(){this.userInput="",this.closeImageBox(),this.emojiBoxShown=!1,this.onVoteCancel(),this.onLotteryCancel(),this.voteConfig={},this.lotteryConfig={},this.pickCommentOn=!1,localStorage.setItem("dynamic_publisher_vote_".concat(this.loginUid,"_config"),"{}"),localStorage.setItem("dynamic_publisher_lottery_".concat(this.loginUid,"_config"),"{}"),localStorage.setItem("dynamic_publisher_div_html_".concat(this.loginUid),"[]"),this.editDraft||(this.isLockedAsScheduled||(this.isScheduled=!1),this.publishTime=void 0)},validatePublish:function(t){return this.imageList.length>this.publishedImages.length?(this.linkMsg(t,"请先删除不符合规格的图片 ".concat(Ct.randomEmoji.shock()),"info"),this.textarea.focus(),!1):0===this.contentLength&&0===this.publishedImages.length?(this.textarea.focus(),!1):!(this.contentLength>this.maxLength)||(this.linkMsg(t,"输入的内容太长啦 ".concat(Ct.randomEmoji.shock()),"info"),!1)},updateImageList:function(t){this.imageList=t,this.storeInput&&localStorage.setItem("dynamic_publisher_pic_".concat(this.loginUid),JSON.stringify(t))},showImageBox:function(){this.imageBoxShown=!0},closeImageBox:function(){this.storeInput&&localStorage.setItem("dynamic_publisher_pic_".concat(this.loginUid),"[]"),this.draftPic=[],this.imageList=[],this.selectedFiles={},this.imageBoxShown=!1},getPopupPanel:function(){var t=this.$el;if(!t.classList)return!1;for(;t&&!t.classList.contains("bp-popup-panel");)t=t.parentElement;return t},setPopupOffset:function(t){t&&(t.style.marginBottom="420px")},showSpecification:function(){var t=this;if(this.specificationAgreed||this.specificationShown)return!1;this.specificationShown=!0,this.isPopupPanel||this.bpPopup({width:796,button:{confirm:"同意并发送"},component:{name:"dynamic-specification-popup",components:{DynamicSpecification:Tr},template:"<dynamic-specification></dynamic-specification>"}}).onConfirm((function(e){e.close(),t.specificationConfirm()})).onCancel((function(e){e.close(),t.specificationCancel()}))},specificationConfirm:function(){v.a.setItem("dy_spec_agreed",1,1/0,"/",".bilibili.com"),this.specificationAgreed=!0,this.specificationShown=!1,this.isScheduled?this.scheduledPublish():this.publish()},specificationCancel:function(){this.specificationShown=!1},logHandler:function(){var t="BAR"===this.type?Dt.d.PUBLISH_AT_LIST_SHOW_2:Dt.d.PUBLISH_AT_LIST_SHOW_1;Object(Mt.d)(t)},insertHtmlAtCaret:function(t){Object(u.j)(t),this.textarea&&(this.textarea.value=Object(u.f)(this.textarea),this.userInput=this.textarea.value)},setSelectText:function(t,e){var n,i,o=t-e-1;if(window.getSelection){if((n=window.getSelection()).getRangeAt&&n.rangeCount){i=n.getRangeAt(0);try{i.setStart(i.commonAncestorContainer,i.endOffset-o)}catch(t){for(var a=i.endContainer,r=function t(e){var n=[];return 0===e.childNodes.length?n.push(e):Array.from(e.childNodes).forEach((function(e){n=n.concat(t(e))})),n}(this.textarea),s=a,c=Array.from(r).indexOf(a);c>=0;c--)if("#text"===r[c].nodeName){var l=r[c].nodeValue.indexOf("#");if(-1!==l){s=r[c];break}}i.setStart(s,l+1)}i.deleteContents()}}else document.selection&&"Control"!==document.selection.type&&this.textarea.setSelectionRange(e,t)},setHashPos:function(t){var e,n;window.getSelection&&(e=window.getSelection()).getRangeAt&&e.rangeCount&&(n=e.getRangeAt(0),"before"===t?this.isSafari?Object(u.p)(n.startContainer,n.endOffset-1):n.setStart(n.startContainer,n.endOffset-1):"after2"===t?this.isSafari?n.setStart(n.startContainer,n.endOffset+1):n.setStart(n.startContainer,n.endOffset+2):"after1"===t?n.setStart(n.startContainer,n.endOffset+1):"static"===t&&n.setStart(n.startContainer,n.endOffset),n.collapse(!0))},onClickPopularize:function(){this.throttleShowLimitToast2()},onClickVote:function(){this.isIE?this.throttleShowLimitToast():this.canVote&&(this.voteShow=!0)},onVoteCreate:function(t){var e=this;this.voteConfig=t;var n,i=t.default_text,o=t.title;this.storeInput&&localStorage.setItem("dynamic_publisher_vote_".concat(this.loginUid,"_config"),JSON.stringify(this.voteConfig)),this.textarea.focus(),this.keepIndex(this.textarea),this.clearVote(),i&&(n="".concat(i),this.insertHtmlAtCaret(n)),n='<input type="button" class="bp-vote-span" readonly value="&nbsp;​'.concat(o,'"></input>&nbsp;'),this.insertHtmlAtCaret(n),setTimeout((function(){e.addVoteClick()}),0),this.voteShow=!1},onVoteCancel:function(){this.voteShow=!1},clearVote:function(){var t=this.textarea.getElementsByClassName("bp-vote-span");if(t&&t.length)for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("click",this.onClickVote),n.nextSibling&&"#text"===n.nextSibling.nodeName&&" "===n.nextSibling.nodeValue&&n.parentNode.removeChild(n.nextSibling),n.parentNode.removeChild(n)}},addVoteClick:function(){var t=this.textarea.getElementsByClassName("bp-vote-span");if(t&&t.length)for(var e=0;e<t.length;e++)t[e].addEventListener("click",this.onClickVote)},onClickLottery:function(){this.isIE?this.throttleShowLimitToast():this.canLottery&&(this.lotteryShow=!0)},onLotteryCreate:function(t){var e,n=this,i=t.title;this.textarea.focus(),this.keepIndex(this.textarea),this.lotteryConfig.lottery_id||(this.clearLottery(),e='<input type="button" class="bp-lottery-span" readonly value="&nbsp;​'.concat(i,'"></input>&nbsp;'),this.insertHtmlAtCaret(e),setTimeout((function(){n.addLotteryClick()}),0)),this.lotteryConfig=t,this.storeInput&&localStorage.setItem("dynamic_publisher_lottery_".concat(this.loginUid,"_config"),JSON.stringify(this.lotteryConfig)),this.lotteryShow=!1},onLotteryCancel:function(){this.lotteryShow=!1},clearLottery:function(){var t=this.textarea.getElementsByClassName("bp-lottery-span");if(t&&t.length)for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("click",this.onClickLottery),n.parentNode.removeChild(n)}},addLotteryClick:function(){var t=this.textarea.getElementsByClassName("bp-lottery-span");if(t&&t.length)for(var e=0;e<t.length;e++)t[e].addEventListener("click",this.onClickLottery)},keepIndex:function(t){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){var n=document.selection.createRange();n.moveToElementText(t),n.collapse(!1),n.select()}},autoHeight:function(t,e){var n=function(e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},i=t.currentStyle?function(e){var n=t.currentStyle[e];if("height"===e&&1!==n.search(/px/i)){var o=t.getBoundingClientRect();return o.bottom-o.top-parseFloat(i("paddingTop"))-parseFloat(i("paddingBottom"))+"px"}return n}:function(e){return getComputedStyle(t,null)[e]},o=parseFloat(i("height"));t.style.resize="none";var a=function(){var n;t._length!==t.value.length&&(t._length=t.value.length,t.style.height=o+"px",t.scrollHeight>o&&(e&&t.scrollHeight>e?(n=e,t.style.overflowY="scroll"):(n=t.scrollHeight,t.style.overflowY="hidden"),t.style.height=n+"px"))};n("propertychange",a),n("input",a),n("focus",a),a()},switchScheduled:function(){if(!(this.editDraft||this.voteConfig.vote_id||this.voteShow||this.lotteryConfig.lottery_id||this.lotteryShow||this.isLockedAsScheduled)){var t=this.editDraft?2:this.isPopupPanel?1:0;Object(Mt.d)(Dt.d.TIMER_ICON,t),this.isScheduled=!this.isScheduled}},restoreFromEditDraft:function(){var t=this,e=function(e,n){var i=e.split(""),o={"<":"&lt;",">":"&gt;"," ":"&#32;","\n":"<br/>"};return i=i.map((function(t){return o[t]||t})),n.forEach((function(e){var n,o=i.slice(e.location,e.location+e.length);t.atItems.push({uid:Number(e.data),uname:o.slice(1).join("")}),o[0]='<input type="button" class="bp-at-span" readonly value="@'.concat(o[0]),o[o.length-1]="".concat(o[o.length-1],'&nbsp;"></input>'),(n=i).splice.apply(n,[e.location,e.length].concat(Gr(o)))})),i.join("")},n=Object(v.e)(this.editDraft.request);if(4===this.editDraft.type&&n){var i=(Object(v.e)(n.ctrl)||[]).filter((function(t){return 1===t.type})),o=e(n.content,i);return this.isIE?Object(u.c)(n.content):Object(u.m)(o)}if(2===this.editDraft.type&&n){var a=(Object(v.e)(n.at_control)||[]).filter((function(t){return 1===t.type})),r=e(n.description,a);return this.isIE?Object(u.c)(n.description):Object(u.m)(r)}return""},scheduledPublishTips:function(){var t=this;if("undefined"!=typeof window){this.canBeScheduled&&"true"!==window.localStorage.getItem("dynamic_scheduled_publish_intro_".concat(this.loginUid))&&(t.schPubTipsVisable=!0,window.localStorage.setItem("dynamic_scheduled_publish_intro_".concat(t.loginUid),!0),setTimeout((function(){t.schPubTipsVisable=!1}),5e3))}}}},Xr=(n(331),n(332),Object(M.a)(Qr,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-rel f-clear publish-panel"},[n("div",{staticClass:"input-section",class:{overflow:t.contentLength>t.maxLength,active:t.textareaActive}},[[t.isIE?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.userInput,expression:"userInput"}],ref:"textarea",staticClass:"textarea",attrs:{placeholder:"有什么想和大家分享的？"},domProps:{value:t.userInput},on:{input:function(e){e.target.composing||(t.userInput=e.target.value)}}}):n("div-edit",{ref:"textarea",staticClass:"textarea no-padding",attrs:{loginUid:t.loginUid,storeInput:t.storeInput,placeholder:"有什么想和大家分享的？"},model:{value:t.userInput,callback:function(e){t.userInput=e},expression:"userInput"}})],n("div",{directives:[{name:"show",rawName:"v-show",value:t.isScheduled,expression:"isScheduled"}],staticClass:"schedule-panel"},[n("span",{staticClass:"dp-label"},[t._v("发布时间：")]),n("date-picker",{attrs:{min:new Date,max:new Date(Date.now()+1296e6)},model:{value:t.publishTime,callback:function(e){t.publishTime=e},expression:"publishTime"}})],1)],2),t.isMounted?n("at-popup",{attrs:{"input-elm":t.textarea,"select-handler":t.selectHandler,validate:t.validate,"log-handler":t.logHandler}}):t._e(),t.isMounted?n("hash-popup",{attrs:{"input-elm":t.textarea,"button-elm":t.$refs.topicBtn,"click-button-handler":t.clickButtonHandler,"select-handler":t.selectTopicHandler,"login-uid":t.loginUid,emojiBoxShown:t.emojiBoxShown,"log-handler":t.logTopicHandler}}):t._e(),t.canVote?n("vote",{staticClass:"vote-box",attrs:{show:t.voteShow,config:t.voteConfig},on:{"vote-create":t.onVoteCreate,cancel:t.onVoteCancel}}):t._e(),t.canLottery?n("lottery",{staticClass:"lottery-box",attrs:{show:t.lotteryShow,config:t.lotteryConfig},on:{"lottery-create":t.onLotteryCreate,cancel:t.onLotteryCancel}}):t._e(),n("div",{staticClass:"action-row f-clear"},[n("div",{ref:"operateDiv",staticClass:"f-left p-rel",staticStyle:{"margin-top":"5px"}},[n("a",{ref:"emojiTrigger",staticClass:"d-i-block bp-v-middle bp-icon-font icon-emoji-btn box-toggle",class:{active:t.emojiBoxShown},staticStyle:{"margin-left":"0"},on:{click:function(e){t.emojiBoxShown=!0},mousedown:t.onMousedown}}),t.supportFileUpload?n("a",{staticClass:"d-i-block bp-v-middle bp-icon-font icon-pic-btn img-btn box-toggle",class:{active:t.imageBoxShown},on:{click:t.callFileDialog,mousedown:t.onMousedown}}):t._e(),n("a",{ref:"topicBtn",staticClass:"d-i-block bp-v-middle bp-icon-font icon-topic img-btn box-toggle",on:{mousedown:t.onMousedown}}),t.canVote&&!t.isScheduled?n("a",{ref:"voteBtn",staticClass:"d-i-block bp-v-middle bp-icon-font vote-create-btn img-btn box-toggle",class:{active:t.voteShow},on:{click:t.onClickVote,mousedown:t.onMousedown}}):t._e(),t.canLottery&&!t.isScheduled?n("a",{ref:"lotteryBtn",staticClass:"d-i-block bp-v-middle bp-icon-font lottery-create-btn img-btn box-toggle",class:{active:t.lotteryShow},on:{click:t.onClickLottery,mousedown:t.onMousedown}}):t._e(),n("a",{staticClass:"d-i-block bp-v-middle bp-icon-font popularize-create-btn img-btn box-toggle",attrs:{title:"添加附加卡"},on:{click:t.onClickPopularize}}),t.canBeScheduled?n("a",{staticClass:"d-i-bloack bp-v-middle bp-icon-font icon-ic_timer img-btn box-toggle",class:{active:t.isScheduled,disabled:t.voteConfig.vote_id||t.voteShow||t.lotteryConfig.lottery_id||t.lotteryShow},on:{click:t.switchScheduled}}):t._e(),t.canBeScheduled?n("div",{directives:[{name:"show",rawName:"v-show",value:t.schPubTipsVisable,expression:"schPubTipsVisable"}],staticClass:"sch-pub-tips"},[n("span",[t._v("可以设置定时发布动态啦")]),n("i",{staticClass:"bp-icon-font icon-group-dynamic",on:{click:function(e){t.schPubTipsVisable=!1}}})]):t._e()]),n("div",{staticClass:"f-right"},[t.canPickComment?n("div",{staticClass:"settings-box"},[n("a",{staticClass:"d-i-block bp-v-middle bp-icon-font settings-btn box-toggle",class:{active:t.settingShown},attrs:{title:"设置"},on:{click:function(e){t.settingShown=!t.settingShown}}}),n("div",{staticClass:"bp-container"},[n("transition",{attrs:{name:"move-in"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.settingShown,expression:"settingShown"}],staticClass:"settings-panel"},[n("check-box",{model:{value:t.pickCommentOn,callback:function(e){t.pickCommentOn=e},expression:"pickCommentOn"}},[n("span",{staticClass:"label"},[t._v("开启精选评论")])])],1)])],1)]):t._e(),n("div",{staticClass:"d-i-block bp-v-middle length-hint"},[n("span",{class:{overflow:t.contentLength>t.maxLength}},[t._v(t._s(t.maxLength-t.contentLength))])]),t.isScheduled?t._e():n("button",{ref:"publishBtn",staticClass:"d-i-block bp-v-middle dynamic-btn pink with-border-radius publish-btn",class:{publishing:t.isPublishing,disabled:t.disabled},on:{click:t.publish}},[t._v(t._s(t.isPublishing?"发布中":"发布"))]),t.isScheduled?n("button",{ref:"publishBtn",staticClass:"d-i-block bp-v-middle with-border-radius sch-pub-btn",class:{publishing:t.isPublishing,disabled:t.schPubDisabled},on:{click:t.scheduledPublish}},[t._v(t._s(!t.editDraft&&t.scheduledCount>=20?"已满上限":"定时发布"))]):t._e()])]),t.emojiBoxShown?n("emoji-box",{staticClass:"bp-emoji-box",attrs:{field:t.textarea,"select-handler":t.emojiSelectHandler,"frozen-elements":[t.textarea,t.emojiTrigger],"emoji-type":["kaomojis","dynamicEmojis"],"spm-type":t.topicName?"TAG":"MAIN","pub-type":t.isPopupPanel?"2":"1"},on:{close:function(e){t.emojiBoxShown=!1}}}):t._e(),t.imageBoxShown?n("image-box",{staticClass:"image-box",attrs:{"init-files":t.selectedFiles,"draft-pic":t.validDraftPic},on:{update:t.updateImageList,close:t.closeImageBox}}):t._e(),t.isPopupPanel?n("bp-popup",{staticClass:"dynamic-specification-popup",attrs:{show:t.specificationShown,width:796,button:{confirm:"确认并发送"},"on-confirm":t.specificationConfirm,"on-cancel":t.specificationCancel}},[n("dynamic-specification")],1):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:t.schConfirmVisible,expression:"schConfirmVisible"}],staticClass:"sch-confirm-wrapper"},[n("bp-popup",{ref:"schPubConfirm",staticClass:"sch-confirm",attrs:{show:t.schConfirmVisible,button:{confirm:"是",cancel:"否"},width:360,onConfirm:t.schPubConfirm,onCancel:function(){t.schConfirmVisible=!1}}},[n("p",[t._v(t._s(t.schConfirmText))])])],1)],1)}),[],!1,null,"6233880e",null).exports);o.a.use(Object(a.a)()),o.a.use(r.a),o.a.use(s.b);var ts=Xr,es=n(75);function ns(t){return(ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function is(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function os(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function as(t,e){return(as=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rs(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=cs(t);if(e){var o=cs(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return ss(this,n)}}function ss(t,e){return!e||"object"!==ns(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function cs(t){return(cs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ls=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&as(t,e)}(r,t);var e,n,i,a=rs(r);function r(){var t;return is(this,r),(t=a.apply(this,arguments)).ifShowScheduleBar=!1,t.maxLength=1e3,t.isChrome=!1,t.isFirefox=!1,t.isIE=!1,t.isEdge=!1,t.isSafari=!1,t.isTheWorld=!1,t.attachInfo={},t}return e=r,(n=[{key:"beforeCreate",value:function(){}},{key:"created",value:function(){this.bus=new o.a,this.initBus(),this.initAttachData()}},{key:"beforeMount",value:function(){var t=Object(v.d)();this.isChrome=-1!==t.indexOf("Chrome"),this.isFirefox=-1!==t.indexOf("Firefox"),this.isIE=-1!==t.indexOf("IE"),this.isEdge=-1!==t.indexOf("Edge"),this.isSafari=-1!==t.indexOf("Safari"),this.isTheWorld=-1!==t.indexOf("TheWorld")}},{key:"mounted",value:function(){}},{key:"beforeDestroy",value:function(){}},{key:"destroyed",value:function(){}},{key:"initBus",value:function(){var t=this;this.bus.$on("schedule-trigger",(function(e){t.ifShowScheduleBar=e})),this.bus.$on("click-selected-item",(function(e){Object(Ct.attachPreview)(e[0],e[1]).then((function(n){n.code||(t.attachInfo=n.data.attach_card,t.bus.$emit("update-extension",{attach:{id:e[0],type:e[1]}}))}))})),this.bus.$on("empty-attach-data",(function(){t.attachInfo={}}))}},{key:"onSucceed",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.$emit.apply(this,["succeed"].concat(e))}},{key:"onFailed",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.$emit.apply(this,["succeed"].concat(e))}},{key:"initAttachData",value:function(){var t=this;this.cheeseAttachQuery&&Object(Ct.attachPreview)(this.cheeseAttachQuery.attachId,this.cheeseAttachQuery.attachType).then((function(e){e.code||(t.attachInfo=e.data.attach_card,t.bus.$emit("update-extension",{attach:{id:t.cheeseAttachQuery.attachId,type:t.cheeseAttachQuery.attachType}}))}))}},{key:"fallbackOldVersion",get:function(){return this.isIE||this.isTheWorld}},{key:"attachData",get:function(){return Object(es.c)(this.attachInfo)}}])&&os(e.prototype,n),i&&os(e,i),r}(l.c);Object(c.a)([Object(l.b)()],ls.prototype,"loginUid",void 0),Object(c.a)([Object(l.b)(Boolean)],ls.prototype,"canLottery",void 0),Object(c.a)([Object(l.b)(Boolean)],ls.prototype,"canVote",void 0),Object(c.a)([Object(l.b)(Boolean)],ls.prototype,"canPickComment",void 0),Object(c.a)([Object(l.b)(Boolean)],ls.prototype,"canCloseComment",void 0),Object(c.a)([Object(l.b)(Boolean)],ls.prototype,"canBeScheduled",void 0),Object(c.a)([Object(l.b)(String)],ls.prototype,"topicName",void 0),Object(c.a)([Object(l.b)()],ls.prototype,"editDraft",void 0),Object(c.a)([Object(l.b)(Number)],ls.prototype,"scheduledCount",void 0),Object(c.a)([Object(l.b)(Boolean)],ls.prototype,"storeInput",void 0),Object(c.a)([Object(l.b)(Boolean)],ls.prototype,"isLockedAsScheduled",void 0),Object(c.a)([Object(l.b)(Function)],ls.prototype,"publishHandler",void 0),Object(c.a)([Object(l.b)(Boolean)],ls.prototype,"isPopupPanel",void 0),Object(c.a)([Object(l.b)(Object)],ls.prototype,"cheeseAttachQuery",void 0);var us=ls=Object(c.a)([Object(l.a)({name:"publish-panel",components:{Editor:D,ScheduleBar:at,Toolbar:Ra,PublishLauncher:mr,PublishTip:Or,PublishPanelV1:ts}})],ls),ds=(n(333),Object(M.a)(us,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.fallbackOldVersion?t._e():n("div",{staticClass:"publish-panel"},[n("div",{staticClass:"editor"},[n("editor",{attrs:{bus:t.bus,"max-length":t.maxLength,"with-schedule-bar":t.ifShowScheduleBar,"is-popup-panel":t.isPopupPanel,attachData:t.attachData}}),n("publish-tip",{attrs:{bus:t.bus}}),n("transition",{attrs:{name:"schedule-bar-in"}},[n("schedule-bar",{directives:[{name:"show",rawName:"v-show",value:t.ifShowScheduleBar,expression:"ifShowScheduleBar"}],attrs:{bus:t.bus}})],1)],1),n("div",{staticClass:"toolbar"},[n("toolbar",{attrs:{bus:t.bus,"is-locked-as-scheduled":t.isLockedAsScheduled,"is-popup-panel":t.isPopupPanel,"can-lottery":t.canLottery,"can-vote":t.canVote,"can-popularize":!t.attachData,"can-be-scheduled":t.canBeScheduled,"edit-draft":t.editDraft,"login-uid":t.loginUid}}),n("publish-launcher",{attrs:{bus:t.bus,"topic-name":t.topicName,"edit-draft":t.editDraft,"scheduled-count":t.scheduledCount,"store-input":t.storeInput,"publish-handler":t.publishHandler,"is-locked-as-scheduled":t.isLockedAsScheduled,"on-schedule-mode":t.ifShowScheduleBar,"is-popup-panel":t.isPopupPanel,"can-pick-comment":t.canPickComment,"can-close-comment":t.canCloseComment,"login-uid":t.loginUid},on:{succeed:t.onSucceed,failed:t.onFailed}})],1)]),t.fallbackOldVersion?n("publish-panel-v1",{attrs:{"topic-name":t.topicName,"edit-draft":t.editDraft,"scheduled-count":t.scheduledCount,"store-input":t.storeInput,"publish-handler":t.publishHandler,"is-locked-as-scheduled":t.isLockedAsScheduled,"is-popup-panel":t.isPopupPanel,"can-lottery":t.canLottery,"can-vote":t.canVote,"can-pick-comment":t.canPickComment,"can-close-comment":t.canCloseComment,"can-be-scheduled":t.canBeScheduled,"login-uid":t.loginUid}}):t._e()],1)}),[],!1,null,"28ce1694",null).exports);o.a.use(Object(a.a)()),o.a.use(r.a),o.a.use(s.b);var fs=ds;e.a=fs},function(t,e,n){"use strict";n(9),n(29);var i=n(11),o=n.n(i),a=(n(41),n(8)),r=n(5),s=n(67),c=n(56),l=n(0);function u(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){u(a,i,o,r,s,"next",t)}function s(t){u(a,i,o,r,s,"throw",t)}r(void 0)}))}}var f={data:function(){return{loginId:"0",isLoginChange:!1}},components:{LinkButton:s.a,BpPopup:c.a},mounted:function(){var t=this;return d(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.fetchLoginInfo)();case 2:n=e.sent,t.loginId=n.mid,t.initEvents();case 5:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.removeEvents()},methods:{reload:function(){window.location.reload()},initEvents:function(){window.addEventListener("focus",this.checkLoginStatus)},removeEvents:function(){document.removeEventListener("focus",this.checkLoginStatus)},checkLoginStatus:function(){var t=this;return d(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.fetchLoginInfo)(!0);case 2:n=e.sent,(t.loginId&&void 0!==n.isLogin&&!n.isLogin||t.loginId&&void 0!==n.isLogin&&t.loginId!==n.mid)&&(t.isLoginChange=!0,r.b.$emit(l.b.REMOVE_SCROLL));case 4:case"end":return e.stop()}}),e)})))()}}},h=(n(334),n(2)),p=Object(h.a)(f,(function(){var t=this.$createElement,e=this._self._c||t;return this.isLoginChange?e("div",{staticClass:"check-login d-table p-fixed w-100 h-100"},[e("div",{staticClass:"panel p-abs bg-white fs-12 ff-yahei"},[e("p",{staticClass:"hint fw-bold fs-14"},[this._v("提示")]),e("p",{staticClass:"content"},[this._v("登录状态发生变化，请刷新页面")]),e("div",{staticClass:"t-center"},[e("link-button",{on:{click:this.reload}},[this._v("确认")])],1)])]):this._e()}),[],!1,null,"7d0a3fd3",null);e.a=p.exports},function(t,e,n){"use strict";var i,o,a=n(10),r=n.n(a),s=n(217),c=n(72),l=n.n(c),u=n(8),d=(n(34),n(51),"PUSH_VC_AUTOPLAY"),f="REMOVE_VC_AUTOPLAY",h="SET_PLAYING_VC",p="REMOVE_PLAYING_VC",m="AUTOPLAY_NEXT_VC";function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v={state:{playingVideo:null,autoplayWaitingStack:[]},mutations:(i={},g(i,d,(function(t,e){t.autoplayWaitingStack.some((function(t){return t.videoId===e.videoId}))||t.autoplayWaitingStack.push({videoId:e.videoId,player:e.player})})),g(i,f,(function(t,e){t.autoplayWaitingStack=t.autoplayWaitingStack.filter((function(t){return t.videoId!==e}))})),g(i,h,(function(t,e){null!==t.playingVideo&&t.playingVideo.player.pause(),t.playingVideo=e,t.autoplayWaitingStack.filter((function(t){return t.videoId!==e.videoId}))})),g(i,p,(function(t){null!==t.playingVideo&&(t.playingVideo=null)})),g(i,m,(function(t){if(t.autoplayWaitingStack.length>0){var e=t.autoplayWaitingStack.pop();null!==t.playingVideo&&t.playingVideo.videoId===e.videoId||e.player.play()}})),i),actions:(o={},g(o,d,(function(t,e){var n=t.commit;n(d,e),n(m)})),g(o,f,(function(t,e){(0,t.commit)(f,e)})),g(o,h,(function(t,e){(0,t.commit)(h,e)})),g(o,p,(function(t){var e=t.commit;e(p),e(m)})),o),getters:{playingVideo:function(t){return t.playingVideo}}};r.a.use(s.a);e.a=new s.a.Store({modules:{vcPlayers:v,flow:l.a.FlowStore(u,{debug:!1,max:0})}})},,,,,,function(t,e,n){"use strict";var i=n(10),o=n.n(i),a=n(39),r=n(43),s=(n(14),n(28),n(25),n(60),n(37),n(33),n(21),n(36),n(46),n(9),n(29),n(13),n(40),n(24),n(32),n(11)),c=n.n(s),l=(n(41),n(77)),u=n.n(l),d=n(6),f=n(5),h=n(50),p=n(7),m=n(8),g=n(17),v=(n(231),n(219),n(12),n(356),n(57)),b=(n(15),n(34),n(38),n(80),n(81),n(54),n(85),n(4));n(45);function y(t){var e=t.length>1?1:0;return t.map((function(t,n){var i,o=Object.assign({},t);return o.cardDisplay=Object(m.bfsUrl)(o.img_src,o.img_width,o.img_height,e),o.img_src=encodeURI(o.img_src),o.img_src_zoom=(i=C(o.img_src),Object(d.g)(Object(m.bfsImgLink)(i,104,104,{e:1,c:1,useWebp:!1}))),o.img_src_boost=function(t){var e=t.img_src,n=t.img_width,i=(t.img_height,C(e));return n<518?Object(d.g)(Object(m.bfsImgLink)(i,null,null,{useWebp:!1})):Object(d.g)(Object(m.bfsImgLink)(i,518,null,{useWebp:!1}))}(o),o.img_src_zoom_one=function(t){var e=C(t.img_src);return Object(d.g)(Object(m.bfsImgLink)(e,214,214,{e:1,c:1,useWebp:!1}))}(o),o.rotate=function(t){var e,n,i,o,a=t.img_width,r=t.img_height;a>r?a>518?(e=518,n=(518-518*r/a)/2,i=0,o=518*r/a):(e=a,n=(a-r)/2,i=(518-a)/2,o=r):r>518?(n=-(518-(e=518*a/r))/2,i=(518-e)/2,o=a>518?518*r/a:r):(n=-(r-(e=a))/2,i=(518-a)/2,o=r);return[{ch:o,ih:o,maxWidth:"518px"},{ih:o,ch:e,position:"absolute",top:n+"px",left:i+"px",transform:"rotate(90deg)",maxHeight:"518px"},{ih:o,ch:o,transform:"rotate(180deg)"},{ih:o,ch:e,position:"absolute",top:n+"px",left:i+"px",transform:"rotate(270deg)",maxHeight:"518px"}]}(o),o.loader=function(t,e){var n=t.img_src_boost;return function(){return new Promise((function(t,i){var o=new Image;o.src=n,o.onload=function(){t(e)},o.onerror=function(){i(e)}}))}}(o,n),o.status="ready",o}))}function _(t){var e=document.documentElement.scrollTop||document.body.scrollTop;return t?t.getBoundingClientRect?t.getBoundingClientRect().top+e:function t(e){return e.offsetParent===document.body?e.offsetTop:e.offsetTop+t(e.offsetParent)}(t):0}function C(t){return t.indexOf("@")>-1?t.split("@")[0]:t}n(396);function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}
/**
 * PhotoImager is an image viewer for website.
 * Please check documention for more detail.
 *
 * @license MIT
 */
var I=!1;"undefined"!=typeof window&&(I=window.navigator.userAgent.indexOf("Firefox")>-1);var x=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._images=[],this._isFavourite=!1,this._isSupported=!1,this._isAuthorized=!1,this._config=null,this._vm=null,this.inited=!1,this._imageMeta={originalWidth:0,originalHeight:0},this._clickeEvents=[],this.config=e}var e,n,i;return e=t,i=[{key:"setOrignalImageSize",value:function(t){var e=t._imageViewer;e.style.width=t._imageMeta.originalWidth+"px",e.style.height=t._imageMeta.originalHeight+"px"}},{key:"setReactiveImageSize",value:function(e){var n=window.innerWidth||document.documentElement.offsetWidth,i=window.innerHeight||document.documentElement.offsetHeight,o=e._imageViewer;t.setOrignalImageSize(e);var a=e._currentImageSize,r=a.width,s=a.height,c=r/s,l=n/i;if(r>n||s>i){switch(!0){case c<1:O(o,i);break;case 1===c:if(l>=1&&s>=i){O(o,i);break}r>=n&&k(o,n);break;case c>1:s>=i&&O(o,i),r>=n&&k(o,n)}if(n>800){var u=.8*n-150;e._currentImageSize.width>u&&k(o,u)}}}},{key:"setReactiveImagePosition",value:function(t){var e=window.innerWidth||document.documentElement.offsetWidth,n=window.innerHeight||document.documentElement.offsetHeight,i=t._imageViewer,o=S(i),a=(e-o.width)/2,r=(n-o.height)/2;i.style.left=(a>0?a:0)+"px",i.style.top=(r>0?r:0)+"px",t._pre&&(t._pre.style.width=i.style.left),t._next&&(t._next.style.width=i.style.left)}}],(n=[{key:"_init",value:function(t){this.inited||(void 0!==t.element?this._initByElement(t):this._initByValues(t),this._createComponent(t),this.isSupported=!!t.isSupported,this.isFavourite=!!t.isFavourite,this.isAuthorized=!!t.isAuthorized)}},{key:"_initByElement",value:function(t){for(var e=this,n=("string"==typeof t.element?document.querySelector(t.element):t.element).querySelectorAll("[data-photo-imager-src]"),i=function(t,i){var o=n[t],a=o.getAttribute("data-photo-imager-src")||"",r=o.getAttribute("title")||"",s=function(){e.currentImage=t,e.show()};o.addEventListener("click",s),e._clickeEvents.push({el:o,handler:s,type:"click"}),e.images.push({url:a,title:r})},o=0,a=n.length;o<a;o++)i(o)}},{key:"_initByValues",value:function(t){if(void 0!==t.images&&"[object Array]"!==Object.prototype.toString.call(t.images))throw new TypeError("[".concat("PhotoImager","] images 参数必须为 Array."));this.images=t.images.map((function(t){return Object.assign({},t,{url:t.url||"",title:t.title||""})}))||[],this.images.length||void 0===this.images||this.images.push(t.image||{title:"",url:""})}},{key:"_createComponent",value:function(e){var n=this,i=document.createElement("div");document.body.appendChild(i);var a=new o.a({data:function(){return{config:e,isSupported:!1,isFavourite:!1,isAuthorized:!1,images:n.images,showComponent:!1,imageInLoading:!0,currentImage:0,totalImages:n.totalImages,eventInited:!1,useZoomingFunc:!1,inActualSize:!1,loadingImageUrl:"",showHinter:!1}},template:'<div class="photo-imager-container" v-show="showComponent" :class="{\'preview-mode\': useZoomingFunc && !inActualSize, \'actual-size\': useZoomingFunc && inActualSize}">\n      <div class="image-container" v-show="!imageInLoading" track-name="big_see">\n        <img class="image-viewer" @contextmenu="rightMouseFunc($event)" :src="showingImage.url" alt="Image" ref="imageViewer" :title="showingImage.title" :style="{ \'z-index\': inActualSize ? 12 : 0 }">\n      </div>\n\n      <div class="loading-image-container" v-show="imageInLoading" style="text-align: center">\n        <img class="image-viewer" @contextmenu="rightMouseFunc($event)" :src="loadingImageUrl">\n      </div>\n\n      <div class="control-buttons" v-show="!inActualSize">\n        <button class="control-button prev" ref="pre" @click="goPrev" v-if="totalImages > 1 && currentImage > 0"></button>\n        <button class="control-button next" ref="next" @click="goNext" v-if="totalImages > 1 && currentImage < totalImages - 1"></button>\n        <button class="close-button" @click="close">\n          <i class="bp-icon-font icon-close"></i>\n        </button>\n      </div>\n\n      <div class="image-hinter-ctnr" @mouseenter="openHinter($event)" @mouseleave="closeHinter($event)" v-show="!inActualSize">\n        <div class="image-count-hinter" :class="{\'show\': showHinter}">\n          <div class="count-hinter">\n            <span class="current-index">{{currentImage + 1}}</span>\n            <span>/ {{totalImages}}</span>\n          </div>\n          <div v-if="isAuthorized" class="view-actual-pictrue">\n            <a :href="showingImage.url" target="_blank">查看原图</a>\n          </div>\n        </div>\n      </div>\n\n      <button class="support-button" v-if="config.showSupportWidget" v-show="isSupported !== \'undefined\' && !inActualSize" @click="onSupport" :class="{actived: isSupported}" track-name="big_sup">\n        <div>\n          <i class="icon bp-svg-icon" :class="isSupported ? \'good-4\' : \'good-1\'"></i>\n        </div>\n        <div>\n          <span class="label" v-text="isSupported ? \'已点赞\' : \'点赞\'"></span>\n        </div>\n      </button>\n\n      <button class="favourite-button" v-if="config.showFavouriteWidget" v-show="isFavourite !== undefined && !inActualSize" @click="onFavourite" :class="{actived: isFavourite}" track-name="big_col">\n        <div>\n          <i class="icon bp-svg-icon" :class="isFavourite ? \'collection-4\' : \'collection-icons\'"></i>\n        </div>\n        <div>\n          <span class="label" v-text="isFavourite ? \'已收藏\' : \'收藏\'"></span>\n        </div>\n      </button>\n\n      <div class="loading-progress" role="progress" v-show="imageInLoading">\n        <i class="loading-icon"></i>\n      </div>\n    </div>\n    ',computed:{showingImage:function(){return this.images[this.currentImage]}},methods:{openHinter:function(){var t=this,e=null;return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN,i=t;clearTimeout(e),i.showHinter=!0,n&&!isNaN(n)&&(e=setTimeout((function(){return i.closeHinter()}),n))}},closeHinter:function(){this.showHinter=!1},rightMouseFunc:function(t){!1!==this.isAuthorized&&(this.popMessage(t.pageX,t.pageY,"作者设置了禁止保存，不可以偷偷存图哦~"),t.returnValue=!1)},popMessage:function(t,e,n){var i=document.createDocumentFragment(),o=document.createElement("div");o.innerHTML='<span class="toast-text">'.concat(n,"</span>"),o.className="pop-message",o.style.left=t+"px",o.style.top=e+"px",setTimeout((function(){o.className+=" out",setTimeout((function(){o.parentNode.removeChild(o)}),350)}),2e3),i.appendChild(o),document.body.appendChild(i)},resetState:function(){this.imageInLoading=!0,this.useZoomingFunc=!1},goPrev:function(){n.currentImage>0&&n.images.length&&!this.imageInLoading&&(n.currentImage--,this.inActualSize=!1),n.currentImage<=0&&this.openHinter(3e3)},goNext:function(){this.currentImage<n.totalImages-1&&!this.imageInLoading&&(n.currentImage++,this.inActualSize=!1),n.currentImage>=n.totalImages-1&&this.openHinter(3e3)},show:function(){this.showComponent=!0,e.hideBodyScroll&&T()},close:function(){this.releaseEvent(),this.showComponent=!1,e.hideBodyScroll&&L(),setTimeout(this.destroy)},destroy:function(){var t=this.$refs.imageViewer;t.removeEventListener("click",this.zoomingEvent),t.removeEventListener("load",this.imageOnLoad),this.releaseEvent(),this.$el.parentElement.removeChild(this.$el),this.$destroy()},onSupport:function(t){if("function"==typeof e.onSupport){var i=!this.isSupported;e.onSupport(i,t.target).then((function(){n.isSupported=i})).catch((function(){}))}},onFavourite:function(t){if("function"==typeof e.onFavourite){var i=!this.isFavourite;e.onFavourite(i,t.target).then((function(){n.isFavourite=i})).catch((function(){}))}},releaseEvent:function(){var t=this;window.removeEventListener("resize",t.setImagePositionAndSize),window.removeEventListener("keyup",t.keyUpEvent),window.removeEventListener("mousewheel",t.scrollingEvent),I&&window.removeEventListener("DOMMouseScroll",t.scrollingEvent),t.eventInited=!1},imageOnLoad:function(){var t=this,e=this;e.imageInLoading=!1,this.$nextTick((function(){var i=P(t.$refs.imageViewer),o=i.width,a=i.height;n._imageMeta.originalWidth=o,n._imageMeta.originalHeight=a,e.setZoomable(),e.setImagePositionAndSize()}))},setZoomable:function(){var t=window.innerWidth||document.documentElement.offsetWidth,e=window.innerHeight||document.documentElement.offsetHeight,n=P(this.$refs.imageViewer),i=n.width,o=n.height;(t<i||e<o)&&(this.inActualSize=!1,this.useZoomingFunc=!0)},scrollingEvent:function(t){if(!this.inActualSize){t.preventDefault();var e=0;t.wheelDelta?e=t.wheelDelta:t.detail&&(e=-1*t.detail),e<0?this.goNext():this.goPrev()}},zoomingEvent:function(){if(this.useZoomingFunc){var i=!this.inActualSize;this.inActualSize=i,i?(t.setOrignalImageSize(n),t.setReactiveImagePosition(n),T()):(this.setImagePositionAndSize(),e.hideBodyScroll||L())}},keyUpEvent:function(t){var e=this;switch(t.keyCode){case 27:e.close();break;case 37:!e.inActualSize&&e.goPrev();break;case 39:!e.inActualSize&&e.goNext()}},setImagePositionAndSize:function(){n._setImagePositionAndSize(),this.setZoomable()},initEvent:function(){var t=this;if(!t.eventInited){var e=this.$refs.imageViewer,n=new Image;n.addEventListener("load",(function e(){t.imageOnLoad(),n.removeEventListener("load",e)})),n.src=t.loadingImageUrl,e.addEventListener("load",t.imageOnLoad),e.addEventListener("click",t.zoomingEvent),window.addEventListener("resize",t.setImagePositionAndSize),window.addEventListener("keyup",t.keyUpEvent),window.addEventListener("mousewheel",t.scrollingEvent,{passive:!1}),I&&window.addEventListener("DOMMouseScroll",t.scrollingEvent),t.eventInited=!0}}},created:function(){this.loadingImageUrl=this.showingImage.url},mounted:function(){this.showComponent&&this.initEvent()},watch:{"showingImage.url":function(t){var e=this,n=this;n.loadingImageUrl="",this.$nextTick((function(){n.loadingImageUrl=t;var i=e.$refs.imageViewer;n.resetState(),i.style.width="",i.style.height=""}))},showComponent:function(t){var e=this;t&&this.$nextTick((function(){e.initEvent()}))}}});a.$mount(i),this._vm=a}},{key:"_setImagePositionAndSize",value:function(){var e=this;window.requestAnimationFrame?window.requestAnimationFrame((function(){t.setReactiveImageSize(e),t.setReactiveImagePosition(e)})):(t.setReactiveImageSize(this),t.setReactiveImagePosition(this))}},{key:"goPrev",value:function(){this._vm.goPrev()}},{key:"goNext",value:function(){this._vm.goNext()}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._init(this.config),t<0&&(t=0),t>this.totalImages-1&&(t=this.totalImages-1),this._vm.show(),"number"==typeof t&&(this.currentImage=t)}},{key:"close",value:function(){this._vm.close()}},{key:"destroy",value:function(){this._clickeEvents.forEach((function(t){t.el.removeEventListener(t.type,t.handler)})),this._vm.destroy()}},{key:"images",get:function(){return this._images},set:function(t){this._vm&&void 0!==this._vm.images&&(this._vm.images=t),this._images=t}},{key:"isFavourite",get:function(){return this._isFavourite},set:function(t){this._isFavourite=t,this._vm&&void 0!==this._vm.isFavourite&&(this._vm.isFavourite=t)}},{key:"isSupported",get:function(){return this._isSupported},set:function(t){this._isSupported=t,this._vm&&void 0!==this._vm.isSupported&&(this._vm.isSupported=t)}},{key:"isAuthorized",get:function(){return this._isAuthorized},set:function(t){this._isAuthorized=t,this._vm&&void 0!==this._vm.isAuthorized&&(this._vm.isAuthorized=t)}},{key:"currentImage",get:function(){return this._vm.currentImage},set:function(t){this._vm.currentImage=t}},{key:"totalImages",get:function(){var t=this.images.length;return this._vm&&"number"==typeof this._vm.totalImages&&(this._vm.totalImages=t),t}},{key:"config",get:function(){return this._config},set:function(t){this._config=t,this._vm&&(this._vm.config=t)}},{key:"_currentImageSize",get:function(){return S(this._vm.$refs.imageViewer)}},{key:"_imageViewer",get:function(){return this._vm.$refs.imageViewer}},{key:"_pre",get:function(){return this._vm.$refs.pre}},{key:"_next",get:function(){return this._vm.$refs.next}}])&&w(e.prototype,n),i&&w(e,i),t}();function k(t,e){t.style.width=e+"px",t.style.height="auto"}function O(t,e){t.style.height=e+"px",t.style.width="auto"}function S(t){return t.getBoundingClientRect()}function P(t){return{width:t.naturalWidth,height:t.naturalHeight}}function T(){document.body.style.overflow="hidden"}var j="undefined"!=typeof window?document.body.style.overflow:"";function L(){document.body.style.overflow=j}var A={name:"dot-loading"},E=(n(397),n(2)),M=Object(E.a)(A,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"dot-loading"},[e("span",{staticClass:"dot"},[e("em",{staticClass:"dot1"}),e("em",{staticClass:"dot2"}),e("em",{staticClass:"dot3"})])])}],!1,null,"47988eef",null).exports;function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){B(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function B(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var N={name:"ImagesBox",props:{images:{type:Array,default:function(){return[]}},parentDOM:{default:function(){return null}},scrollToViewPort:{type:Function},extendCallback:{type:Function,default:function(t,e){0}},originCallback:{type:Function,default:function(t,e){0}},showImgTag:null,dynamicId:String,spmPageTypeString:String},components:{Loading:M},mounted:function(){var t,e=new x({images:(t=this.images,t.map((function(t){return{url:t.img_src,width:t.img_width,height:t.img_height}}))),showSupportWidget:!1,showFavouriteWidget:!1,hideBodyScroll:!0});this.photoImager=e;this.spmId={live:"444.46",topic:"333.169",space:"333.49",dt:"444.42"}[this.spmPageTypeString]},data:function(){return{HOST:b.a,imgList:y(this.images),mode:"zoom",activeIndex:-1,boostSrc:"",zloading:!1,bloading:!1,pageSize:Math.ceil(this.images.length/9),rotateStatus:0,rotate:{},ch:"",openingTags:[]}},methods:{safeJsonParse:d.e,urlFilter:function(t){return/^https?:\/\//.test(t)?t:""},ChangeMode:function(t){var e=this;return this.zloading=!1,this.bloading=!1,this.ReturnToViewPort(),this.$nextTick((function(){e.mode=t})),!0},ChangeActiveIndex:function(t){this.activeIndex=t},ChangeBoostSrc:function(t){this.InitStatus(),this.boostSrc=this.imgList[t].img_src_boost},ChangeContainerHeight:function(){this.ch=this.rotate.ch,this.ReturnToViewPort()},InitStatus:function(){this.boostSrc="",this.ch="",this.rotate=this.imgList[this.activeIndex].rotate[0],this.rotateStatus=0},ReturnToViewPort:function(){var t=this;this.$nextTick((function(){if(t.scrollToViewPort)t.scrollToViewPort();else{var e,n=_(t.$refs.container),i=document.documentElement.scrollTop||document.body.scrollTop;e=t.parentDOM?_(t.parentDOM):n-150,i>n&&window.scrollTo(0,e)}}))},ChangeStatus:function(t,e){this.$set(this.imgList,t,R(R({},this.imgList[t]),{status:e}))},ZoomToBoost:function(t){var e=this;if(!this.zloading){var n=this.imgList[t];n.img_tags&&n.img_tags.length>0?this.openingTags=n.img_tags:this.openingTags=[];var i=n.status,o=n.loader;switch(this.ChangeActiveIndex(t),i){case"ready":case"error":n.status="loading",this.zloading=!0,(n.loader=o()).then((function(){e.ChangeBoostSrc(t),e.ChangeMode("boost"),e.zloading=!1,n.status="loaded",e.imgList.forEach((function(n,i){if(t!==i){n.status="loading";var o=n.loader;(n.loader=o()).then((function(){n.status="loaded"})).catch((function(t){e.imgList[t].status="error",e.imgList[t].loader=o}))}}))})).catch((function(t){e.zloading=!1,e.imgList[t].status="error",e.imgList[t].loader=o}));break;case"loading":this.zloading=!0,n.loader.then((function(){e.ChangeBoostSrc(t),e.ChangeMode("boost"),e.zloading=!1,n.status="loaded"}));break;case"loaded":this.ChangeBoostSrc(t),this.ChangeMode("boost")}this.extendCallback(t,this.imgList[t].img_src)}},SwitchBoost:function(t){var e=this;this.ChangeActiveIndex(t);var n=this.imgList[t];n.img_tags&&n.img_tags.length>0?this.openingTags=n.img_tags:this.openingTags=[];var i=n.status,o=n.loader;switch(i){case"error":this.bloading=!1,this.ChangeBoostSrc(t);break;case"loading":this.bloading=!0,o.then((function(t){t===e.activeIndex&&(e.bloading=!1,e.ChangeBoostSrc(t))}));break;case"loaded":this.bloading=!1,this.ChangeBoostSrc(t)}},OpenPhotoImager:function(t){this.photoImager.show(t),this.originCallback(t,this.imgList[t].img_src)},TurnToLeft:function(){this.rotateStatus--,this.rotateStatus<0&&(this.rotateStatus=3),this.rotate=this.imgList[this.activeIndex].rotate[this.rotateStatus],this.ch=this.rotate.ch},TurnToRight:function(){this.rotateStatus++,this.rotateStatus>3&&(this.rotateStatus=0),this.rotate=this.imgList[this.activeIndex].rotate[this.rotateStatus],this.ch=this.rotate.ch},imgBg:function(t){var e=this.imgList.length,n=t.cardDisplay;if(1===e){var i=n.width,o=n.height;return i||o?i&&!o?o=200*i/320:o&&!i&&(i=320*o/200):(i=320,o=200),"background-image: url(".concat(n.url,"); width: ").concat(i,"px; height: ").concat(o,"px")}return"background-image: url(".concat(n.url,")")},tagReport:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click";this.spmId&&this.$bpreport.click({logId:"000502",spmId:this.spmId,event:"card_pic_tag_"+e,data:{card_id:this.dynamicId,tag_type:t.type>1||1===t.type&&1===t.source_type?t.type+1:t.type,tag_name:t.text}})}},computed:{pageNo:function(){return Math.floor(this.activeIndex/9)+1},onlyOneCardStyle:function(){return 1===this.imgList.length&&this.imgList[0].img_width<200&&this.imgList[0].img_height<200?"width: auto; height: auto;":""},perTagPercentagePosition:function(){var t=this;return this.openingTags.length>0&&this.showImgTag?this.openingTags.map((function(e){var n=e.x/1e3,i=e.y/1e3,o=1===e.orientation;n>100?n=100:n<0&&(n=0),i>100?i=100:i<0&&(i=0);var a="";return a=o?"right: ".concat(100-n,"%; top: ").concat(i,"%;"):"left: ".concat(n,"%; top: ").concat(i,"%;"),4===e.type&&(e.text=Object(d.e)(e.poi).poi_info,e.text=e.text&&e.text.show_title),t.tagReport(e,"show"),R(R({},e),{},{reverse:o,style:a})})):[]}},watch:{boostSrc:function(t){""===t&&(this.openingTags=[])}}},U=(n(398),n(399),Object(E.a)(N,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"container",staticClass:"imagesbox"},["zoom"===t.mode?n("div",{staticClass:"zoom-wrap"},[n("ul",{staticClass:"zoom-list list-none",class:"zoom-"+t.imgList.slice(0,9).length,style:t.onlyOneCardStyle},t._l(t.imgList.slice(0,9),(function(e,i){return n("li",{key:i+e.status,staticClass:"card",class:"card-"+t.imgList.slice(0,9).length,style:t.onlyOneCardStyle,on:{click:function(e){return t.ZoomToBoost(i)}}},[n("div",{staticClass:"img-content",class:{"bg-top":e.cardDisplay.gifTop},style:t.imgBg(e),on:{error:function(e){return t.ChangeStatus(i,"error")}}}),e.img_tags&&e.img_tags.length?n("div",{staticClass:"tag-img",class:{small:t.imgList.length>1}}):t._e(),t.zloading&&t.activeIndex===i?n("div",{staticClass:"z-loading"},[n("loading")],1):t._e(),"error"===e.status?n("div",{staticClass:"z-error"},[n("span",{staticClass:"bp-svg-icon error"}),n("p",[t._v("加载失败")]),n("p",[t._v("点击重试")])]):t._e(),8===i&&t.imgList.length>9&&"error"!==e.status&&"loading"!==e.status?n("div",{staticClass:"plus-mask",domProps:{textContent:t._s(t.imgList.length+"P")}}):t._e()])})),0)]):t._e(),"boost"===t.mode?n("div",{staticClass:"boost-wrap"},[n("ul",{staticClass:"boost-control list-none"},[n("li",{staticClass:"bp-v-middle",on:{click:function(e){t.ChangeMode("zoom")&&t.InitStatus()}}},[n("i",{staticClass:"bp-icon-font icon-sq-dynamic bp-v-middle"}),n("span",[t._v("收起")])]),n("li",{staticClass:"bp-v-middle",on:{click:function(e){return t.OpenPhotoImager(t.activeIndex)}}},[n("i",{staticClass:"bp-icon-font icon-ss-dynamic bp-v-middle"}),n("span",[t._v("查看大图")])]),n("li",{staticClass:"bp-v-middle",on:{click:t.TurnToLeft}},[n("i",{staticClass:"bp-icon-font icon-left-r-dynamic bp-v-middle"}),n("span",[t._v("向左旋转")])]),n("li",{staticClass:"bp-v-middle",on:{click:t.TurnToRight}},[n("i",{staticClass:"bp-icon-font icon-right-r-dynamic bp-v-middle"}),n("span",[t._v("向右旋转")])])]),n("div",{staticClass:"boost-img",style:{height:t.ch?t.ch+"px":""},on:{click:function(e){t.ChangeMode("zoom")&&t.InitStatus()}}},[n("transition",{attrs:{name:"boost-fade",mode:"out-in"},on:{"after-leave":t.ChangeContainerHeight}},[n("div",{staticClass:"boost-img-container"},[n("img",{key:t.boostSrc,style:t.rotate,attrs:{src:t.boostSrc,height:t.rotate.ih}}),t._l(t.perTagPercentagePosition,(function(e){return 0===t.rotateStatus?n("div",{staticClass:"shop-tag",class:{"not-reverse":!e.reverse},style:e.style,on:{click:function(t){t.stopPropagation()}}},[n("div",{staticClass:"tag-point"}),n("div",{staticClass:"tag-bg"},[n("div",{staticClass:"tag-real"},[n("div",{staticClass:"tag-fake"},[t._v(" ")]),1===e.type&&e.url?n("a",{staticClass:"tag-text",attrs:{href:t.urlFilter(e.url),target:"_blank",title:e.text},on:{click:function(n){return t.tagReport(e)}}},[n("div",{staticClass:"tag-icon"}),n("div",{staticClass:"tag-text"},[t._v(t._s(e.text))])]):t._e(),2===e.type&&e.mid?n("a",{staticClass:"tag-text",attrs:{href:"//space.bilibili.com/"+e.mid,target:"_blank",title:e.text},on:{click:function(n){return t.tagReport(e)}}},[t._v("@"+t._s(e.text))]):t._e(),3===e.type&&e.text?n("a",{staticClass:"tag-text",attrs:{href:t.urlFilter(e.jump_url)||t.HOST.T+"/topic/name/"+encodeURIComponent(e.text)+"/feed",target:"_blank",title:e.text},on:{click:function(n){return t.tagReport(e)}}},[t._v(t._s("#"+e.text+"#"))]):t._e(),4===e.type?n("div",{staticClass:"tag-text",attrs:{title:e.text}},[n("div",{staticClass:"tag-icon lbs"}),n("div",{staticClass:"tag-text"},[t._v(t._s(e.text))])]):t._e(),0===e.type?n("div",{staticClass:"tag-text",attrs:{title:e.text}},[t._v(t._s(e.text))]):t._e()])])]):t._e()}))],2)]),t.bloading?n("div",{staticClass:"b-loading"},[n("loading")],1):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:0!==t.activeIndex,expression:"activeIndex !== 0"}],staticClass:"prev",on:{click:function(e){return e.stopPropagation(),t.SwitchBoost(t.activeIndex-1)}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.activeIndex!==t.imgList.length-1,expression:"activeIndex !== imgList.length - 1"}],staticClass:"next",on:{click:function(e){return e.stopPropagation(),t.SwitchBoost(t.activeIndex+1)}}})],1),n("div",{staticClass:"boost-slider-wrap"},[1!==t.imgList.length?n("div",{staticClass:"boost-slider-border",style:{left:t.activeIndex%9*58+"px"}}):t._e(),1!==t.imgList.length?n("div",{staticClass:"boost-slider"},[t.pageSize>1&&t.pageNo>1?n("div",{staticClass:"arrow-left",on:{click:function(e){t.SwitchBoost(9*(t.pageNo-1)-1)}}}):t._e(),t.pageSize>1&&t.pageNo!==t.pageSize?n("div",{staticClass:"arrow-right",on:{click:function(e){return t.SwitchBoost(9*t.pageNo)}}}):t._e(),n("ul",{staticClass:"list-none",style:{transform:"translateX(-"+100*(t.pageNo-1)+"%)"}},t._l(t.imgList,(function(e,i){return n("li",{key:i+e.status,class:i===t.activeIndex?"active":"",on:{click:function(e){return t.SwitchBoost(i)}}},[n("img",{attrs:{src:e.img_src_zoom}})])})),0)]):t._e()])]):t._e()])}),[],!1,null,"690d023e",null).exports);o.a.use(v.b);var H=U;n(74);function $(t){var e=W(t);return Object(d.g)(Object(m.bfsImgLink)(e,203,127,{e:1,c:1}))}function z(t){return m.numberFormat.autoParse(t).replace(/\s+/g,"")}function V(t){var e,n,i,o;return n=Math.floor(t/3600),i=Math.floor((t-3600*n)/60),o=(t-3600*n)%60,e="".concat(F(i),":").concat(F(o)),n>0&&(e="".concat(F(n),":").concat(e)),e}function F(t){return t<10?"0".concat(t):t}function W(t){return t.indexOf("@")>-1?t.split("@")[0]:t}var G={props:{href:{type:String,default:function(){return""},required:!0},link:{type:Function,default:function(){}}}},J=Object(E.a)(G,(function(){var t=this.$createElement,e=this._self._c||t;return this.href?e("a",{attrs:{target:"_blank",href:this.href},on:{click:this.link}},[this._t("content")],2):e("div",[this._t("content")],2)}),[],!1,null,"2b044bfb",null).exports,K={props:{images:{type:Array,default:function(){return[]}},link:{type:String,default:function(){return""}},title:{type:String,default:function(){return""}},content:{type:String,default:function(){return""}},linkCallback:{type:Function,default:function(t){0}}},data:function(){return{imgList:(t=this.images,e=1===t.length?520:170,t.map((function(t){var n=W(t);return Object(d.g)(Object(m.bfsImgLink)(n,e,120,{e:1,c:1}))})))};var t,e},methods:{linkMethods:function(){this.linkCallback(this.link)}},components:{Hyper:J}},Y=(n(400),Object(E.a)(K,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-container"},[n("hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"images-area"},t._l(t.imgList,(function(e,i){return n("img",{class:"card-"+t.imgList.length,attrs:{src:e}})})),0),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title",domProps:{textContent:t._s(t.title)}}),n("div",{staticClass:"content",domProps:{textContent:t._s(t.content)}})])])])],1)}),[],!1,null,"3d352df6",null).exports),q=n(19);function Z(t){return Object(q.a)({method:"post",url:"//api.bilibili.com/x/v2/history/toview/add",data:{aid:t,jsonp:"jsonp"}}).catch((function(t){return Promise.resolve(t)}))}function Q(t){return Object(q.a)({method:"post",url:"//api.bilibili.com/x/v2/history/toview/del",data:{jsonp:"jsonp",aid:t}}).catch((function(t){return Promise.resolve(t)}))}function X(t){return Object(q.a)({method:"get",url:"//api.bilibili.com/x/player/videoshot",data:{aid:t,index:1}})}function tt(t){return Object(q.a)({method:"get",url:"//api.bilibili.com/x/v2/dm/ajax",data:{aid:t}})}var et={data:function(){return{progress:0,loadStatus:!1,pic:"",x:0,y:0,size:0,width:203,data:null}},props:{aid:{required:!0},hit:{required:!0,default:!1},movex:{required:!0,default:0}},computed:{img:function(){return this.pic.replace(/^http:/,"")},show:function(){return this.hit&&this.data}},watch:{hit:function(){this.hit&&!this.loadStatus&&this.ajax()},movex:function(t){this.onMouseMove(t)}},methods:{ajax:function(){var t=this;X(t.aid).then((function(e){t.loadStatus=!0,0===e.code&&e.data&&(t.pic=e.data.image[0],t.data=e.data)})).catch((function(e){t.loadStatus=!0,console.error(e)}))},onMouseMove:function(t){if(this.loadStatus&&this.data){var e=this.data.index.length,n=this.data.img_y_size/this.data.img_x_size*this.width;this.progress=Math.floor(t/this.width*100),this.size=this.width*this.data.img_x_len;var i=Math.floor(t/this.width*e);this.x=-i%this.data.img_x_len*this.width,this.y=-Math.floor(i/this.data.img_x_len)*n}}}},nt=(n(401),Object(E.a)(et,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.show?"cover-preview-module show":"cover-preview-module"},[t.img?n("div",{staticClass:"cover",style:{backgroundImage:"url("+t.img+")",backgroundPosition:t.x+"px "+t.y+"px",backgroundSize:t.size+"px"}}):t._e(),n("div",{staticClass:"progress-bar"},[n("span",{style:{width:t.progress+"%"}})])])}),[],!1,null,"5f843606",null).exports),it={props:{aid:{required:!0},hit:{required:!0,default:!1}},data:function(){return{loadStatus:!1,timer:null,timeout:null,danmus:[],index:0,speed:5,dest:1.5,wrapWidth:203}},watch:{hit:function(t){!t||this.loadStatus?t?this.start():(clearInterval(this.timer),clearTimeout(this.timeout)):this.ajax()}},mounted:function(){this.wrapWidth=this.$refs.wrap.offsetWidth},destroyed:function(){clearInterval(this.timer),clearTimeout(this.timeout)},methods:{noop:function(){},ajax:function(){var t=this;tt(t.aid).then((function(e){0===e.code&&(t.loadStatus=!0,t.danmus=e.data||[],t.start())})).catch((function(e){t.loadStatus=!0,console.log(e)}))},start:function(){var t=this;this.$nextTick((function(){t.timer=setInterval((function(){if(t.index>t.danmus.length-1)clearInterval(t.timer),t.reset();else{var e=(t.$refs["dm"+t.index]||{})[0];if(!e)return;var n=e.offsetWidth;e.style.transform="translateX(".concat(-n-t.wrapWidth+"px",")"),e.style.transition="transform "+t.speed+"s linear",t.index++}}),1e3*t.dest)}))},reset:function(){var t=this;t.timeout=setTimeout((function(){t.index=0;for(var e=0;e<t.danmus.length;e++){var n=(t.$refs["dm"+e]||{})[0];if(!n)return;n.style.transform="",n.style.transition=""}t.start(),clearTimeout(t.timeout)}),1e3*t.speed-1e3*t.dest)}}},ot=(n(402),Object(E.a)(it,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"wrap",class:t.hit?"danmu-module show":"danmu-module"},t._l(t.danmus,(function(e,i){return n("p",{ref:"dm"+i,refInFor:!0,class:i%2==0?"dm":"dm row2",on:{mouseenter:function(e){return e.stopPropagation(),t.noop(e)},mouseleave:function(e){return e.stopPropagation(),t.noop(e)},mousemove:function(e){return e.stopPropagation(),t.noop(e)}}},[t._v(t._s(e))])})),0)}),[],!1,null,"3c877149",null).exports);function at(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var rt={props:{image:{type:String,default:function(){return""}},title:{type:String,default:function(){return""}},tag:{type:String,default:function(){return""}},content:{type:String,default:function(){return""}},aid:{type:Number,default:function(){return""}},duration:{type:Number,default:function(){return 0}},view:{type:Number,default:function(){return 0}},danmaku:{type:Number,default:function(){return 0}},link:{type:String,default:function(){return""}},linkCallback:{type:Function,default:function(t){0}},seeLaterCallback:{type:Function,default:function(t){0}},preview:{type:null,default:function(){return!1}},fromBiz:{type:Boolean},needPay:{type:Boolean},isCooperation:{type:Boolean}},data:function(){return{imageURL:$(this.image),danmakuNum:z(this.danmaku),viewNum:z(this.view),durationTime:V(this.duration),seeLaterStatus:0,tipsText:"",clickLocker:!1,hit:!1,movex:0,timeout:null}},computed:{canPreview:function(){return this.preview&&!this.needPay},typeTxt:function(){return this.tag?this.tag:this.needPay?"付费视频":this.isCooperation?"合作视频":"投稿视频"}},methods:{onMouseEnter:function(){if(this.canPreview){var t=this;clearTimeout(t.timeout),t.timeout=setTimeout((function(){t.hit||(t.hit=!0),clearTimeout(t.timeout)}),500)}},onMouseLeave:function(){this.canPreview&&(clearTimeout(this.timeout),this.hit=!1,this.movex=0)},onMouseMove:function(t){this.canPreview&&(this.movex=t.layerX||0)},linkMethods:function(){this.linkCallback(this.link)},ChangeTipsText:function(t){this.tipsText=t},SeeLaterHover:function(){0===this.seeLaterStatus?this.tipsText="稍后再看":this.tipsText="移除"},SeeLaterClick:function(){var t,e=this;return(t=c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.quickLogin)();case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!e.clickLocker){t.next=7;break}return t.abrupt("return");case 7:e.clickLocker=!0,e.seeLaterCallback(e.seeLaterStatus),0===e.seeLaterStatus?Z(e.aid).then((function(t){e.clickLocker=!1,0===t.code?(e.tipsText="已加稍后再看",e.seeLaterStatus=1):e.tipsText=t.msg||"添加失败，请重试"})):1===e.seeLaterStatus&&Q(e.aid).then((function(t){e.clickLocker=!1,0===t.code?(e.tipsText="已从稍后再看列表中移除",e.seeLaterStatus=0):e.tipsText=t.msg||"移除失败，请重试"}));case 10:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){at(a,i,o,r,s,"next",t)}function s(t){at(a,i,o,r,s,"throw",t)}r(void 0)}))})()}},components:{Hyper:J,CoverPreview:nt,DanmuPreview:ot}},st=(n(403),Object(E.a)(rt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"video-container",class:{"can-hover":!t.fromBiz}},[n("hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{staticClass:"video-wrap",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area",on:{mouseenter:t.onMouseEnter,mouseleave:t.onMouseLeave,mousemove:t.onMouseMove}},[n("div",{staticClass:"types",class:t.needPay&&"need-pay",style:t.hit?"opacity: 0":""},[t._v(t._s(t.typeTxt))]),t.canPreview?n("cover-preview",{attrs:{aid:t.aid,hit:t.hit,movex:t.movex}}):t._e(),n("img",{attrs:{src:t.imageURL}}),n("div",{staticClass:"mask"},[n("span",{domProps:{textContent:t._s(t.durationTime)}})]),t.canPreview?n("danmu-preview",{attrs:{aid:t.aid,hit:t.hit}}):t._e(),t.fromBiz||t.needPay?t._e():n("div",{staticClass:"see-later",class:1===t.seeLaterStatus?"done":"",on:{mouseover:t.SeeLaterHover,mouseout:function(e){return t.ChangeTipsText("")},click:function(e){return e.preventDefault(),e.stopPropagation(),t.SeeLaterClick(e)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.tipsText,expression:"tipsText"}],staticClass:"tips",domProps:{textContent:t._s(t.tipsText)}})])],1),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title",domProps:{textContent:t._s(t.title)}}),n("div",{staticClass:"content",domProps:{textContent:t._s(t.content)}}),n("div",{staticClass:"view-danmaku"},[n("div",[n("i",{staticClass:"bp-icon-font icon-play-a"}),n("span",{staticClass:"view",domProps:{textContent:t._s(t.viewNum)}})]),n("div",[n("i",{staticClass:"bp-icon-font icon-danmu-a"}),n("span",{staticClass:"danmaku",domProps:{textContent:t._s(t.danmakuNum)}})])])])])])],1)}),[],!1,null,"0514ecc0",null).exports),ct={data:function(){return{progress:0,loadStatus:!1,pic:"",x:0,y:0,size:0,width:203,data:null}},props:{aid:{required:!0},hit:{required:!0,default:!1},movex:{required:!0,default:0}},computed:{img:function(){return this.pic.replace(/^http:/,"")},show:function(){return this.hit&&this.data}},watch:{hit:function(){this.hit&&!this.loadStatus&&this.ajax()},movex:function(t){this.onMouseMove(t)}},methods:{ajax:function(){var t=this;X(t.aid).then((function(e){t.loadStatus=!0,0===e.code&&e.data&&(t.pic=e.data.image[0],t.data=e.data)})).catch((function(e){t.loadStatus=!0,console.error(e)}))},onMouseMove:function(t){if(this.loadStatus&&this.data){var e=this.data.index.length,n=this.data.img_y_size/this.data.img_x_size*this.width;this.progress=Math.floor(t/this.width*100),this.size=this.width*this.data.img_x_len;var i=Math.floor(t/this.width*e);this.x=-i%this.data.img_x_len*this.width,this.y=-Math.floor(i/this.data.img_x_len)*n}}}},lt=(n(404),Object(E.a)(ct,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.show?"cover-preview-module show":"cover-preview-module"},[t.img?n("div",{staticClass:"cover",style:{backgroundImage:"url("+t.img+")",backgroundPosition:t.x+"px "+t.y+"px",backgroundSize:t.size+"px"}}):t._e(),n("div",{staticClass:"progress-bar"},[n("span",{style:{width:t.progress+"%"}})])])}),[],!1,null,"313ee167",null).exports),ut={props:{aid:{required:!0},hit:{required:!0,default:!1}},data:function(){return{loadStatus:!1,timer:null,timeout:null,danmus:[],index:0,speed:5,dest:1.5,wrapWidth:203}},watch:{hit:function(t){!t||this.loadStatus?t?this.start():(clearInterval(this.timer),clearTimeout(this.timeout)):this.ajax()}},mounted:function(){this.wrapWidth=this.$refs.wrap.offsetWidth},destroyed:function(){clearInterval(this.timer),clearTimeout(this.timeout)},methods:{noop:function(){},ajax:function(){var t=this;tt(t.aid).then((function(e){0===e.code&&(t.loadStatus=!0,t.danmus=e.data||[],t.start())})).catch((function(e){t.loadStatus=!0,console.log(e)}))},start:function(){var t=this;this.$nextTick((function(){t.timer=setInterval((function(){if(t.index>t.danmus.length-1)clearInterval(t.timer),t.reset();else{var e=(t.$refs["dm"+t.index]||{})[0];if(!e)return;var n=e.offsetWidth;e.style.transform="translateX(".concat(-n-t.wrapWidth+"px",")"),e.style.transition="transform "+t.speed+"s linear",t.index++}}),1e3*t.dest)}))},reset:function(){var t=this;t.timeout=setTimeout((function(){t.index=0;for(var e=0;e<t.danmus.length;e++){var n=(t.$refs["dm"+e]||{})[0];if(!n)return;n.style.transform="",n.style.transition=""}t.start(),clearTimeout(t.timeout)}),1e3*t.speed-1e3*t.dest)}}},dt=(n(405),Object(E.a)(ut,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"wrap",class:t.hit?"danmu-module show":"danmu-module"},t._l(t.danmus,(function(e,i){return n("p",{ref:"dm"+i,refInFor:!0,class:i%2==0?"dm":"dm row2",on:{mouseenter:function(e){return e.stopPropagation(),t.noop(e)},mouseleave:function(e){return e.stopPropagation(),t.noop(e)},mousemove:function(e){return e.stopPropagation(),t.noop(e)}}},[t._v(t._s(e))])})),0)}),[],!1,null,"01e60aac",null).exports);function ft(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var ht={props:{image:{type:String,default:function(){return""}},title:{type:String,default:function(){return""}},content:{type:String,default:function(){return""}},aid:{type:Number,default:function(){return""}},duration:{type:Number,default:function(){return 0}},view:{type:Number,default:function(){return 0}},danmaku:{type:Number,default:function(){return 0}},link:{type:String,default:function(){return""}},linkCallback:{type:Function,default:function(t){0}},seeLaterCallback:{type:Function,default:function(t){0}},preview:{type:null,default:function(){return!1}},fromBiz:{type:Boolean},needPay:{type:Boolean},isCooperation:{type:Boolean}},data:function(){return{imageURL:$(this.image),danmakuNum:z(this.danmaku),viewNum:z(this.view),durationTime:V(this.duration),seeLaterStatus:0,tipsText:"",clickLocker:!1,hit:!1,movex:0,timeout:null}},computed:{canPreview:function(){return this.preview&&!this.needPay}},methods:{onMouseEnter:function(){if(this.canPreview){var t=this;clearTimeout(t.timeout),t.timeout=setTimeout((function(){t.hit||(t.hit=!0),clearTimeout(t.timeout)}),500)}},onMouseLeave:function(){this.canPreview&&(clearTimeout(this.timeout),this.hit=!1,this.movex=0)},onMouseMove:function(t){this.canPreview&&(this.movex=t.layerX||0)},linkMethods:function(){this.linkCallback(this.link)},ChangeTipsText:function(t){this.tipsText=t},SeeLaterHover:function(){0===this.seeLaterStatus?this.tipsText="稍后再看":this.tipsText="移除"},SeeLaterClick:function(){var t,e=this;return(t=c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.quickLogin)();case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:if(!e.clickLocker){t.next=7;break}return t.abrupt("return");case 7:e.clickLocker=!0,e.seeLaterCallback(e.seeLaterStatus),0===e.seeLaterStatus?Z(e.aid).then((function(t){e.clickLocker=!1,0===t.code?(e.tipsText="已加稍后再看",e.seeLaterStatus=1):e.tipsText=t.msg||"添加失败，请重试"})):1===e.seeLaterStatus&&Q(e.aid).then((function(t){e.clickLocker=!1,0===t.code?(e.tipsText="已从稍后再看列表中移除",e.seeLaterStatus=0):e.tipsText=t.msg||"移除失败，请重试"}));case 10:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){ft(a,i,o,r,s,"next",t)}function s(t){ft(a,i,o,r,s,"throw",t)}r(void 0)}))})()}},components:{Hyper:J,CoverPreview:lt,DanmuPreview:dt}},pt=(n(406),Object(E.a)(ht,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"video-container",class:{"can-hover":!t.fromBiz}},[n("hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{staticClass:"video-wrap",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area",on:{mouseenter:t.onMouseEnter,mouseleave:t.onMouseLeave,mousemove:t.onMouseMove}},[n("div",{staticClass:"types",style:t.hit?"opacity: 0":""},[t._v("直播回放")]),t.canPreview?n("cover-preview",{attrs:{aid:t.aid,hit:t.hit,movex:t.movex}}):t._e(),n("img",{attrs:{src:t.imageURL}}),n("div",{staticClass:"mask"},[n("span",{domProps:{textContent:t._s(t.durationTime)}})]),t.canPreview?n("danmu-preview",{attrs:{aid:t.aid,hit:t.hit}}):t._e(),t.fromBiz||t.needPay?t._e():n("div",{staticClass:"see-later",class:1===t.seeLaterStatus?"done":"",on:{mouseover:t.SeeLaterHover,mouseout:function(e){return t.ChangeTipsText("")},click:function(e){return e.preventDefault(),e.stopPropagation(),t.SeeLaterClick(e)}}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.tipsText,expression:"tipsText"}],staticClass:"tips",domProps:{textContent:t._s(t.tipsText)}})])],1),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title",domProps:{textContent:t._s(t.title)}}),n("div",{staticClass:"content",domProps:{textContent:t._s(t.content)}}),n("div",{staticClass:"view-danmaku"},[n("div",[n("i",{staticClass:"bp-icon-font icon-play-a"}),n("span",{staticClass:"view",domProps:{textContent:t._s(t.viewNum)}})]),n("div",[n("i",{staticClass:"bp-icon-font icon-danmu-a"}),n("span",{staticClass:"danmaku",domProps:{textContent:t._s(t.danmakuNum)}})])])])])])],1)}),[],!1,null,"4a97ece4",null).exports),mt={props:{link:{type:String,required:!0},coverUrl:{type:String,required:!0},viewNum:{type:String,required:!0},title:{type:String,required:!0},areaName:{type:String,required:!0},status:{type:String,required:!0},showViewNum:{type:Boolean,default:!0},linkCallback:{type:Function,default:function(){}}},data:function(){return{cover:$(this.coverUrl)}},components:{Hyper:J}},gt=(n(407),Object(E.a)(mt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"live-container"},[n("hyper",{attrs:{href:t.link,link:t.linkCallback}},[n("div",{staticClass:"live-wrap",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area"},[n("div",{staticClass:"status",class:{back:"直播中"!==t.status}},[t._v(t._s(t.status))]),n("img",{attrs:{src:t.cover}})]),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title fs-16 tc-black"},[t._v(t._s(t.title))]),n("div",{staticClass:"bottom-text tc-slate fs-12"},[n("div",{staticClass:"section d-i-block"},[t._v(t._s(t.areaName))]),t.showViewNum?n("div",{staticClass:"view-num d-i-block"},[t._v(" · "+t._s(t.viewNum))]):t._e()])])])])],1)}),[],!1,null,"23b19018",null).exports),vt={props:{image:{type:String,default:function(){return""}},title:{type:String,default:function(){return""}},content:{type:String,default:function(){return""}},view:{type:Number,default:function(){return 0}},danmaku:{type:Number,default:function(){return 0}},link:{type:String,default:function(){return""}},linkCallback:{type:Function,default:function(t){0}},fromBiz:{type:Boolean},tags:null,hideViewDanmaku:null},data:function(){return{imageURL:$(this.image),danmakuNum:z(this.danmaku),viewNum:z(this.view)}},computed:{tagInfo:function(){return!this.tags||this.tags.length<1?{}:this.tags[0]},tagText:function(){return this.tagInfo.name},tagStyle:function(){return"background-color: #".concat(this.tagInfo.color,";")}},methods:{linkMethods:function(){this.linkCallback(this.link)}},components:{Hyper:J}},bt=(n(408),Object(E.a)(vt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bangumi-container",class:{"can-hover":!t.fromBiz}},[n("hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area"},[n("img",{attrs:{src:t.imageURL}}),t.tagText?n("div",{staticClass:"tag",style:t.tagStyle},[t._v(t._s(t.tagText))]):t._e()]),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title",domProps:{textContent:t._s(t.title)}}),n("div",{staticClass:"content",domProps:{textContent:t._s(t.content)}}),t.hideViewDanmaku?t._e():n("div",{staticClass:"view-danmaku"},[n("div",[n("i",{staticClass:"bp-icon-font icon-play-a"}),n("span",{staticClass:"view",domProps:{textContent:t._s(t.viewNum)}})]),n("div",[n("i",{staticClass:"bp-icon-font icon-danmu-a"}),n("span",{staticClass:"danmaku",domProps:{textContent:t._s(t.danmakuNum)}})])])])])])],1)}),[],!1,null,"6d8fee64",null).exports),yt=(n(55),{props:{image:{type:String,default:""},link:{type:String,default:""},content:{type:String,default:""},desc:{type:String,default:""},tag:{type:Array,default:function(){return[]}},styleType:{type:String}},components:{Hyper:J},computed:{imgStyle:function(){var t=this.hasImage?this.image:"//s1.hdslb.com/bfs/seed/bplus-common/dynamic-assets/img_loading.png";return"background-image: url(".concat(t,")")},hasImage:function(){return""!==this.image},hasDesc:function(){return""!==this.desc}}}),_t=(n(409),Object(E.a)(yt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h5share-container bg-white pointer t-left",class:{"share-iframe-container":"share-iframe"===t.styleType}},[n("hyper",{attrs:{href:t.link}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area f-left"},[n("div",{staticClass:"share-img w-100 h-100",class:{"bg-shrink":!t.hasImage},style:t.imgStyle})]),n("div",{staticClass:"text-area f-left",class:{"share-iframe-text":"share-iframe"===t.styleType}},[n("div",{staticClass:"text-content ff-yahei tc-black ls-0",class:{middle:!t.hasDesc}},[n("div",{staticClass:"text fs-14 line-clamp-1 break-all"},[t._v(t._s(t.content))]),t.tag[0]?n("span",{staticClass:"tag t-center fs-12",style:{background:"#"+t.tag[0].color}},[t._v(t._s(t.tag[0].name))]):t._e()]),t.hasDesc?n("div",{staticClass:"text-desc ff-yahei tc-slate fs-12 ls-0 line-clamp-1"},[t._v(t._s(t.desc))]):t._e()])])])],1)}),[],!1,null,"47cded4d",null).exports),Ct={props:{cover:{type:String,default:""},link:{type:String,default:""},title:{type:String,default:""},author:{type:String,default:""},desc:{type:String,default:""},content:{type:String,default:""},tags:null},components:{Hyper:J},computed:{imgStyle:function(){var t=this.cover||"//s1.hdslb.com/bfs/seed/bplus-common/dynamic-assets/img_loading.png";return"background-image: url(".concat(t,")")},tagInfo:function(){return!this.tags||this.tags.length<1?{}:this.tags[0]},tagText:function(){return this.tagInfo.name},tagStyle:function(){return"background-color: #".concat(this.tagInfo.color,";")}}},wt=(n(410),Object(E.a)(Ct,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h5share-container bg-white pointer t-left p-rel"},[n("hyper",{attrs:{href:t.link}},[n("div",{attrs:{slot:"content"},slot:"content"},[t.tagText?n("div",{staticClass:"tag",style:t.tagStyle},[t._v(t._s(t.tagText))]):t._e(),n("div",{staticClass:"image-area f-left"},[n("div",{staticClass:"share-img w-100 h-100",style:t.imgStyle})]),n("div",{staticClass:"text-area f-left"},[n("div",{staticClass:"text-content ff-yahei fs-14 ls-0 line-clamp-1"},[t._v(t._s(t.title))]),n("div",{staticClass:"text-desc ff-yahei fs-12 ls-0 line-clamp-1"},[t._v(t._s(t.desc))]),n("div",{staticClass:"text-desc ff-yahei fs-12 ls-0 line-clamp-1"},[t._v(t._s(t.content))])])])])],1)}),[],!1,null,"1509e9aa",null).exports),It={props:{image:{type:String,default:""},link:{type:String,default:""},content:{type:String,default:""},desc:{type:String,default:""},styleType:{type:String},linkCallback:{type:Function,default:function(){}}},components:{Hyper:J},computed:{imgStyle:function(){var t=this.hasImage?this.image:"//s1.hdslb.com/bfs/seed/bplus-common/dynamic-assets/img_loading.png";return"background-image: url(".concat(t,")")},hasImage:function(){return""!==this.image},hasDesc:function(){return""!==this.desc}}},xt=(n(412),Object(E.a)(It,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"music-container bg-white pointer t-left",class:{"share-iframe-container":"share-iframe"===t.styleType}},[i("hyper",{attrs:{href:t.link,link:t.linkCallback}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("div",{staticClass:"image-area f-left p-rel"},[i("div",{staticClass:"share-img w-100 h-100",class:{"bg-shrink":!t.hasImage},style:t.imgStyle}),i("img",{staticClass:"music-play-icon p-abs",attrs:{src:n(411)}})]),i("div",{staticClass:"text-area f-left",class:{"share-iframe-text":"share-iframe"===t.styleType}},[i("div",{staticClass:"text-content ff-yahei tc-black fs-14 ls-0 line-clamp-1",class:{middle:!t.hasDesc}},[t._v(t._s(t.content))]),t.hasDesc?i("div",{staticClass:"text-desc ff-yahei tc-slate fs-12 ls-0"},[t._v(t._s(t.desc))]):t._e()])])])],1)}),[],!1,null,"7d9db8c7",null).exports),kt={props:{image:{type:String,default:""},link:{type:String,default:""},content:{type:String,default:""},desc:{type:String,default:""}},components:{Hyper:J},computed:{imgStyle:function(){return this.hasImage?"background-image: url(".concat(this.image,")"):"background: #DFF7FF url(".concat(n(413),") center/28px no-repeat;")},hasImage:function(){return""!==this.image},hasDesc:function(){return""!==this.desc}},methods:{onClick:function(){this.$emit("click")}}},Ot=(n(414),Object(E.a)(kt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vote-container bg-white pointer t-left",on:{click:t.onClick}},[n("hyper",{attrs:{href:t.link}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area f-left"},[n("div",{staticClass:"share-img w-100 h-100",class:{"bg-shrink":!t.hasImage},style:t.imgStyle})]),n("div",{staticClass:"text-area f-left"},[n("div",{staticClass:"text-content ff-yahei tc-black fs-14 ls-0 line-clamp-1",class:{middle:!t.hasDesc}},[t._v(t._s(t.content))]),t.hasDesc?n("div",{staticClass:"text-desc ff-yahei tc-slate fs-12 ls-0 line-clamp-1"},[t._v(t._s(t.desc))]):t._e(),n("div",{staticClass:"vote-btn-box"},[n("div",{staticClass:"vote-btn"},[t._v("投票")])])])])])],1)}),[],!1,null,"9b0fce88",null).exports),St={props:{data:{type:Object,required:!0}},computed:{info:function(){if(this.data){var t=this.data;t.origin&&(t=JSON.parse(t.origin));try{return JSON.parse(t.image_info)}catch(e){return t.image_info||{}}}return{}},desc:function(){return this.info.desc},title:function(){return this.info.title},tag:function(){return this.info.tag_name},tagStyle:function(){return"background-color: ".concat(this.info.tag_color,";")},posterImg:function(){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=W(t);return Object(d.g)(Object(m.bfsImgLink)(n,520*e,152*e))}(this.info.icon)}},methods:{handleClick:function(){window.open(this.info.jump_url,"_blank")}}},Pt=(n(415),Object(E.a)(St,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-subscription",on:{click:t.handleClick}},[n("div",{staticClass:"card-subscription__desc"},[t._v(t._s(t.desc))]),n("div",{staticClass:"card-subscription__poster"},[n("img",{staticClass:"card-subscription__poster-img",attrs:{src:t.posterImg}}),n("div",{staticClass:"card-subscription__poster-tag",style:t.tagStyle},[t._v(t._s(t.tag))]),n("div",{staticClass:"card-subscription__poster-title"},[t._v(t._s(t.title))])])])}),[],!1,null,"3706b0bb",null).exports),Tt=n(338),jt=n.n(Tt),Lt={props:["cover","coverType","title","description","contentCount","link","linkCallback"],data:function(){return{}},computed:{coverBfsUrl:function(){var t="";return this.cover&&(t=Object(m.bfsImgLink)(this.cover.replace(/^http:|^https:/,""),null,127)),t},coverBoxStyle:function(){return this.coverBfsUrl?12!==this.coverType?"background-image: url(".concat(this.coverBfsUrl,")"):"background-image: url(".concat(this.coverBfsUrl,"); filter: blur(12px)"):"background-image: url(".concat(jt.a,"); background-size: 34px 33px;")},coverImageStyle:function(){var t="";return 12===this.coverType&&(t="width: 127px; height: 127px; background-image: url(".concat(this.coverBfsUrl,")")),t},contentCountString:function(){return"".concat(this.contentCount,"个内容")}},watch:{},components:{Hyper:J},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{linkMethods:function(){"function"==typeof this.linkCallback&&this.linkCallback(this.link)}}},At=(n(416),Object(E.a)(Lt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"media-list"},[n("Hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{staticClass:"content",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"cover-box-cliper"},[n("div",{staticClass:"cover-box",style:t.coverBoxStyle}),t.coverImageStyle?n("div",{staticClass:"cover-image",style:t.coverImageStyle}):t._e(),n("div",{staticClass:"media-list-icon"})]),n("div",{staticClass:"text-box"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),n("div",{staticClass:"description"},[t._v(t._s(t.description))]),n("div",{staticClass:"count-box"},[t._v(t._s(t.contentCountString))])])])])],1)}),[],!1,null,"bf1c912a",null).exports),Et={props:{isUpdate:{type:null,default:function(){return!1}},image:{type:String,default:function(){return""}},title:{type:String,default:function(){return""}},subtitle:{type:String,default:function(){return""}},content:{type:String,default:function(){return""}},link:{type:String,default:function(){return""}},linkCallback:{type:Function,default:function(t){0}}},data:function(){return{imageURL:$(this.image)}},computed:{},methods:{linkMethods:function(){this.linkCallback(this.link)}},components:{Hyper:J}},Mt=(n(417),Object(E.a)(Et,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"video-container",class:{"can-hover":t.link}},[n("hyper",{attrs:{href:t.link,link:t.linkMethods}},[n("div",{staticClass:"video-wrap",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"image-area"},[n("div",{staticClass:"types"},[t._v("付费课程")]),n("img",{attrs:{src:t.imageURL}})]),n("div",{staticClass:"text-area"},[n("div",{staticClass:"title",domProps:{textContent:t._s(t.title)}}),n("div",{staticClass:"content",class:{"is-update":t.isUpdate},domProps:{textContent:t._s(t.content)}}),t.subtitle?n("div",{staticClass:"subtitle",class:{"is-update":t.isUpdate},domProps:{textContent:t._s(t.subtitle)}}):t._e()])])])],1)}),[],!1,null,"217e4707",null).exports),Dt=(n(22),n(23),n(63),n(16),n(18),n(20),n(0));function Rt(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Bt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==n.return||n.return()}finally{if(s)throw a}}}}function Bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Nt={props:{text:{type:String,default:""},clipText:{type:String,default:""},pureText:{type:String,default:""},type:{type:Number,default:1},isDetail:null,maxLines:{type:Number,default:4},lineHeight:{type:Number,default:22},clickLogHandler:{type:Function,default:function(){}},url:{type:String,default:function(){return""}},isRepost:{type:Boolean,default:!1}},data:function(){return{isMounted:!1,needClip:!1,isExpanded:!0}},computed:{needShowMoreLines:function(){return this.type===Dt.a.REPOST||this.type===Dt.a.PIC||this.type===Dt.a.WORD},pureTextLength:function(){return Object(f.g)(this.pureText)}},watch:{text:function(){this.nextTickAttachAtHrefs()}},mounted:function(){var t=this;this.isMounted=!0,setTimeout((function(){t.calcClip()}),0),this.nextTickAttachAtHrefs()},methods:{nextTickAttachAtHrefs:function(){var t=this;g.c.getIsNeedCardPopup()&&this.$nextTick((function(){t.attachAtHrefs(t.$refs.full)}))},attachAtHrefs:function(t){if(t)for(var e=t.children,n=0;n<e.length;n++){var i=e[n];if("A"===i.nodeName){var o=i.href.match(/\/\/space\.bilibili\.com\/(\d+)/);if(o){var a=+o[1];a&&Object(h.a)(a,this.$refs.foldingText,i)}}}},mouseenter:function(t){this.$emit("mouseenter",t)},mouseleave:function(t){this.$emit("mouseleave",t)},click:function(t){var e=t.srcElement||t.originalTarget||t.target;t.target&&"A"===t.target.nodeName||e.getAttribute("click-href")?this.clickLogHandler():(this.url&&window.open(this.url),this.$emit("click",t))},calcClip:function(){if(!this.isDetail&&this.$refs.full){this.pureText.match(/[\n↵]/g);var t,e=0,n=Rt(this.pureText.split(/[\n↵]/g));try{for(n.s();!(t=n.n()).done;){var i=t.value;e+=Math.ceil(Object(f.g)(i)/35)}}catch(t){n.e(t)}finally{n.f()}e>6&&(this.needClip=!0,this.isExpanded=!1,this.nextTickAttachAtHrefs())}},triggerExpand:function(){this.isExpanded=!this.isExpanded},stopPropagation:function(t){t.preventDefault(),t.stopPropagation()}}},Ut=(n(418),Object(E.a)(Nt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"foldingText",staticClass:"text p-rel"},[n("div",{staticClass:"content",on:{mouseenter:t.mouseenter,mouseleave:t.mouseleave,click:t.click}},[t.isMounted&&t.needClip?n("div",{ref:"clip",staticClass:"content-ellipsis",class:{hidden:t.isExpanded},domProps:{innerHTML:t._s(t.clipText)}}):t._e(),n("div",{ref:"full",staticClass:"content-full",class:{hidden:!t.isExpanded},domProps:{innerHTML:t._s(t.text)}})]),t.needClip?n("div",{staticClass:"btns"},[n("div",{staticClass:"expand-btn",on:{click:function(e){return e.stopPropagation(),t.triggerExpand(e)}}},[t._v(t._s(t.isExpanded?"收起":"展开"))])]):t._e()])}),[],!1,null,"b3414e94",null).exports),Ht={props:["show","url","title"],data:function(){return{iframeShow:!1}},computed:{},watch:{show:function(){this.updateShowStatus()}},components:{},beforeCreate:function(){},created:function(){this.updateShowStatus()},beforeMount:function(){},mounted:function(){this.updateShowStatus()},beforeDestroy:function(){},destroyed:function(){},methods:{onClose:function(){this.$emit("close")},updateShowStatus:function(){var t=this;this.show?this.iframeShow=!0:setTimeout((function(){t.iframeShow=!1}),500)}}},$t=(n(419),Object(E.a)(Ht,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"backdrop",on:{click:t.onClose}},[n("transition",{attrs:{name:"slide"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"extension-wrapper",on:{click:function(t){t.stopPropagation()}}},[n("div",{staticClass:"title-box"},[n("div",{staticClass:"title-text"},[t._v(t._s(t.title))]),n("div",{staticClass:"close-button bp-icon-font icon-group-dynamic close-btn",on:{click:t.onClose}})]),t.iframeShow?n("iframe",{attrs:{src:t.url,frameborder:"0"}}):t._e()])])],1)])}),[],!1,null,"21fef14f",null).exports),zt={props:["content"],data:function(){return{}},computed:{},watch:{},components:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{}},Vt=(n(420),Object(E.a)(zt,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"risk-tip"},[e("span",{staticClass:"tip-icon"}),e("span",{staticClass:"risk-tip-content"},[this._v("\n    "+this._s(this.content)+"\n  ")])])}),[],!1,null,"3773de5c",null).exports),Ft=n(162),Wt={props:["uid","dynamicId","likeInfo"],data:function(){return{}},computed:{likeUsersList:function(){return this.likeInfo&&this.likeInfo.like_users||[]},displayText:function(){return this.likeInfo&&this.likeInfo.like_display_text||"赞了"}},watch:{},components:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{}},Gt=(n(421),Object(E.a)(Wt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.likeUsersList.length,expression:"likeUsersList.length"}],staticClass:"like-users-panel"},[n("i",{staticClass:"like-icon"}),n("div",{staticClass:"users-box"},[t._l(t.likeUsersList,(function(e,i){return[n("a",{key:e.uid,staticClass:"like-users-list",attrs:{href:"//space.bilibili.com/"+e.uid,title:e.uname,target:"_blank"}},[t._v(t._s(e.uname))]),i+1!==t.likeUsersList.length?[t._v("、")]:t._e()]}))],2),n("span",{staticClass:"suffix-text"},[t._v("赞了")])])}),[],!1,null,"9f189eb0",null).exports),Jt=(n(51),{playingVideo:null,autoplayWaitingStack:[]}),Kt=function(t){if(Jt.autoplayWaitingStack.some((function(e){return e.videoId===t.videoId}))||Jt.autoplayWaitingStack.push({videoId:t.videoId,player:t.player}),Jt.autoplayWaitingStack.length>0){var e=Jt.autoplayWaitingStack.pop();null!==Jt.playingVideo&&Jt.playingVideo.videoId===e.videoId||e.player.play()}},Yt=function(t){Jt.autoplayWaitingStack=Jt.autoplayWaitingStack.filter((function(e){return e.videoId!==t}))},qt=function(t){null!==Jt.playingVideo&&Jt.playingVideo.player.pause(),Jt.playingVideo=t,Jt.autoplayWaitingStack.filter((function(e){return e.videoId!==t.videoId}))},Zt=function(){if(Jt.playingVideo=null,Jt.autoplayWaitingStack.length>0){var t=Jt.autoplayWaitingStack.pop();null!==Jt.playingVideo&&Jt.playingVideo.videoId===t.videoId||t.player.play()}},Qt=function(){return Jt.playingVideo},Xt=n(47);function te(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function ee(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){te(a,i,o,r,s,"next",t)}function s(t){te(a,i,o,r,s,"throw",t)}r(void 0)}))}}var ne={props:{cardInfo:{type:Object,required:!0},cardData:{type:Object,required:!0},isFake:{type:Boolean,default:!1},isDetail:{type:Boolean,default:!1},currentType:{type:Number,default:0},myUid:null,popupDom:null,isGuest:null,spmPageTypeString:String,regString:{type:String,default:""}},data:function(){return{card:Object(d.e)(this.cardInfo.card),originalCardInfo:{uid:0,name:"",face:"",url:"",type_desc:"",contentArray:""},originalCardInfoContent:"",clipOriginalCardInfoContent:"",repostContent:"",clipRepostContent:"",containerDOM:null,vcPlayer:null,inViewport:!1,vcError:!1,vcPlayed:!1,repostDescHovered:!1,originDescHovered:!1,hasFullScreen:!1,attentionList:f.r.getMyAttentionList(),TYPES:Dt.a,HOST:b.a,iframeInstance:null,iframeDom:null,justFocus:!1}},computed:{CardTypeIs:function(){return{Vote:this.originType===Dt.a.WORD&&this.originalCardInfo.voteInfo,Pic:this.originType===Dt.a.PIC,Video:this.originType===Dt.a.VIDEO&&!this.isLivePlayback,LivePlayBack:this.originType===Dt.a.VIDEO&&this.isLivePlayback,Collection:this.originType===Dt.a.COLLECTION,Article:this.originType===Dt.a.ARTICLE,Music:this.originType===Dt.a.MUSIC,Bangumi:[Dt.a.BANGUMI,Dt.a.FILM,Dt.a.TV,Dt.a.DOCUMENTARY].includes(this.originType),H5Share:this.originType===Dt.a.H5_SHARE&&this.isSupportBizType,ComicShare:this.originType===Dt.a.COMIC_SHARE&&this.isSupportBizType,Live:[Dt.a.LIVE_ROOM,Dt.a.LIVE,Dt.a.LIVE_PUSH].includes(this.originType)||this.originType===Dt.a.SUBSCRIPTION&&"live_room"===this.cardOrigin.type,Subscription:this.originType===Dt.a.SUBSCRIPTION&&"live_room"!==this.cardOrigin.type,MediaList:this.originType===Dt.a.MEDIA_LIST,Cheese:[Dt.a.CHEESE_SERIES,Dt.a.CHEESE_UPDATE].includes(this.originType)}},errorTips:function(){return this.card.item.tips},needRefresh:function(){var t=this.cardInfo.need_refresh;return!(!t||1!==t)},getPageSpmid:function(){try{return window.document.querySelector("[name=spm_prefix]").content}catch(t){return""}},isRepost:function(){return this.cardInfo.desc.type===Dt.a.REPOST},isShareTag:function(){return 0===this.cardInfo.desc.r_type},isBangumiLike:function(){return-1!==[Dt.a.FILM,Dt.a.TV,Dt.a.DOCUMENTARY,Dt.a.BANGUMI,Dt.a.COLLECTION].indexOf(this.originType)},showOriginUserFocusButton:function(){return!this.isBangumiLike},cardOrigin:function(){return this.isRepost?Object(d.e)(this.card.origin):this.card},originType:function(){return this.isRepost?this.cardInfo.desc.orig_type:this.cardInfo.desc.type},isLivePlayback:function(){var t,e,n,i,o;return(null===(t=this.cardInfo)||void 0===t||null===(e=t.desc)||void 0===e||null===(n=e.origin)||void 0===n?void 0:n.stype)?2===this.cardInfo.desc.origin.stype:!!(null===(i=this.cardInfo)||void 0===i||null===(o=i.desc)||void 0===o?void 0:o.stype)&&2===this.cardInfo.desc.stype},isSupportBizType:function(){return this.cardOrigin.sketch&&-1===[].indexOf(this.cardOrigin.sketch.biz_type)},isSupportCardType:function(){return this.originType===Dt.a.SUBSCRIPTION&&"live_room"!==this.card.type||(this.originType===Dt.a.H5_SHARE||this.originType===Dt.a.COMIC_SHARE?this.isSupportBizType:-1!==Object.values(Dt.a).indexOf(this.originType)&&this.originalCardInfo&&(this.originalCardInfoContent||this.originalCardInfo.face||this.originalCardInfo.name||this.originalCardInfo.uid||this.originalCardInfo.url))},userName:function(){return this.cardInfo.desc.user_profile.info.uname},dynamicDetailUrl:function(){return this.isDetail?"":"".concat(b.a.T,"/").concat(this.cardInfo.desc.dynamic_id,"?tab=2")},originDynamicDetailUrl:function(){return!this.isDetail||this.isRepost||this.originType!==this.TYPES.NONE&&this.originType!==this.TYPES.WORD&&this.originType!==this.TYPES.PIC&&this.originType!==this.TYPES.H5_SHARE&&this.isSupportCardType?this.originalCardInfo.url:""},avatarStyle:function(){return{"background-image":"url(".concat(Object(m.bfsImgLink)(Object(d.g)(this.originalCardInfo.face),24,24),")")}},isFocus:function(){return this.attentionList.indexOf(this.originalCardInfo.uid)>-1||this.justFocus},repostRiskContent:function(){return this.cardData.riskTip&&this.cardData.riskTip.content},originRiskContent:function(){return this.originalCardInfo.riskTip&&this.originalCardInfo.riskTip.content},isSelf:function(){return this.originalCardInfo.uid===this.myUid},hasShopCard:function(){return this.shopCardList.length>0},shopCardList:function(){return this.originalCardInfo.shopCards||[]},likeInfo:function(){return this.cardInfo.display&&this.cardInfo.display.like_info||{}},likeUsersPanelShow:function(){return this.likeInfo.like_users&&this.likeInfo.like_users.length>0}},components:{ImagesBox:H,CardArticle:Y,CardVideo:st,CardLive:gt,CardBangumi:bt,CardH5Share:_t,CardComicShare:wt,CardMusic:xt,CardVote:Ot,CardSubscription:Pt,CardMediaList:At,FoldingText:Ut,RiskTip:Vt,CardCheese:Mt,ShopPanel:Ft.a,LikeUsersPanel:Gt,CardLivePlayback:pt},created:function(){var t=this;this.getRepostContent(),this.originalCardInfo=Object(g.h)(this.cardInfo,this.isFake,this.regString),"server"===Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_ENV?this.originalCardInfoContent=Object(f.k)(this.originalCardInfo.contentArray,this.originalCardInfo.renderOpts):(Object(f.l)(this.originalCardInfo.contentArray,this.originalCardInfo.renderOpts).then((function(e){t.originalCardInfoContent=e})),Object(f.l)(this.originalCardInfo.clipContentArray,this.originalCardInfo.renderOpts).then((function(e){t.clipOriginalCardInfoContent=e})))},watch:{cardInfo:{handler:function(){this.originalCardInfo=Object(g.h)(this.cardInfo,this.isFake,this.regString)},deep:!0}},beforeDestroy:function(){Object(g.i)(window,"message",this.iframeChangeMessageHandler)},mounted:function(){this.containerDOM=this.findAncestor("card")||this.$el,this.originType===Dt.a.CLIP&&this.initVcPlayer(),g.c.getIsNeedCardPopup()&&(this.$refs.username&&Object(h.a)(this.originalCardInfo.uid,this.$refs.cardcontent,this.$refs.username),this.$refs.userhead&&Object(h.a)(this.originalCardInfo.uid,this.$refs.cardcontent,this.$refs.userhead)),f.b.$on(Dt.b.IFRAME_WRAPPER_CLICK,this.onWrapperClick),Object(g.a)(window,"message",this.iframeChangeMessageHandler,!1)},filters:{formatMinutes:function(t){var e=t%60;return e<10&&(e="0"+e),Math.floor(t/60).toString()+":"+e.toString()}},methods:{extendImageLogHandler:function(){Object(p.d)(Dt.d.CARD_BPM,Object.assign({like_show_area:this.likeUsersPanelShow?1:0},Object(g.f)(this.cardInfo)))},seeLaterLogHandler:function(t){t?Object(p.d)(Dt.d.CARD_WATCH_LATER_CANCEL,Object(g.f)(this.cardInfo)):Object(p.d)(Dt.d.CARD_WATCH_LATER,Object(g.f)(this.cardInfo))},originImageLogHandler:function(){Object(p.d)(Dt.d.CARD_ORIGINAL_PIC,Object(g.f)(this.cardInfo))},getRepostContent:function(){var t=this;if(this.card.item){var e=Object(f.o)(this.card.item.content,{ctrlJson:this.card.item.ctrl,extendCtrlJson:this.cardInfo.extend_json,dynamicId:this.cardInfo.desc.dynamic_id},this.regString),n=this.card.item.content;n=Object(Xt.a)(n,6);var i=Object(f.o)(n,{ctrlJson:this.card.item.ctrl,extendCtrlJson:this.cardInfo.extend_json},this.regString);"server"===Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_ENV?this.repostContent=Object(f.k)(e,{ctrlJson:this.card.item.ctrl,extendCtrlJson:this.cardInfo.extend_json,dynamicId:this.cardInfo.desc.dynamic_id,display:this.cardInfo.display}):(Object(f.l)(e,{ctrlJson:this.card.item.ctrl,extendCtrlJson:this.cardInfo.extend_json,dynamicId:this.cardInfo.desc.dynamic_id,display:this.cardInfo.display}).then((function(e){t.repostContent=e})),Object(f.l)(i,{ctrlJson:this.card.item.ctrl,extendCtrlJson:this.cardInfo.extend_json,dynamicId:this.cardInfo.desc.dynamic_id,display:this.cardInfo.display}).then((function(e){t.clipRepostContent=e})))}},findAncestor:function(t){for(var e=this.$el;e&&e.classList&&!e.classList.contains(t);)e=e.parentElement;return e},iframeChangeMessageHandler:function(t){var e=t.data;if(/^bp-dynamic-iframe-update:/.test(e)){var n=JSON.parse(e.replace(/^bp-dynamic-iframe-update:/,""));this.extensionIframeTitle=n.title}},initVcPlayer:function(){var t=this;if(this.$refs.vcCtnr)if(window.LinkPlayer)this.afterInitVcPlayer();else{u()("//s1.hdslb.com/bfs/static/player/live/link/player-1.4.5.min.js").then((function(){t.afterInitVcPlayer()}))}},afterInitVcPlayer:function(){var t=this,e=window.LinkPlayer;this.vcPlayer=new e(this.$refs.vcCtnr,{videoId:this.cardOrigin.item.id,playurl:Object(d.g)(this.cardOrigin.item.video_playurl)+"&rand="+Math.floor(1e7*Math.random()),backupUrl:this.cardOrigin.item.backup_playurl||[],initTime:this.cardOrigin.item.video_time,endingType:1,danmakuSize:.7,autoPlay:!1,onInitialized:function(){},beforePlaying:function(){Object(p.d)(Dt.d.CARD_VC_PLAY,Object(g.f)(t.cardInfo)),qt({videoId:t.cardOrigin.item.id,player:t.vcPlayer}),t.vcPlayed=!0},onPaused:function(){Zt()},onEnded:function(){Zt()},onError:function(){t.vcError=!0}}),this.vcPlayer.volume&&this.vcPlayer.volume(0),this.registerVcEvents()},playVc:function(){this.vcPlayer&&this.vcPlayer.play&&this.vcPlayer.play()},registerVcEvents:function(){var t=this;f.b.$on(Dt.b.SCROLL,(function(){t.handleScroll()})),this.handleScroll()},isInViewport:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.$refs.vcCtnr;if(!e)return!1;var n=e.getBoundingClientRect().top,i=e.offsetHeight,o=window.innerHeight;return n+i+t<=o&&n-t>0},handleScroll:function(){var t=this;if("SafariMobile"!==Object(d.d)())if(this.isInViewport()&&!this.inViewport)this.inViewport=!0,setTimeout((function(){t.inViewport&&Kt({videoId:t.cardOrigin.item.id,player:t.vcPlayer})}),800);else if(!this.isInViewport()&&this.inViewport){var e=Qt();this.inViewport=!1,null!==e&&e.videoId===this.cardOrigin.item.id&&setTimeout((function(){t.isFullscreen()||t.vcPlayer.pause()}),100),Yt(this.cardOrigin.item.id)}},isFullscreen:function(){return!!(document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement)},originDescMouseEnter:function(){this.originalCardInfo.url&&this.originDynamicDetailUrl&&(this.originDescHovered=!0)},originDescMouseLeave:function(){this.originDescHovered=!1},repostDescMouseEnter:function(){this.dynamicDetailUrl&&this.dynamicDetailUrl&&(this.repostDescHovered=!0)},repostDescMouseLeave:function(){this.repostDescHovered=!1},detailLogHandler:function(){this.dynamicDetailUrl&&Object(p.d)(Dt.d.CARD_CLICK,Object.assign({like_show_area:this.likeUsersPanelShow?1:0,card_type:Object(p.a)(Dt.a.REPOST).card_type,card_id:this.cardInfo.desc.dynamic_id,tag_type:g.c.getCurrentType()},this.isGuest?{nologin:1}:{}))},focusHandler:function(){var t=this;return ee(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.quickLogin)((function(){Object(p.d)(Dt.d.LOGIN_SUCCESS,{from:t.spmPageTypeString})}));case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:if(!t.isFocus){e.next=8;break}return t.bpPopup({title:"取消关注",content:"真的要取消对 ".concat(t.originalCardInfo.name," 的关注吗？"),button:{confirm:"取消关注",cancel:"点错了~"}}).onConfirm((function(e){t.bpapi({method:"post",url:"".concat(b.a.API_MAIN,"/x/relation/modify"),data:{act:2,fid:t.originalCardInfo.uid,spmid:t.getPageSpmid,re_src:0}}).then((function(){t.justFocus=!1,f.r.deleteFromMyAttentionList(t.originalCardInfo.uid),t.linkMsg(e.confirmBtn,"取消了对 ".concat(t.originalCardInfo.name," 的关注"),"success"),e.close()}),function(){var n=ee(c.a.mark((function n(i){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.linkMsg(t.$refs.follow,i.msg,i.type),e.close();case 2:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())})).onCancel((function(t){t.close()})),e.abrupt("return");case 8:t.bpapi({method:"post",url:"".concat(b.a.API_MAIN,"/x/relation/modify"),data:{act:1,fid:t.originalCardInfo.uid,spmid:t.getPageSpmid,re_src:0}}).then((function(){t.justFocus=!0,f.r.insertToMyAttentionList(t.originalCardInfo.uid),t.linkMsg(t.$refs.follow,"关注成功","success")}),function(){var e=ee(c.a.mark((function e(n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.linkMsg(t.$refs.follow,n.msg,n.type);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 9:case"end":return e.stop()}}),e)})))()},repostLogHandler:function(){Object(p.d)(Dt.d.CARD_ATCLICK,Object(g.f)(this.cardInfo))},originNameLogHandler:function(){Object(p.d)(Dt.d.CARD_SHARE_NICKNAME,this.originalCardInfo.name)},originCardLogHandler:function(){this.originalCardInfo.url&&(Object(p.d)(Dt.d.CARD_CLICK,Object.assign({like_show_area:this.likeUsersPanelShow?1:0},Object(g.f)(this.cardInfo),this.isGuest?{nologin:1}:{})),this.currentType===Dt.a.HOT&&this.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:6,uid:f.r.getUid(),dynamic_id:this.cardInfo.desc.dynamic_id}}))},onWrapperClick:function(t,e){if(!e||e===this.cardInfo.desc.dynamic_id){var n=t.srcElement||t.originalTarget||t.target,i=n.getAttribute("click-href"),o=n.getAttribute("click-title"),a=n.getAttribute("shop-item-id");if(a){var r=Object(g.f)(this.cardInfo,{item_id:a});Object(p.d)(Dt.d.ITEM_CLICK,r),t.stopPropagation()}else i&&o&&(t.preventDefault(),t.stopPropagation(),this.showIframe(i,o))}},onVoteCardClick:function(){this.showIframe(this.originalCardInfo.voteInfo.url,"投票")},initIframe:function(){var t=new o.a({template:'<extension-iframe :show="extensionIframeShown" :url="extensionIframeUrl" :title="extensionIframeTitle" @close="closeIframe"></extension-iframe>',components:{ExtensionIframe:$t},data:function(){return{extensionIframeUrl:"",extensionIframeShown:!1,extensionIframeTitle:""}},methods:{closeIframe:this.closeIframe}});this.iframeInstance=t},showIframe:function(t,e){this.initIframe();var n=this.popupDom||this.$refs.iframeDom,i=document.createElement("div");n.appendChild(i),this.iframeInstance.extensionIframeShown=!0,this.iframeInstance.extensionIframeUrl=t,this.iframeInstance.extensionIframeTitle=e,this.iframeDom=this.iframeInstance.$mount(i).$el,Object(p.d)(this.originalCardInfo.hasLottery?Dt.d.LOTTERY_RETWEET:this.originalCardInfo.voteInfo?Dt.d.POLLCLICK:void 0,Object(g.f)(this.cardInfo))},closeIframe:function(){var t=this;this.iframeInstance&&(this.iframeInstance.extensionIframeShown=!1,setTimeout((function(){t.iframeDom.parentNode.removeChild(t.iframeDom),t.iframeInstance.$destroy(),t.iframeInstance=null}),200))},gotoDetail:function(){var t=this.dynamicDetailUrl;this.needRefresh&&(this.isDetail?location.reload(!0):window.open(t))}}},ie=(n(422),Object(E.a)(ne,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"cardcontent",staticClass:"card-content",on:{click:t.onWrapperClick}},[t.isRepost&&t.repostRiskContent?i("risk-tip",{attrs:{content:t.repostRiskContent}}):t._e(),t.isRepost&&t.repostContent?i("folding-text",{staticClass:"description",class:{active:t.repostDescHovered},attrs:{text:t.repostContent,"clip-text":t.clipRepostContent,"pure-text":t.repostContent?t.card.item.content:"",type:t.TYPES.REPOST,"is-detail":t.isDetail,"click-log-handler":t.repostLogHandler,url:t.dynamicDetailUrl},on:{mouseenter:t.repostDescMouseEnter,mouseleave:t.repostDescMouseLeave,click:t.detailLogHandler}}):t._e(),i("div",{staticClass:"post-content",class:{repost:t.isRepost},attrs:{"data-ori-did":t.cardInfo.desc.orig_dy_id}},[t.originType===t.TYPES.NONE?i("div",{staticClass:"deleted"},[i("p",{staticClass:"tc-slate p-rel"},[i("i",{staticClass:"bp-icon-font icon-gantan-01 deleted-icon"}),i("span",{staticClass:"deleted-text",on:{click:t.gotoDetail}},[t._v(t._s(t.errorTips))])])]):t.isSupportCardType?i("div",{staticClass:"original-card-content"},[t.isRepost&&!t.showOriginUserFocusButton?i("div",{staticClass:"original-poster"},[i("a",{staticClass:"username d-i-block",attrs:{href:t.originalCardInfo.title_url,target:"_blank"},on:{click:t.originNameLogHandler}},[t._v(t._s(t.originalCardInfo.name))]),i("div",{staticClass:"original-poster-tip"},[t._v(t._s(t.originalCardInfo.type_desc))])]):t._e(),t.isRepost&&t.showOriginUserFocusButton?i("div",{staticClass:"up-info"},[i("a",{ref:"userhead",staticClass:"up-info-avatar",style:t.avatarStyle,attrs:{href:t.HOST.SPACE+"/"+t.originalCardInfo.uid+"/dynamic",target:"_blank"},on:{click:t.originNameLogHandler}}),i("a",{ref:"username",staticClass:"username d-i-block up-info-name",attrs:{href:t.HOST.SPACE+"/"+t.originalCardInfo.uid+"/dynamic",target:"_blank"},on:{click:t.originNameLogHandler}},[t._v(t._s(t.originalCardInfo.name))]),i("div",{staticClass:"up-info-tip"},[t._v(t._s(t.originalCardInfo.type_desc))]),t.isSelf||!t.justFocus&&t.isFocus?t._e():i("button",{ref:"follow",staticClass:"up-focus-btn",class:{"is-focus":t.isFocus},on:{click:t.focusHandler}},[t._v(t._s(t.isFocus?"已关注":"关注"))])]):t._e(),t.originRiskContent?i("risk-tip",{attrs:{content:t.originRiskContent}}):t._e(),t.originalCardInfoContent&&t.originalCardInfoContent?i("folding-text",{staticClass:"description",class:{active:t.originDescHovered},attrs:{text:t.originalCardInfoContent,"clip-text":t.clipOriginalCardInfoContent,"pure-text":t.originalCardInfo.pureText,type:t.originType,"is-detail":t.isDetail,"is-repost":t.isRepost,"click-log-handler":t.repostLogHandler,url:t.originDynamicDetailUrl},on:{mouseenter:t.originDescMouseEnter,mouseleave:t.originDescMouseLeave,click:t.originCardLogHandler}}):t._e(),t.CardTypeIs.Vote?i("card-vote",{attrs:{content:t.originalCardInfo.voteInfo.title,desc:t.originalCardInfo.voteInfo.desc},on:{click:t.onVoteCardClick}}):t._e(),[t.CardTypeIs.Pic?i("images-box",{attrs:{"extend-callback":t.extendImageLogHandler,"origin-callback":t.originImageLogHandler,images:t.originalCardInfo.images,parentDOM:t.containerDOM,"show-img-tag":!0,"dynamic-id":t.cardInfo.desc.dynamic_id,"spm-page-type-string":t.spmPageTypeString}}):t.CardTypeIs.Video?i("card-video",{attrs:{"see-later-callback":t.seeLaterLogHandler,"link-callback":t.originCardLogHandler,preview:!0,image:t.originalCardInfo.image,title:t.originalCardInfo.title,content:t.originalCardInfo.desc,aid:t.originalCardInfo.aid,duration:t.originalCardInfo.duration,view:t.originalCardInfo.view,danmaku:t.originalCardInfo.danmaku,link:t.originalCardInfo.url,"need-pay":t.originalCardInfo.needPay,"is-cooperation":t.originalCardInfo.isCooperation}}):t.CardTypeIs.Collection?i("card-video",{attrs:{"see-later-callback":t.seeLaterLogHandler,"link-callback":t.originCardLogHandler,preview:!0,tag:t.originalCardInfo.tag,image:t.originalCardInfo.cover,title:t.originalCardInfo.title,content:t.originalCardInfo.desc,aid:t.originalCardInfo.aid,duration:t.originalCardInfo.duration,view:t.originalCardInfo.play_count,danmaku:t.originalCardInfo.bullet_count,link:t.originalCardInfo.url,"need-pay":t.originalCardInfo.needPay,"is-cooperation":t.originalCardInfo.isCooperation}}):t.CardTypeIs.LivePlayBack?i("card-live-playback",{attrs:{"see-later-callback":t.seeLaterLogHandler,"link-callback":t.originCardLogHandler,preview:!0,image:t.originalCardInfo.image,title:t.originalCardInfo.title,content:t.originalCardInfo.desc,aid:t.originalCardInfo.aid,duration:t.originalCardInfo.duration,view:t.originalCardInfo.view,danmaku:t.originalCardInfo.danmaku,link:t.originalCardInfo.url,"need-pay":t.originalCardInfo.needPay,"is-cooperation":t.originalCardInfo.isCooperation}}):t.CardTypeIs.Clip?i("div",{staticClass:"p-rel vc-ctnr"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.vcPlayed,expression:"!vcPlayed"}],staticClass:"vc-cover",style:{backgroundImage:"url("+t.originalCardInfo.cover+")"},on:{click:t.playVc}},[i("span",{staticClass:"duration"},[t._v(t._s(t._f("formatMinutes")(t.originalCardInfo.duration)))]),i("div",{staticClass:"play-area"},[i("img",{staticClass:"play-btn",attrs:{src:n(395)}})])]),i("div",{ref:"vcCtnr",staticClass:"vc-video"})]):t.CardTypeIs.Article?i("card-article",{attrs:{"link-callback":t.originCardLogHandler,images:t.originalCardInfo.images,title:t.originalCardInfo.title,content:t.originalCardInfo.desc,link:t.originalCardInfo.url}}):t.CardTypeIs.Music?i("card-music",{attrs:{"link-callback":t.originCardLogHandler,link:t.originalCardInfo.url,image:t.originalCardInfo.cover,content:t.originalCardInfo.title,desc:t.originalCardInfo.desc}}):t.CardTypeIs.Bangumi?i("card-bangumi",{attrs:{"link-callback":t.originCardLogHandler,image:t.originalCardInfo.cover,title:t.originalCardInfo.title,content:t.originalCardInfo.desc,view:t.originalCardInfo.play_count,danmaku:t.originalCardInfo.bullet_count,link:t.originalCardInfo.url,tags:t.originalCardInfo.tags}}):t.CardTypeIs.H5Share?i("card-h5-share",{attrs:{link:t.originalCardInfo.target_url,image:t.originalCardInfo.cover,content:t.originalCardInfo.title,desc:t.originalCardInfo.desc,tag:t.originalCardInfo.tag}}):t.CardTypeIs.ComicShare?i("card-comic-share",{attrs:{link:t.originalCardInfo.target_url,cover:t.originalCardInfo.cover,title:t.originalCardInfo.title,content:t.originalCardInfo.tagsText,author:t.originalCardInfo.author,desc:t.originalCardInfo.desc,tags:t.originalCardInfo.tag}}):t.CardTypeIs.Live?i("card-live",{attrs:{link:t.originalCardInfo.url,"cover-url":t.originalCardInfo.cover,"show-view-num":t.originalCardInfo.show_view_num,"view-num":t.originalCardInfo.view_num,title:t.originalCardInfo.title,"area-name":t.originalCardInfo.area_name,status:t.originalCardInfo.status,"link-callback":t.originCardLogHandler}}):t.CardTypeIs.Subscription?i("card-subscription",{attrs:{data:t.card}}):t.CardTypeIs.MediaList?i("card-media-list",{attrs:{link:t.originalCardInfo.url,cover:t.originalCardInfo.cover,"cover-type":t.originalCardInfo.coverType,title:t.originalCardInfo.title,description:t.originalCardInfo.description,"content-count":t.originalCardInfo.contentCount,"link-callback":t.originCardLogHandler}}):t.CardTypeIs.Cheese?i("card-cheese",{attrs:{"link-callback":t.originCardLogHandler,image:t.originalCardInfo.image,title:t.originalCardInfo.title,subtitle:t.originalCardInfo.subtitle,content:t.originalCardInfo.desc,link:t.originalCardInfo.url,"is-update":t.originType===t.TYPES.CHEESE_UPDATE}}):t._e(),t.hasShopCard?i("shop-panel",{attrs:{"shop-card-list":t.shopCardList,"is-repost":t.isRepost,"card-info":t.cardInfo}}):t._e(),t.originalCardInfo.originAttachCard?i("shop-panel",{attrs:{"shop-card-list":t.originalCardInfo.originAttachCard,"is-repost":t.isRepost,"card-info":t.cardInfo}}):t._e()]],2):i("div",{staticClass:"not-support"},[t._m(0)])]),t.originalCardInfo.attachCard?i("shop-panel",{attrs:{"shop-card-list":t.originalCardInfo.attachCard,"is-repost":!1,"card-info":t.cardInfo}}):t._e(),t.likeUsersPanelShow?i("like-users-panel",{attrs:{uid:t.myUid,"dynamic-id":t.cardInfo.desc.dynamic_id,"like-info":t.likeInfo}}):t._e(),i("div",{ref:"iframeDom"})],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"tc-slate p-rel"},[e("i",{staticClass:"bp-icon-font icon-jinz-01 forbidden-icon"}),e("span",{staticClass:"forbidden-text"},[this._v("暂不支持此类动态显示")])])}],!1,null,"f6cd6c04",null).exports);n(82);var oe=n(62),ae=n(31),re=n(164);function se(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var ce={data:function(){return{loading:!1,boxText:"",wordLength:0,maxLength:233,isExceed:!1,sendDynId:"",emojiBoxShown:!1,isChildForward:!1,isMounted:!1,atItems:[],contentAtItems:[],loginInfo:f.r.getMyLoginInfo(),userInfo:f.r.getMyUserInfo(),pageType:g.c.getPageType()}},props:{textareaWidth:{type:Number,default:0},forwInfo:{type:Object,default:function(){return{content:"",atUsers:[]}}},cardInfo:{type:Object},feedCurrentType:{type:Number,default:0}},components:{EmojiBox:oe.a,AtPopup:re.a},methods:{getAreaHeight:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180,e=this.$refs.textarea,n=40,i=0;this.$nextTick((function(){e.style.cssText+="height: ".concat(n,"px;");var o=(i=e.scrollHeight>n?t>e.scrollHeight?e.scrollHeight:t:25)>=t?"auto":"hidden";e.style.cssText+="height: ".concat(i,"px; overflow: ").concat(o,";")}))},sendMsg:function(){var t=this;if(Object(p.d)(Dt.d.CARD_SHARE_2,Object(g.f)(this.cardInfo)),this.loginInfo.isLogin&&!this.isExceed&&!this.loading){var e=Object(ae.c)(this.boxText);0===e.length&&(e="转发动态");var n={uid:f.r.getUid(),dynamic_id:this.sendDynId,content:e,extension:JSON.stringify({emoji_type:1})},i=f.a.generateAtParams(e,this.contentAtItems,this.atItems),o=i.atUids,a=i.ctrl;n.at_uids=o,n.ctrl=a;var r={url:b.a.API_VC+"/dynamic_repost/v1/dynamic_repost/repost",method:"post",data:n};this.loading=!0,this.bpapi(r).then((function(n){if(t.loading=!1,0===n.data.result)t.atItems=[],t.contentAtItems=[],t.$nextTick((function(){f.b.$emit(Dt.b.INSERT_FORWARDING,{extend_json:JSON.stringify({from:{emoji_type:1}}),desc:{timestamp:Math.floor((new Date).getTime()/1e3),uid:f.r.getUid(),user_profile:{info:{uname:t.userInfo.card.name,face:t.userInfo.card.face}},dynamic_id:n.data.dynamic_id},card:JSON.stringify({item:{content:e}})},t.cardInfo.desc.dynamic_id,t.isChildForward)})),setTimeout((function(){t.linkMsg(t.$refs.submitbtn,"发送成功","success")}),500),t.boxText="",t.feedCurrentType===Dt.a.HOT&&t.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:3,uid:f.r.getUid(),dynamic_id:t.cardInfo.desc.dynamic_id}}),f.b.$emit(Dt.b.SET_TOP,t.cardInfo.desc.dynamic_id);else{if(2===n.data.result)return Object(m.showVerifyPopup)(t);t.linkMsg(t.$refs.submitbtn,n.data.errmsg,"caution")}}),(function(e){t.loading=!1,t.linkMsg(t.$refs.submitbtn,e.msg,e.type)}))}},quickLogin:function(){return(t=c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.quickLogin)();case 2:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){se(a,i,o,r,s,"next",t)}function s(t){se(a,i,o,r,s,"throw",t)}r(void 0)}))})();var t},textareaMove:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(e=e||0,n=n||0,t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveStart("character",e),i.moveEnd("character",n),i.select()}else{var o=0===n?e:n;t.setSelectionRange(e,o),t.focus()}},forwardHandler:function(t,e){var n=this;if(e===this.cardInfo.desc.dynamic_id){this.isChildForward=t.isChildForward,this.boxText=t.comment,this.sendDynId=t.dynId,this.contentAtItems=t.atUsers;var i=this.$refs.textarea;if(!i)return;this.$nextTick((function(){n.textareaMove(i,0,0)}))}},validate:function(){return!this.emojiBoxShown},selectHandler:function(t){var e=this.boxText,n=this.$refs.textarea.selectionEnd,i=e.substring(0,n),o=e.substring(n),a=i.lastIndexOf("@");i=i.substring(0,a+1),this.boxText="".concat(i).concat(t.uname," ").concat(o),this.atItems.push(t)},logHandler:function(){Object(p.d)(Dt.d.PUBLISH_AT_LIST_SHOW,Object(g.f)(this.cardInfo))}},watch:{boxText:function(){this.getAreaHeight(),this.wordLength=this.boxText.length,this.isExceed=this.wordLength>this.maxLength,0===this.wordLength&&(this.sendDynId=this.cardInfo.desc.dynamic_id,this.isChildForward=!1)}},mounted:function(){var t=this;this.isMounted=!0;var e=this.$refs.textarea;this.loginInfo.isLogin&&""===this.boxText&&this.cardInfo.desc.type===Dt.a.REPOST&&(this.boxText=this.forwInfo.content,this.contentAtItems=this.forwInfo.atUsers,this.$nextTick((function(){t.textareaMove(e,0,0)}))),this.$nextTick((function(){e&&t.loginInfo.isLogin&&e.focus()})),this.sendDynId=this.cardInfo.desc.dynamic_id,this.getAreaHeight(),f.b.$on(Dt.b.FORWARD_DYNAMIC,this.forwardHandler)}},le=(n(423),Object(E.a)(ce,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"f-left textarea-container"},[t.loginInfo.isLogin?t._e():n("div",{staticClass:"comm-nologin",style:{width:t.textareaWidth+"px"}},[t._v("请先"),n("a",{staticClass:"loginBtn",on:{click:t.quickLogin}},[t._v("登录")]),t._v("后转发 (・ω・)")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.boxText,expression:"boxText"}],ref:"textarea",staticClass:"textarea",style:{width:t.textareaWidth+"px"},attrs:{spellcheck:"false",placeholder:"请自觉遵守互联网相关的政策法规，严禁发布色情、暴力、反动的言论。"},domProps:{value:t.boxText},on:{input:function(e){e.target.composing||(t.boxText=e.target.value)}}}),t.isMounted?n("at-popup",{attrs:{"input-elm":t.$refs.textarea,"select-handler":t.selectHandler,validate:t.validate,"log-handler":t.logHandler}}):t._e(),n("div",{staticClass:"comm-tool f-clear"},[n("div",{ref:"emojiTrigger",staticClass:"comm-emoji f-left",class:{exceed:t.isExceed||!t.loginInfo.isLogin},on:{click:function(e){t.emojiBoxShown=t.loginInfo.isLogin&&!0}}},[n("i",{staticClass:"dynamic-comm-icon icon-face"}),n("span",{staticClass:"comm-text"},[t._v("表情")]),t.emojiBoxShown?n("emoji-box",{staticClass:"bp-emoji-box",attrs:{field:t.$refs.textarea,"frozen-elements":[t.$refs.textarea,t.$refs.emojiTrigger],"emoji-type":["kaomojis","dynamicEmojis"],"spm-type":t.pageType},on:{close:function(e){t.emojiBoxShown=!1}}}):t._e()],1),n("div",{ref:"submitbtn",staticClass:"comm-submit f-right",class:{exceed:t.isExceed||!t.loginInfo.isLogin},on:{click:t.sendMsg}},[t._v("转发")]),n("div",{staticClass:"comm-word f-right"},[n("span",{class:{exceed:t.isExceed}},[t._v(t._s(t.wordLength))]),n("span",[t._v("/"+t._s(t.maxLength))])])])],1)}),[],!1,null,"61311d32",null).exports),ue=(n(489),n(61),n(163));function de(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var fe={data:function(){return{loading:!1,boxText:"",wordLength:0,maxLength:233,isExceed:!1,sendDynId:"",emojiBoxShown:!1,isChildForward:!1,atItems:[],contentAtItems:[],loginInfo:f.r.getMyLoginInfo(),userInfo:f.r.getMyUserInfo(),pageType:g.c.getPageType()}},props:{textareaWidth:{type:Number,default:0},forwInfo:{type:Object,default:function(){return{content:"",atUsers:[]}}},cardInfo:{type:Object},feedCurrentType:{type:Number,default:0}},components:{EmojiBox:oe.a,AtPopup:ue.a},methods:{getAreaHeight:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180,e=this.$refs.textarea,n=40,i=0;this.$nextTick((function(){e.style.cssText+="height: ".concat(n,"px;");var o=(i=e.scrollHeight>n?t>e.scrollHeight?e.scrollHeight:t:25)>=t?"auto":"hidden";e.style.cssText+="height: ".concat(i,"px; overflow: ").concat(o,";")}))},sendMsg:function(){var t=this;if(Object(p.d)(Dt.d.CARD_SHARE_2,Object(g.f)(this.cardInfo)),this.loginInfo.isLogin&&!this.isExceed&&!this.loading){var e=Object(ae.c)(this.boxText);0===e.length&&(e="转发动态");var n={uid:f.r.getUid(),dynamic_id:this.sendDynId,content:e,extension:JSON.stringify({emoji_type:1})},i=f.a.generateAtParams(e,this.contentAtItems,this.atItems),o=i.atUids,a=i.ctrl;n.at_uids=o,n.ctrl=a;var r={url:b.a.API_VC+"/dynamic_repost/v1/dynamic_repost/repost",method:"post",data:n};this.loading=!0,this.bpapi(r).then((function(n){if(t.loading=!1,0===n.data.result)t.atItems=[],t.contentAtItems=[],t.$nextTick((function(){f.b.$emit(Dt.b.INSERT_FORWARDING,{extend_json:JSON.stringify({from:{emoji_type:1}}),desc:{timestamp:Math.floor((new Date).getTime()/1e3),uid:f.r.getUid(),user_profile:{info:{uname:t.userInfo.card.name,face:t.userInfo.card.face}},dynamic_id:n.data.dynamic_id},card:JSON.stringify({item:{content:e}})},t.cardInfo.desc.dynamic_id,t.isChildForward)})),setTimeout((function(){t.linkMsg(t.$refs.submitbtn,"发送成功","success")}),500),t.boxText="",t.feedCurrentType===Dt.a.HOT&&t.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:3,uid:f.r.getUid(),dynamic_id:t.cardInfo.desc.dynamic_id}}),f.b.$emit(Dt.b.SET_TOP,t.cardInfo.desc.dynamic_id);else{if(2===n.data.result)return Object(m.showVerifyPopup)(t);t.linkMsg(t.$refs.submitbtn,n.data.errmsg,"caution")}}),(function(e){t.loading=!1,t.linkMsg(t.$refs.submitbtn,e.msg,e.type)}))}},quickLogin:function(){return(t=c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.quickLogin)();case 2:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){de(a,i,o,r,s,"next",t)}function s(t){de(a,i,o,r,s,"throw",t)}r(void 0)}))})();var t},textareaMove:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(e=e||0,n=n||0,t.createTextRange){var i=t.createTextRange();i.collapse(!0),i.moveStart("character",e),i.moveEnd("character",n),i.select()}else{var o=0===n?e:n;t.setSelectionRange(e,o),t.focus()}},forwardHandler:function(t,e){var n=this;if(e===this.cardInfo.desc.dynamic_id){this.isChildForward=t.isChildForward,this.boxText=t.comment,this.sendDynId=t.dynId,this.contentAtItems=t.atUsers;var i=this.$refs.textarea;if(!i)return;this.$nextTick((function(){n.textareaMove(i,0,0)}))}},validate:function(){return!this.emojiBoxShown},selectHandler:function(t){var e=this.boxText,n=this.$refs.textarea.selectionEnd,i=e.substring(0,n),o=e.substring(n),a=i.lastIndexOf("@"),r=i.substring(a+1,n);i=i.substring(0,a+1),this.boxText="".concat(i).concat(t.uname," ").concat(o);var s=this.atItems.findIndex((function(t){return t.uname===r}));s>-1&&this.atItems.splice(s,1),20!==this.atItems.length?this.atItems.push(t):this.linkMsg(this.$refs.textarea,"最多支持@ 20位用户","caution")},logHandler:function(){Object(p.d)(Dt.d.PUBLISH_AT_LIST_SHOW,Object(g.f)(this.cardInfo))},handleKeydown:function(t){var e=this;if(8===t.keyCode){var n=this.boxText,i=this.$refs.textarea.selectionEnd,o=n.substring(0,i),a=n.substring(i),r=o.lastIndexOf("@");if(-1===r)return;var s=o.substring(r+1,i);if(/\s/.test(s[s.length-1])||/\s/.test(s))return;var c=this.atItems.findIndex((function(t){return t.uname===s}));if(-1===c)return;o=o.substring(0,r),this.boxText="".concat(o).concat(a),t.preventDefault(),this.atItems.splice(c,1),this.$nextTick((function(){e.$refs.atPopup.forceHide()}))}},checkAtItems:function(t){if(""!==t){for(var e=[],n=0;n<t.length;n++)if("@"===t[n]){var i="";t:for(var o=n+1;o<t.length&&t[o];o++){if(/\s/.test(t[o])){e.push(i),n=o;break t}i+=t[o]}}}else this.atItems=[]},requestAt:function(t,e){var n=this;return new Promise((function(i,o){var a={uid:f.r.getUid()};e&&(a.keyword=e),n.bpapi({url:t,method:"get",data:a}).then(i).catch(o)}))}},watch:{boxText:function(t){this.getAreaHeight(),this.wordLength=this.boxText.length,this.isExceed=this.wordLength>this.maxLength,0===this.wordLength&&(this.sendDynId=this.cardInfo.desc.dynamic_id,this.isChildForward=!1),this.checkAtItems(t)}},mounted:function(){var t=this,e=this.$refs.textarea;this.loginInfo.isLogin&&""===this.boxText&&this.cardInfo.desc.type===Dt.a.REPOST&&(this.boxText=this.forwInfo.content,this.contentAtItems=this.forwInfo.atUsers,this.$nextTick((function(){t.textareaMove(e,0,0)}))),this.$nextTick((function(){e&&t.loginInfo.isLogin&&e.focus()})),this.sendDynId=this.cardInfo.desc.dynamic_id,this.getAreaHeight(),e.addEventListener("keydown",this.handleKeydown),f.b.$on(Dt.b.FORWARD_DYNAMIC,this.forwardHandler)},destroyed:function(){this.$refs.textarea.removeEventListener("keydown",this.handleKeydown)}},he=(n(426),Object(E.a)(fe,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"f-left textarea-container"},[t.loginInfo.isLogin?t._e():n("div",{staticClass:"comm-nologin",style:{width:t.textareaWidth+"px"}},[t._v("请先"),n("a",{staticClass:"loginBtn",on:{click:t.quickLogin}},[t._v("登录")]),t._v("后转发 (・ω・)")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.boxText,expression:"boxText"}],ref:"textarea",staticClass:"textarea",style:{width:t.textareaWidth+"px"},attrs:{spellcheck:"false",placeholder:"请自觉遵守互联网相关的政策法规，严禁发布色情、暴力、反动的言论。"},domProps:{value:t.boxText},on:{input:function(e){e.target.composing||(t.boxText=e.target.value)}}}),n("at-popup",{ref:"atPopup",attrs:{"input-el":t.$refs.textarea,"before-show":t.validate,request:t.requestAt},on:{select:function(e){var n=e.item,i=e.matchString;return t.selectHandler(n,i)},active:t.logHandler}}),n("div",{staticClass:"comm-tool f-clear"},[n("div",{ref:"emojiTrigger",staticClass:"comm-emoji f-left",class:{exceed:t.isExceed||!t.loginInfo.isLogin},on:{click:function(e){t.emojiBoxShown=t.loginInfo.isLogin&&!0}}},[n("i",{staticClass:"dynamic-comm-icon icon-face"}),n("span",{staticClass:"comm-text"},[t._v("表情")]),t.emojiBoxShown?n("emoji-box",{staticClass:"bp-emoji-box",attrs:{field:t.$refs.textarea,"frozen-elements":[t.$refs.textarea,t.$refs.emojiTrigger],"emoji-type":["kaomojis","dynamicEmojis"],"spm-type":t.pageType},on:{close:function(e){t.emojiBoxShown=!1}}}):t._e()],1),n("div",{ref:"submitbtn",staticClass:"comm-submit f-right",class:{exceed:t.isExceed||!t.loginInfo.isLogin},on:{click:t.sendMsg}},[t._v("转发")]),n("div",{staticClass:"comm-word f-right"},[n("span",{class:{exceed:t.isExceed}},[t._v(t._s(t.wordLength))]),n("span",[t._v("/"+t._s(t.maxLength))])])])],1)}),[],!1,null,"ef7573de",null).exports),pe={data:function(){return{text:""}},props:{forwData:{type:Object,default:function(){return{}}},cardInfo:{type:Object},clickLogHandler:{type:Function,default:function(){}}},methods:{getUserInfoUrl:function(){return"".concat(b.a.SPACE,"/").concat(this.uid,"/dynamic")},onUserInfoClick:function(t){var e="head"===t?Dt.d.CARD_HEAD:Dt.d.CARD_NICKNAME,n=Object.assign(Object(g.f)(this.cardInfo),{jumpfrom:3});Object(p.d)(e,n)},toBfsImg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"//static.hdslb.com/images/member/noface.gif",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return Object(d.g)(Object(m.bfsImgLink)(t,e,n))},forwardChildDynamic:function(){if(!f.r.getMyLoginInfo().isLogin)return Object(m.quickLogin)(),this.linkMsg(this.$refs.submitbtn,"请先登陆","info");var t={uid:this.uid,uname:this.uname},e=this.getAtUserList(this.comment,this.ctrl,t);f.b.$emit(Dt.b.FORWARD_DYNAMIC,{dynId:"".concat(this.dynamicId),comment:"//@".concat(this.uname,":").concat(this.comment),isChildForward:!0,atUsers:e},this.cardInfo.desc.dynamic_id)},getAtUserList:function(t,e,n){var i=[n];if(!e||""===e)return i;var o=Object(d.e)(e);return Array.isArray(o)||(o=[]),o.forEach((function(e){var n={uid:~~e.data,uname:t.substr(e.location+1,e.length-1)};0===i.filter((function(t){return t.uid===n.uid})).length&&i.push(n)})),i},click:function(t){t.target&&"A"===t.target.nodeName&&this.clickLogHandler()},initText:function(){var t=this,e=Object(d.e)(this.cardInfo.extend_json),n=Object(d.e)((this.forwData||{}).extend_json),i={vote:e.vote,lott:e.lott,from:n.from},o=JSON.stringify(i),a=Object(f.o)(this.comment,{ctrlJson:this.ctrl,extendCtrlJson:o,dynamicId:this.dynamicId});Object(f.l)(a,{ctrlJson:this.ctrl,extendCtrlJson:o,dynamicId:this.dynamicId}).then((function(e){t.text=e,g.c.getIsNeedCardPopup()&&t.$nextTick((function(){t.attachAtHrefs()}))}))},attachAtHrefs:function(){for(var t=this.$refs.text.children,e=0;e<t.length;e++){var n=t[e];if("A"===n.nodeName){var i=n.href.match(/\/\/space\.bilibili\.com\/(\d+)/);if(i){var o=+i[1];o&&Object(h.a)(o,this.$refs.wrap,n)}}}}},computed:{getPublishTime:function(){return Object(g.d)(this.forwData.desc.timestamp)},uid:function(){return this.forwData.desc.uid},uname:function(){return this.forwData.desc.user_profile.info.uname},ctrl:function(){return this.forwData.extend_json&&JSON.stringify(JSON.parse(this.forwData.extend_json).ctrl)||""},face:function(){return this.forwData.desc.user_profile.info.face},dynamicId:function(){return this.forwData.desc.dynamic_id},comment:function(){try{return JSON.parse(this.forwData.card).item.content||""}catch(t){return""}}},mounted:function(){this.initText(),g.c.getIsNeedCardPopup()&&(Object(h.a)(this.uid,this.$refs.wrap,this.$refs.userhead),Object(h.a)(this.uid,this.$refs.wrap,this.$refs.username))}},me=(n(427),Object(E.a)(pe,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"wrap",staticClass:"dynamic-list-item-wrap f-clear"},[n("div",{staticClass:"f-left"},[n("div",{ref:"userhead",staticClass:"forw-face"},[n("a",{staticClass:"c-pointer",attrs:{href:t.getUserInfoUrl("head"),target:"_blank"},on:{click:function(e){return t.onUserInfoClick("head")}}},[n("img",{staticClass:"forw-head",attrs:{src:t.toBfsImg(t.face,32,32)}})])])]),n("div",{staticClass:"item-detail f-left"},[n("div",{staticClass:"item-user"},[n("a",{ref:"username",staticClass:"user-name c-pointer",attrs:{href:t.getUserInfoUrl("name"),target:"_blank"},on:{click:function(e){return t.onUserInfoClick("name")}}},[t._v(t._s(t.uname))])]),n("div",{ref:"text",staticClass:"text",domProps:{innerHTML:t._s(t.text)},on:{click:t.click}}),n("div",{staticClass:"info"},[n("span",{staticClass:"time"},[t._v(t._s(t.getPublishTime))]),t.dynamicId?n("a",{ref:"submitbtn",staticClass:"forw-submit f-right",on:{click:t.forwardChildDynamic}},[t._v("转发")]):t._e()])])])}),[],!1,null,"78a08664",null).exports),ge={},ve=(n(428),Object(E.a)(ge,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"comm-loading"},[e("span",{staticClass:"loading-icon"}),e("span",[this._v("加载中……")])])}],!1,null,"740f9d96",null).exports),be=(n(429),{props:{pageType:{type:String,required:!0},cardInfo:{type:Object,default:function(){}},feedCurrentType:{type:Number,default:0},cardData:{type:Object,default:function(){}}},data:function(){return{isLoading:!1,isLoaded:!1,isLoadingMore:!1,offset:0,firstCount:5,forwInfo:{content:"",atUsers:[]},list:[],hasMore:!0,loginInfo:f.r.getMyLoginInfo(),userInfo:f.r.getMyUserInfo(),fallbackOldVersion:!1}},components:{forwSendBoxNew:he,forwSendBox:le,loading:ve,forwListItem:me},methods:{toBfsImg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"//static.hdslb.com/images/member/noface.gif",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return Object(d.g)(Object(m.bfsImgLink)(t,e,n))},getForwardingList:function(){var t=this;if(this.hasMore&&!this.isLoading&&!this.isLoadingMore){this.isLoading=!0;var e={url:b.a.API_VC+"/dynamic_repost/v1/dynamic_repost/repost_detail",method:"get",data:{dynamic_id:this.cardInfo.desc.dynamic_id_str,offset:this.offset||void 0}};this.bpapi(e).then((function(e){var n=e.data;n.items&&0!==n.total||(n.items=[]),0===t.offset&&(t.isDetailPage||(n.items.length>t.firstCount&&(n.has_more=!0),n.items=n.items.slice(0,t.firstCount))),t.offset=n.offset,t.list=t.list.concat(n.items),t.hasMore=n.has_more,t.isLoading=!1,t.isLoaded=!0,t.isLoadingMore=!1}),(function(e){t.linkMsg(t.$refs.foraArea,e.msg,e.type),t.isLoading=!1,t.isLoaded=!0,t.isLoadingMore=!1}))}},loadMore:function(){if(this.hasMore&&!this.isLoading&&!this.isLoadingMore&&this.isLoaded){if(Object(p.d)(Dt.d.CARD_SHARE_3,Object(g.f)(this.cardInfo)),!this.isDetailPage)return window.open(this.cardData.more_forw_url);this.getForwardingList()}},getAtUserList:function(t,e,n){var i=[n];if(!e||""===e)return i;var o=Object(d.e)(e);return Array.isArray(o)||(o=[]),o.forEach((function(e){var n={uid:~~e.data,uname:t.substr(e.location+1,e.length-1)};0===i.filter((function(t){return t.uid===n.uid})).length&&i.push(n)})),i},clickLogHandler:function(){Object(p.d)(Dt.d.CARD_RT_ATCLICK,Object(g.f)(this.cardInfo))}},computed:{isDetailPage:function(){return this.pageType===Dt.c.DETAIL},isTagPage:function(){return this.pageType===Dt.c.TAG}},beforeMount:function(){var t=Object(d.d)(),e=-1!==t.indexOf("IE"),n=-1!==t.indexOf("TheWorld");this.fallbackOldVersion=e||n},mounted:function(){var t=this;if(this.cardInfo.desc.type===Dt.a.REPOST){var e=Object(d.e)(this.cardInfo.card);if(e){var n=e.item.content,i={uid:this.cardInfo.desc.user_profile.info.uid,uname:this.cardInfo.desc.user_profile.info.uname};this.forwInfo.atUsers=f.a.generateAtUsers(n,e.item.ctrl,i),this.forwInfo.content="//@".concat(this.cardInfo.desc.user_profile.info.uname,":").concat(n)}}this.getForwardingList(this.offset),f.b.$on(Dt.b.INSERT_FORWARDING,(function(e,n,i){t.cardInfo.desc.dynamic_id!==n||Dt.a.REPOST===t.cardInfo.desc.type&&!0===i||(t.list.unshift(e),g.b.repostAdd(t.cardInfo),f.b.$emit(Dt.b.STORAGE_UPDATE,t.cardInfo))})),f.b.$on(Dt.b.FORWARDING_SCROLL,(function(){t.$refs.loadMore&&t.isDetailPage&&function(t){if("undefined"==typeof window)return!1;var e=t.getBoundingClientRect().top;return e+t.offsetHeight<=window.innerHeight&&e>0}(t.$refs.loadMore)&&t.loadMore()}))},beforeDestroy:function(){f.b.$off(Dt.b.INSERT_FORWARDING),f.b.$off(Dt.b.FORWARDING_SCROLL)}}),ye=(n(430),Object(E.a)(be,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"foraArea",staticClass:"forw-area"},[t.isLoading?n("div",{staticClass:"forw-loading-box"},[n("loading")],1):t._e(),t.isLoaded?n("div",{staticClass:"forw-main"},[n("div",{staticClass:"forw-send f-clear"},[n("div",{staticClass:"f-left"},[n("div",{staticClass:"forw-face"},[n("img",{staticClass:"forw-head",attrs:{src:t.toBfsImg(t.userInfo.card.face,32,32)}})])]),t.fallbackOldVersion?n("forw-send-box",{attrs:{"textarea-width":470,"forw-info":t.forwInfo,"card-info":t.cardInfo,"feed-current-type":t.feedCurrentType}}):n("forw-send-box-new",{attrs:{"textarea-width":470,"forw-info":t.forwInfo,"card-info":t.cardInfo,"feed-current-type":t.feedCurrentType}})],1),n("div",{staticClass:"forw-list"},t._l(t.list,(function(e,i){return n("forw-list-item",{key:String(Math.random()),attrs:{"forw-data":e,"card-info":t.cardInfo,"click-log-handler":t.clickLogHandler}})})),1)]):t._e(),n("div",{staticClass:"forw-more",class:{"forw-more-tag":t.isTagPage}},[t.isLoadingMore?n("loading",[t._v("加载中...")]):[t.hasMore?n("a",{ref:"loadMore",staticClass:"more",on:{click:t.loadMore}},[t._v("查看更多转发")]):n("a",{class:{nomore:!t.hasMore}},[t._v("没有更多啦(〜￣△￣)〜")])]],2)])}),[],!1,null,"b2249404",null).exports),_e=(n(49),n(56)),Ce={props:{show:null,title:String,hideButton:Boolean,disabled:null},components:{BpPopup:_e.a},methods:{onConfirm:function(t){this.$emit("onConfirm",t)},onCancel:function(t){this.$emit("onCancel",t)}}},we=(n(431),n(432),Object(E.a)(Ce,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"im-popup-fade"}},[t.show?n("div",{staticClass:"im-popup"},[t.hideButton?t._e():n("bp-popup",{staticClass:"im-popup-shell",attrs:{show:t.show,title:t.title,onConfirm:t.onConfirm,onCancel:t.onCancel,disabled:t.disabled}},[n("div",{staticClass:"content"},[t._t("default")],2)]),t.hideButton?n("bp-popup",{staticClass:"im-popup-shell hide-button",staticStyle:{width:"auto !important",padding:"0",margin:"0"},attrs:{show:t.show,title:t.title,onConfirm:t.onConfirm,onCancel:t.onCancel,button:!1}},[n("div",{staticClass:"split-line"}),n("div",{staticClass:"content",staticStyle:{padding:"0"}},[t._t("default")],2)]):t._e()],1):t._e()])}),[],!1,null,"53efcfd2",null).exports),Ie={props:["checked","value","name"],data:function(){return{}},computed:{},watch:{},components:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{onClick:function(t){this.$emit("click",t)}}},xe=(n(433),Object(E.a)(Ie,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:"type-selector"},[n("input",{staticClass:"radio",attrs:{name:t.name,type:"radio"},domProps:{value:t.value,checked:t.checked},on:{click:t.onClick}}),t.checked?n("span",{staticClass:"radio-selected"}):t._e(),t.checked?t._e():n("span",{staticClass:"radio-default"}),t._t("default")],2)}),[],!1,null,"1f7f31f2",null).exports),ke={props:{show:null,types:Array,accusedUid:[String,Number],objectId:[String,Number]},data:function(){return{type:-1,reportContent:"",maxNum:60,reportTypeList:[{type:4,name:"垃圾广告"},{type:7,name:"话题不相关"},{type:8,name:"引战"},{type:1,name:"色情"},{type:5,name:"人身攻击"},{type:3,name:"违法信息"},{type:0,name:"其他"}]}},computed:{showList:function(){var t=this;return this.types?this.reportTypeList.filter((function(e){return t.types.includes(e.type)})):this.reportTypeList},tooMuch:function(){return this.reportContent.length>this.maxNum},active:function(){return!!(this.type&&this.type>0||0===this.type&&this.reportContent.trim())}},components:{ImPopup:we,ImRadio:xe},methods:{onConfirm:function(){this.active?this.reportIt():this.linkMsg(this.$refs.popup,"请输入举报内容","caution",!0)},onCancel:function(){this.$emit("cancel")},reportIt:function(){var t=this;return this.bpapi({url:"//api.vc.bilibili.com/bplus_report/v1/Report/add",data:{biz_code:this.bizCode||7,module:this.module||1202,accused_uid:this.accusedUid,object_id:this.objectId,reason_type:this.type,reason_desc:0===this.type?this.reportContent:void 0},method:"post"}).then((function(){t.linkMsg(t.$refs.popup,"举报成功","success",!0),t.$emit("success")}),(function(e){t.linkMsg(t.$refs.popup,"举报失败，".concat(e.msg),"error",!0)}))}}},Oe=(n(434),Object(E.a)(ke,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("im-popup",{staticClass:"report-popup",attrs:{show:t.show,title:"我要举报",disabled:!t.active},on:{onConfirm:t.onConfirm,onCancel:t.onCancel}},[n("div",{ref:"popup",staticClass:"content-text"},[t._v("请选择举报的理由：")]),n("div",{staticClass:"selector-box"},t._l(t.showList,(function(e){return n("im-radio",{key:e.type,class:{"other-reason":0===e.type},attrs:{checked:e.type===t.type,value:e.type,name:"report-type"},on:{click:function(n){t.type=e.type}}},[t._v(t._s(e.name))])})),1),n("div",{directives:[{name:"show",rawName:"v-show",value:0===t.type,expression:"type === 0"}],staticClass:"report-tip"},[t._v("为帮助审核人员更快处理，请补充问题类型和出现位置等详细信息")]),n("div",{directives:[{name:"show",rawName:"v-show",value:0===t.type,expression:"type === 0"}],staticClass:"input-box report-input"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reportContent,expression:"reportContent"}],staticClass:"textarea",attrs:{maxlength:t.maxNum,autofocus:"autofocus",placeholder:"举报内容",max:"50"},domProps:{value:t.reportContent},on:{input:function(e){e.target.composing||(t.reportContent=e.target.value)}}}),n("div",{staticClass:"indicator"},[n("span",{class:{"too-much":t.tooMuch}},[t._v(t._s(t.reportContent.length))]),t._v("/"),n("span",[t._v(t._s(t.maxNum))])])])])}),[],!1,null,"f55b66b8",null).exports);o.a.use(Object(a.a)()),o.a.use(r.a),o.a.use(q.b);var Se=Oe,Pe=(n(435),Object(E.a)({},(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"skeleton"},[e("div",{staticClass:"skeleton-head"}),e("div",{staticClass:"skeleton-body"},[e("div",{staticClass:"first-line"},[e("div",{staticClass:"skeleton-user-name"}),e("div",{staticClass:"skeleton-focusbtn"})]),e("div",{staticClass:"skeleton-time"}),e("div",{staticClass:"skeleton-content"})])])}],!1,null,"17bb0413",null).exports),Te=n(249),je=n.n(Te),Le={props:{src:{type:String},id:{type:String,default:"svga-player"},autoplay:{type:Boolean,default:!0}},mounted:function(){this.playUrl(this.src)},watch:{src:function(t){this.playUrl(t)}},methods:{playUrl:function(t){var e=this;if(t){var n=new je.a.Player("#"+this.id),i=new je.a.Parser("#"+this.id);n.loops=1,i.load(t.replace(/^http:/,"https:"),(function(t){e.$emit("start"),n.setVideoItem(t),e.autoplay&&n.startAnimation()})),n.onFinished((function(){e.$emit("finish")}))}else this.$emit("finish")}}},Ae=(n(436),Object(E.a)(Le,(function(){var t=this.$createElement;return(this._self._c||t)("div",{directives:[{name:"show",rawName:"v-show",value:this.src,expression:"src"}],staticClass:"svga-player",attrs:{id:this.id}})}),[],!1,null,null,null).exports),Ee=n(376),Me=n.n(Ee);n(492);function De(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}function Re(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){De(a,i,o,r,s,"next",t)}function s(t){De(a,i,o,r,s,"throw",t)}r(void 0)}))}}var Be={data:function(){return{showMorePanel:!1,isUnfocus:"undefined"==typeof window||this.cardInfo.isUnfocus,detailLink:"".concat(b.a.T,"/").concat(this.cardInfo.desc.dynamic_id,"?tab=2"),isTransmitHover:!1,isCommentHover:!1,isPraiseHover:!1,currentTop:0,showForwardingPanelData:!1,showCommentPanelData:!1,isInThisCard:!1,chromeScaleFix:!1,lazyLoaded:!1,emojiInited:!1,isShowLog:!1,attentionList:f.r.getMyAttentionList(),date:this.getNewDate(),reportPopupShow:!1,reportDid:"",reportUid:"",hasInitComment:!1,scrollContainer:null,canRender:!0,HOST:b.a,svgaPlayerShown:!1,svgaPlayerStart:!1,isLovedTemp:-1,updatePraiseLoading:!1}},props:{cardInfo:{type:Object,required:!0},isSelf:{type:Boolean,required:!0},isDraft:{type:Boolean,default:!1},isNeedCardPopup:{type:Boolean,default:!0},idx:{type:Number,default:0},defaultTab:{type:Number},pageType:{type:String},scrollDom:{},currentType:{type:Number,default:0},topicName:{type:String},popupDom:null,disableLazyLoad:{type:Boolean,default:!1},foldItems:null,ifJumpAfterLogin:{type:Boolean,default:function(){return!0}},regString:{type:String,default:""}},components:{CardContent:ie,Forwarding:ye,ReportPopup:Se,CardSkeleton:Pe,SvgaPlayer:Ae},created:function(){g.c.setCurrentType(this.currentType),g.c.setIsNeedCardPopup(this.isNeedCardPopup),g.c.setPageType(this.pageType)},watch:{"cardData.face":{handler:function(t){t&&this.updateAvatar()},immediate:!0},currentType:function(t){g.c.setCurrentType(t)},lazyLoaded:function(t){t&&(this.initCardRich(),this.cardInfo.foldType&&Object(p.d)(Dt.d.FOLD_SHOW,this.cardInfo.foldType))},emojiInited:function(t){var e=this;t&&(this.canRender=!1,this.$nextTick((function(){e.canRender=!0})))}},mounted:function(){var t=this;this.scrollContainer=this.scrollDom||window,Object(f.i)().then((function(){t.emojiInited=!0})),window.devicePixelRatio>=1.1&&window.devicePixelRatio<=1.2&&(this.chromeScaleFix=!0),this.initBus(),this.initEvent(),this.lazyLoaded=this.isInViewport(),(this.isHotTab||this.isTagPage)&&(this.isUnfocus=-1===this.attentionList.indexOf(this.cardInfo.desc.uid)),1===this.defaultTab?this.onTransmitClick():2===this.defaultTab&&this.onCommentClick(),m.bus.$on("ShowBvConfigUpdated",(function(){t.canRender=!1,t.$nextTick((function(){t.canRender=!0}))})),this.updateAvatar()},beforeDestroy:function(){f.b.$off(Dt.b.MORE_PANEL_CLOSE,this.morePanelClose)},methods:{updateAvatar:function(){!this.isBangumiLike&&this.cardInfo.desc&&this.cardInfo.desc.dynamic_id&&new Me.a({}).append({avatar:this.cardData.face,pendent:this.userHeadPendant,avatarHeight:48,avatarWidth:48,pendentHeight:81,iconType:this.verifyIconType,pendentWidth:this.avatarStepWidth,stepWidth:81,isAnimate:!0,duration:2},document.getElementById("dynamicId_".concat(this.cardInfo.desc.dynamic_id)),"dynamicId_".concat(this.cardInfo.desc.dynamic_id))},numberFormat:m.numberFormat.autoParse,initCommentComponent:function(t){var e=this;window.bbComment?this.commentComponentCallback():u()("//s1.hdslb.com/bfs/seed/jinkela/commentpc/comment.min.js").then((function(){e.commentComponentCallback()}))},commentComponentCallback:function(){var t=this;this.hasInitComment=!0;var e=location.hash.match(/reply(\d+)/),n={oid:this.cardData.comment_oid,pageType:this.cardData.comment_id,noPage:!this.isDetailPage,dynamicRepost:!0,smallPager:!0,pageSize:10,jumpId:e&&e[1],contentMaxLength:233};if(window.bbComment){var i=new bbComment(this.$refs.bbcomment,n);i.on("commentSent",(function(){Object(p.d)(Dt.d.CARD_COMMENT_2,Object(g.f)(t.cardInfo))})),i.on("pageLoaded",(function(){Object(p.d)(Dt.d.CARD_COMMENT_3,Object(g.f)(t.cardInfo))})),i.on("clickSpace",(function(e){var n="face"===e?Dt.d.CARD_HEAD:Dt.d.CARD_NICKNAME,i=Object.assign(Object(g.f)(t.cardInfo),{jumpfrom:2});Object(p.d)(n,i)})),this.isDetailPage||i.on("moreLinkClick",(function(){window.open(t.cardData.more_comment_url)})),i.on("dynamicRepost",(function(e){var n={url:b.a.API_VC+"/dynamic_repost/v1/dynamic_repost/reply",method:"post",data:{uid:f.r.getUid(),type:1,rid:t.cardInfo.desc.dynamic_id,content:e,repost_code:3e4,from:"create.comment",extension:JSON.stringify({emoji_type:1})}};t.bpapi(n).then((function(e){0===e.data.result?(t.boxText="",t.tranIsCheck=!1,t.feedCurrentType===Dt.a.HOT&&t.uid&&t.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:3,uid:f.r.getUid(),dynamic_id:t.cardInfo.desc.dynamic_id}}),i.trigger("repostSuc",e)):i.trigger("repostFail",e)}),(function(t){i.trigger("repostError",t)}))}))}},initCardRich:function(){var t=this;!this.isBangumiLike&&g.c.getIsNeedCardPopup()&&this.$nextTick((function(){t.$refs.username&&Object(h.a)(t.cardInfo.desc.uid,t.$refs.card,t.$refs.username),t.$refs.userhead&&Object(h.a)(t.cardInfo.desc.uid,t.$refs.card,t.$refs.userhead)}))},inThisCard:function(){this.isInThisCard=!0},outThisCard:function(){this.isInThisCard=!1},morePanelClose:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t!==this.cardInfo.desc.dynamic_id;e?this.showMorePanel=!1:this.onMoreClick()},initEvent:function(){var t=this;document.body.addEventListener("click",(function(){t.showMorePanel=!1}),!1),this.$refs.morePanel&&this.$refs.morePanel.addEventListener("click",(function(t){t.stopPropagation()}),!1),this.$refs.buttonArea&&this.$refs.buttonArea.addEventListener("click",(function(e){f.b.$emit(Dt.b.MORE_PANEL_CLOSE,t.cardInfo.desc.dynamic_id,t.cardInfo.desc.type,t.cardInfo.desc.uid),e.stopPropagation()}),!1),Object(g.a)(this.scrollContainer,"scroll",this.scrollHandler)},scrollHandler:function(){var t=this.scrollContainer.scrollTop;f.b.$emit(Dt.b.SCROLL,t,this.scrollContainer),f.b.$emit(Dt.b.FORWARDING_SCROLL),f.b.$emit(Dt.b.COMM_SCROLL)},isInViewport:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.$refs.card;if(!e)return!1;if(this.lazyLoaded)return!0;var n=e.getBoundingClientRect().top,i=window.innerHeight;return n<i+400+t},clickHeadLog:function(){Object(p.d)(Dt.d.CARD_HEAD,Object.assign(Object(g.f)(this.cardInfo),{jumpfrom:1}))},clickNameLog:function(){Object(p.d)(Dt.d.CARD_NICKNAME,Object.assign(Object(g.f)(this.cardInfo),{jumpfrom:1}))},onSetTopClick:function(){var t=this;this.cardData.isSetTop?(Object(p.d)(Dt.d.CARD_MORE_TOP,Object(g.f)(this.cardInfo)),this.bpapi({method:"post",url:b.a.API_VC+"/dynamic_mix/v1/dynamic_mix/space_top_rm",data:{dynamic_id:this.cardInfo.desc.dynamic_id}}).then((function(t){window.location.reload()}),(function(e){t.linkMsg(t.$refs.setTopRef,"取消置顶失败，请稍后重试",e.type)}))):(Object(p.d)(Dt.d.CARD_MORE_UNTOP,Object(g.f)(this.cardInfo)),this.bpapi({method:"post",url:b.a.API_VC+"/dynamic_mix/v1/dynamic_mix/space_top_set",data:{dynamic_id:this.cardInfo.desc.dynamic_id}}).then((function(t){window.location.reload()}),(function(e){t.linkMsg(t.$refs.setTopRef,"置顶失败，请稍后重试",e.type)})))},onDeleteClick:function(){var t=this;this.bpPopup({title:"删除动态",content:"确定要删除此条动态吗？",button:{confirm:"删除",cancel:"我点错了"}}).onConfirm((function(e){t.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_svr/v1/dynamic_svr/rm_dynamic"),data:{dynamic_id:t.isFakeCard?t.cardInfo.did:t.cardInfo.desc.dynamic_id},throttleInterval:5e3}).then((function(n){t.linkMsg(e.confirmBtn,"删除成功",n.type),e.close(),t.delete()}),(function(n){t.linkMsg(e.confirmBtn,n.msg,n.type)}))})).onCancel((function(e){t.showMorePanel=!1,e.close()}))},onUncollectClick:function(){var t=this;this.card&&this.card.collection&&this.card.collection.id?this.bpPopup({title:"取消收藏",content:"确定取消收藏吗？",button:{confirm:"取消收藏",cancel:"再想想"}}).onConfirm((function(e){t.bpapi({method:"post",url:"".concat(b.a.API_MAIN,"/x/v3/fav/resource/unfav-all"),data:{type:21,rid:t.card.collection.id}}).then((function(n){t.linkMsg(e.confirmBtn,"取消收藏成功",n.type),e.close(),t.delete()}),(function(n){t.linkMsg(e.confirmBtn,n.msg,n.type)}))})).onCancel((function(e){t.showMorePanel=!1,e.close()})):this.linkMsg(this.$refs.uncollectRef,"取消收藏失败，缺少合集id","caution")},onUnsubscribeClick:function(){var t=this;this.bpapi({method:"post",url:"".concat(b.a.API_MAIN,"/x/v1/tunnel/notify/close"),data:{oid:this.cardInfo.desc.rid}}).then((function(e){t.delete()}),(function(e){t.showMorePanel=!1,t.linkMsg(t.$refs.unsubscribeRef,e.msg,e.type)}))},onUnfocusClick:function(t){var e=this;return Re(c.a.mark((function n(){var i;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.isHotTab&&Object(p.d)(Dt.d.HOTFOLLOW,Object.assign(Object(g.f)(e.cardInfo),e.isGuestPage?{nologin:1}:{})),e.isDetailPage&&Object(p.d)(Dt.d.DETAIL_FOLLOW_CLICK,Object.assign(Object(g.f)(e.cardInfo),e.isGuestPage?{nologin:1}:{})),n.next=4,Object(m.quickLogin)((function(){e.ifJumpAfterLogin?(Object(p.d)(Dt.d.LOGIN_SUCCESS,{from:e.spmPageTypeString}),window.location.replace("https://t.bilibili.com/".concat(e.cardInfo.desc.dynamic_id))):window.location.reload()}));case 4:if(n.sent){n.next=7;break}return n.abrupt("return");case 7:i=t.target,e.isUnfocus?e.bpapi({method:"post",url:"".concat(b.a.API_MAIN,"/x/relation/modify"),data:{act:1,fid:e.cardInfo.desc.uid,spmid:e.getPageSpmid,re_src:0}}).then((function(t){e.setUnfocusStatus(!1),e.linkMsg(i,"关注成功！",t.type),e.showMorePanel=!1,f.r.insertToMyAttentionList(e.cardInfo.desc.uid),e.isHotTab&&e.uid&&(Object(p.d)(Dt.d.HOTFOLLOW,Object.assign(Object(g.f)(e.cardInfo),e.isGuestPage?{nologin:1}:{})),e.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:5,uid:e.uid,dynamic_id:e.cardInfo.desc.dynamic_id,count:1}}))}),(function(t){e.showMorePanel=!1,e.linkMsg(i,t.msg,t.type)})):e.bpPopup({title:"取消关注",content:"真的要取消对 ".concat(e.cardInfo.desc.user_profile.info.uname," 的关注吗？"),button:{confirm:"取消关注",cancel:"点错了~"}}).onConfirm((function(t){e.bpapi({method:"post",url:"".concat(b.a.API_MAIN,"/x/relation/modify"),data:{act:2,fid:e.cardInfo.desc.uid,spmid:e.getPageSpmid,re_src:0}}).then((function(n){e.setUnfocusStatus(!0),e.linkMsg(t.confirmBtn,"取消了对 ".concat(e.cardInfo.desc.user_profile.info.uname," 的关注"),n.type),e.showMorePanel=!1,t.close(),f.r.deleteFromMyAttentionList(e.cardInfo.desc.uid),e.isHotTab&&e.uid&&e.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:5,uid:e.uid,dynamic_id:e.cardInfo.desc.dynamic_id,count:-1}})}),(function(n){t.close(),e.linkMsg(t.confirmBtn,n.msg,n.type)}))})).onCancel((function(t){e.showMorePanel=!1,t.close()}));case 9:case"end":return n.stop()}}),n)})))()},setUnfocusStatus:function(t){f.b.$emit(Dt.b.UNFOCUS,this.cardInfo,t),this.updateAllStorage(this.cardInfo,t)},updateAllStorage:function(t,e){var n=this;Dt.e.forEach((function(i){var o="dynamic_cards_".concat(n.uid,"_").concat(i.type),a=f.q.get(o);if(a){var r=Object(d.e)(a)||[];r.forEach((function(n){n.desc.uid===t.desc.uid&&(n.isUnfocus=e)})),f.q.set(o,r)}}))},unfocusHandler:function(t,e){t.desc.uid===this.cardInfo.desc.uid&&(this.cardInfo.isUnfocus=e,this.isUnfocus=e)},onReportClick:function(){var t=this;return Re(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.quickLogin)((function(){t.ifJumpAfterLogin?(Object(p.d)(Dt.d.LOGIN_SUCCESS,{from:t.spmPageTypeString}),window.location.replace("https://t.bilibili.com")):window.location.reload()}));case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:t.reportUid=t.cardInfo.desc.uid,t.reportDid=t.cardInfo.desc.dynamic_id,t.reportPopupShow=!0;case 8:case"end":return e.stop()}}),e)})))()},onReportSucess:function(){this.reportPopupShow=!1},onReportCancel:function(){this.reportPopupShow=!1},onMoreClick:function(){this.showMorePanel=!this.showMorePanel},onTransmitHover:function(){this.isTransmitHover=!0},onTransmitLeave:function(){this.isTransmitHover=!1},onCommentHover:function(){this.isCommentHover=!0},onCommentLeave:function(){this.isCommentHover=!1},onPraiseHover:function(){this.isPraiseHover=!0},onPraiseLeave:function(){this.isPraiseHover=!1},onTransmitClick:function(){var t=this;return Re(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.showForwardingPanelData?Object(p.d)(Dt.d.CARD_SHARE_0,Object.assign(Object(g.f)(t.cardInfo),t.isGuestPage?{nologin:1}:{})):Object(p.d)(Dt.d.CARD_SHARE_1,Object.assign(Object(g.f)(t.cardInfo),t.isGuestPage?{nologin:1}:{})),!t.isGuestPage){e.next=7;break}return e.next=4,Object(m.quickLogin)((function(){t.ifJumpAfterLogin?(Object(p.d)(Dt.d.LOGIN_SUCCESS,{from:t.spmPageTypeString}),window.location.replace("https://t.bilibili.com/".concat(t.cardInfo.desc.dynamic_id,"?tab=1"))):window.location.reload()}));case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:if(!t.isDeletedDyn){e.next=9;break}return e.abrupt("return",t.linkMsg(t.$refs.transmitRef,"禁止转发","caution"));case 9:t.showForwardingPanelData=!t.showForwardingPanelData,t.showCommentPanelData=!1;case 11:case"end":return e.stop()}}),e)})))()},onCommentClick:function(){var t=this;return Re(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.showCommentPanelData?Object(p.d)(Dt.d.CARD_COMMENT_0,Object.assign(Object(g.f)(t.cardInfo),t.isGuestPage?{nologin:1}:{})):Object(p.d)(Dt.d.CARD_COMMENT_1,Object.assign(Object(g.f)(t.cardInfo),t.isGuestPage?{nologin:1}:{})),!t.isGuestPage){e.next=7;break}return e.next=4,Object(m.quickLogin)((function(){t.ifJumpAfterLogin?(Object(p.d)(Dt.d.LOGIN_SUCCESS,{from:t.spmPageTypeString}),window.location.replace("https://t.bilibili.com/".concat(t.cardInfo.desc.dynamic_id,"?tab=2"))):window.location.reload()}));case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:t.showCommentPanelData=!t.showCommentPanelData,t.showForwardingPanelData=!1,t.hasInitComment||t.initCommentComponent();case 10:case"end":return e.stop()}}),e)})))()},onPraiseClick:function(){var t=this;return Re(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=1===t.isLoved)?Object(p.d)(Dt.d.CARD_LIKE_0,Object(g.f)(t.cardInfo)):Object(p.d)(Dt.d.CARD_LIKE_1,Object.assign(Object(g.f)(t.cardInfo),t.isGuestPage?{nologin:1}:{})),e.next=4,Object(m.quickLogin)((function(){t.ifJumpAfterLogin?(Object(p.d)(Dt.d.LOGIN_SUCCESS,{from:t.spmPageTypeString}),window.location.replace("https://t.bilibili.com/".concat(t.cardInfo.desc.dynamic_id))):window.location.reload()}));case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:t.handlePraiseStatus(n);case 8:case"end":return e.stop()}}),e)})))()},handlePraiseStatus:function(t){if(this.updatePraiseLoading)this.linkMsg(this.$refs.praiseBtn,"点击得太快啦，小电视反应不过来了呢","caution");else{if(t)this.isLovedTemp=0,this.cardInfo.desc.like=this.cardInfo.desc.like-1;else if(this.isLovedTemp=1,this.cardInfo.desc.like=this.cardInfo.desc.like+1,this.loveAnimationUrl)return void(this.svgaPlayerShown=!0);this.updatePraiseStatus(t)}},updatePraiseStatus:function(t){var e=this;this.updatePraiseLoading=!0,this.bpapi({method:"post",url:b.a.API_VC+"/dynamic_like/v1/dynamic_like/thumb",data:{uid:this.uid,dynamic_id:this.cardInfo.desc.dynamic_id,up:t?2:1}}).then((function(n){e.updatePraiseLoading=!1,t||e.linkMsg(e.$refs.praiseBtn,"点赞成功","success"),e.isHotTab&&e.uid&&e.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:2,uid:e.uid,dynamic_id:e.cardInfo.desc.dynamic_id,count:t?-1:1}}),f.b.$emit(Dt.b.STORAGE_UPDATE,e.cardInfo)}),(function(n){e.updatePraiseLoading=!1,t?(e.isLovedTemp=1,e.cardInfo.desc.like=e.cardInfo.desc.like+1):(e.isLovedTemp=0,e.cardInfo.desc.like=e.cardInfo.desc.like-1),e.linkMsg(e.$refs.praiseBtn,n.msg,n.type)}))},editDraft:function(){Object(p.d)(Dt.d.TIMER_EDIT,""),this.$emit("edit-draft")},sendDraft:function(){var t=this;Object(p.d)(Dt.d.TIMER_PUBLISH,""),this.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_draft/v1/dynamic_draft/publish_now"),data:{draft_id:this.cardInfo.desc.draft_id},throttleInterval:5e3}).then((function(e){t.linkMsg(t.$refs.sendNowBtn,"发送成功",e.type),t.delete()}),(function(e){t.linkMsg(t.$refs.sendNowBtn,e.msg,e.type)}))},deleteDraft:function(){var t=this;Object(p.d)(Dt.d.TIMER_DELETE,""),this.bpPopup({title:"删除动态",content:"确认删除此定时发布的动态吗？",button:{confirm:"删除",cancel:"我点错了"}}).onConfirm((function(e){t.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_draft/v1/dynamic_draft/rm_draft"),data:{draft_id:t.cardInfo.desc.draft_id},throttleInterval:5e3}).then((function(n){t.linkMsg(e.confirmBtn,"删除成功",n.type),e.close(),t.delete()}),(function(n){t.linkMsg(e.confirmBtn,n.msg,n.type)}))})).onCancel((function(t){t.close()}))},initBus:function(){var t=this,e=function(){var e=window.innerHeight;if(t.lazyLoaded=t.isInViewport(e),t.isInViewport(e)&&!t.isShowLog&&t.lazyLoaded){var n=[],i=Object(g.f)(t.cardInfo);(t.cardData.hasLottery||t.originCardData.hasLottery)&&n.push("lottery_retweet"),(t.cardData.hasVote||t.originCardData.hasVote)&&n.push("poll");var o=n.join(","),a=Object.assign({like_show_area:t.likeUsersPanelShow?1:0},i,t.isGuestPage?{nologin:1}:{});if(o&&(a=Object.assign(a,{card_content:o})),t.isTagPage&&(a=Object.assign(a,{tagname:t.topicName})),t.cardInfo.desc.dynamic_id&&"-1"!==t.cardInfo.desc.dynamic_id){if(Object(p.d)(Dt.d.CARD_SHOW,a),t.cardInfo.desc.type===Dt.a.REPOST){var r=Object(g.g)(t.cardInfo);Object(p.d)(Dt.d.CARD_SHOW,Object.assign(a,r))}t.isHotTab&&t.uid&&t.bpapi({method:"post",url:"".concat(b.a.API_VC,"/dynamic_report/v1/dynamic_report/rcmd_report"),data:{report_type:1,uid:t.uid,dynamic_id:t.cardInfo.desc.dynamic_id}})}t.isShowLog=!0}};f.b.$on(Dt.b.SCROLL,e),f.b.$on(Dt.b.SET_TOP,(function(e){e===t.cardInfo.desc.dynamic_id&&(t.currentTop=t.$el.getBoundingClientRect().top)})),f.b.$on(Dt.b.LOCATE_CARD_EL,(function(e){e===t.cardInfo.desc.dynamic_id&&(document.documentElement.scrollTop=Object(f.h)(t.$el)-t.currentTop)})),f.b.$on(Dt.b.UNFOCUS,this.unfocusHandler),f.b.$on(Dt.b.STORAGE_UPDATE,this.storageUpdateHandler),f.b.$on(Dt.b.MORE_PANEL_CLOSE,this.morePanelClose),f.b.$on(Dt.b.LOAD_NOTICE,this.updatePublishTime),f.b.$on(Dt.b.REMOVE_SCROLL,(function(){f.b.$off(Dt.b.SCROLL,e),Object(g.i)(t.scrollContainer,"scroll",t.scrollHandler)})),(this.isHotTab||this.isTagPage)&&f.b.$on(Dt.b.ATTENTION_LIST_UPDATE,(function(){t.attentionList=f.r.getMyAttentionList(),t.isUnfocus=-1===t.attentionList.indexOf(t.cardInfo.desc.uid)}))},delete:function(){var t=this;Dt.e.forEach((function(e){e.type!==Dt.a.ALL&&e.type!==t.cardInfo.desc.type||f.q.delete("dynamic_cards_".concat(t.uid,"_").concat(e.type),t.cardInfo)})),this.$emit("delete",this.cardInfo)},getNewDate:function(){return new Date},storageUpdateHandler:function(t){var e=this;this.cardInfo.desc.dynamic_id===t.desc.dynamic_id&&Dt.e.forEach((function(n){n.type!==Dt.a.ALL&&n.type!==t.desc.type||f.q.replace("dynamic_cards_".concat(e.uid,"_").concat(n.type),t)}))},updatePublishTime:function(){this.date=this.getNewDate()},onWrapperClick:function(t){f.b.$emit(Dt.b.IFRAME_WRAPPER_CLICK,t,this.cardInfo.desc.dynamic_id)},onUnfold:function(){Object(p.d)(Dt.d.FOLD_CLICK,this.cardInfo.foldType),this.$emit("unfold",{index:this.idx,ids:this.cardInfo.allIds||[]})},getFoldUserAvatarStyle:function(t){var e=t.face||"//static.hdslb.com/images/member/noface.gif";return{backgroundImage:"url(".concat(Object(m.bfsImgLink)(e,30,30).replace(/^http:/,""),")")}},onSvgaStart:function(){var t=this;setTimeout((function(){t.svgaPlayerStart=!0}),0)},onSvgaFinish:function(){this.svgaPlayerShown=!1,this.svgaPlayerStart=!1,this.updatePraiseStatus(!1)}},computed:{isRealSelf:function(){return this.cardInfo.desc.type===Dt.a.CHEESE_SERIES||this.cardInfo.desc.type===Dt.a.CHEESE_UPDATE?this.uid===this.cardData.uid:this.isSelf},isShowCard:function(){return this.disableLazyLoad||this.lazyLoaded},isShowButtonBar:function(){return this.cardData.comment_id>0&&!this.isDraft},cardData:function(){return this.canRender?Object(g.e)(this.cardInfo):{}},getPageSpmid:function(){try{return window.document.querySelector("[name=spm_prefix]").content}catch(t){return""}},originCardData:function(){return Object(g.h)(this.cardInfo)},uid:function(){return f.r.getMyLoginInfo().isLogin?f.r.getMyLoginInfo().mid:0},card:function(){return Object(d.e)(this.cardInfo.card)},isHotTab:function(){return this.currentType===Dt.a.HOT},cardStyle:function(){return{"min-height":this.lazyLoaded?"":"150px","margin-top":0!==this.idx||this.isDetailPage?"8px":"0",border:this.isGamePage&&0===this.idx||this.isMainPage?"":"1px solid #eee"}},showForwardingPanel:function(){return 1===this.defaultTab&&!this.showCommentPanelData&&!this.isDeletedDyn||this.showForwardingPanelData},showCommentPanel:function(){return 2===this.defaultTab&&!this.showForwardingPanelData||this.showCommentPanelData},isDeletedDyn:function(){var t=this.cardInfo.desc.type===Dt.a.REPOST?this.card.item.orig_type:this.cardInfo.desc.type;return Dt.a.NONE===t},isCheeseSeries:function(){var t=this.cardInfo.desc.type===Dt.a.REPOST?this.card.item.orig_type:this.cardInfo.desc.type;return Dt.a.CHEESE_SERIES===t},isCheeseUpdate:function(){var t=this.cardInfo.desc.type===Dt.a.REPOST?this.card.item.orig_type:this.cardInfo.desc.type;return Dt.a.CHEESE_UPDATE===t},userHead:function(){return Object(m.bfsImgLink)(Object(d.g)(this.cardData.face),48,48)},isDetailPage:function(){return this.pageType===Dt.c.DETAIL},isMainPage:function(){return this.pageType===Dt.c.MAIN},isSpacePage:function(){return this.pageType===Dt.c.SPACE},isTagPage:function(){return this.pageType===Dt.c.TAG},isGamePage:function(){return this.pageType===Dt.c.GAME},isGuestPage:function(){return this.pageType===Dt.c.GUEST},isLivePage:function(){return this.pageType===Dt.c.LIVE},setTopText:function(){return this.cardData.isSetTop?"取消置顶":"置顶"},attentionText:function(){return this.isUnfocus?"关注":"取消关注"},spmPageTypeString:function(){return this.isGuestPage?"nologin":this.isMainPage?"dt":this.isDetailPage?"detail":this.isSpacePage?"space":this.isTagPage?"topic":this.isLivePage?"live":""},isPersonalIdentity:function(){return this.cardInfo.desc&&this.cardInfo.desc.user_profile&&this.cardInfo.desc.user_profile.card&&this.cardInfo.desc.user_profile.card.official_verify&&0===this.cardInfo.desc.user_profile.card.official_verify.type},isCompanyIdentity:function(){return this.cardInfo.desc&&this.cardInfo.desc.user_profile&&this.cardInfo.desc.user_profile.card&&this.cardInfo.desc.user_profile.card.official_verify&&1===this.cardInfo.desc.user_profile.card.official_verify.type},isBigVip:function(){return this.cardInfo.desc.user_profile&&this.cardInfo.desc.user_profile.vip&&this.cardInfo.desc.user_profile.vip.vipType>0&&1===this.cardInfo.desc.user_profile.vip.vipStatus},isYearlyVip:function(){return this.isBigVip&&2===this.cardInfo.desc.user_profile.vip.vipType},verifyIconType:function(){return!this.isBigVip||this.isPersonalIdentity||this.isCompanyIdentity?this.isCompanyIdentity?"business":this.isPersonalIdentity?"personal":"":"big-vip"},userHeadPendant:function(){var t=this.cardInfo.desc.user_profile;return t&&t.pendant?d.c?t.pendant.image_enhance||t.pendant.image||"":t.pendant.image_enhance_frame||t.pendant.image||"":""},avatarStepWidth:function(){var t=this.cardInfo.desc.user_profile;try{return!d.c&&t.pendant.image_enhance_frame?3240:81}catch(t){return 81}},isBigCardDecorator:function(){var t=this.cardInfo.desc.user_profile;return!(!t||!t.decorate_card)&&!!(t.decorate_card.card_url&&t.decorate_card.fan&&t.decorate_card.fan.is_fan&&3===t.decorate_card.item_type)},fansCardNumText:function(){if(!this.isBigCardDecorator)return"";var t=this.cardInfo.desc.user_profile.decorate_card.fan.number;return this.cardInfo.desc.user_profile.decorate_card.fan.num_desc||""||"000000".concat(t).substring(String(t).length)},fansCardTextColorStyle:function(){if(!this.isBigCardDecorator)return"";var t=this.cardInfo.desc.user_profile.decorate_card.fan.color;return"color: ".concat(t,";")},cardDecoratorStyle:function(){var t=this.cardInfo.desc.user_profile;if(!t||!t.decorate_card||!t.decorate_card.card_url)return"";var e="";this.showFocusButton&&(e="right: 107px;"),this.isBigCardDecorator&&(e="".concat(e," width: 146px; height: 44px;"));var n=t.decorate_card.card_url;return"background-image: url(".concat(n.replace(/^http?:/,""),"); ").concat(e,";")},cardDecoratorTitle:function(){var t=this.cardInfo.desc.user_profile;return t&&t.decorate_card&&t.decorate_card.name?t.decorate_card.name:""},showFocusButton:function(){return(this.isHotTab||this.isTagPage)&&!this.isRealSelf&&!this.isCheeseUpdate},showSetTopButton:function(){return this.isSelf&&this.pageType==Dt.c.SPACE},showMoreButton:function(){return(this.showDeleteButton||this.showAttentionButton||this.showReportButton||this.showSetTopButton)&&!this.isDraft},showUnsubscribeButton:function(){return this.cardInfo.desc.type===Dt.a.SUBSCRIPTION},showUncollectButton:function(){return this.cardInfo.desc.type===Dt.a.COLLECTION},showDeleteButton:function(){var t=this.cardInfo.desc.type;return this.isRealSelf&&!this.isHotTab&&(t===Dt.a.REPOST||t===Dt.a.WORD||t===Dt.a.PIC||t===Dt.a.H5_SHARE||t===Dt.a.CLIP||t===Dt.a.COMIC_SHARE)},showAttentionButton:function(){var t=this.cardInfo.desc.type===Dt.a.SUBSCRIPTION;return!(this.isRealSelf||this.isHotTab||this.pageType!==Dt.c.MAIN||this.isBangumiLike||this.showFocusButton||this.isCheeseUpdate||t)},showReportButton:function(){var t=this.cardInfo.desc.type;return!this.isRealSelf&&-1===[Dt.a.DRAMA,Dt.a.BANGUMI,Dt.a.PGC_BANGUMI,Dt.a.FILM,Dt.a.TV,Dt.a.GUOCHUANG,Dt.a.DOCUMENTARY,Dt.a.HOT].indexOf(t)},disabledDraftButton:function(){return 1===this.cardInfo.desc.draft_status},publishTime:function(){var t=this.cardInfo.desc.type,e=this.cardInfo.display&&this.cardInfo.display.usr_action_txt||"";if(t===Dt.a.LIVE_PUSH)return e||"直播了";if(t===Dt.a.SUBSCRIPTION)return e="live_room"===this.card.type?"直播了 · ":"","".concat(e,"来自我的预约");var n=this.cardInfo.desc.type===Dt.a.COLLECTION,i=this.date,o=Object(f.d)(i,"yyyy-MM-dd"),a=i.getTime(),r=n?1e3*this.card.pubdate:1e3*this.cardInfo.desc.timestamp,s=new Date(r);if(this.isDraft)return Object(f.d)(s,"yyyy-MM-dd")===o?"今天 "+Object(f.d)(s,"hh:mm"):Object(f.d)(s,"MM-dd hh:mm");var c=a-r,l=Math.floor(c/6e4),u=Math.floor(l/60),d=new Date(o+" 00:00:00").getTime()-864e5,h=new Date(Object(f.d)(i,"yyyy")+"-01-01").getTime();return u<1&&l<=1?"刚刚":u<1&&l>1&&l<60?"".concat(l," 分钟前"):u>=1&&u<24?"".concat(u," 小时前"):r>=d?"昨天 "+Object(f.d)(s,"hh:mm"):r>=h?Object(f.d)(s,"MM-dd"):Object(f.d)(s,"yyyy-MM-dd")},publishAction:function(){if(!this.isBangumiLike)return"";var t="更新了";if(this.cardInfo.desc.type===Dt.a.COLLECTION){t=this.cardInfo.display&&this.cardInfo.display.usr_action_txt?this.cardInfo.display.usr_action_txt:"更新了合集",t="".concat(this.card.collection&&this.card.collection.name||"").concat(t)}return"".concat(" ").concat(t)},isBangumi:function(){return-1!==[Dt.a.BANGUMI,Dt.a.PGC_BANGUMI].indexOf(this.cardInfo.desc.type)},isBangumiLike:function(){return-1!==[Dt.a.FILM,Dt.a.TV,Dt.a.DOCUMENTARY,Dt.a.BANGUMI,Dt.a.PGC_BANGUMI,Dt.a.GUOCHUANG,Dt.a.COLLECTION].indexOf(this.cardInfo.desc.type)},isFakeCard:function(){return this.cardInfo.desc.dynamic_id<0},focusButtonStyle:function(){return this.showMoreButton?"right: 48px":"right: 16px"},morePanelStyle:function(){return this.isTagPage?"right: -9px":"right: 5px"},showFoldUsers:function(){return 2===this.cardInfo.foldType},foldAllIds:function(){return this.cardInfo.allIds},foldUserList:function(){var t=this,e={},n=[];return this.foldAllIds.forEach((function(n){var i=t.foldItems[n].desc.user_profile;e[i.info.uid]=i})),Object.keys(e).forEach((function(t){n.push(e[t])})),n},showFoldUserInfoList:function(){var t=this.foldUserList.slice(0,4),e=[];return t.forEach((function(t){e.push(t.info)})),e},foldText:function(){var t="",e=this.foldAllIds;switch(this.cardInfo.foldType){case 1:e.length>1&&(t="展开".concat(e.length-1,"条相关动态"));break;case 2:var n=this.showFoldUserInfoList.length;t=n>1?"等".concat(n,"人转发了此动态"):"转发了此动态";break;case 3:t="展开".concat(e.length-1,"条相关动态")}return t},isLoved:function(){return this.isLovedTemp>-1?this.isLovedTemp:this.cardInfo.desc.is_liked},extendJsonLikeIcon:function(){return Object(d.e)(this.cardInfo.extend_json).like_icon||{}},notLovedIconUrl:function(){return this.extendJsonLikeIcon.start_url||""},lovedIconUrl:function(){return this.extendJsonLikeIcon.end_url||""},loveAnimationUrl:function(){return this.extendJsonLikeIcon.action_url||""},customLikeIconStaticStyle:function(){return this.isPraiseHover||this.isLoved?this.lovedIconUrl?"background-image: url(".concat(this.lovedIconUrl,");"):"":this.notLovedIconUrl?"background-image: url(".concat(this.notLovedIconUrl,");"):""},likeUsersPanelShow:function(){return this.cardInfo.display&&this.cardInfo.display.like_info&&this.cardInfo.display.like_info.like_users&&this.cardInfo.display.like_info.like_users.length>0}}},Ne=(n(437),n(438),Object(E.a)(Be,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"card",staticClass:"card",class:{"chrome-scale-1-1":t.chromeScaleFix},style:t.cardStyle,attrs:{"data-did":t.cardInfo.desc.dynamic_id},on:{click:t.onWrapperClick,mouseenter:t.inThisCard,mouseleave:t.outThisCard}},[t.isShowCard&&t.isBangumiLike?n("a",{ref:"userhead",staticClass:"user-head c-pointer",style:{backgroundImage:"url("+t.userHead+")","border-radius":t.isBangumiLike?"12px":"50%"},attrs:{href:t.cardData.name_url,target:"_blank"},on:{click:t.clickHeadLog}}):t._e(),t.isBangumiLike?t._e():n("a",{ref:"userhead",staticClass:"user-head c-pointer avatar-comp",attrs:{target:"_blank",id:"dynamicId_"+t.cardInfo.desc.dynamic_id,href:t.cardData.name_url},on:{click:t.clickHeadLog}}),t.isShowCard?t._e():n("card-skeleton"),t.isShowCard&&t.canRender?n("div",{staticClass:"main-content",style:{"padding-bottom":t.isShowButtonBar?"0":"24px"}},[t.isBangumiLike&&t.cardData.bangumi_desc?[t.cardData.bangumi_url?n("a",{staticClass:"d-i-block type-label c-pointer",attrs:{href:t.cardData.bangumi_url,target:"_blank"}},[t._v(t._s(t.cardData.bangumi_desc))]):n("div",{staticClass:"d-i-block type-label c-default"},[t._v(t._s(t.cardData.bangumi_desc))])]:t._e(),n("div",{staticClass:"user-name fs-16 ls-0 d-i-block",class:{"big-vip":t.isYearlyVip}},[n("a",{ref:"username",staticClass:"c-pointer",attrs:{href:t.cardData.name_url,target:"_blank"},on:{click:t.clickNameLog}},[t._v(t._s(t.cardData.name))])]),n("div",{staticClass:"time fs-12 ls-0 tc-slate"},[t.isBangumiLike||t.isDetailPage||t.isFakeCard?n("span",[t._v(t._s(t.publishTime))]):n("a",{staticClass:"detail-link tc-slate",attrs:{href:t.cardData.detail_url,target:"_blank"}},[t._v(t._s(t.publishTime))]),n("span",[t._v(t._s(t.publishAction))])]),n("card-content",{ref:"cardContent",attrs:{"card-info":t.cardInfo,"card-data":t.cardData,"is-fake":t.isFakeCard,"my-uid":t.uid,"is-detail":t.isDetailPage,"current-type":t.currentType,"popup-dom":t.popupDom,"is-guest":t.isGuestPage,"spm-page-type-string":t.spmPageTypeString,regString:t.regString}}),t.isDraft&&t.cardInfo.desc.error_msg?n("div",{staticClass:"error-msg fs-14 ls-0"},[n("i",{staticClass:"icon-error"},[t._v("​")]),t._v("定时发布失败，"+t._s(t.cardInfo.desc.error_msg)+"\n    ")]):t._e(),!t.isFakeCard&&t.isShowButtonBar?n("div",{staticClass:"button-bar tc-slate"},[n("div",{staticClass:"single-button c-pointer",on:{click:t.onTransmitClick,mouseenter:t.onTransmitHover,mouseleave:t.onTransmitLeave}},[n("span",{staticClass:"text-bar",class:{selected:t.showForwardingPanel||t.isTransmitHover}},[n("i",{staticClass:"bp-svg-icon single-icon",class:{transmit:!t.showForwardingPanel,"transmit-hover":t.showForwardingPanel||t.isTransmitHover}}),n("span",{ref:"transmitRef",staticClass:"text-offset"},[t._v("\n            "+t._s(t.cardInfo.desc.repost?t.numberFormat(t.cardInfo.desc.repost):"转发")+"\n          ")])])]),n("div",{staticClass:"single-button c-pointer",on:{click:t.onCommentClick,mouseenter:t.onCommentHover,mouseleave:t.onCommentLeave}},[n("span",{staticClass:"text-bar",class:{selected:t.showCommentPanel||t.isCommentHover}},[n("i",{staticClass:"bp-svg-icon single-icon",class:{comment:!t.showCommentPanel,"comment-hover":t.showCommentPanel||t.isCommentHover}}),n("span",{staticClass:"text-offset"},[t._v("\n            "+t._s(t.cardData.comment_count?t.numberFormat(t.cardData.comment_count):"评论")+"\n          ")])])]),n("div",{ref:"praiseBtn",staticClass:"single-button c-pointer p-rel",on:{click:t.onPraiseClick,mouseenter:t.onPraiseHover,mouseleave:t.onPraiseLeave}},[n("span",{staticClass:"text-bar",class:{selected:1===t.isLoved||t.isPraiseHover}},[t.customLikeIconStaticStyle?t._e():n("i",{staticClass:"custom-like-icon",class:{zan:!t.isLoved,"zan-hover":1===t.isLoved,"zan-a-hover":t.isPraiseHover}}),t.customLikeIconStaticStyle?n("i",{staticClass:"custom-like-icon",style:t.customLikeIconStaticStyle}):t._e(),n("span",{staticClass:"text-offset",domProps:{textContent:t._s(t.cardInfo.desc.like<1?"赞":t.numberFormat(t.cardInfo.desc.like))}})]),t.svgaPlayerShown?n("svga-player",{staticClass:"svga-position",attrs:{src:t.loveAnimationUrl,id:"svga-"+t.cardInfo.desc.dynamic_id},on:{start:t.onSvgaStart,finish:t.onSvgaFinish}}):t._e()],1)]):t._e(),t.isFakeCard&&!t.isDraft?n("div",{staticClass:"button-bar tc-slate"},[t._m(0),t._m(1),t._m(2)]):t._e()],2):t._e(),t.cardDecoratorStyle?n("div",{staticClass:"card-decorator",style:t.cardDecoratorStyle,attrs:{title:t.cardDecoratorTitle}},[t.isBigCardDecorator?n("div",{staticClass:"fans-card-text",style:t.fansCardTextColorStyle},[t._v(t._s(t.fansCardNumText))]):t._e()]):t._e(),t.showFocusButton&&t.isShowCard?n("div",{staticClass:"focus-btn p-abs c-pointer",style:t.focusButtonStyle,on:{click:t.onUnfocusClick}},[t.isUnfocus?n("div",{staticClass:"unfocus t-center w-100 h-100"},[n("p",{staticClass:"unfocus-text fs-14"},[t._v("+ 关注")])]):n("div",{staticClass:"focus t-center w-100 h-100"},[n("p",{staticClass:"focus-text fs-14"},[t._v("已关注")])])]):t._e(),t.showMoreButton?[n("div",{ref:"buttonArea",staticClass:"button-area c-pointer"},[n("div",{staticClass:"more-button bp-icon-font icon-more-1"})]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showMorePanel,expression:"showMorePanel"}],ref:"morePanel",staticClass:"more-panel fs-14 ls-0",class:t.isTagPage&&"tag"},[t.showSetTopButton?n("p",{ref:"setTopRef",staticClass:"child-button c-pointer",on:{click:t.onSetTopClick}},[t._v(t._s(t.setTopText))]):t._e(),t.showDeleteButton?n("p",{ref:"deleteRef",staticClass:"child-button c-pointer",on:{click:t.onDeleteClick}},[t._v("删除")]):t._e(),t.showUncollectButton?n("p",{ref:"uncollectRef",staticClass:"child-button c-pointer",on:{click:t.onUncollectClick}},[t._v("取消收藏")]):t._e(),t.showUnsubscribeButton?n("p",{ref:"unsubscribeRef",staticClass:"child-button c-pointer",on:{click:t.onUnsubscribeClick}},[t._v("不感兴趣")]):t._e(),t.showAttentionButton?n("p",{staticClass:"child-button c-pointer",on:{click:t.onUnfocusClick}},[t._v(t._s(t.attentionText))]):t._e(),t.showReportButton?n("p",{ref:"reportRef",staticClass:"child-button c-pointer",on:{click:t.onReportClick}},[t._v("举报")]):t._e()])]:t._e(),t.isDraft?[n("div",{staticClass:"button-group fs-12 ls-0 t-center"},[n("p",{staticClass:"draft-button",on:{click:t.editDraft}},[t._v("编辑")]),n("p",{ref:"sendNowBtn",staticClass:"draft-button",on:{click:t.sendDraft}},[t._v("\n        "+t._s(t.disabledDraftButton?"发送中":"立即发送")+"\n      ")]),n("p",{staticClass:"draft-button",on:{click:t.deleteDraft}},[t._v("删除")]),t.disabledDraftButton?n("div",{staticClass:"disabled"}):t._e()])]:t._e(),n("report-popup",{attrs:{show:t.reportPopupShow,"object-id":t.reportDid,"accused-uid":t.reportUid},on:{success:t.onReportSucess,cancel:t.onReportCancel}}),t.showForwardingPanel&&!t.isFakeCard?n("div",{staticClass:"panel-area"},[n("forwarding",{attrs:{"page-type":t.pageType,"feed-current-type":t.currentType,"card-info":t.cardInfo,"card-data":t.cardData}})],1):t._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showCommentPanel&&!t.isFakeCard,expression:"showCommentPanel && !isFakeCard"}],ref:"bbcomment",staticClass:"panel-area"}),t.foldText?n("div",{staticClass:"fold-box"},[n("div",{staticClass:"fold-hoverable",on:{click:t.onUnfold}},[t.showFoldUsers?n("div",{staticClass:"fold-users"},t._l(t.showFoldUserInfoList,(function(e,i){return n("div",{key:i,staticClass:"fold-user-avatar",style:t.getFoldUserAvatarStyle(e),attrs:{title:e.uname}})})),0):t._e(),n("span",{staticClass:"fold-text"},[t._v(t._s(t.foldText))]),n("span",{staticClass:"fold-arrow"})])]):t._e()],2)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"single-button"},[e("i",{staticClass:"bp-svg-icon transmit-disable single-icon"}),e("span",[this._v("--")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"single-button"},[e("i",{staticClass:"bp-svg-icon comment-disable single-icon"}),e("span",[this._v("--")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"single-button"},[e("i",{staticClass:"bp-svg-icon zan-disable single-icon"}),e("span",[this._v("--")])])}],!1,null,"59e7bd6e",null).exports);n(439);o.a.use(Object(a.a)()),o.a.use(r.a),o.a.use(q.b);e.a=Ne},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){t.exports=n.p+"static/img/auth.fb6a43d9.png"},function(t,e,n){"use strict";var i=n(88);n.n(i).a},function(t,e,n){"use strict";var i=n(89);n.n(i).a},function(t,e,n){"use strict";var i=n(90);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(92);n.n(i).a},function(t,e,n){"use strict";var i=n(93);n.n(i).a},function(t,e,n){},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAARVBMVEUAAAAAAADt7e00NDQAAAAAAAAAAAAAAAD5+fna2trU1NQxMTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6Ojr///96jHstAAAAFnRSTlOAAO6OenQLMPne2o1uZlxYSD80KByQlCrO7wAAARVJREFUSMeVllkSgyAQRFsdwH0P9z9qSJmEScSl39+U/apQYQZkO5axb42Iaftx2T/9E6wbBAoZnD0R7BTT0ZnskTAbJDFzUrAdDunsXlgNTjDrv+AEp4j7FRwucVpY5VqQNQrW4AbGfoUOt+g+woybzJugF3S9qCBMuM30Eqwg8qjKuollU5fVAxGxGX5/QeW9z4tPVeShrKBwQRigKP1mxLwvoRiCIFDUfjNi3tdQSIYFmiZ/G9983kCzYNRljBVFVDUjeqSNdD7EW6SNdD7EDdJGOg8DQdpI5yG0QC+Jfmn6s9I/jt4a7Oajtzd9gOgjyjYBus2wjYxtlXQzZts9O1D4kcUPRX7s8oOdvzrwlxP6+vMEBiIX8eTRZ3EAAAAASUVORK5CYII="},function(t,e,n){"use strict";var i=n(94);n.n(i).a},function(t,e,n){"use strict";var i=n(95);n.n(i).a},function(t,e,n){"use strict";var i=n(96);n.n(i).a},function(t,e,n){"use strict";var i=n(97);n.n(i).a},function(t,e,n){"use strict";var i=n(98);n.n(i).a},function(t,e,n){"use strict";var i=n(99);n.n(i).a},function(t,e,n){"use strict";var i=n(100);n.n(i).a},function(t,e,n){"use strict";var i=n(101);n.n(i).a},function(t,e,n){"use strict";var i=n(102);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(103);n.n(i).a},function(t,e,n){"use strict";var i=n(104);n.n(i).a},function(t,e,n){"use strict";var i=n(105);n.n(i).a},function(t,e,n){"use strict";var i=n(106);n.n(i).a},function(t,e,n){"use strict";var i=n(107);n.n(i).a},function(t,e,n){"use strict";var i=n(108);n.n(i).a},function(t,e,n){"use strict";var i=n(109);n.n(i).a},function(t,e,n){"use strict";var i=n(110);n.n(i).a},function(t,e,n){"use strict";var i=n(111);n.n(i).a},function(t,e,n){"use strict";var i=n(112);n.n(i).a},function(t,e,n){"use strict";var i=n(113);n.n(i).a},function(t,e,n){"use strict";var i=n(114);n.n(i).a},function(t,e,n){"use strict";var i=n(115);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(116);n.n(i).a},function(t,e,n){"use strict";var i=n(117);n.n(i).a},function(t,e,n){"use strict";var i=n(118);n.n(i).a},function(t,e,n){"use strict";var i=n(119);n.n(i).a},function(t,e,n){"use strict";var i=n(120);n.n(i).a},function(t,e,n){"use strict";var i=n(121);n.n(i).a},function(t,e,n){"use strict";var i=n(122);n.n(i).a},function(t,e,n){"use strict";var i=n(123);n.n(i).a},function(t,e,n){"use strict";var i=n(124);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(125);n.n(i).a},function(t,e,n){"use strict";var i=n(126);n.n(i).a},function(t,e,n){"use strict";var i=n(127);n.n(i).a},function(t,e,n){"use strict";var i=n(128);n.n(i).a},function(t,e,n){"use strict";var i=n(129);n.n(i).a},function(t,e,n){"use strict";var i=n(130);n.n(i).a},function(t,e,n){"use strict";var i=n(131);n.n(i).a},function(t,e,n){"use strict";var i=n(132);n.n(i).a},function(t,e,n){"use strict";var i=n(133);n.n(i).a},function(t,e,n){"use strict";var i=n(134);n.n(i).a},function(t,e,n){"use strict";var i=n(135);n.n(i).a},function(t,e,n){"use strict";var i=n(136);n.n(i).a},function(t,e,n){"use strict";var i=n(137);n.n(i).a},function(t,e,n){"use strict";var i=n(138);n.n(i).a},function(t,e,n){"use strict";var i=n(139);n.n(i).a},function(t,e,n){"use strict";var i=n(140);n.n(i).a},function(t,e,n){"use strict";var i=n(141);n.n(i).a},function(t,e,n){"use strict";var i=n(142);n.n(i).a},function(t,e,n){"use strict";var i=n(143);n.n(i).a},function(t,e,n){"use strict";var i=n(144);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(145);n.n(i).a},function(t,e,n){"use strict";var i=n(146);n.n(i).a},function(t,e,n){"use strict";var i=n(147);n.n(i).a},function(t,e,n){"use strict";var i=n(148);n.n(i).a},function(t,e,n){"use strict";var i=n(149);n.n(i).a},function(t,e,n){"use strict";var i=n(150);n.n(i).a},function(t,e,n){"use strict";var i=n(151);n.n(i).a},function(t,e,n){"use strict";var i=n(152);n.n(i).a},function(t,e,n){"use strict";var i=n(153);n.n(i).a},function(t,e,n){"use strict";var i=n(154);n.n(i).a},function(t,e,n){"use strict";var i=n(155);n.n(i).a},function(t,e,n){"use strict";var i=n(156);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(10),o=n.n(i),a=n(248);"undefined"!=typeof window&&(window.Sentry&&(Sentry.init({dsn:"https://d340547ea5594fd68a13559a8c3c577e@api.bilibili.com/x/traceback/26",debug:!1,release:Object({NODE_ENV:"production",BASE_URL:"/"}).COMMIT_ID,environment:"production",sampleRate:.01,integrations:[new a.TrackingReport({env:"production"}),new Sentry.Integrations.Vue({Vue:o.a,attachProps:!0})]}),window.SentryTest=function(){var t=document.getElementById("some-element-not-exist");try{t.getBoundingClientRect()}catch(t){Sentry.captureException(t)}}),"function"==typeof window.onLoginInfoLoaded&&window.onLoginInfoLoaded((function(t){if(t.isLogin)try{Sentry.configureScope((function(e){e.setUser(t)}))}catch(t){}})))},function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABCCAYAAADuSnCvAAAAAXNSR0IArs4c6QAACMhJREFUeAHtm2lsFVUUx+3rgtC0BSvCB1SKLA2FLo/lA8pS0ASjLEqMcSeKCcgShUSJfjAqagigokEjbiCJKCgxEaLgwpIgfmhfFwpUGkrY92Jbu9NXf2d8M5k3zExnpu9BH+1N7rv3nnvuuef8737vvLibIuDa2triA4HAOML+CQkJB3Nzcw9EQGy7IoqLi4cGg8HsuLi4i62trXtHjx7d0m6hdhh87eQ7ygaMFYCxB+ZNV65cKSssLHzNUcEOMFHHAur6G0A2A8ZOQPm0A+K0ohEBBDDu1yQSIb0MhV/W0yIZpwHmUsdHeplGHfR5buIRAYTWKTFWioLLUXyxkd7RNDKfQ/bHRjnoUGykeUlHBBAUfInKjxgVoDuvwoCFRrrXdEFBwTPU9Rk+Ti8DME75fL55eprXeJhgr0Kk3P79+29vamraTTTDRM4LTHifmNAdkxiCT8D8NWAYG/FMfHz8xLy8vArHwmwYjcJtWO2zRo4ceYJWyofruJGTFlyDQc8b6U7TlH0UINabgHEOGZMjBYboE7EeohpXWlo6qLm5WXrKAJUmIaC0ETw7atSodZJ26hhysxh638KfoC+DvAv0jPxIL/ER6yGqstnZ2ZUom48/rdIkDI37L2jtJ/V0u3hRUdEMwNgITxgYpC8hb0qkwRBdHPUQ6arMEWlSwKljj5BJuW34PoYyrYA1OzExcZuBHpakl02E7zvKJ+kzoNWRnk75Ij3dLo6sIHNYtR2PmmcJCK2TS+vIEid7jDvwiWqhGA3r0buSeW4L4Zd+v/+YmR1XAVJRUZFaXV29CuY5ZgVuBBq9rBk73gSU5cSv6G0KA+TAgQP9GxoadsKQqWe6UeOA8UtqaurMIUOGNKk2apMqm560xsbG37sKGAIA08HUmpqa7wm1jqEBAlofkDFcRaqrhNj8ICvfItVeBRkIk8mQ3tFVXT2r1rCcnJyTyvoOGK84QYJedAreWie8nYinL7qkt6NPr5aWlgXwLI2TSxa5V7ArABA/4RdaLVV2Za93Hg0oNuawhVhHPMdKH+y7jH39EgBjqhWT0GH8GcYZhLL1jjkX0ruYRWMcypfhM8yMAKw+TB0jZVLNN2NQaTAujlUwVBskZKdaz6bsVT3NGMfWMQKI3Z7jDILKjQVjNc1h8A873Wn4gQLIrVZMMBy2yotFOqvIefSusdIde/v4+LnFigF62LbWhi+WsuxsSvMxbrTNWSxZFQ1dBYtuMAzIdgNiAMR4E2XI7niSE3QSJ+gRbI3Py9bYi0S5kqitrc1ic1Uiy6cXGU7LRBSQo0eP3sxdSjaK+/GjUMLPCXoEYRKva0sJlztVTM+HzPGkt+Jb2WCVsxAEiIsvTE5OLs7MzIzYccIzICjWi3VdbtX8KKYYf+nSJTkth8lkooKkHLVzlYiHHwDIDcmJp3gW8SzCp0RUXV1dG7rI9kABSEL0KuIm/h/Jd+vClHdSmMrfRcHp8GbS6o7nIIzIcyLfgseyLHLlxD4s5B+T8jSSgCSX3du55Z8vNKfOsUGqQCrJQInheFdlKTekpKQkWZXjJqQuV70rBNJd1GF6brGr25VRIgjDHN926ysWAOlR2Xqak7hMqNQ5yAmvCY9rXV0PGQxz/KiMIfI2U4hXxndKSorr70Z4QmikTjmRK/NUKHTU8m50Ra7iXAPCBzFFXKao5fXhcRIBTpSFABGAr5DnTXlq7JDLyspqRsCOkFdk8TrYh2sLPwbLhK5O6oNJy3yiOS+92TUgckDi3mAflZ+iZrX1A+wPLmqaRDnC6+BlqpArT+3aM7RXyQuBJL1pGPc4R9yq4hoQqYCZe5zbiqLNz1NCDXXsDnnP1bmeVD3XFCMFuwExNFQ3IN2AGBAwJLt7SGcERB7ZOXukGXS7LklPy64bTdkXyFfOX0mYlpY2L7Q8aiLIu5P7klIIZ7k+yMnIyGjUMolw/slgI/gem6wClvu39XnRiEd9yPDhjWyW5Kj+OPca3xDXGkEujziZbiIvFT+0qqoq7EvFQ4cOpbMjlS+NZlJuGZuvHsSj6jTlolVLjx49KukBsouV544H6BHbAWkJW/xqLo9WQxur1o3Rsxk6VaRXkj+cu441xOVoLy6g/47jf1Lkf6PeQziLVHFhMxPVG0R9jJ7MqVfOQ5XEpwmN4SDnFdUtJnKanvMboQrGSeIPqQzRDKMOiCjP7dVeWnwK0UoTY04AyN3kP0L4rzEf2p/cx07grHTcmBeNdNSHjKo0B619zBk5DJ+50Cbh5evCv/AfkidDqoBX+lLmjAXERwCEDJ2t5G0g3kr8mrhrBohYw/CRHrAy5IUU5vju9DCERWHEa5yQp8yY/MwhGjiBRVCeMuVuwdSRJ7fcN5qzs6lGJtULNhYPtsmLuSzZ16C05Y5YOocMGRm3Vm6A7BStMmONXl9fP6EdnY8LILvsmJj1V9jlx0qe7IrpAe/Y6cs9cIGPTdMOOyaEzOIOdQO7y952fJ05D90HstzL10N2X0vV8ixaotxSY/AuDJ9oZ5TMwPAcJKy14+tseeh8GzrJo5Wtw67VHB5fVPYhFJJhYQsIPDIBjyC0FRyLmYDRzHCRc9VNYqR8oScnys0S76LuDZ5XjortCiBKxOebT6gQJd2F3C6OB9pnGhogEC9wwMqn+xzrQmDs7dmz5zRs1s5KGiACAqAcYyyNheGHGxkU7Ati36r09PR7Q+crzVxlldFSughL1STuJOYwicpDs+zwYtoBgqwGp7FnC9cJa5kzyswMsgREz1xeXp7CK3xflUb8deJPq2l9SMUlVPiwnhatOHqsR/Y9FvJ/TEpKWiJ5XEgFe/fufdZ4X2tWztHxP/QNl7b/YN+yA6RNAYG+R/6qalZZpGlcN+5EphUgv3rRI2wOcaowc81GePea8J9jYn7LhB4VErf4K+mRVy0C0kuZLD/3UqknQKgw2K9fv/uoUJarMtLy98/1eLDyX/CiiJcy8qRB3WPwa6m7gvAQ/n224OND35W4Fvsfl7KGlCwvH7sAAAAASUVORK5CYII="},function(t,e,n){"use strict";n(14),n(9),n(29);var i=n(11),o=n.n(i),a=(n(41),n(6)),r=n(5),s=n(8),c=n(7);n(15),n(22),n(23),n(25),n(16),n(18),n(20);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var u={_support:!("undefined"==typeof window||!window||!window.localStorage||"object"!=l(window.localStorage)),getItem:function(t){return this._support?window.localStorage.getItem(t):null},setItem:function(t,e){this._support&&window.localStorage.setItem(t,e)},removeItem:function(t){this.getItem(t)&&window.localStorage.removeItem(t)}};var d=n(19),f={props:{uid:{required:!0,default:function(){return 0}}},data:function(){return{host:{isDynamic:!1,isMessage:!1},floatMessage:null,navDropBox:{message:{show:!1}},notify:{num:0,type:0},hoverTimer:null}},mounted:function(){this.onInit()},methods:{loadPromisePolyfill:function(t){var e,n,i,o;window._bp_promise_loading=!0,e="//s1.hdslb.com/bfs/seed/bplus-common/promise/promise.polyfill.min.js",n=function(){window._bp_promise_loading=!1,t&&t()},i=document.createElement("script"),o=document.getElementsByTagName("script")[0],i.async=1,o.parentNode.insertBefore(i,o),i.onload=i.onreadystatechange=function(t,e){(e||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i=void 0,e||n&&n())},i.src=e},onInit:function(){if(void 0!==window.Promise){if(this.dealHost(),function(){var t,e,n;if(void 0!==document.hidden)t="hidden",n="visibilitychange",e="visibilityState";else if(void 0!==document.mozHidden)t="mozHidden",n="mozvisibilitychange",e="mozVisibilityState";else if(void 0!==document.msHidden)t="msHidden",n="msvisibilitychange",e="msVisibilityState";else{if(void 0===document.webkitHidden)return;t="webkitHidden",n="webkitvisibilitychange",e="webkitVisibilityState"}document.addEventListener(n,(function(){window._im_visiable=!(document[e]===t)}),!1),window._im_visiable=!(document[e]===t)}(),this.startGetMessage(),this.host.isDynamic)return;this.getFloatMessage(),setInterval(this.getFloatMessage,6e4)}else window._bp_promise_loading?setTimeout(this.onInit,1e3):this.loadPromisePolyfill(this.onInit)},emitClick:function(t){this.$emit("click",t)},dealHost:function(){switch(window.location.hostname){case"message.bilibili.com":this.host.isMessage=!0;break;case"t.bilibili.com":this.host.isDynamic=!0}},startGetMessage:function(){var t=this;window.addEventListener("message",(function(e){e.data.type&&"nav-im-update"===e.data.type&&(t.notify.num=e.data.count,t.notify.type=e.data.notifyType)}))},getFloatMessage:function(){if(window._im_visiable){var t=this,e=(new Date).getTime(),n={ts:0};try{n=JSON.parse(u.getItem("im_floatmsg_"+t.uid))||n}catch(t){}if(e-n.ts<6e4&&n.uid===t.uid){var i=n.res;if(0===i.data.length)return;var o=u.getItem("biliMSFCount-100_"+t.uid)||0;i.data[0].count>o&&(t.floatMessage=i.data[0])}else Object(d.a)({url:"//message.bilibili.com/api/tooltip/query.list.do",method:"get"}).then((function(n){var i=n,o={};if(o.res=i,o.ts=e,o.uid=t.uid,u.setItem("im_floatmsg_"+t.uid,JSON.stringify(o)),0!==i.data.length){var a=u.getItem("biliMSFCount-100_"+t.uid)||0;i.data[0].count>a&&(t.floatMessage=i.data[0])}}))}},closeFloatMsg:function(){u.setItem("biliMSFCount-100_"+this.uid,this.floatMessage.count),this.floatMessage=null},clearFloatMsgStore:function(){var t=this;Object(d.a)({url:"//message.bilibili.com/api/tooltip/clear.do",method:"get",data:{mc:this.floatMessage.mc}}).then((function(e){if(0===e.code){var n=document.createElement("a");n.setAttribute("href","//member.bilibili.com/v2#/charge"),n.setAttribute("target","_blank"),n.click(),u.removeItem("biliMSFCount-100_"+t.uid),t.closeFloatMsg()}}))},showDropBox:function(t){var e=this;clearTimeout(this.hoverTimer),this.hoverTimer=setTimeout((function(){e.navDropBox[t].show=!0}),300)},hideDropBox:function(t){var e=this;clearTimeout(this.hoverTimer),this.hoverTimer=setTimeout((function(){e.navDropBox[t].show=!1}),200)}}},h=(n(445),n(2)),p=Object(h.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",{staticClass:"nav-item",on:{click:t.emitClick,mouseleave:function(e){return t.hideDropBox("message")}}},[n("a",{staticClass:"t",attrs:{href:"//message.bilibili.com",target:"_blank",title:"消息"},on:{mouseenter:function(e){return t.showDropBox("message")}}},[t.notify.num&&0===t.notify.type?n("div",{staticClass:"num",domProps:{textContent:t._s(t.notify.num>99?"99+":t.notify.num)}}):t._e(),t.notify.num&&1===t.notify.type?n("div",{staticClass:"red_point"}):t._e(),t._v("\n    消息\n  ")]),t.floatMessage?n("div",{staticClass:"notify-float"},[n("div",{staticClass:"tri"}),n("ul",{staticClass:"float_msg"},[n("div",[t._v("\n        "+t._s(t.floatMessage.message.replace("%s"," "+t.floatMessage.count+" "))+"\n        "),n("span",{on:{click:function(e){return t.clearFloatMsgStore()}}},[t._v("查看详情")])]),n("i",{staticClass:"b-icon",on:{click:function(e){return t.closeFloatMsg()}}})])]):t._e(),n("transition",{attrs:{name:"slide-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.navDropBox.message.show,expression:"navDropBox.message.show"}],staticClass:"i-frame"},[n("iframe",{attrs:{src:"//message.bilibili.com/pages/nav/index_new_sync",frameborder:"0",width:"100%",height:"100%"}})])])],1)}),[],!1,null,"3fb44889",null).exports,m=n(224),g=n(56),v=n(4),b=n(0);function y(t,e,n,i,o,a,r){try{var s=t[a](r),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(i,o)}var _={data:function(){return{isShowPanel:!1,isShowBackdrop:!1,canLottery:!1,draftCount:0}},components:{ImNav:p,BpPopup:g.a,PublishPanel:m.a},props:{loginInfo:{type:Object,default:function(){return{mid:0,face:"",isLogin:!1}}},pageType:{type:String}},computed:{bfsUserHead:function(){return Object(a.g)(Object(s.bfsImgLink)(this.loginInfo.face))}},watch:{isShowBackdrop:function(t){t?document.body.classList.add("bp-stop-scroll"):document.body.classList.remove("bp-stop-scroll")}},mounted:function(){this.fetchLotteryRight(),this.getDraftCount()},methods:{fetchLotteryRight:function(){var t=this;this.bpapi({url:"".concat(v.a.API_VC,"/dynamic_repost/v1/dynamic_repost/pre_judge"),method:"get",data:{uid:this.loginInfo.mid}}).then((function(e){t.canLottery=!!e.data.lottery_right}))},getDraftCount:function(){var t=this;this.bpapi({url:v.a.API_VC+"/dynamic_draft/v1/dynamic_draft/get_draft_cnt",method:"get",data:{}}).then((function(e){t.draftCount=e.data.draft_count||0}))},onMousedown:function(t){(t||window.event).preventDefault()},onImClick:function(){Object(c.d)(b.d.NAV_IM)},onHomeClick:function(){Object(c.d)(b.d.NAV_INDEX),this.pageType===b.c.DETAIL?window.location.href=v.a.T:(window.location.reload(),document.documentElement.scrollTop=document.body.scrollTop=0)},onHeadClick:function(){Object(c.d)(b.d.NAV_HEAD),window.open("".concat(v.a.SPACE,"/").concat(this.loginInfo.mid,"/dynamic"))},onLoginClick:function(){return(t=o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.quickLogin)((function(){Object(c.d)(b.d.LOGIN_SUCCESS,{nologin:1}),window.location.reload()}));case 2:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,o){var a=t.apply(e,n);function r(t){y(a,i,o,r,s,"next",t)}function s(t){y(a,i,o,r,s,"throw",t)}r(void 0)}))})();var t},onRegisterClick:function(){window.location.href="".concat(v.a.PASSPORT,"/register/phone.html")},onPublishClick:function(){var t=this;this.isShowBackdrop=!0,setTimeout((function(){t.isShowPanel=!0}),200),Object(c.d)(b.d.NAV_PUBLISH)},afterPublished:function(t){r.b.$emit("PUBLISH_SUCCEED",t),this.onCancel(),t.isScheduled&&this.draftCount++},onCancel:function(){var t=this;this.isShowPanel=!1,setTimeout((function(){t.isShowBackdrop=!1}),200)}}},C=(n(446),Object(h.a)(_,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sticky-bar"},[i("div",{staticClass:"bar-content"},[i("a",{staticClass:"f-left c-pointer",on:{click:t.onHomeClick}},[i("img",{staticClass:"title-icon f-left",attrs:{src:n(444)}}),i("span",{staticClass:"title fs-14 ls-0 f-left"},[t._v("动态首页")])]),t.loginInfo.isLogin?i("div",{staticClass:"f-right"},[i("div",{staticClass:"send-button c-pointer f-right",on:{click:t.onPublishClick,mousedown:t.onMousedown}},[i("span",{staticClass:"send-text",on:{mousedown:t.onMousedown}},[t._v("发布动态")])]),i("im-nav",{staticClass:"message fs-12 ls-0 c-pointer f-right",attrs:{uid:t.loginInfo.mid},on:{click:t.onImClick}},[t._v("消息")]),i("img",{staticClass:"head f-right c-pointer",attrs:{src:t.bfsUserHead},on:{click:t.onHeadClick}})],1):i("div",{staticClass:"not-login-panel tc-slate fs-12 ls-0 f-right"},[i("div",{staticClass:"login-button f-right c-pointer",on:{click:t.onLoginClick}},[t._v("登录")]),i("div",{staticClass:"register-button f-right c-pointer",on:{click:t.onRegisterClick}},[t._v("注册")])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowBackdrop,expression:"isShowBackdrop"}],staticClass:"backdrop"},[i("div",{staticClass:"position-box"},[i("bp-popup",{staticClass:"dynamic-specification-popup",attrs:{show:t.isShowPanel,width:632,title:"发布动态",button:!1,"on-cancel":t.onCancel}},[i("publish-panel",{attrs:{"login-uid":t.loginInfo.mid,"store-input":!0,"can-vote":!0,"can-lottery":t.canLottery,"can-be-scheduled":!0,"scheduled-count":t.draftCount,"is-popup-panel":!0},on:{succeed:t.afterPublished}})],1)],1)])])}),[],!1,null,"224187b8",null));e.a=C.exports},,function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n(51),n(48),n(13),n(12);var i=[/iPhone/i,/iPod/i,/iPad/i,/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,/Android/i,/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,/Windows Phone/i,/(?=.*\bWindows\b)(?=.*\bARM\b)/i,/BlackBerry/i,/BB10/i,/Opera Mini/i,/(CriOS|Chrome)(?=.*\bMobile\b)/i,/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i")];function o(){var t=window.navigator.userAgent;return i.some((function(e){return e.test(t)}))}n(214)},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA0CAMAAADomgtXAAAA0lBMVEX///8AAAAAAAD///8AAAACAgIAAAAAAAAAAAACAgL09PT///////8CAgK6urr////e3t4AAAD////////////////7+/sCAgL8/Pz////////////o6OjMzMwAAAD9/f39/f3////////////////w8PDOzs6ysrKwsLCXl5d+fn7////////t7e3b29vm5ualpaWRkZHPz88AAAD////////////////h4eHi4uK9vb3V1dXExMQtLS3IyMj///////////////////////+JiYnv39IJAAAARnRSTlNLAALbBQoQCBIMWVZUGTuTNhZZXU5mYx5gUmtpSzoacVzWhHlnV0EpIRkPy7hSSjwxLiUUxaiPdFRFQisiIhnPvq+fl4ocGYilIQAAAkFJREFUSMed1ul2qjAUBeBUISEit0UmrfNQ26teq3Ye7/z+r9QTtlLFooT9RznJlyxWIIGd7KakcpIjLM2Qr4qZEF0Mw1A/qSJq2ZB6rNhEGFu9YjZ5j+kh+P7ARt9N9No483XQZMI4BA3x6jF2Dpm4qy5joZkJS3En/qOWSNydvGoyVruWqKThuhdBF1IKw1AFETvv6UYmY23BtRLClNyJYvlfmiZdm3DzyOXSpLGANzBmwpyszijt9nhYJXmGPNEodnfcbquL1YQwpIJgL2HQqyINRqlt/W+sG3pB+AIKSE7aHsuVel2SVBAurLGcqUICyuvcDiujIDnBR0wjARckFZSXng70LuUGtnwd6LfWUPALppULLhQ0TF5J38Xsn38AVrhpfA3vy+XbYRF4WqbMRkehtQ/j3PUyoJUNkf5pQx8i00EBiPzqFoDI71AfIv2hPkQGxeDtAysCfw58VgD2/zYKLcedV+gBmDULPXJTLIIu7N/77Cjkadid/rHzvMjaW0cCdTcrwJLgutsjF+vt0Q10YOAm+6o11jkCxtYGCu7Wq7ld6OIIOImndHr1fK5eceIJ18ccyUUYeFi8hr0XPOm2F4QLcgIQkrudt+VzTzU/ftvLo60me16+dVwO93mUc8t1onnTt8+jqNNxttLpRFHX9kfzyHEt/nmUkwSlWZ1Fq61aU6Ex262lQ7OBlVKfK0StG1LUvBOqqwaq736u7FCZfM4koUuycocBIugDtBc0QO1AUATNR+qASfZZZv0Dm7Yy8miU9cIAAAAASUVORK5CYII="},function(t,e,n){},function(t,e,n){"use strict";var i=n(175);n.n(i).a},function(t,e,n){"use strict";var i=n(176);n.n(i).a},function(t,e,n){"use strict";var i=n(177);n.n(i).a},function(t,e,n){"use strict";var i=n(178);n.n(i).a},function(t,e,n){"use strict";var i=n(179);n.n(i).a},function(t,e,n){"use strict";var i=n(180);n.n(i).a},function(t,e,n){"use strict";var i=n(181);n.n(i).a},function(t,e,n){"use strict";var i=n(182);n.n(i).a},function(t,e,n){"use strict";var i=n(183);n.n(i).a},function(t,e,n){"use strict";var i=n(184);n.n(i).a},function(t,e,n){"use strict";var i=n(185);n.n(i).a},function(t,e,n){"use strict";var i=n(186);n.n(i).a},function(t,e,n){"use strict";var i=n(187);n.n(i).a},function(t,e,n){"use strict";var i=n(188);n.n(i).a},function(t,e,n){t.exports=n.p+"static/img/icon-music.6ffed546.png"},function(t,e,n){"use strict";var i=n(189);n.n(i).a},function(t,e,n){t.exports=n.p+"static/img/icon-vote.324976be.svg"},function(t,e,n){"use strict";var i=n(190);n.n(i).a},function(t,e,n){"use strict";var i=n(191);n.n(i).a},function(t,e,n){"use strict";var i=n(192);n.n(i).a},function(t,e,n){"use strict";var i=n(193);n.n(i).a},function(t,e,n){"use strict";var i=n(194);n.n(i).a},function(t,e,n){"use strict";var i=n(195);n.n(i).a},function(t,e,n){"use strict";var i=n(196);n.n(i).a},function(t,e,n){"use strict";var i=n(197);n.n(i).a},function(t,e,n){"use strict";var i=n(198);n.n(i).a},function(t,e,n){"use strict";var i=n(199);n.n(i).a},,,function(t,e,n){"use strict";var i=n(200);n.n(i).a},function(t,e,n){"use strict";var i=n(201);n.n(i).a},function(t,e,n){"use strict";var i=n(202);n.n(i).a},function(t,e,n){},function(t,e,n){"use strict";var i=n(203);n.n(i).a},function(t,e,n){"use strict";var i=n(204);n.n(i).a},function(t,e,n){"use strict";var i=n(205);n.n(i).a},function(t,e,n){"use strict";var i=n(206);n.n(i).a},function(t,e,n){"use strict";var i=n(207);n.n(i).a},function(t,e,n){"use strict";var i=n(208);n.n(i).a},function(t,e,n){"use strict";var i=n(209);n.n(i).a},function(t,e,n){"use strict";var i=n(210);n.n(i).a},function(t,e,n){"use strict";var i=n(211);n.n(i).a},function(t,e,n){},,,,,function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAOCAYAAADwikbvAAAAAXNSR0IArs4c6QAAAONJREFUKBVjYEACKuueh6qsfVaAJARnqqx7VgiShwsAGUzInP9MbCcYGP/XKG94K4ssDuH/rwbLI0kwGp/5z/rx0Yvm/wz/4xj+/5dEksPOZGR8zsjAuIhfTqKWEeiUDqBGPcb/7Gl3goWfYNeBEFVZ+1bmP+PPWUADLjEqr3v2DKjRjBiNMCOgBpxiUF779D9MkBQapA8lwGCagRK3YGwQjc6HyWHVDJRUhSmA0uh8sDAuzWh6sXNxab6NphydD5GmLMCAkQ4KejSb8HLB6oH6mECpBRTpxBoAjWNQIllEUfIEAL7CZEeEoUL3AAAAAElFTkSuQmCC"},function(t,e,n){"use strict";var i=n(215);n.n(i).a},function(t,e,n){"use strict";var i=n(216);n.n(i).a},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var i=n(369);n.n(i).a},,,,,,,,,function(t,e,n){"use strict";n.r(e);n(16);var i=n(19),o=n(6),a=n(226),r=n(10),s=n.n(r),c=n(43),l=n(39),u=(n(230),n(232)),d=n(339),f=n(171),h=n(225),p=n(7),m=n(5),g=n(341),v=n(4),b=n(0),y={data:function(){return{cardInfo:void 0,defaultTab:2,pageType:b.c.DETAIL,isInit:!1,isMobile:Object(g.a)(),styleString:"",myLoginInfo:void 0,regString:""}},components:{StickyBar:d.a,Card:u.a,BackTop:f.a,CheckLogin:h.a},mounted:function(){var t=this;this.isMobile&&this.adaptMobile(),this.getWhiteList(),this.getLoginInfo().then((function(){m.r.getUid()?t.getMyUserInfo().then(t.getAttentionList).then(t.getCardInfo):t.getCardInfo(),t.isInit=!0,Object(p.c)("444.42","000391","000502",t.isGuest?{nologin:1}:{})}))},methods:{getLoginInfo:function(){var t=this;return this.bpapi({method:"get",url:"".concat(v.a.API_MAIN,"/x/web-interface/nav")}).then((function(e){m.r.setMyLoginInfo(e.data),t.myLoginInfo=m.r.getMyLoginInfo()}),(function(){return m.r.resetMyLoginInfo(),t.myLoginInfo=m.r.getMyLoginInfo(),0}))},getWhiteList:function(){var t=this;this.bpapi({method:"get",url:"".concat(v.a.API_MAIN,"/x/web-interface/param"),data:{key:"web_scheme_whitelist"}}).then((function(e){t.regString=e.data.value}))},getMyUserInfo:function(){return this.bpapi({url:v.a.API_MAIN+"/x/web-interface/card",method:"get",data:{mid:m.r.getUid(),photo:!0}}).then((function(t){m.r.setMyUserInfo(t.data)}),(function(){return m.r.resetMyUserInfo(),0}))},getAttentionList:function(){return this.bpapi({method:"get",url:"".concat(v.a.API_VC,"/feed/v1/feed/get_attention_list"),data:{uid:m.r.getUid()}}).then((function(t){m.r.setMyAttentionList(t.data.list)}),(function(){return m.r.resetMyAttentionList(),0}))},getCardInfo:function(){var t=this,e=Object(o.h)(window.location),n={};if(~~e.params.type===b.a.PIC){var i=e.path[0];i?(n.rid=~~i,n.type=~~e.params.type):this.redirectTo404()}else{var a=e.path[0];a?n.dynamic_id="".concat(a):this.redirectTo404()}this.bpapi({method:"get",url:v.a.API_VC+"/dynamic_svr/v1/dynamic_svr/get_dynamic_detail",data:n}).then((function(n){n.data.card?(t.cardInfo=n.data.card,t.defaultTab=~~e.params.tab||2,t.modifyTitle()):t.redirectTo404()}),(function(){t.redirectTo404()}))},deleteHandler:function(){window.location.href="".concat(v.a.T)},adaptMobile:function(){var t=document.getElementsByTagName("body")[0],e=(window.innerWidth/632).toFixed(2),n="width: 632px; transform-origin: 0 0; transform: scale(".concat(e,")");t.setAttribute("style",n),this.styleString="min-height: ".concat(100/e,"vh")},modifyTitle:function(){this.cardInfo&&this.cardInfo.desc&&this.cardInfo.desc.user_profile&&this.cardInfo.desc.user_profile&&this.cardInfo.desc.user_profile.info&&this.cardInfo.desc.user_profile.info.uname?document.title="".concat(this.cardInfo.desc.user_profile.info.uname,"的动态-哔哩哔哩"):document.title="动态-哔哩哔哩"},redirectTo404:function(){window.location.href="".concat(v.a.MAIN,"/404")}},computed:{isSelf:function(){return!!this.myLoginInfo.isLogin&&m.r.getUid()===this.cardInfo.desc.uid},isGuest:function(){return!m.r.getUid()}}},_=(n(578),n(2)),C=Object(_.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isInit&&!t.isMobile?n("sticky-bar",{attrs:{"page-type":t.pageType,"login-info":t.myLoginInfo}}):t._e(),n("div",{staticClass:"detail-content"},[n("div",{staticClass:"detail-card",class:{"is-mobile":t.isMobile}},[t.cardInfo?n("card",{class:{"card-is-mobile":t.isMobile},style:t.styleString,attrs:{"card-info":t.cardInfo,"is-self":t.isSelf,"default-tab":t.defaultTab,"page-type":t.pageType,regString:t.regString},on:{delete:t.deleteHandler}}):t._e()],1)]),n("back-top"),n("check-login")],1)}),[],!1,null,"06059f6b",null).exports;n(240),n(336),n(55),n(85),n(54),n(337);s.a.use(c.a),s.a.use(Object(l.a)()),s.a.use(i.b),new s.a({el:"#app",store:a.a,components:{BpPopup:c.a,Detail:C},computed:{appMarginTop:function(){return"IE 9"===Object(o.d)()?"30px":0}},mounted:function(){window.spmReportData={},window.reportConfig={sample:1,scrollTracker:!0,msgObjects:"spmReportData"};var t=document.createElement("script");t.src="https://s1.hdslb.com/bfs/seed/log/report/log-reporter.js",document.getElementsByTagName("body")[0].appendChild(t)}})}]);
//# sourceMappingURL=detail.faad86e9.js.map